var Mixtures;(()=>{var t={20:(t,e,n)=>{"use strict";const i=n(24),s=n(913);class l extends i{static make(t){return new l(t)}static withParser(t){return s(l.make,t)}constructor(t){super(t),this._level=1,this._counter=0}_wait(t,e,n){return"startArray"!==t.name?n(new Error("Top-level object should be an array.")):(this._transform=this._filter,this._transform(t,e,n))}_push(t){this._assembler.current.length&&(t?(++this._counter,this._assembler.current.pop()):this.push({key:this._counter++,value:this._assembler.current.pop()}))}}l.streamArray=l.make,l.make.Constructor=l,t.exports=l},24:(t,e,n)=>{"use strict";const{Transform:i}=n(203),s=n(436);class l{constructor(t){this.depth=t}startObject(){++this.depth}endObject(){--this.depth}startArray(){++this.depth}endArray(){--this.depth}}t.exports=class extends i{constructor(t){super(Object.assign({},t,{writableObjectMode:!0,readableObjectMode:!0})),t&&(this.objectFilter=t.objectFilter,this.includeUndecided=t.includeUndecided),"function"!=typeof this.objectFilter&&(this._filter=this._transform),this._transform=this._wait||this._filter,this._assembler=new s(t)}_transform(t,e,n){this._assembler[t.name]&&(this._assembler[t.name](t.value),this._assembler.depth===this._level&&this._push()),n(null)}_filter(t,e,n){if(this._assembler[t.name]){this._assembler[t.name](t.value);const e=this.objectFilter(this._assembler);if(e)return this._assembler.depth===this._level&&(this._push(),this._transform=this._filter),this._transform=this._accept,n(null);if(!1===e)return this._saved_assembler=this._assembler,this._assembler=new l(this._saved_assembler.depth),this._saved_assembler.dropToLevel(this._level),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter),this._transform=this._reject,n(null);this._assembler.depth===this._level&&this._push(!this.includeUndecided)}n(null)}_accept(t,e,n){this._assembler[t.name]&&(this._assembler[t.name](t.value),this._assembler.depth===this._level&&(this._push(),this._transform=this._filter)),n(null)}_reject(t,e,n){this._assembler[t.name]&&(this._assembler[t.name](t.value),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter)),n(null)}}},193:t=>{"use strict";t.exports=require("string_decoder")},203:t=>{"use strict";t.exports=require("stream")},207:(t,e,n)=>{const i=n(896),s=n(928),l=s.join(__dirname,"path.txt");t.exports=function(){let t;if(i.existsSync(l)&&(t=i.readFileSync(l,"utf-8")),process.env.ELECTRON_OVERRIDE_DIST_PATH)return s.join(process.env.ELECTRON_OVERRIDE_DIST_PATH,t||"electron");if(t)return s.join(__dirname,"dist",t);throw new Error("Electron failed to install correctly, please delete node_modules/electron and try installing again")}()},246:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createFunctionWithReturnValue=e.getGlobal=e.getCurrentWebContents=e.getCurrentWindow=e.getBuiltin=void 0;const i=n(280),s=n(726),l=n(207),r=n(759),o=n(371),{Promise:a}=global,h=new i.CallbacksRegistry,u=new Map,m=new FinalizationRegistry((t=>{const e=u.get(t);void 0!==e&&void 0===e.deref()&&(u.delete(t),l.ipcRenderer.send("REMOTE_BROWSER_DEREFERENCE",f,t,0))})),c=new WeakMap,d=new WeakSet,f=process.contextId||function(){const t=o.getElectronBinding("v8_util");if(t)return t.getHiddenValue(global,"contextId");throw new Error("Electron >=v13.0.0-beta.6 required to support sandboxed renderers")}();process.on("exit",(()=>{l.ipcRenderer.send("REMOTE_BROWSER_CONTEXT_RELEASE",f)}));const p=Symbol("is-remote-proxy");function C(t,e=new Set){const n=t=>{if(e.has(t))return{type:"value",value:null};if(t&&t.constructor&&"NativeImage"===t.constructor.name)return{type:"nativeimage",value:s.serialize(t)};if(Array.isArray(t)){e.add(t);const n={type:"array",value:C(t,e)};return e.delete(t),n}if(t instanceof Buffer)return{type:"buffer",value:t};if(s.isSerializableObject(t))return{type:"value",value:t};if("object"==typeof t){if(s.isPromise(t))return{type:"promise",then:n((function(e,n){t.then(e,n)}))};if(c.has(t))return{type:"remote-object",id:c.get(t)};const i={type:"object",name:t.constructor?t.constructor.name:"",members:[]};e.add(t);for(const e in t)i.members.push({name:e,value:n(t[e])});return e.delete(t),i}return"function"==typeof t&&d.has(t)?{type:"function-with-return-value",value:n(t())}:"function"==typeof t?{type:"function",id:h.add(t),location:h.getLocation(t),length:t.length}:{type:"value",value:t}};return t.map(n)}function g(t,e,n,i){if(Array.isArray(i))for(const s of i){if(Object.prototype.hasOwnProperty.call(e,s.name))continue;const i={enumerable:s.enumerable};if("method"===s.type){const e=function(...t){let i;return i=this&&this.constructor===e?"REMOTE_BROWSER_MEMBER_CONSTRUCTOR":"REMOTE_BROWSER_MEMBER_CALL",y(l.ipcRenderer.sendSync(i,f,n,s.name,C(t)))};let r=b(e,n,s.name);i.get=()=>(r.ref=t,r),i.set=t=>(r=t,t),i.configurable=!0}else"get"===s.type&&(i.get=()=>y(l.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_GET",f,n,s.name)),s.writable&&(i.set=t=>{const e=C([t]),i=l.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_SET",f,n,s.name,e);return null!=i&&y(i),t}));Object.defineProperty(e,s.name,i)}}function A(t,e,n,i){if(null===i)return;const s={};g(t,s,n,i.members),A(t,s,n,i.proto),Object.setPrototypeOf(e,s)}function b(t,e,n){let i=!1;const s=()=>{if(i)return;i=!0;const s=l.ipcRenderer.sendSync("REMOTE_BROWSER_MEMBER_GET",f,e,n);g(t,t,s.id,s.members)};return new Proxy(t,{set:(t,e,n)=>("ref"!==e&&s(),t[e]=n,!0),get:(t,e)=>{if(e===p)return!0;Object.prototype.hasOwnProperty.call(t,e)||s();const n=t[e];return"toString"===e&&"function"==typeof n?n.bind(t):n},ownKeys:t=>(s(),Object.getOwnPropertyNames(t)),getOwnPropertyDescriptor:(t,e)=>Object.getOwnPropertyDescriptor(t,e)||(s(),Object.getOwnPropertyDescriptor(t,e))})}function y(t){if(!t)return{};if("value"===t.type)return t.value;if("array"===t.type)return t.members.map((t=>y(t)));if("nativeimage"===t.type)return s.deserialize(t.value);if("buffer"===t.type)return Buffer.from(t.value.buffer,t.value.byteOffset,t.value.byteLength);if("promise"===t.type)return a.resolve({then:y(t.then)});if("error"===t.type)return E(t);if("exception"===t.type)throw"error"===t.value.type?E(t.value):new Error(`Unexpected value type in exception: ${t.value.type}`);{let e;if("id"in t){const e=function(t){const e=u.get(t);if(void 0!==e){const t=e.deref();if(void 0!==t)return t}}(t.id);if(void 0!==e)return e}if("function"===t.type){const n=function(...e){let i;return i=this&&this.constructor===n?"REMOTE_BROWSER_CONSTRUCTOR":"REMOTE_BROWSER_FUNCTION_CALL",y(l.ipcRenderer.sendSync(i,f,t.id,C(e)))};e=n}else e={};return g(e,e,t.id,t.members),A(e,e,t.id,t.proto),e.constructor&&e.constructor[p]&&Object.defineProperty(e.constructor,"name",{value:t.name}),c.set(e,t.id),function(t,e){const n=new WeakRef(e);u.set(t,n),m.register(e,t)}(t.id,e),e}}function E(t){const e=t.value;for(const{name:n,value:i}of t.members)e[n]=y(i);return e}function x(t,e){l.ipcRenderer.on(t,((n,i,s,...r)=>{"number"!=typeof n.senderId||0===n.senderId||void 0===n.senderId?i===f?e(s,...r):l.ipcRenderer.send("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",f,i,s):console.error(`Message ${t} sent by unexpected WebContents (${n.senderId})`)}))}const M=process.argv.includes("--enable-api-filtering-logging");function v(){const t={stack:void 0};return M&&Error.captureStackTrace(t,v),t.stack}x("REMOTE_RENDERER_CALLBACK",((t,e)=>{h.apply(t,y(e))})),x("REMOTE_RENDERER_RELEASE_CALLBACK",(t=>{h.remove(t)})),e.require=t=>y(l.ipcRenderer.sendSync("REMOTE_BROWSER_REQUIRE",f,t,v())),e.getBuiltin=function(t){return y(l.ipcRenderer.sendSync("REMOTE_BROWSER_GET_BUILTIN",f,t,v()))},e.getCurrentWindow=function(){return y(l.ipcRenderer.sendSync("REMOTE_BROWSER_GET_CURRENT_WINDOW",f,v()))},e.getCurrentWebContents=function(){return y(l.ipcRenderer.sendSync("REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",f,v()))},e.getGlobal=function(t){return y(l.ipcRenderer.sendSync("REMOTE_BROWSER_GET_GLOBAL",f,t,v()))},Object.defineProperty(e,"process",{enumerable:!0,get:()=>e.getGlobal("process")}),e.createFunctionWithReturnValue=function(t){const e=()=>t;return d.add(e),e},r.browserModuleNames.forEach((t=>{Object.defineProperty(e,t,{enumerable:!0,get:()=>e.getBuiltin(t)})}))},280:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CallbacksRegistry=void 0,e.CallbacksRegistry=class{constructor(){this.nextId=0,this.callbacks={},this.callbackIds=new WeakMap,this.locationInfo=new WeakMap}add(t){let e=this.callbackIds.get(t);if(null!=e)return e;e=this.nextId+=1,this.callbacks[e]=t,this.callbackIds.set(t,e);const n=/at (.*)/gi,i=(new Error).stack;if(!i)return e;let s,l;for(;null!==(l=n.exec(i));){const t=l[1];if(t.includes("(native)"))continue;if(t.includes("(<anonymous>)"))continue;if(t.includes("callbacks-registry.js"))continue;if(t.includes("remote.js"))continue;if(t.includes("@electron/remote/dist"))continue;const e=/([^/^)]*)\)?$/gi.exec(t);e&&(s=e[1]);break}return this.locationInfo.set(t,s),e}get(t){return this.callbacks[t]||function(){}}getLocation(t){return this.locationInfo.get(t)}apply(t,...e){return this.get(t).apply(global,...e)}remove(t){const e=this.callbacks[t];e&&(this.callbackIds.delete(e),delete this.callbacks[t])}}},317:t=>{"use strict";t.exports=require("child_process")},319:(t,e,n)=>{"use strict";const i=n(437),s={value1:/^(?:[\"\{\[\]\-\d]|true\b|false\b|null\b|\s{1,256})/,string:/^(?:[^\x00-\x1f\"\\]{1,256}|\\[bfnrt\"\\\/]|\\u[\da-fA-F]{4}|\")/,key1:/^(?:[\"\}]|\s{1,256})/,colon:/^(?:\:|\s{1,256})/,comma:/^(?:[\,\]\}]|\s{1,256})/,ws:/^\s{1,256}/,numberStart:/^\d/,numberDigit:/^\d{0,256}/,numberFraction:/^[\.eE]/,numberExponent:/^[eE]/,numberExpSign:/^[-+]/};let l=!0;try{new RegExp(".","y"),l=!1}catch(t){}!l&&Object.keys(s).forEach((t=>{let e=s[t].source.slice(1);"(?:"===e.slice(0,3)&&")"===e.slice(-1)&&(e=e.slice(3,-1)),s[t]=new RegExp(e,"y")})),s.numberFracStart=s.numberExpStart=s.numberStart,s.numberFracDigit=s.numberExpDigit=s.numberDigit;const r={true:!0,false:!1,null:null},o={object:"objectStop",array:"arrayStop","":"done"},a={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",'"':'"',"\\":"\\","/":"/"};class h extends i{static make(t){return new h(t)}constructor(t){super(Object.assign({},t,{readableObjectMode:!0})),this._packKeys=this._packStrings=this._packNumbers=this._streamKeys=this._streamStrings=this._streamNumbers=!0,t&&("packValues"in t&&(this._packKeys=this._packStrings=this._packNumbers=t.packValues),"packKeys"in t&&(this._packKeys=t.packKeys),"packStrings"in t&&(this._packStrings=t.packStrings),"packNumbers"in t&&(this._packNumbers=t.packNumbers),"streamValues"in t&&(this._streamKeys=this._streamStrings=this._streamNumbers=t.streamValues),"streamKeys"in t&&(this._streamKeys=t.streamKeys),"streamStrings"in t&&(this._streamStrings=t.streamStrings),"streamNumbers"in t&&(this._streamNumbers=t.streamNumbers),this._jsonStreaming=t.jsonStreaming),!this._packKeys&&(this._streamKeys=!0),!this._packStrings&&(this._streamStrings=!0),!this._packNumbers&&(this._streamNumbers=!0),this._done=!1,this._expect=this._jsonStreaming?"done":"value",this._stack=[],this._parent="",this._open_number=!1,this._accumulator=""}_flush(t){this._done=!0,super._flush((e=>{if(e)return t(e);this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),t(null)}))}_processBuffer(t){let e,n,i=0;t:for(;;)switch(this._expect){case"value1":case"value":if(s.value1.lastIndex=i,e=s.value1.exec(this._buffer),!e){if(this._done||i+16<this._buffer.length)return i<this._buffer.length?t(new Error("Parser cannot parse input: expected a value")):t(new Error("Parser has expected a value"));break t}switch(n=e[0],n){case'"':this._streamStrings&&this.push({name:"startString"}),this._expect="string";break;case"{":this.push({name:"startObject"}),this._stack.push(this._parent),this._parent="object",this._expect="key1";break;case"[":this.push({name:"startArray"}),this._stack.push(this._parent),this._parent="array",this._expect="value1";break;case"]":if("value1"!==this._expect)return t(new Error("Parser cannot parse input: unexpected token ']'"));this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),this.push({name:"endArray"}),this._parent=this._stack.pop(),this._expect=o[this._parent];break;case"-":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"-"})),this._packNumbers&&(this._accumulator="-"),this._expect="numberStart";break;case"0":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"0"})),this._packNumbers&&(this._accumulator="0"),this._expect="numberFraction";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:n})),this._packNumbers&&(this._accumulator=n),this._expect="numberDigit";break;case"true":case"false":case"null":if(this._buffer.length-i===n.length&&!this._done)break t;this.push({name:n+"Value",value:r[n]}),this._expect=o[this._parent]}l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"keyVal":case"string":if(s.string.lastIndex=i,e=s.string.exec(this._buffer),!e){if(i<this._buffer.length&&(this._done||this._buffer.length-i>=6))return t(new Error("Parser cannot parse input: escaped characters"));if(this._done)return t(new Error("Parser has expected a string value"));break t}if(n=e[0],'"'===n)"keyVal"===this._expect?(this._streamKeys&&this.push({name:"endKey"}),this._packKeys&&(this.push({name:"keyValue",value:this._accumulator}),this._accumulator=""),this._expect="colon"):(this._streamStrings&&this.push({name:"endString"}),this._packStrings&&(this.push({name:"stringValue",value:this._accumulator}),this._accumulator=""),this._expect=o[this._parent]);else if(n.length>1&&"\\"===n.charAt(0)){const t=2==n.length?a[n.charAt(1)]:(h=n,String.fromCharCode(parseInt(h.slice(2),16)));("keyVal"===this._expect?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:t}),("keyVal"===this._expect?this._packKeys:this._packStrings)&&(this._accumulator+=t)}else("keyVal"===this._expect?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:n}),("keyVal"===this._expect?this._packKeys:this._packStrings)&&(this._accumulator+=n);l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"key1":case"key":if(s.key1.lastIndex=i,e=s.key1.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected an object key"));break t}if(n=e[0],'"'===n)this._streamKeys&&this.push({name:"startKey"}),this._expect="keyVal";else if("}"===n){if("key1"!==this._expect)return t(new Error("Parser cannot parse input: unexpected token '}'"));this.push({name:"endObject"}),this._parent=this._stack.pop(),this._expect=o[this._parent]}l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"colon":if(s.colon.lastIndex=i,e=s.colon.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected ':'"));break t}n=e[0],":"===n&&(this._expect="value"),l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"arrayStop":case"objectStop":if(s.comma.lastIndex=i,e=s.comma.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected ','"));break t}if(this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),n=e[0],","===n)this._expect="arrayStop"===this._expect?"value":"key";else if("}"===n||"]"===n){if("}"===n?"arrayStop"===this._expect:"arrayStop"!==this._expect)return t(new Error("Parser cannot parse input: expected '"+("arrayStop"===this._expect?"]":"}")+"'"));this.push({name:"}"===n?"endObject":"endArray"}),this._parent=this._stack.pop(),this._expect=o[this._parent]}l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberStart":if(s.numberStart.lastIndex=i,e=s.numberStart.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected a starting digit"));break t}n=e[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="0"===n?"numberFraction":"numberDigit",l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberDigit":if(s.numberDigit.lastIndex=i,e=s.numberDigit.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected a digit"));break t}if(n=e[0],!n){if(i<this._buffer.length){this._expect="numberFraction";break}if(this._done){this._expect=o[this._parent];break}break t}this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberFraction":if(s.numberFraction.lastIndex=i,e=s.numberFraction.exec(this._buffer),!e){if(i<this._buffer.length||this._done){this._expect=o[this._parent];break}break t}n=e[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="."===n?"numberFracStart":"numberExpSign",l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberFracStart":if(s.numberFracStart.lastIndex=i,e=s.numberFracStart.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected a fractional part of a number"));break t}n=e[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberFracDigit",l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberFracDigit":if(s.numberFracDigit.lastIndex=i,e=s.numberFracDigit.exec(this._buffer),n=e[0],!n){if(i<this._buffer.length){this._expect="numberExponent";break}if(this._done){this._expect=o[this._parent];break}break t}this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberExponent":if(s.numberExponent.lastIndex=i,e=s.numberExponent.exec(this._buffer),!e){if(i<this._buffer.length){this._expect=o[this._parent];break}if(this._done){this._expect="done";break}break t}n=e[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpSign",l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberExpSign":if(s.numberExpSign.lastIndex=i,e=s.numberExpSign.exec(this._buffer),!e){if(i<this._buffer.length){this._expect="numberExpStart";break}if(this._done)return t(new Error("Parser has expected an exponent value of a number"));break t}n=e[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpStart",l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberExpStart":if(s.numberExpStart.lastIndex=i,e=s.numberExpStart.exec(this._buffer),!e){if(i<this._buffer.length||this._done)return t(new Error("Parser cannot parse input: expected an exponent part of a number"));break t}n=e[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpDigit",l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"numberExpDigit":if(s.numberExpDigit.lastIndex=i,e=s.numberExpDigit.exec(this._buffer),n=e[0],!n){if(i<this._buffer.length||this._done){this._expect=o[this._parent];break}break t}this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),l?this._buffer=this._buffer.slice(n.length):i+=n.length;break;case"done":if(s.ws.lastIndex=i,e=s.ws.exec(this._buffer),!e){if(i<this._buffer.length){if(this._jsonStreaming){this._expect="value";break}return t(new Error("Parser cannot parse input: unexpected characters"))}break t}n=e[0],this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),l?this._buffer=this._buffer.slice(n.length):i+=n.length}var h;!l&&(this._buffer=this._buffer.slice(i)),t(null)}}h.parser=h.make,h.make.Constructor=h,t.exports=h},371:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getElectronBinding=void 0,e.getElectronBinding=t=>process._linkedBinding?process._linkedBinding("electron_common_"+t):process.electronBinding?process.electronBinding(t):null},434:t=>{"use strict";t.exports=require("events")},436:(t,e,n)=>{"use strict";const i=n(434),s=t=>function(){this.done?this.done=!1:this.stack.push(this.current,this.key),this.current=new t,this.key=null};class l extends i{static connectTo(t,e){return new l(e).connectTo(t)}constructor(t){super(),this.stack=[],this.current=this.key=null,this.done=!0,t&&(this.reviver="function"==typeof t.reviver&&t.reviver,this.reviver&&(this.stringValue=this._saveValue=this._saveValueWithReviver),t.numberAsString&&(this.numberValue=this.stringValue))}connectTo(t){return t.on("data",(t=>{this[t.name]&&(this[t.name](t.value),this.done&&this.emit("done",this))})),this}get depth(){return(this.stack.length>>1)+(this.done?0:1)}get path(){const t=[];for(let e=0;e<this.stack.length;e+=2){const n=this.stack[e+1];t.push(null===n?this.stack[e].length:n)}return t}dropToLevel(t){if(t<this.depth)if(t){const e=t-1<<1;this.current=this.stack[e],this.key=this.stack[e+1],this.stack.splice(e)}else this.stack=[],this.current=this.key=null,this.done=!0;return this}consume(t){return this[t.name]&&this[t.name](t.value),this}keyValue(t){this.key=t}numberValue(t){this._saveValue(parseFloat(t))}nullValue(){this._saveValue(null)}trueValue(){this._saveValue(!0)}falseValue(){this._saveValue(!1)}endObject(){if(this.stack.length){const t=this.current;this.key=this.stack.pop(),this.current=this.stack.pop(),this._saveValue(t)}else this.done=!0}_saveValue(t){this.done?this.current=t:this.current instanceof Array?this.current.push(t):(this.current[this.key]=t,this.key=null)}_saveValueWithReviver(t){this.done?this.current=this.reviver("",t):this.current instanceof Array?(t=this.reviver(""+this.current.length,t),this.current.push(t),void 0===t&&delete this.current[this.current.length-1]):(void 0!==(t=this.reviver(this.key,t))&&(this.current[this.key]=t),this.key=null)}}l.prototype.stringValue=l.prototype._saveValue,l.prototype.startObject=s(Object),l.prototype.startArray=s(Array),l.prototype.endArray=l.prototype.endObject,t.exports=l},437:(t,e,n)=>{"use strict";const{Transform:i}=n(203),{StringDecoder:s}=n(193);t.exports=class extends i{constructor(t){super(Object.assign({},t,{writableObjectMode:!1})),this._buffer=""}_transform(t,e,n){"string"==typeof t?this._transform=this._transformString:(this._stringDecoder=new s,this._transform=this._transformBuffer),this._transform(t,e,n)}_transformBuffer(t,e,n){this._buffer+=this._stringDecoder.write(t),this._processBuffer(n)}_transformString(t,e,n){this._buffer+=t.toString(),this._processBuffer(n)}_processBuffer(t){this._buffer&&(this.push(this._buffer,"utf8"),this._buffer=""),t(null)}_flushInput(){this._stringDecoder&&(this._buffer+=this._stringDecoder.end())}_flush(t){this._flushInput(),this._processBuffer(t)}}},606:(t,e,n)=>{t.exports=n(918)},726:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deserialize=e.serialize=e.isSerializableObject=e.isPromise=void 0;const i=n(207);e.isPromise=function(t){return t&&t.then&&t.then instanceof Function&&t.constructor&&t.constructor.reject&&t.constructor.reject instanceof Function&&t.constructor.resolve&&t.constructor.resolve instanceof Function};const s=[Boolean,Number,String,Date,Error,RegExp,ArrayBuffer];function l(t){return null===t||ArrayBuffer.isView(t)||s.some((e=>t instanceof e))}e.isSerializableObject=l;const r=function(t,e){const n=Object.entries(t).map((([t,n])=>[t,e(n)]));return Object.fromEntries(n)};e.serialize=function t(e){return e&&e.constructor&&"NativeImage"===e.constructor.name?function(t){const e=[],n=t.getScaleFactors();if(1===n.length){const i=n[0],s=t.getSize(i),l=t.toBitmap({scaleFactor:i});e.push({scaleFactor:i,size:s,buffer:l})}else for(const i of n){const n=t.getSize(i),s=t.toDataURL({scaleFactor:i});e.push({scaleFactor:i,size:n,dataURL:s})}return{__ELECTRON_SERIALIZED_NativeImage__:!0,representations:e}}(e):Array.isArray(e)?e.map(t):l(e)?e:e instanceof Object?r(e,t):e},e.deserialize=function t(e){return e&&e.__ELECTRON_SERIALIZED_NativeImage__?function(t){const e=i.nativeImage.createEmpty();if(1===t.representations.length){const{buffer:n,size:i,scaleFactor:s}=t.representations[0],{width:l,height:r}=i;e.addRepresentation({buffer:n,scaleFactor:s,width:l,height:r})}else for(const n of t.representations){const{dataURL:t,size:i,scaleFactor:s}=n,{width:l,height:r}=i;e.addRepresentation({dataURL:t,scaleFactor:s,width:l,height:r})}return e}(e):Array.isArray(e)?e.map(t):l(e)?e:e instanceof Object?r(e,t):e}},759:(t,e,n)=>{"use strict";var i,s;Object.defineProperty(e,"__esModule",{value:!0}),e.browserModuleNames=e.commonModuleNames=void 0;const l=n(371);e.commonModuleNames=["clipboard","nativeImage","shell"],e.browserModuleNames=["app","autoUpdater","BaseWindow","BrowserView","BrowserWindow","contentTracing","crashReporter","dialog","globalShortcut","ipcMain","inAppPurchase","Menu","MenuItem","nativeTheme","net","netLog","MessageChannelMain","Notification","powerMonitor","powerSaveBlocker","protocol","pushNotifications","safeStorage","screen","session","ShareMenu","systemPreferences","TopLevelWindow","TouchBar","Tray","utilityProcess","View","webContents","WebContentsView","webFrameMain"].concat(e.commonModuleNames);const r=l.getElectronBinding("features");!1!==(null===(i=null==r?void 0:r.isDesktopCapturerEnabled)||void 0===i?void 0:i.call(r))&&e.browserModuleNames.push("desktopCapturer"),!1!==(null===(s=null==r?void 0:r.isViewApiEnabled)||void 0===s?void 0:s.call(r))&&e.browserModuleNames.push("ImageView")},896:t=>{"use strict";t.exports=require("fs")},913:(t,e,n)=>{"use strict";const{chain:i}=n(969),s=n(319);t.exports=(t,e)=>i([new s(e),t(e)],Object.assign({},e,{writableObjectMode:!1,readableObjectMode:!0}))},918:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),s=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};if(Object.defineProperty(e,"__esModule",{value:!0}),"browser"===process.type)throw new Error('"@electron/remote" cannot be required in the browser process. Instead require("@electron/remote/main").');s(n(246),e)},928:t=>{"use strict";t.exports=require("path")},932:t=>{"use strict";t.exports=require("process")},969:(t,e,n)=>{"use strict";const{Readable:i,Writable:s,Duplex:l,Transform:r}=n(203),o=Symbol.for("object-stream.none"),a=Symbol.for("object-stream.final"),h=Symbol.for("object-stream.many"),u=t=>new r({writableObjectMode:!0,readableObjectMode:!0,transform(e,n,i){try{const s=t.call(this,e,n);if(s&&"function"==typeof s.then)return void s.then((t=>(f.sanitize(t,this),i(null))),(t=>i(t)));if(s&&"function"==typeof s.next)return void(async(t,e)=>{for(;;){let n=t.next();if(n&&"function"==typeof n.then&&(n=await n),n.done)break;let i=n.value;i&&"function"==typeof i.then&&(i=await i),f.sanitize(i,e)}})(s,this).then((()=>i(null)),(t=>i(t)));f.sanitize(s,this),i(null)}catch(t){i(t)}}}),m=t=>new r({writableObjectMode:!0,readableObjectMode:!0,transform(e,n,i){try{let s=e;for(let e=0;e<t.length;++e){const l=t[e].call(this,s,n);if(l===f.none)return void i(null);if(f.isFinal(l)){s=f.getFinalValue(l);break}s=l}f.sanitize(s,this),i(null)}catch(t){i(t)}}}),c=t=>t&&"function"==typeof t.pipe&&"function"==typeof t.on&&(!t._writableState||!1!==("object"==typeof t._readableState?t._readableState.readable:null))&&(!t._writableState||t._readableState),d=t=>t&&"function"==typeof t.write&&"function"==typeof t.on&&(!t._readableState||!1!==("object"==typeof t._writableState?t._writableState.writable:null));class f extends l{constructor(t,e){if(super(e||{writableObjectMode:!0,readableObjectMode:!0}),!(t instanceof Array&&t.length))throw Error("Chain's argument should be a non-empty array.");this.streams=t.filter((t=>t)).map(((t,e,n)=>{if("function"==typeof t||t instanceof Array)return f.convertToTransform(t);if((i=t)&&"function"==typeof i.pipe&&i._readableState&&"function"==typeof i.on&&"function"==typeof i.write||!e&&c(t)||e===n.length-1&&d(t))return t;var i;throw Error("Arguments should be functions, arrays or streams.")})).filter((t=>t)),this.input=this.streams[0],this.output=this.streams.reduce(((t,e)=>t&&t.pipe(e)||e)),d(this.input)||(this._write=(t,e,n)=>n(null),this._final=t=>t(null),this.input.on("end",(()=>this.end()))),c(this.output)?(this.output.on("data",(t=>!this.push(t)&&this.output.pause())),this.output.on("end",(()=>this.push(null)))):(this._read=()=>{},this.resume(),this.output.on("finish",(()=>this.push(null)))),e&&e.skipEvents||this.streams.forEach((t=>t.on("error",(t=>this.emit("error",t)))))}_write(t,e,n){let i=null;try{this.input.write(t,e,(t=>n(t||i)))}catch(t){i=t}}_final(t){let e=null;try{this.input.end(null,null,(n=>t(n||e)))}catch(t){e=t}}_read(){this.output.resume()}static make(t,e){return new f(t,e)}static sanitize(t,e){f.isFinal(t)?t=f.getFinalValue(t):f.isMany(t)&&(t=f.getManyValues(t)),null!=t&&t!==f.none&&(t instanceof Array?t.forEach((t=>null!=t&&e.push(t))):e.push(t))}static convertToTransform(t){return"function"==typeof t?u(t):t instanceof Array&&t.length?m(t):null}}f.none=o,f.final=t=>({[a]:t}),f.isFinal=t=>t&&"object"==typeof t&&a in t,f.getFinalValue=t=>t[a],f.many=t=>({[h]:t}),f.isMany=t=>t&&"object"==typeof t&&h in t,f.getManyValues=t=>t[h],f.chain=f.make,f.make.Constructor=f,t.exports=f}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var l=e[i]={exports:{}};return t[i].call(l.exports,l,l.exports,n),l.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};(()=>{"use strict";n.r(i),n.d(i,{Console:()=>nn});class t{static isBlank(t){return null==t||0==t.length}static notBlank(t){return null!=t&&t.length>0}static safeArray(t){return null==t?[]:t}static len(t){return null==t?0:t.length}static arrayLength(t){return null==t?0:t.length}static anyTrue(t){if(null==t)return!1;for(let e of t)if(e)return!0;return!1}static allTrue(t){if(null==t)return!0;for(let e of t)if(!e)return!1;return!0}static anyFalse(t){if(null==t)return!1;for(let e of t)if(!e)return!0;return!1}static allFalse(t){if(null==t)return!0;for(let e of t)if(e)return!1;return!0}static iterAnyTrue(t,e){for(let n of t)if(e(n))return!0;return!1}static iterAllTrue(t,e){for(let n of t)if(!e(n))return!1;return!0}static iterAnyFalse(t,e){for(let n of t)if(!e(n))return!0;return!1}static iterAllFalse(t,e){for(let n of t)if(e(n))return!1;return!0}static swap(t,e,n){let i=t[e];t[e]=t[n],t[n]=i}static duplicate(t){return null==t?[]:t.slice(0)}static append(t,e){return null==t||0==t.length?[e]:((t=t.slice(0)).push(e),t)}static prepend(t,e){return null==t||0==t.length?[e]:((t=t.slice(0)).unshift(e),t)}static concat(t,e){return null==t&&null==e?[]:null==t?e.slice(0):null==e?t.slice(0):t.concat(e)}static remove(t,e){return(t=t.slice(0)).splice(e,1),t}static flatten(t){let e=[];for(let n of t)e.push(...n);return e}static transpose(e){let n=e.length,i=e[0].length,s=t.anyArray(null,i);for(let l=0;l<i;l++){s[l]=t.anyArray(null,n);for(let t=0;t<n;t++)s[l][t]=e[t][l]}return s}static equals(t,e){if(null==t&&null==e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n])return!1;return!0}static equivalent(t,e){const n=null==t?0:t.length;if(n!=(null==e?0:e.length))return!1;for(let i=0;i<n;i++)if(t[i]!=e[i])return!1;return!0}static compareTo(t,e){const n=Math.max(t.length,e.length);for(let i=0;i<n;i++){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1}return 0}static booleanArray(t,e){let n=new Array(e);return n.fill(t),n}static numberArray(t,e){let n=new Array(e);return n.fill(t),n}static stringArray(t,e){let n=new Array(e);return n.fill(t),n}static anyArray(t,e){let n=new Array(e);return n.fill(t),n}static genericArray(t,e){let n=new Array(e);return n.fill(t),n}static genericBlankArrays(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}static funcArray(t,e){let n=new Array(t);for(let i=0;i<t;i++)n[i]=e(i);return n}static first(t){return null==t||0==t.length?null:t[0]}static last(t){return null==t||0==t.length?null:t[t.length-1]}static min(t){if(null==t||0==t.length)return Number.MAX_VALUE;let e=t[0];for(let n=1;n<t.length;n++)e=Math.min(e,t[n]);return e}static max(t){if(null==t||0==t.length)return Number.MIN_VALUE;let e=t[0];for(let n=1;n<t.length;n++)e=Math.max(e,t[n]);return e}static idxMin(t){if(null==t||0==t.length)return-1;let e=0;for(let n=1;n<t.length;n++)t[n]<t[e]&&(e=n);return e}static idxMax(t){if(null==t||0==t.length)return-1;let e=0;for(let n=1;n<t.length;n++)t[n]>t[e]&&(e=n);return e}static range(t){if(null==t||0==t.length)return 0;let e=t[0],n=t[0];for(let i=1;i<t.length;i++)t[i]<e&&(e=t[i]),t[i]>n&&(n=t[i]);return n-e}static reverse(t){let e=[];for(let n=t.length-1;n>=0;n--)e.push(t[n]);return e}static identity0(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=n;return e}static identity1(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=n+1;return e}static identityN(t,e){let n=new Array(e);for(let i=0;i<e;i++)n[i]=i+t;return n}static notMask(t){let e=new Array(t.length);for(let n=t.length-1;n>=0;n--)e[n]=!t[n];return e}static idxGet(t,e){let n=[];for(let i=0;i<e.length;i++)n.push(t[e[i]]);return n}static maskCount(t){if(!t)return 0;let e=0;for(let n=t.length-1;n>=0;n--)t[n]&&e++;return e}static maskIdx(t){let e=[];for(let n=0;n<t.length;n++)t[n]&&e.push(n);return e}static idxMask(e,n){let i=t.booleanArray(!1,n);for(let t of e)i[t]=!0;return i}static maskMap(t){let e=[];for(let n=0,i=0;n<t.length;n++)e.push(t[n]?i++:-1);return e}static maskGet(t,e){let n=[];for(let i=0;i<t.length;i++)e[i]&&n.push(t[i]);return n}static maskEqual(t,e){let n=[];if(e.constructor===Array){let i=e;for(let e=0;e<t.length;e++)n.push(t[e]==i[e])}else for(let i=0;i<t.length;i++)n.push(t[i]==e);return n}static sum(t){if(null==t||0==t.length)return 0;let e=t[0];for(let n=1;n<t.length;n++)e+=t[n];return e}static add(t,e){let n=[];if(e.constructor===Array){let i=e;for(let e=0;e<t.length;e++)n.push(t[e]+i[e])}else for(let i=0;i<t.length;i++)n.push(t[i]+e);return n}static sub(t,e){let n=[];if(e.constructor===Array){let i=e;for(let e=0;e<t.length;e++)n.push(t[e]-i[e])}else for(let i=0;i<t.length;i++)n.push(t[i]-e);return n}static mul(t,e){let n=[];if(e.constructor===Array){let i=e;for(let e=0;e<t.length;e++)n.push(t[e]*i[e])}else for(let i=0;i<t.length;i++)n.push(t[i]*e);return n}static neg(t){let e=t.slice(0);for(let t=e.length-1;t>=0;t--)e[t]*=-1;return e}static setTo(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]=e}static addTo(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]+=e}static mulBy(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]*=e}static setToArray(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]=e[n]}static addToArray(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]+=e[n]}static subFromArray(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]-=e[n]}static mulByArray(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]*=e[n]}static divByArray(t,e){for(let n=null==t?-1:t.length-1;n>=0;n--)t[n]/=e[n]}static idxSort(t){let e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=n;return e.sort(((e,n)=>t[e]<t[n]?-1:t[e]>t[n]?1:0)),e}static sort(t){t.sort(((t,e)=>t-e))}static sorted(t){return t=t.slice(0),this.sort(t),t}static sortedUnique(e){if(null==e||0==e.length)return[];let n=t.uniqueUnstable(e);return"number"==typeof e[0]?this.sort(n):n.sort(),n}static uniqueUnstable(t){return Array.from(new Set(t))}static uniqueStable(t){let e=new Set(t),n=[];for(let i of t)e.has(i)&&(n.push(i),e.delete(i));return n}static maskUnique(t){let e=new Set(t),n=this.booleanArray(!1,t.length);for(let i=0;i<t.length;i++)e.has(t[i])&&(n[i]=!0,e.delete(t[i]));return n}static idxUnique(t){let e=new Set(t),n=[];for(let i=0;i<t.length;i++)e.has(t[i])&&(n.push(i),e.delete(t[i]));return n}static exclude(e,n){const i=t.len(e);if(0==i)return[];let s=new Array(i),l=0;for(let t=0;t<e.length;t++)s[t]=n.indexOf(e[t])<0,s[t]&&l++;return l==i?e:t.maskGet(e,s)}}class e{static parityPerms(e){let n=t.booleanArray(!1,e.length),i=0;for(let t=e.length-1;t>=0;t--)if(n[t])i++;else{let i=t;do{i=e[i],n[i]=!0}while(i!=t)}return i}static parityIdentity(t){return 1&this.parityPerms(t)}static parityOrder(t){if(t.length<=1)return 0;if(2==t.length)return t[0]<t[1]?0:1;if(3==t.length){let e=1;return t[0]<t[1]&&e++,t[0]<t[2]&&e++,t[1]<t[2]&&e++,1&e}if(4==t.length){let e=0;return t[0]<t[1]&&e++,t[0]<t[2]&&e++,t[0]<t[3]&&e++,t[1]<t[2]&&e++,t[1]<t[3]&&e++,t[2]<t[3]&&e++,1&e}let e=[],n=t.slice(0);n.sort();for(let i=0;i<t.length;i++)e.push(n.indexOf(t[i]));return this.parityIdentity(e)}static smallPermutation(t){return 1==t?this.PERM1:2==t?this.PERM2:3==t?this.PERM3:4==t?this.PERM4:null}static allPermutations(e){if(e<=this.SMALL_PERMS)return this.smallPermutation(e);for(;this.PERM_CACHE.length<this.MAX_CACHE-this.SMALL_PERMS;)this.PERM_CACHE.push(null);if(e<this.MAX_CACHE&&null!=this.PERM_CACHE[e-this.SMALL_PERMS])return this.PERM_CACHE[e-this.SMALL_PERMS];let n=1;for(let t=2;t<=e;t++)n*=t;let i=[],s=t.identity0(e);i.push(s.slice(0));let l=t.booleanArray(!1,e);for(let r=1;r<n;r++)t:for(;s[0]<e;){s[e-1]++;for(let t=e-1;t>0&&!(s[t]<e);t--)s[t]=0,s[t-1]++;t.setTo(l,!1);for(let t of s){if(l[t])continue t;l[t]=!0}i[r]=s.slice(0);break}return e<this.MAX_CACHE&&(this.PERM_CACHE[e-this.SMALL_PERMS]=i),i}}e.PERM1=[[0]],e.PERM2=[[0,1],[1,0]],e.PERM3=[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],e.PERM4=[[0,1,2,3],[0,1,3,2],[0,2,1,3],[0,2,3,1],[0,3,1,2],[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]],e.SMALL_PERMS=4,e.MAX_CACHE=8,e.PERM_CACHE=[];class s{}s.ELEMENTS=[null,"H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn"],s.ELEMENT_GROUPS=[0,1,18,1,2,13,14,15,16,17,18,1,2,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,5,6,7,8,9,10,11,12],s.ELEMENT_ROWS=[0,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],s.ELEMENT_BLOCKS=[0,1,2,1,1,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,1,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,1,1,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3],s.ELEMENT_VALENCE=[0,1,2,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,9,10,11,12,3,4,5,6,7,8,1,2,3,4,5,6,7,8,9,10,11,12,3,4,5,6,7,8,1,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,5,6,7,8,9,10,11,12,3,4,5,6,7,8,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,5,6,7,8,9,10,11,12],s.ELEMENT_BONDING=[0,1,0,1,2,3,4,3,2,1,0,1,2,3,4,3,2,1,0,1,2,3,4,5,6,7,8,9,10,11,12,3,4,3,2,1,0,1,2,3,4,5,6,7,8,9,10,11,12,3,4,3,2,1,0,1,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,5,6,7,8,9,10,11,12,3,4,3,2,1,0,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,5,6,7,8,9,10,11,12],s.ELEMENT_SHELL=[0,2,2,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,18,18,18,18,18,18,18,18,18,18,8,8,8,8,8,8,8,8,18,18,18,18,18,18,18,18,18,18,8,8,8,8,8,8,8,8,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,8,8,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],s.NATURAL_ATOMIC_WEIGHTS=[0,1.00794,4.002602,6.941,9.012182,10.811,12.0107,14.0067,15.9994,18.9984032,20.1797,22.98977,24.305,26.981538,28.0855,30.973761,32.065,35.453,39.948,39.0983,40.078,44.95591,47.867,50.9415,51.9961,54.938049,55.845,58.9332,58.6934,63.546,65.409,69.723,72.64,74.9216,78.96,79.904,83.798,85.4678,87.62,88.90585,91.224,92.90638,95.94,98,101.07,102.9055,106.42,107.8682,112.411,114.818,118.71,121.76,127.6,126.90447,131.293,132.90545,137.327,138.9055,140.116,140.90765,144.24,145,150.36,151.964,157.25,158.92534,162.5,164.93032,167.259,168.93421,173.04,174.967,178.49,180.9479,183.84,186.207,190.23,192.217,195.078,196.96655,200.59,204.3833,207.2,208.98038,209,210,222,223,226,227,230.0331266,231.03588,233.039628,237,244,243,247,247,251,252,257,258,259,262,261,262,266,264,277,268,271,272,285],s.ELEMENT_H=1,s.ELEMENT_He=2,s.ELEMENT_Li=3,s.ELEMENT_Be=4,s.ELEMENT_B=5,s.ELEMENT_C=6,s.ELEMENT_N=7,s.ELEMENT_O=8,s.ELEMENT_F=9,s.ELEMENT_Ne=10,s.ELEMENT_Na=11,s.ELEMENT_Mg=12,s.ELEMENT_Al=13,s.ELEMENT_Si=14,s.ELEMENT_P=15,s.ELEMENT_S=16,s.ELEMENT_Cl=17,s.ELEMENT_Ar=18,s.ELEMENT_K=19,s.ELEMENT_Ca=20,s.ELEMENT_Sc=21,s.ELEMENT_Ti=22,s.ELEMENT_V=23,s.ELEMENT_Cr=24,s.ELEMENT_Mn=25,s.ELEMENT_Fe=26,s.ELEMENT_Co=27,s.ELEMENT_Ni=28,s.ELEMENT_Cu=29,s.ELEMENT_Zn=30,s.ELEMENT_Ga=31,s.ELEMENT_Ge=32,s.ELEMENT_As=33,s.ELEMENT_Se=34,s.ELEMENT_Br=35,s.ELEMENT_Kr=36,s.ELEMENT_Rb=37,s.ELEMENT_Sr=38,s.ELEMENT_Y=39,s.ELEMENT_Zr=40,s.ELEMENT_Nb=41,s.ELEMENT_Mo=42,s.ELEMENT_Tc=43,s.ELEMENT_Ru=44,s.ELEMENT_Rh=45,s.ELEMENT_Pd=46,s.ELEMENT_Ag=47,s.ELEMENT_Cd=48,s.ELEMENT_In=49,s.ELEMENT_Sn=50,s.ELEMENT_Sb=51,s.ELEMENT_Te=52,s.ELEMENT_I=53,s.ELEMENT_Xe=54,s.ELEMENT_Cs=55,s.ELEMENT_Ba=56,s.ELEMENT_La=57,s.ELEMENT_Ce=58,s.ELEMENT_Pr=59,s.ELEMENT_Nd=60,s.ELEMENT_Pm=61,s.ELEMENT_Sm=62,s.ELEMENT_Eu=63,s.ELEMENT_Gd=64,s.ELEMENT_Tb=65,s.ELEMENT_Dy=66,s.ELEMENT_Ho=67,s.ELEMENT_Er=68,s.ELEMENT_Tm=69,s.ELEMENT_Yb=70,s.ELEMENT_Lu=71,s.ELEMENT_Hf=72,s.ELEMENT_Ta=73,s.ELEMENT_W=74,s.ELEMENT_Re=75,s.ELEMENT_Os=76,s.ELEMENT_Ir=77,s.ELEMENT_Pt=78,s.ELEMENT_Au=79,s.ELEMENT_Hg=80,s.ELEMENT_Tl=81,s.ELEMENT_Pb=82,s.ELEMENT_Bi=83,s.ELEMENT_Po=84,s.ELEMENT_At=85,s.ELEMENT_Rn=86,s.ELEMENT_Fr=87,s.ELEMENT_Ra=88,s.ELEMENT_Ac=89,s.ELEMENT_Th=90,s.ELEMENT_Pa=91,s.ELEMENT_U=92,s.ELEMENT_Np=93,s.ELEMENT_Pu=94,s.ELEMENT_Am=95,s.ELEMENT_Cm=96,s.ELEMENT_Bk=97,s.ELEMENT_Cf=98,s.ELEMENT_Es=99,s.ELEMENT_Fm=100,s.ELEMENT_Md=101,s.ELEMENT_No=102,s.ELEMENT_Lr=103,s.ELEMENT_Rf=104,s.ELEMENT_Db=105,s.ELEMENT_Sg=106,s.ELEMENT_Bh=107,s.ELEMENT_Hs=108,s.ELEMENT_Mt=109,s.ELEMENT_Ds=110,s.ELEMENT_Rg=111,s.ELEMENT_Cn=112;class l{constructor(e,n,i=0){if(this.m=e,this.n=n,0!=e){this.A=new Array(e);for(let s=0;s<e;s++)this.A[s]=t.numberArray(i,n)}}static fromArray(t){let e=new l(0,0);return e.A=t,e.m=t.length,e.n=t[0].length,e}clone(){const{A:t,m:e,n}=this;let i=new l(e,n);for(let s=0;s<e;s++)for(let e=0;e<n;e++)i.A[s][e]=t[s][e];return i}get numRows(){return this.m}get numCols(){return this.n}get(t,e){return this.A[t][e]}set(t,e,n){this.A[t][e]=n}transpose(){const{A:t,m:e,n}=this;let i=new l(n,e);const s=i.A;for(let i=0;i<e;i++)for(let e=0;e<n;e++)s[e][i]=t[i][e];return i}norm1(){const{A:t,m:e,n}=this;let i=0;for(let s=0;s<n;s++){let n=0;for(let i=0;i<e;i++)n+=Math.abs(t[i][s]);i=Math.max(i,n)}return i}normInf(){const{A:t,m:e,n}=this;let i=0;for(let s=0;s<e;s++){let e=0;for(let i=0;i<n;i++)e+=Math.abs(t[s][i]);i=Math.max(i,e)}return i}uminus(){const{A:t,m:e,n}=this;let i=new l(e,n),s=i.A;for(let i=0;i<e;i++)for(let e=0;e<n;e++)s[i][e]=-t[i][e];return i}plus(t){const{A:e,m:n,n:i}=this;let s=new l(n,i),r=s.A;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r[s][n]=e[s][n]+t.A[s][n];return s}plusEquals(t){const{A:e,m:n,n:i}=this;for(let s=0;s<n;s++)for(let n=0;n<i;n++)e[s][n]=e[s][n]+t.A[s][n];return this}minus(t){const{A:e,m:n,n:i}=this;let s=new l(n,i),r=e;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r[s][n]=e[s][n]-t.A[s][n];return s}minusEquals(t){const{A:e,m:n,n:i}=this;for(let s=0;s<n;s++)for(let n=0;n<i;n++)e[s][n]=e[s][n]-t.A[s][n];return this}arrayTimes(t){const{A:e,m:n,n:i}=this;let s=new l(n,i),r=s.A;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r[s][n]=e[s][n]*t.A[s][n];return s}arrayTimesEquals(t){const{A:e,m:n,n:i}=this;for(let s=0;s<n;s++)for(let n=0;n<i;n++)e[s][n]=e[s][n]*t.A[s][n];return this}arrayRightDivide(t){const{A:e,m:n,n:i}=this;let s=new l(n,i),r=s.A;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r[s][n]=e[s][n]/t.A[s][n];return s}arrayRightDivideEquals(t){const{A:e,m:n,n:i}=this;for(let s=0;s<n;s++)for(let n=0;n<i;n++)e[s][n]=e[s][n]/t.A[s][n];return this}arrayLeftDivide(t){const{A:e,m:n,n:i}=this;let s=new l(n,i),r=s.A;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r[s][n]=t.A[s][n]/e[s][n];return s}arrayLeftDivideEquals(t){const{A:e,m:n,n:i}=this;for(let s=0;s<n;s++)for(let n=0;n<i;n++)e[s][n]=t.A[s][n]/e[s][n];return this}scalarTimes(t){const{A:e,m:n,n:i}=this;let s=new l(n,i),r=s.A;for(let s=0;s<n;s++)for(let n=0;n<i;n++)r[s][n]=t*e[s][n];return s}scalarTimesEquals(t){const{A:e,m:n,n:i}=this;for(let s=0;s<n;s++)for(let n=0;n<i;n++)e[s][n]=t*e[s][n];return this}times(t){const{A:e,m:n,n:i}=this;let s=new l(n,t.n),r=s.A,o=new Array(i);for(let s=0;s<t.n;s++){for(let e=0;e<i;e++)o[e]=t.A[e][s];for(let t=0;t<n;t++){let n=e[t],l=0;for(let t=0;t<i;t++)l+=n[t]*o[t];r[t][s]=l}}return s}rank(){return new r(this).rank()}cond(){return new r(this).cond()}trace(){const{A:t,m:e,n}=this;let i=0;for(let s=0;s<Math.min(e,n);s++)i+=t[s][s];return i}static identity(t,e){let n=new l(t,e),i=n.A;for(let n=0;n<t;n++)for(let t=0;t<e;t++)i[n][t]=n==t?1:0;return n}toString(){let t=["["];for(let e of this.A)t.push(JSON.stringify(e));return t.push("]"),t.join("\n")}}class r{constructor(e){let n=e.A,i=this.m=e.m,s=this.n=e.n,l=Math.min(i,s),o=this.s=new Array(Math.min(i+1,s)),a=this.U=new Array(i),h=this.V=new Array(s);for(let e=0;e<i;e++)a[e]=t.numberArray(0,l);for(let e=0;e<s;e++)h[e]=t.numberArray(0,s);let u=new Array(s),m=new Array(i),c=Math.min(i-1,s),d=Math.max(0,Math.min(s-2,i));for(let t=0;t<Math.max(c,d);t++){if(t<c){o[t]=0;for(let e=t;e<i;e++)o[t]=r.hypot(o[t],n[e][t]);if(0!=o[t]){n[t][t]<0&&(o[t]=-o[t]);for(let e=t;e<i;e++)n[e][t]/=o[t];n[t][t]+=1}o[t]=-o[t]}for(let e=t+1;e<s;e++){if(t<c&&0!=o[t]){let s=0;for(let l=t;l<i;l++)s+=n[l][t]*n[l][e];s=-s/n[t][t];for(let l=t;l<i;l++)n[l][e]+=s*n[l][t]}u[e]=n[t][e]}if(t<c)for(let e=t;e<i;e++)a[e][t]=n[e][t];if(t<d){u[t]=0;for(let e=t+1;e<s;e++)u[t]=r.hypot(u[t],u[e]);if(0!=u[t]){u[t+1]<0&&(u[t]=-u[t]);for(let e=t+1;e<s;e++)u[e]/=u[t];u[t+1]+=1}if(u[t]=-u[t],t+1<i&&0!=u[t]){for(let e=t+1;e<i;e++)m[e]=0;for(let e=t+1;e<s;e++)for(let s=t+1;s<i;s++)m[s]+=u[e]*n[s][e];for(let e=t+1;e<s;e++){let s=-u[e]/u[t+1];for(let l=t+1;l<i;l++)n[l][e]+=s*m[l]}}for(let e=t+1;e<s;e++)h[e][t]=u[e]}}let f=Math.min(s,i+1);c<s&&(o[c]=n[c][c]),i<f&&(o[f-1]=0),d+1<f&&(u[d]=n[d][f-1]),u[f-1]=0;for(let t=c;t<l;t++){for(let e=0;e<i;e++)a[e][t]=0;a[t][t]=1}for(let t=c-1;t>=0;t--)if(0!=o[t]){for(let e=t+1;e<l;e++){let n=0;for(let s=t;s<i;s++)n+=a[s][t]*a[s][e];n=-n/a[t][t];for(let s=t;s<i;s++)a[s][e]+=n*a[s][t]}for(let e=t;e<i;e++)a[e][t]=-a[e][t];a[t][t]=1+a[t][t];for(let e=0;e<t-1;e++)a[e][t]=0}else{for(let e=0;e<i;e++)a[e][t]=0;a[t][t]=1}for(let t=s-1;t>=0;t--){if(t<d&&0!=u[t])for(let e=t+1;e<l;e++){let n=0;for(let i=t+1;i<s;i++)n+=h[i][t]*h[i][e];n=-n/h[t+1][t];for(let i=t+1;i<s;i++)h[i][e]+=n*h[i][t]}for(let e=0;e<s;e++)h[e][t]=0;h[t][t]=1}let p=f-1,C=0,g=Math.pow(2,-52),A=Math.pow(2,-966);for(;f>0;){let t,e;for(t=f-2;t>=-1&&-1!=t;t--)if(Math.abs(u[t])<=A+g*(Math.abs(o[t])+Math.abs(o[t+1]))){u[t]=0;break}if(t==f-2)e=4;else{let n;for(n=f-1;n>=t&&n!=t;n--){let e=(n!=f?Math.abs(u[n]):0)+(n!=t+1?Math.abs(u[n-1]):0);if(Math.abs(o[n])<=A+g*e){o[n]=0;break}}n==t?e=3:n==f-1?e=1:(e=2,t=n)}if(t++,1==e){let e=u[f-2];u[f-2]=0;for(let n=f-2;n>=t;n--){let i=r.hypot(o[n],e),l=o[n]/i,a=e/i;o[n]=i,n!=t&&(e=-a*u[n-1],u[n-1]=l*u[n-1]);for(let t=0;t<s;t++)i=l*h[t][n]+a*h[t][f-1],h[t][f-1]=-a*h[t][n]+l*h[t][f-1],h[t][n]=i}}else if(2==e){let e=u[t-1];u[t-1]=0;for(let n=t;n<f;n++){let s=r.hypot(o[n],e),l=o[n]/s,h=e/s;o[n]=s,e=-h*u[n],u[n]=l*u[n];for(let e=0;e<i;e++)s=l*a[e][n]+h*a[e][t-1],a[e][t-1]=-h*a[e][n]+l*a[e][t-1],a[e][n]=s}}else if(3==e){let e=Math.max(Math.max(Math.max(Math.max(Math.abs(o[f-1]),Math.abs(o[f-2])),Math.abs(u[f-2])),Math.abs(o[t])),Math.abs(u[t])),n=o[f-1]/e,l=o[f-2]/e,m=u[f-2]/e,c=o[t]/e,d=u[t]/e,p=((l+n)*(l-n)+m*m)/2,g=n*m*(n*m),A=0;0==p&&0==g||(A=Math.sqrt(p*p+g),p<0&&(A=-A),A=g/(p+A));let b=(c+n)*(c-n)+A,y=c*d;for(let e=t;e<f-1;e++){let n=r.hypot(b,y),l=b/n,m=y/n;e!=t&&(u[e-1]=n),b=l*o[e]+m*u[e],u[e]=l*u[e]-m*o[e],y=m*o[e+1],o[e+1]=l*o[e+1];for(let t=0;t<s;t++)n=l*h[t][e]+m*h[t][e+1],h[t][e+1]=-m*h[t][e]+l*h[t][e+1],h[t][e]=n;if(n=r.hypot(b,y),l=b/n,m=y/n,o[e]=n,b=l*u[e]+m*o[e+1],o[e+1]=-m*u[e]+l*o[e+1],y=m*u[e+1],u[e+1]=l*u[e+1],e<i-1)for(let t=0;t<i;t++)n=l*a[t][e]+m*a[t][e+1],a[t][e+1]=-m*a[t][e]+l*a[t][e+1],a[t][e]=n}u[f-2]=b,C+=1}else if(4==e){if(o[t]<=0){o[t]=o[t]<0?-o[t]:0;for(let e=0;e<=p;e++)h[e][t]=-h[e][t]}for(;t<p&&!(o[t]>=o[t+1]);){let e=o[t];if(o[t]=o[t+1],o[t+1]=e,t<s-1)for(let n=0;n<s;n++)e=h[n][t+1],h[n][t+1]=h[n][t],h[n][t]=e;if(t<i-1)for(let n=0;n<i;n++)e=a[n][t+1],a[n][t+1]=a[n][t],a[n][t]=e;t++}C=0,f--}}}getU(){return l.fromArray(this.U)}getV(){return l.fromArray(this.V)}getSingularValues(){return this.s}getS(){const{n:t}=this;let e=new l(t,t,0),n=e.A;for(let e=0;e<t;e++)n[e][e]=this.s[e];return e}norm2(){return this.s[0]}cond(){const{m:t,n:e,s:n}=this;return n[0]/n[Math.min(t,e)-1]}rank(){const{m:t,n:e,s:n}=this;let i=Math.pow(2,-52),s=Math.max(t,e)*n[0]*i,l=0;for(let t=0;t<n.length;t++)n[t]>s&&l++;return l}static hypot(t,e){let n;return Math.abs(t)>Math.abs(e)?(n=e/t,n=Math.abs(t)*Math.sqrt(1+n*n)):0!=e?(n=t/e,n=Math.abs(e)*Math.sqrt(1+n*n)):n=0,n}}const o=Math.pow(2,-52);class a{constructor(e,n){this.px=e,this.py=n,this.numTriangles=0,this.edgeStack=t.numberArray(0,512),this.hull=null,this.px=e,this.py=n,this.sz=e.length;let i=Math.max(2*this.sz-5,0);this.triangles=new Array(3*i),this.halfedges=new Array(3*i),this.hashSize=Math.ceil(Math.sqrt(this.sz)),this.hullPrev=new Array(this.sz),this.hullNext=new Array(this.sz),this.hullTri=new Array(this.sz),this.hullHash=t.numberArray(-1,this.hashSize),this.ids=new Array(this.sz),this.dists=new Array(this.sz),this.update()}trimConcave(e){const n=O(e),{sz:i,px:s,py:l}=this;let r=this.triangles.slice(0),o=[];for(let t=0,e=0;e<r.length;t++,e+=3)o.push(i*Math.min(r[e+0],r[e+1])+Math.max(r[e+0],r[e+1])),o.push(i*Math.min(r[e+0],r[e+2])+Math.max(r[e+0],r[e+2])),o.push(i*Math.min(r[e+1],r[e+2])+Math.max(r[e+1],r[e+2]));let a=t.uniqueUnstable(o);for(let t=0;t<o.length;t++)o[t]=a.indexOf(o[t]);let h=new Array(o.length);for(;;){const e=r.length/3;h.fill(0);for(let t=0,n=0;t<e;t++,n+=3)h[o[n+0]]++,h[o[n+1]]++,h[o[n+2]]++;let i=t.booleanArray(!0,e);for(let t=0,a=0;t<e;t++,a+=3){const e=h[o[a+0]],u=h[o[a+1]],m=h[o[a+2]],c=r[a],d=r[a+1],f=r[a+2];1==e&&1!=u&&1!=m?i[t]=q(s[c]-s[d],l[c]-l[d])<n:1!=e&&1==u&&1!=m?i[t]=q(s[c]-s[f],l[c]-l[f])<n:1!=e&&1!=u&&1==m&&(i[t]=q(s[d]-s[f],l[d]-l[f])<n)}if(t.allTrue(i))break;let a=new Array(3*t.maskCount(i)),u=new Array(3*t.maskCount(i));for(let t=0,n=0,s=0,l=0;t<e;t++,n+=3)i[t]&&(a[s++]=r[n],a[s++]=r[n+1],a[s++]=r[n+2],u[l++]=o[n],u[l++]=o[n+1],u[l++]=o[n+2]);r=a,o=u}return r}traceOutline(e){const n=e.length/3,{sz:i,px:s,py:l}=this;let r=new Map;for(let t=0,s=0;t<n;t++,s+=3){const t=i*Math.min(e[s+0],e[s+1])+Math.max(e[s+0],e[s+1]),n=i*Math.min(e[s+0],e[s+2])+Math.max(e[s+0],e[s+2]),l=i*Math.min(e[s+1],e[s+2])+Math.max(e[s+1],e[s+2]);r.set(t,(r.get(t)||0)+1),r.set(n,(r.get(n)||0)+1),r.set(l,(r.get(l)||0)+1)}let o=[];for(let t of r.entries())if(1==t[1]){const e=t[0],n=Math.floor(e/i),s=e%i;o.push(n),o.push(s)}const a=t.uniqueUnstable(o),h=a.length,u=new Map;for(let t=0;t<h;t++)u.set(a[t],t);let m=t.numberArray(-1,h),c=t.numberArray(-1,h);for(let t=0;t<o.length;t+=2){const e=u.get(o[t]),n=u.get(o[t+1]);m[e]<0?m[e]=n:c[e]=n,m[n]<0?m[n]=e:c[n]=e}let d=t.booleanArray(!1,h),f=new Array(h);f[0]=0,d[0]=!0;for(let t=1;t<h;t++){const e=f[t-1];d[m[e]]?f[t]=c[e]:f[t]=m[e],d[f[t]]=!0}return t.idxGet(a,f)}update(){const e=this.sz;let{px:n,py:i,ids:s,dists:l,triangles:r,halfedges:a}=this;const h=t.min(n),u=t.min(i),m=t.max(n),c=t.max(i);for(let t=0;t<e;t++)s[t]=t;this.centreX=.5*(h+m),this.centreY=.5*(u+c);let d=0,f=0,p=0,C=Number.POSITIVE_INFINITY;for(let t=0;t<e;t++){const e=N(this.centreX-n[t],this.centreY-i[t]);e<C&&(d=t,C=e)}const g=n[d],A=i[d];C=Number.POSITIVE_INFINITY;for(let t=0;t<e;t++){if(t==d)continue;const e=N(g-n[t],A-i[t]);e<C&&e>0&&(f=t,C=e)}let b=n[f],y=i[f],E=Number.POSITIVE_INFINITY;for(let t=0;t<e;t++){if(t==d||t==f)continue;let e=this.circumRadius(g,A,b,y,n[t],i[t]);e<E&&(p=t,E=e)}let x=n[p],M=i[p];if(!Number.isFinite(E)){for(let t=0;t<e;t++)l[t]=n[t]-n[0],0==l[t]&&(l[t]=i[t]-i[0]);this.quicksort(0,e-1);let t=new Array(e),o=0,h=Number.NEGATIVE_INFINITY;for(let n=0;n<e;n++){let e=s[n];l[e]>h&&(t[o++]=e,h=l[e])}return this.hull=t.slice(0,o),r=[],void(a=[])}if(this.orient(g,A,b,y,x,M)){let t=f,e=b,n=y;f=p,b=x,y=M,p=t,x=e,M=n}this.pickCircumCentre(g,A,b,y,x,M);for(let t=0;t<e;t++)l[t]=N(n[t]-this.centreX,i[t]-this.centreY);this.quicksort(0,e-1),this.hullStart=d;let v=3;const{hullNext:T,hullPrev:q,hullTri:S,hullHash:w,hashSize:O}=this;T[d]=q[p]=f,T[f]=q[d]=p,T[p]=q[f]=d,S[d]=0,S[f]=1,S[p]=2,w.fill(-1),w[this.hashKey(g,A)]=d,w[this.hashKey(b,y)]=f,w[this.hashKey(x,M)]=p,this.numTriangles=0,this.addTriangle(d,f,p,-1,-1,-1);let D=0,R=0;for(let t=0;t<s.length;t++){let e=s[t],l=n[e],r=i[e];if(t>0&&Math.abs(l-D)<=o&&Math.abs(r-R)<=o)continue;if(D=l,R=r,e==d||e==f||e==p)continue;let a=0;for(let t=0,e=this.hashKey(l,r);t<O&&(a=w[(e+t)%O],!(a>=0&&a!=T[a]));t++);a=q[a];let h=a,u=T[h];for(;!this.orient(l,r,n[h],i[h],n[u],i[u]);){if(h=u,h==a){h=-1;break}u=T[h]}if(h<0)continue;let m=this.addTriangle(h,e,T[h],-1,-1,S[h]);S[e]=this.legalise(m+2),S[h]=m,v++;let c=T[h];for(u=T[c];this.orient(l,r,n[c],i[c],n[u],i[u]);)m=this.addTriangle(c,e,u,S[e],-1,S[c]),S[e]=this.legalise(m+2),T[c]=c,v--,c=u,u=T[c];if(h==a)for(u=q[h];this.orient(l,r,n[u],i[u],n[h],i[h]);)m=this.addTriangle(u,e,h,-1,S[h],S[u]),this.legalise(m+2),S[u]=m,T[h]=h,v--,h=u,u=q[h];this.hullStart=q[e]=h,T[h]=q[c]=e,T[e]=c,w[this.hashKey(l,r)]=e,w[this.hashKey(n[h],i[h])]=h}this.hull=new Array(v);for(let t=0,e=this.hullStart;t<v;t++)this.hull[t]=e,e=T[e];this.triangles=r.slice(0,this.numTriangles),this.halfedges=a.slice(0,this.numTriangles)}hashKey(t,e){return Math.floor(this.pseudoAngle(t-this.centreX,e-this.centreY)*this.hashSize)%this.hashSize}legalise(t){let e=0,n=0;for(;;){let i=this.halfedges[t],s=t-t%3;if(n=s+(t+2)%3,i<0){if(0==e)break;t=this.edgeStack[--e];continue}const l=i-i%3,r=s+(t+1)%3,o=l+(i+2)%3,{px:a,py:h,triangles:u,halfedges:m}=this,c=u[n],d=u[t],f=u[r],p=u[o];if(this.inCircle(a[c],h[c],a[d],h[d],a[f],h[f],a[p],h[p])){this.triangles[t]=p,this.triangles[i]=c;const s=m[o];if(s<0){let e=this.hullStart;do{if(this.hullTri[e]==o){this.hullTri[e]=t;break}e=this.hullPrev[e]}while(e!=this.hullStart)}this.link(t,s),this.link(i,m[n]),this.link(n,o);const r=l+(i+1)%3;e<this.edgeStack.length&&(this.edgeStack[e++]=r)}else{if(0==e)break;t=this.edgeStack[--e]}}return n}link(t,e){this.halfedges[t]=e,e>=0&&(this.halfedges[e]=t)}addTriangle(t,e,n,i,s,l){const r=this.numTriangles;return this.triangles[r]=t,this.triangles[r+1]=e,this.triangles[r+2]=n,this.link(r,i),this.link(r+1,s),this.link(r+2,l),this.numTriangles+=3,r}pseudoAngle(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}orientIfSure(t,e,n,i,s,l){const r=(i-e)*(s-t),o=(n-t)*(l-e);return Math.abs(r-o)>=33306690738754716e-32*Math.abs(r+o)?r-o:0}orient(t,e,n,i,s,l){let r=this.orientIfSure(s,l,t,e,n,i);return 0!=r||(r=this.orientIfSure(t,e,n,i,s,l),0!=r||(r=this.orientIfSure(n,i,s,l,t,e))),r<0}inCircle(t,e,n,i,s,l,r,o){const a=t-r,h=e-o,u=n-r,m=i-o,c=s-r,d=l-o,f=u*u+m*m,p=c*c+d*d;return a*(m*p-f*d)-h*(u*p-f*c)+(a*a+h*h)*(u*d-m*c)<0}circumRadius(t,e,n,i,s,l){const r=n-t,o=i-e,a=s-t,h=l-e,u=r*r+o*o,m=a*a+h*h,c=.5/(r*h-o*a),d=(h*u-o*m)*c,f=(r*m-a*u)*c;return d*d+f*f}pickCircumCentre(t,e,n,i,s,l){const r=n-t,o=i-e,a=s-t,h=l-e,u=r*r+o*o,m=a*a+h*h,c=.5/(r*h-o*a);this.centreX=t+(h*u-o*m)*c,this.centreY=e+(r*m-a*u)*c}quicksort(e,n){const{ids:i,dists:s}=this;if(n-e<=20)for(let t=e+1;t<=n;t++){const n=i[t],l=s[n];let r=t-1;for(;r>=e&&s[i[r]]>l;)i[r+1]=i[r--];i[r+1]=n}else{let l=e+n>>1,r=e+1,o=n;t.swap(i,l,r),s[i[e]]>s[i[n]]&&t.swap(i,e,n),s[i[r]]>s[i[n]]&&t.swap(i,r,n),s[i[e]]>s[i[r]]&&t.swap(i,e,r);let a=i[r];const h=s[a];for(;;){do{r++}while(s[i[r]]<h);do{o--}while(s[i[o]]>h);if(o<r)break;t.swap(i,r,o)}i[e+1]=i[o],i[o]=a,n-r+1>=o-e?(this.quicksort(r,n),this.quicksort(e,o-1)):(this.quicksort(e,o-1),this.quicksort(r,n))}}}class h{static pointInPolygon(t,e,n,i){if(t<X(n)||t>U(n)||e<X(i)||e>U(i))return!1;let s=n.length;for(let l=0;l<s;l++)if(n[l]==t&&i[l]==e)return!0;let l=!1;for(let r=0;r<s;r++){let o=n[r],a=i[r],h=n[r+1<s?r+1:0],u=i[r+1<s?r+1:0];e>Math.min(a,u)&&e<=Math.max(a,u)&&t<=Math.max(o,h)&&a!=u&&(o==h||t<=(e-a)*(h-o)/(u-a)+o)&&(l=!l)}return l}static areLinesParallel(t,e,n,i,s,l,r,o){let a=n-t,h=i-e,u=r-s,m=o-l,c=Math.abs(a)>Math.abs(h);if(c!=Math.abs(u)>Math.abs(m))return!1;const d=1e-6;return c?Math.abs(h/a-m/u)<d:Math.abs(a/h-u/m)<d}static lineIntersect(t,e,n,i,s,l,r,o){let a=((r-s)*(e-l)-(o-l)*(t-s))/((o-l)*(n-t)-(r-s)*(i-e));return[t+a*(n-t),e+a*(i-e)]}static isPointOnLineSeg(t,e,n,i,s,l){if(t<Math.min(n,s)||t>Math.max(n,s)||e<Math.min(i,l)||e>Math.max(i,l))return!1;if(t==n&&e==i||t==s&&e==l)return!0;let r=s-n,o=l-i;return Math.abs(r)>Math.abs(o)?B(e,o/r*(t-n)+i):B(t,r/o*(e-i)+n)}static pointLineDistance(t,e,n,i,s,l){let r=s-n,o=l-i;return Math.abs(o*t-r*e+s*i-l*n)/N(r,o)}static pointLineSegDistance(t,e,n,i,s,l){let r=s-n,o=l-i,a=((t-n)*r+(e-i)*o)/q(r,o);return a=Math.max(0,Math.min(1,a)),N(t-(n+a*r),e-(i+a*o))}static doLineSegsIntersect(t,e,n,i,s,l,r,o){if(Math.max(t,n)<Math.min(s,r)||Math.max(e,i)<Math.min(l,o))return!1;if(Math.min(t,n)>Math.max(s,r)||Math.min(e,i)>Math.max(l,o))return!1;let a=n-t,h=i-e,u=r-s,m=o-l;if(R(q(a,h),0)||R(q(u,m),0))return!1;if(Math.abs(h)>Math.abs(a)&&Math.abs(m)>Math.abs(u)){if(R(a/h-u/m,0))return!1}else if(Math.abs(a)>Math.abs(h)&&Math.abs(u)>Math.abs(m)&&R(h/a-m/u,0))return!1;if(t==s&&e==l||t==r&&e==o||n==s&&i==l||n==r&&i==o)return!0;if(!(t!=n&&s!=r||t!=s&&t!=r&&n!=s&&n!=r))return!0;if(!(e!=i&&l!=o||e!=l&&e!=o&&i!=l&&i!=o))return!0;let c=t-s,d=e-l,f=u*d-m*c,p=a*d-h*c,C=m*a-u*h;return 0!=C&&(C<0&&(C=-C,f=-f,p=-p),f>=0&&f<=C&&p>=0&&p<=C)}static rectsIntersect(t,e,n,i,s,l,r,o){return t<=s&&t+n>=s+r&&e<=l&&e+i>=l+o||s<=t&&s+r>=t+n&&l<=e&&l+o>=e+i||!(t+n<s||s+r<t||e+i<l||l+o<e)}static sortAngles(e){if(null==e||e.length<2)return e;e=e.slice(0);for(let t=0;t<e.length;t++)e[t]=P(e[t]);if(2==e.length)return F(e[1],e[0])>Math.PI?[e[1],e[0]]:e;for(t.sort(e);;){let t=e[e.length-1],n=e[0],i=e[1];if(z(n,t)<=z(i,n))break;for(let t=e.length-1;t>0;t--)e[t]=e[t-1];e[0]=t}return e}static idxSortAngles(e){const n=t.len(e);if(null==e||n<2)return t.identity0(n);if(2==n)return F(e[1],e[0])>Math.PI?[1,0]:[0,1];e=t.duplicate(e);for(let t=0;t<n;t++)e[t]=P(e[t]);let i=t.idxSort(e);for(;;){let t=e[i[n-1]],s=e[i[0]],l=e[i[1]];if(z(s,t)<=z(l,s))break;let r=i.pop();i.unshift(r)}return i}static uniqueAngles(t,e){let n=h.sortAngles(t),i=[];i.push(n[0]);for(let t=1;t<n.length;t++)Math.abs(z(n[t],n[t-1]))>e&&i.push(n[t]);return i}static thetaObtuse(t,e){let n=e-t;for(;n<-Math.PI;)n+=2*Math.PI;for(;n>Math.PI;)n-=2*Math.PI;return n>0?t-.5*(2*Math.PI-n):t+.5*(2*Math.PI+n)}static emergentAngle(e){let n=e.length;if(1==n)return e[0];if(2==n)return.5*(e[0]+e[1]);t.sort(e);let i=0,s=F(e[0],e[n-1]);for(let t=1;t<n;t++){let n=F(e[t],e[t-1]);n>s&&(i=t,s=n)}let l=0;for(let t=0;t<n;t++){let n=e[t]-e[i];n<0&&(n+=I),l+=n}return l/n+e[i]}static dotProduct(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}static crossProduct(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}static affineTranslate(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}static affineMirror(t,e){return[[t?-1:1,0,0],[0,e?-1:1,0],[0,0,1]]}static affineScale(t,e){return[[t,0,0],[0,e,0],[0,0,1]]}static affineRotate(t){let e=Math.cos(t),n=Math.sin(t);return[[e,-n,0],[n,e,0],[0,0,1]]}static affineCompose(t,e){let n=[[0,0,0],[0,0,0],[0,0,0]],i=[0,0,0];for(let s=0;s<3;s++){for(let e=0;e<3;e++)i[e]=t[e][s];for(let t=0;t<3;t++){let l=e[t],r=0;for(let t=0;t<3;t++)r+=i[t]*l[t];n[t][s]=r}}return n}static applyAffine(t,e,n){return[t*n[0][0]+e*n[0][1]+n[0][2],t*n[1][0]+e*n[1][1]+n[1][2]]}static applyAffineArray(t,e,n){for(let i=0;i<t.length;i++)[t[i],e[i]]=this.applyAffine(t[i],e[i],n)}static isAffineMirror(t){let e=t[0][0],n=t[0][1],i=t[0][2],s=t[1][0],l=t[1][1],r=t[1][2],o=t[2][0],a=t[2][1],h=t[2][2];return e*l*h+n*r*o+i*s*a-i*l*o-n*s*h-e*r*a<0}static magnitude2(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}static magnitude(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}static dist2(t,e){let n=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return n*n+i*i+s*s}static dist(t,e){let n=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(n*n+i*i+s*s)}static normalise(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(0==e)return;const n=1/Math.sqrt(e);t[0]*=n,t[1]*=n,t[2]*=n}static normalised(t){let e=t.slice(0);return this.normalise(e),e}static acuteAngle(t,e){let n=this.magnitude(t),i=this.magnitude(e);if(0==n||0==i)return 0;let s=this.dotProduct(t,e)/(n*i);return s=Math.max(-1,Math.min(1,s)),Math.acos(s)}static arcControlPoints(t,e,n,i,s){let l=-n,r=e,o=s,a=-i,h=.5*(e+i),u=.5*(n+s),m=3/8*(l+o),c=3/8*(r+a),d=m*m+c*c,f=h*m+u*c,p=f*f-d*(h*h+u*u-t*t),C=(Math.sqrt(p)-f)/d;return[e+C*l,n+C*r,i+C*o,s+C*a]}static createBezierEllipse(t,e,n,i,s){let l=24,r=Math.cos(s),o=Math.sin(s),a=I/l,h=new Array(49),u=new Array(49);for(let s=0;s<l;s++){let l=s*a,m=Math.cos(l),c=Math.sin(l);h[2*s]=n*m*r-i*c*o+t,u[2*s]=n*m*o+i*c*r+e}h[48]=h[0],u[48]=u[0];for(let t=0;t<l;t++){let e=(t-1+l)%l,n=t,i=(t+1)%l,s=(t+2)%l,r=h[2*e],o=h[2*n],a=h[2*i],m=h[2*s],c=u[2*e],d=u[2*n],f=u[2*i],p=u[2*s];h[2*t+1]=.5*(o+a+.3*(o-r+a-m)),u[2*t+1]=.5*(d+f+.3*(d-c+f-p))}let m=new Array(49);for(let t=0;t<49;t++)m[t]=!(1&~t);return{px:h,py:u,ctrl:m}}static fitCircle(t,e){let n=Number.POSITIVE_INFINITY;for(let i=0;i<t.length;i++)n=Math.min(n,q(t[i],e[i]));return Math.sqrt(n)}static fitEllipse(e,n,i,s,l,r){let o=.5*this.fitCircle(e,n),a=o,h=o*a,u=t.concat(e,[i,l,0,0]),m=t.concat(n,[0,0,s,r]);const c=u.length;let d=t=>{let e=Number.POSITIVE_INFINITY,n=1/(t[0]*t[0]),i=1/(t[1]*t[1]);for(let t=0;t<c;t++)e=Math.min(e,Math.sqrt(u[t]*u[t]*n+m[t]*m[t]*i));e<1&&(t[0]*=e,t[1]*=e),t[2]=t[0]*t[1]},f=1,p=[0,0,0],C=[0,0,0];for(;f>.001;){p[0]=o*(1+f),p[1]=a,d(p),C[0]=o,C[1]=a*(1+f),d(C);let t=!1;p[2]>h&&(o=p[0],a=p[1],h=p[2],t=!0),C[2]>h&&(o=C[0],a=C[1],h=C[2],t=!0),t||(f*=.6)}return[o,a]}static superimpose(e,n,i,s){let o=e.length;if(1==o)return[[1,0,i[0]-e[0]],[0,1,s[0]-n[0]],[0,0,1]];if(2==o){let t=Math.atan2(n[1]-n[0],e[1]-e[0]),l=z(Math.atan2(s[1]-s[0],i[1]-i[0]),t),r=Math.cos(l),o=Math.sin(l),a=r,h=-o,u=o,m=r,c=.5*(e[0]+e[1]),d=.5*(n[0]+n[1]);return[[a,h,.5*(i[0]+i[1])-(a*c+h*d)],[u,m,.5*(s[0]+s[1])-(u*c+m*d)],[0,0,1]]}let a=1/o,h=t.sum(e)*a,u=t.sum(n)*a,m=t.sum(i)*a,c=t.sum(s)*a,d=new l(3,o),f=new l(3,o);for(let t=0;t<o;t++)d.set(0,t,e[t]-h),d.set(1,t,n[t]-u),d.set(2,t,0),f.set(0,t,i[t]-m),f.set(1,t,s[t]-c),f.set(2,t,0);let p=d.times(f.transpose()),C=new r(p),g=C.getV().times(C.getU().transpose()),A=g.get(0,0),b=g.get(0,1),y=g.get(1,0),E=g.get(1,1);return[[A,b,m-(A*h+b*u)],[y,E,c-(y*h+E*u)],[0,0,1]]}static convexHull(t,e,n){let i=new u(t,e,O(.1*n));return[i.hullX,i.hullY]}static outlinePolygon(e,n,i){let s=new a(e,n),l=s.trimConcave(i),r=s.traceOutline(l);return[t.idxGet(e,r),t.idxGet(n,r)]}}class u{constructor(t,e,n){this.x=t,this.y=e,this.threshSq=n,this.hsz=0,this.hullX=[],this.hullY=[];const i=t.length;let s=0,l=0;for(let n=0;n<i;n++)(t[l]>t[n]||t[l]==t[n]&&e[l]>e[n])&&(l=n),(t[s]<t[n]||t[s]==t[n]&&e[s]<e[n])&&(s=n);let r=[],o=[];for(let t=0;t<i;t++)t!=s&&t!=l&&(this.right(l,s,t)>0?r.push(t):o.push(t));this.hullX.push(t[l]),this.hullY.push(e[l]),this.quickHull(l,s,r),this.hullX.push(t[s]),this.hullY.push(e[s]),this.quickHull(s,l,o);for(let t=0;t<this.hullX.length-1;)q(this.hullX[t]-this.hullY[t+1],this.hullY[t]-this.hullY[t+1])<n?(this.hullX.splice(t+1,1),this.hullY.splice(t+1,1)):t++}quickHull(t,e,n){if(0==n.length)return;let i=this.furthestPoint(t,e,n),s=[],l=[];for(let r=0;r<n.length;r++){let o=n[r];o!=t&&o!=e&&(this.right(t,i,o)>0?s.push(o):this.right(i,e,o)>0&&l.push(o))}this.quickHull(t,i,s),this.hullX.push(this.x[i]),this.hullY.push(this.y[i]),this.quickHull(i,e,l)}right(t,e,n){const i=this.x,s=this.y;return(i[t]-i[e])*(s[n]-s[e])-(i[n]-i[e])*(s[t]-s[e])}distance(t,e,n){const i=this.x,s=this.y;let l=((i[n]-i[t])*(i[e]-i[t])+(s[n]-s[t])*(s[e]-s[t]))/((i[e]-i[t])*(i[e]-i[t])+(s[e]-s[t])*(s[e]-s[t])),r=i[t]+l*(i[e]-i[t]),o=s[t]+l*(s[e]-s[t]);return(r-i[n])*(r-i[n])+(o-s[n])*(o-s[n])}furthestPoint(t,e,n){let i=-1,s=-1;for(let l=0;l<n.length;l++){let r=n[l];if(r==t||r==e)continue;let o=this.distance(t,e,r);o>i&&(i=o,s=r)}return s}}class m{static zero(){return new m}static fromArray(t){return new m(t[0],t[1])}constructor(t,e){this.x=null==t?0:t,this.y=null==e?0:e}clone(){return new m(this.x,this.y)}equals(t){return this.x==t.x&&this.y==t.y}scaleBy(t){1!=t&&(this.x*=t,this.y*=t)}offsetBy(t,e){this.x+=t,this.y+=e}withScaleBy(t){return new m(this.x*t,this.y*t)}withOffsetBy(t,e){return new m(this.x+t,this.y+e)}toString(){return"["+this.x+","+this.y+"]"}}class c{static zero(){return new c}static fromArray(t){return new c(t[0],t[1])}constructor(t,e){this.w=null==t?0:t,this.h=null==e?0:e}clone(){return new c(this.w,this.h)}equals(t){return this.w==t.w&&this.h==t.h}isZero(){return 0==this.w&&0==this.h}scaleBy(t){1!=t&&(this.w*=t,this.h*=t)}fitInto(t,e){let n=1;this.w>t&&(n=t/this.w),this.h>e&&(n=Math.min(n,e/this.h)),n<1&&this.scaleBy(n)}withScaleBy(t){return new c(this.w*t,this.h*t)}toString(){return"["+this.w+","+this.h+"]"}}class d{static zero(){return new d}static fromBounds(t,e,n,i){return new d(t,e,n-t,i-e)}static fromSize(t){return new d(0,0,t.w,t.h)}static fromOval(t){return new d(t.cx-t.rw,t.cy-t.rh,2*t.rw,2*t.rh)}static fromArray(t){return new d(t[0],t[1],t[2],t[3])}constructor(t,e,n,i){this.x=null==t?0:t,this.y=null==e?0:e,this.w=null==n?0:n,this.h=null==i?0:i}clone(){return new d(this.x,this.y,this.w,this.h)}equals(t){return this.x==t.x&&this.y==t.y&&this.w==t.w&&this.h==t.h}getPos(){return new m(this.x,this.y)}setPos(t){this.x=t.x,this.y=t.y}getSize(){return new c(this.w,this.h)}setSize(t){this.w=t.w,this.h=t.h}minX(){return this.x}minY(){return this.y}midX(){return this.x+.5*this.w}midY(){return this.y+.5*this.h}maxX(){return this.x+this.w}maxY(){return this.y+this.h}area(){return this.w*this.h}scaleBy(t){1!=t&&(this.x*=t,this.y*=t,this.w*=t,this.h*=t)}offsetBy(t,e){this.x+=t,this.y+=e}grow(t,e){this.x-=t,this.y-=e,this.w+=2*t,this.h+=2*e}withScaleBy(t){return new d(this.x*t,this.y*t,this.w*t,this.h*t)}withOffsetBy(t,e){return new d(this.x+t,this.y+e,this.w,this.h)}withGrow(t,e){return new d(this.x-t,this.y-e,this.w+2*t,this.h+2*e)}intersects(t){return h.rectsIntersect(this.x,this.y,this.w,this.h,t.x,t.y,t.w,t.h)}intersection(t){let e=this.x,n=e+this.w,i=this.y,s=i+this.h,l=t.x,r=l+t.w,o=t.y,a=o+t.h,h=Math.max(e,l),u=Math.max(i,o),m=Math.min(n,r),c=Math.min(s,a);return new d(h,u,m-h,c-u)}contains(t,e){return t>=this.x&&t<this.x+this.w&&e>=this.y&&e<this.y+this.h}union(t){let e=Math.min(this.x,t.x),n=Math.max(this.x+this.w,t.x+t.w),i=Math.min(this.y,t.y),s=Math.max(this.y+this.h,t.y+t.h);return new d(e,i,n-e,s-i)}isZero(){return 0==this.w&&0==this.h}isEmpty(){return 0==this.w&&0==this.h}notEmpty(){return this.w>0||this.h>0}toString(){return"["+this.x+","+this.y+";"+this.w+","+this.h+"]"}}class f{static zero(){return new f}static fromBox(t){return new f(t.x+.5*t.w,t.y+.5*t.h,.5*t.w,.5*t.h)}static fromArray(t){return new f(t[0],t[1],t[2],t[3])}constructor(t,e,n,i){this.cx=null==t?0:t,this.cy=null==e?0:e,this.rw=null==n?0:n,this.rh=null==i?0:i}clone(){return new f(this.cx,this.cy,this.rw,this.rh)}setCentre(t){this.cx=t.x,this.cy=t.y}setRadius(t){this.rw=t.w,this.rh=t.h}minX(){return this.cx-this.rw}minY(){return this.cy-this.rh}maxX(){return this.cx+this.rw}maxY(){return this.cy+this.rh}scaleBy(t){1!=t&&(this.cx*=t,this.cy*=t,this.rw*=t,this.rh*=t)}offsetBy(t,e){this.cx+=t,this.cy+=e}withScaleBy(t){return new f(this.cx*t,this.cy*t,this.rw*t,this.rh*t)}withOffsetBy(t,e){return new f(this.cx+t,this.cy+e,this.rw,this.rh)}contains(t,e){let n=t-this.cx,i=e-this.cy,s=n/this.rw,l=i/this.rh;return s*s+l*l<=1}toString(){return"["+this.cx+","+this.cy+";"+this.rw+","+this.rh+"]"}}class p{static zero(){return new p}static fromPos(t,e){return new p(t.x,t.y,e.x,e.y)}constructor(t,e,n,i){this.x1=null==t?0:t,this.y1=null==e?0:e,this.x2=null==n?0:n,this.y2=null==i?0:i}clone(){return new p(this.x1,this.y1,this.x2,this.y2)}setPos1(t){this.x1=t.x,this.y1=t.y}setPos2(t){this.x2=t.x,this.y2=t.y}minX(){return Math.min(this.x1,this.x2)}minY(){return Math.min(this.y1,this.y2)}maxX(){return Math.max(this.x1,this.x2)}maxY(){return Math.max(this.y1,this.y2)}scaleBy(t){1!=t&&(this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t)}offsetBy(t,e){this.x1+=t,this.y1+=e,this.x2+=t,this.y2+=e}toString(){return"["+this.x1+","+this.y1+";"+this.x2+","+this.y2+"]"}}class C{static parseXML(t){let e;return e=this.customParser?(new this.customParser).parseFromString(t,"application/xml"):(new DOMParser).parseFromString(t,"application/xml"),null==e?null:e}static toString(t){return this.customSerial?(new this.customSerial).serializeToString(t.documentElement):(new XMLSerializer).serializeToString(t.documentElement)}static toPrettyString(t){let e=['<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">','  <xsl:strip-space elements="*"/>','  <xsl:template match="para[content-style][not(text())]">','    <xsl:value-of select="normalize-space(.)"/>',"  </xsl:template>",'  <xsl:template match="node()|@*">','    <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>',"  </xsl:template>",'  <xsl:output indent="yes"/>',"</xsl:stylesheet>"].join("\n"),n=this.parseXML(e),i=new XSLTProcessor;i.importStylesheet(n);let s=i.transformToDocument(t);return(new XMLSerializer).serializeToString(s)}static nodeText(t){let e="";for(let n of Array.from(t.childNodes))3!=n.nodeType&&4!=n.nodeType||(e+=n.nodeValue);return e}static childText(t,e){if(null==t)return null;let n=this.findElement(t,e);return null==n?null:this.nodeText(n)}static appendElement(t,e){let n=t.ownerDocument.createElement(e);return t.appendChild(n),n}static appendElementAfter(t,e){let n=t.ownerDocument.createElement(e),i=t.nextSibling;return null==i?t.parentNode.appendChild(n):t.parentNode.insertBefore(n,i),n}static appendText(t,e,n=!1){null!=e&&0!=e.length&&(n?t.appendChild(t.ownerDocument.createCDATASection(e)):t.appendChild(t.ownerDocument.createTextNode(e)))}static createTextChild(t,e,n,i=!1){let s=t.ownerDocument.createElement(e);t.appendChild(s),i?s.appendChild(t.ownerDocument.createCDATASection(n)):s.textContent=n}static setText(t,e,n=!1){for(;null!=t.firstChild;)t.removeChild(t.firstChild);this.appendText(t,e,n)}static findElement(t,e){if(null==t)return null;let n=t.firstChild;for(;null!=n;){if(1==n.nodeType&&n.nodeName==e)return n;n=n.nextSibling}return null}static findChildElements(t,e){if(null==t)return[];let n=[],i=t.firstChild;for(;null!=i;)1==i.nodeType&&i.nodeName===e&&n.push(i),i=i.nextSibling;return n}static childElements(t){if(null==t)return[];let e=[],n=t.firstChild;for(;null!=n;)1==n.nodeType&&e.push(n),n=n.nextSibling;return e}}function g(t){return"string"==typeof t?A.parse(t):t instanceof A?t:new A(t)}C.customParser=null,C.customSerial=null;class A{constructor(t){this.el=t}get elHTML(){return this.el}get elInput(){return this.el}get elCanvas(){return this.el}static parse(t){let e=C.parseXML(t);if(null==e)throw"Invalid XHTML string: "+t;let n=e.documentElement.outerHTML,i=document.createElement("template");return i.innerHTML=n,new A(i.content.firstChild)}static find(t){let e=document.querySelector(t);return e?new A(e):null}static findAll(t){let e=document.querySelectorAll(t),n=[];for(let t=0;t<e.length;t++)n.push(new A(e.item(t)));return n}parent(){let t=this.el.parentElement;return t?new A(t):null}ancestor(t){let e=this.el.closest(t);return e?new A(e):null}children(t){let e=[];for(let n=this.el.firstElementChild;n;n=n.nextElementSibling)t&&n.tagName.toLocaleLowerCase()!=t.toLocaleLowerCase()||e.push(new A(n));return e}find(t){let e=this.el.querySelector(t);return e?new A(e):null}findAll(t){let e=this.el.querySelectorAll(t),n=[];for(let t=0;t<e.length;t++)n.push(new A(e.item(t)));return n}exists(){return document.documentElement.contains(this.el)}isVisible(){return this.elHTML.offsetWidth>0||this.elHTML.offsetHeight>0||this.elHTML.getClientRects().length>0}append(t){this.el.append(t.el)}appendTo(t){return t instanceof A?t.el.append(this.el):t.appendChild(this.el),this}prepend(t){this.el.prepend(t.el)}prependTo(t){return t instanceof A?t.el.prepend(this.el):t.append(this.el),this}insertBefore(t){return t.el.parentElement.insertBefore(this.el,t.el),this}insertAfter(t){let e=t.el.nextElementSibling;return e?t.el.parentElement.insertBefore(this.el,e):t.el.parentElement.append(this.el),this}remove(){this.el.remove()}empty(){this.el.innerHTML=""}getHTML(){return this.el.innerHTML}setHTML(t){this.el.innerHTML=t}appendHTML(t){let e=C.parseXML("<z>"+t+"</z>");if(null==e)throw"Invalid XHTML string: "+t;let n=e.documentElement.innerHTML;this.el.insertAdjacentHTML("beforeend",n)}getText(){return this.el.textContent}setText(t){this.el.textContent=t}appendText(t){let e=document.createTextNode(t);this.el.appendChild(e)}getValue(){return this.el.value}setValue(t){this.el.value=t||""}getCSS(t){return this.elHTML.style.getPropertyValue(t)}setCSS(t,e){this.elHTML.style.setProperty(t,null==e?void 0:e.toString())}css(t){for(let e in t)this.setCSS(e,t[e].toString());return this}getAttr(t){return this.el.hasAttribute(t)?this.el.getAttribute(t):null}setAttr(t,e){this.el.setAttribute(t,e)}attr(t){for(let e in t)this.setAttr(e,t[e].toString());return this}addClass(t){for(let e of t.split(" "))e&&this.elHTML.classList.add(e)}removeClass(t){for(let e of t.split(" "))e&&this.elHTML.classList.remove(e)}hasClass(t){return this.elHTML.classList.contains(t)}setClass(t,e){e?this.addClass(t):this.removeClass(t)}class(t){return this.addClass(t),this}toggleClass(t){for(let e in t)t[e]?this.elHTML.classList.add(e):this.elHTML.classList.remove(e)}width(){return this.elHTML.offsetWidth}height(){return this.elHTML.offsetHeight}offset(){let t=this.el.getBoundingClientRect(),e=this.el.ownerDocument.defaultView;return new m(t.left+e.pageXOffset,t.top+e.pageYOffset)}size(){return new c(this.width(),this.height())}area(){let t=this.offset();return new d(t.x,t.y,this.width(),this.height())}setBoundaryPixels(t,e,n,i){this.css({left:`${t}px`,top:`${e}px`,width:`${n}px`,height:`${i}px`})}setSizePixels(t,e){this.css({width:`${t}px`,height:`${e}px`})}hasFocus(){return this.el===document.activeElement}grabFocus(t=!1){t?setTimeout((()=>this.grabFocus()),10):this.elHTML.focus()}removeEvent(t,e){this.el.removeEventListener(t,e)}onKeyDown(t){this.el.addEventListener("keydown",t)}onKeyUp(t){this.el.addEventListener("keyup",t)}onKeyPress(t){this.el.addEventListener("keypress",t)}onScroll(t){this.el.addEventListener("scroll",t)}onWheel(t){this.el.addEventListener("wheel",t)}onClick(t){this.el.addEventListener("click",t)}onContextMenu(t){this.el.addEventListener("contextmenu",t)}onDblClick(t){this.el.addEventListener("dblclick",t)}onMouseDown(t){this.el.addEventListener("mousedown",t)}onMouseUp(t){this.el.addEventListener("mouseup",t)}onMouseEnter(t){this.el.addEventListener("mouseenter",t)}onMouseLeave(t){this.el.addEventListener("mouseleave",t)}onMouseMove(t){this.el.addEventListener("mousemove",t)}onMouseOver(t){this.el.addEventListener("mouseover",t)}onChange(t){this.el.addEventListener("change",t)}onInput(t){this.el.addEventListener("input",t)}onTouchStart(t){this.el.addEventListener("touchstart",t)}onTouchMove(t){this.el.addEventListener("touchmove",t)}onTouchCancel(t){this.el.addEventListener("touchcancel",t)}onTouchEnd(t){this.el.addEventListener("touchend",t)}}function b(t,e=0){if(null==t||0==t.length)return e;let n=t.startsWith("0x")?parseInt(t.substring(2),16):t.startsWith("#")?parseInt(t.substring(1),16):parseInt(t);return isNaN(n)?e:n}function y(t,e){if(null==t)return"";let n=t.toPrecision(e);if(n.indexOf(".")>0){for(;n.endsWith("0");)n=n.substring(0,n.length-1);n.endsWith(".")&&(n=n.substring(0,n.length-1))}return n}function E(t){let e=(16777215&t).toString(16);for(;e.length<6;)e="0"+e;return"#"+e}function x(t){let e=t>>>24&255;return 0==e?1:255==e?0:1-e*(1/255)}const M=1/255;function v(t){return 16777215==t?"white":0==t?"black":-1==t?null:t>=0&&t<=16777215?E(t):"rgba("+(t>>16&255)+","+(t>>8&255)+","+(255&t)+","+(1-(t>>24&255)*M)+")"}function T(t){let e="";if(!t)return"";for(t=t.firstChild;t;)3!=t.nodeType&&4!=t.nodeType||(e+=t.nodeValue),t=t.nextSibling;return e}function N(t,e){return Math.hypot(t,e)}function q(t,e){return t*t+e*e}function S(t,e,n){return t*t+e*e+n*n}function w(t){return t<0?-1:t>0?1:0}function O(t){return t*t}function D(t){return 0==t?0:1/t}function R(t,e){return t==e||Math.abs(t-e)<=1e-7*Math.max(t,e)}function B(t,e){return t==e||Math.abs(t-e)<=1e-14*Math.max(t,e)}const I=2*Math.PI,k=1/I,_=Math.PI/180,L=180/Math.PI;function P(t){return t==-Math.PI?Math.PI:t<-Math.PI?t+Math.ceil((-t-Math.PI)*k)*I:t>Math.PI?t-Math.ceil((t-Math.PI)*k)*I:t}function z(t,e){let n=P(t)-P(e);return n-(n>Math.PI?I:0)+(n<=-Math.PI?I:0)}function F(t,e){let n=P(t)-P(e);return n+(n<0?I:0)}function X(t){if(null==t||0==t.length)return 0;let e=t[0];for(let n=1;n<t.length;n++)e=Math.min(e,t[n]);return e}function U(t){if(null==t||0==t.length)return 0;let e=t[0];for(let n=1;n<t.length;n++)e=Math.max(e,t[n]);return e}function Y(t,e){if(null==t)return null;let n=t.firstChild;for(;n;){if(n.nodeName==e)return n;n=n.nextSibling}return null}function j(t,e){if(null==t)return null;let n=t.firstChild,i=[];for(;n;)n.nodeName==e&&i.push(n),n=n.nextSibling;return i}function H(t){if(null==t)return null;if(Array.isArray(t))return t.slice(0);if("object"!=typeof t)return t;let e={};for(let n in t)e[n]=t[n];return e}function W(t){if(null==t)return null;if("function"==typeof t)return null;if("object"!=typeof t)return t;let e=Array.isArray(t)?[]:{};for(let n in t){let i=t[n];e[n]="object"==typeof i?W(i):i}return e}function V(t){if(!t)return"";const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,(t=>e[t]))}var G;!function(t){t.Backspace="Backspace",t.Tab="Tab",t.Enter="Enter",t.Escape="Escape",t.Space=" ",t.PageUp="PageUp",t.PageDown="PageDown",t.End="End",t.Home="Home",t.Left="ArrowLeft",t.Right="ArrowRight",t.Up="ArrowUp",t.Down="ArrowDown",t.Delete="Delete",t.Insert="Insert"}(G||(G={}));class Q{constructor(t,e,n){if(this.nbrs=[],this.indices=null,this.labels=null,this.props=null,null!=t)for(let e=0;e<t;e++)this.nbrs.push([]);if(null!=e&&null!=n)for(let t=0;t<e.length;t++)this.nbrs[e[t]].push(n[t]),this.nbrs[n[t]].push(e[t])}clone(){let t=new Q;for(let e of this.nbrs)t.nbrs.push(e.slice(0));return t.indices=null==this.indices?null:this.indices.slice(0),t.labels=null==this.labels?null:this.labels.slice(0),t.props=null==this.props?null:this.props.slice(0),t}static fromMolecule(t){let e=new Q;e.indices=[];for(let n=0;n<t.numAtoms;n++)e.nbrs.push([]),e.indices.push(n+1);for(let n=1;n<=t.numBonds;n++){let i=t.bondFrom(n)-1,s=t.bondTo(n)-1;e.nbrs[i].push(s),e.nbrs[s].push(i)}return e}static fromMoleculeMask(e,n){let i=t.maskCount(n),s=t.maskMap(n),l=new Q(i);l.indices=t.maskIdx(n),t.addTo(l.indices,1);for(let t=0;t<i;t++){let i=e.atomAdjList(l.indices[t]);l.nbrs[t]=[];for(let e=0;e<i.length;e++)n[i[e]-1]&&l.nbrs[t].push(s[i[e]-1])}return l}static fromNeighbours(t){let e=new Q;return e.nbrs=t,e}toString(){let e="#nodes="+this.nbrs.length;for(let n=0;n<this.nbrs.length;n++)e+=" "+n+":{"+this.nbrs[n]+"}",n<t.len(this.indices)&&(e+="[i="+this.indices[n]+"]"),n<t.len(this.labels)&&(e+="[l="+this.labels[n]+"]");return e}get numNodes(){return this.nbrs.length}numEdges(t){return this.nbrs[t].length}getEdge(t,e){return this.nbrs[t][e]}getEdges(t){return this.nbrs[t]}getIndex(t){return null==this.indices?0:this.indices[t]}setIndex(e,n){null==this.indices&&(this.indices=t.numberArray(0,this.nbrs.length)),this.indices[e]=n}getLabel(t){return null==this.labels?null:this.labels[t]}setLabel(e,n){null==this.labels&&(this.labels=t.stringArray("",this.nbrs.length)),this.labels[e]=n}getProperty(t){return null==this.props?null:this.props[t]}setProperty(t,e){null==this.props&&(this.props=new Array(this.nbrs.length)),this.props[t]=e}addNode(){return this.nbrs.push([]),null!=this.indices&&this.indices.push(0),null!=this.labels&&this.labels.push(""),null!=this.props&&this.props.push(null),this.nbrs.length-1}hasEdge(t,e){return this.nbrs[t].length<=this.nbrs[e].length?this.nbrs[t].indexOf(e)>=0:this.nbrs[e].indexOf(t)>=0}addEdge(t,e){this.nbrs[t].push(e),this.nbrs[e].push(t)}removeEdge(t,e){let n=this.nbrs[t].indexOf(e),i=this.nbrs[e].indexOf(t);n>=0&&this.nbrs[t].splice(n,1),i>=0&&this.nbrs[e].splice(i,1)}isolateNode(t){for(let e of this.nbrs[t]){let n=this.nbrs[e].indexOf(t);n>=0&&this.nbrs[e].splice(n,1)}this.nbrs[t]=[]}keepNodesMask(e){const n=this.nbrs.length,i=t.maskCount(e);if(i==n)return;if(0==i)return this.nbrs=[],this.indices=null,this.labels=null,void(this.props=null);let s=t.maskMap(e),l=[];for(let t=0;t<i;t++)l.push([]);for(let t=0,i=0;t<n;t++)if(e[t]){for(let n of this.nbrs[t])e[n]&&l[i].push(s[n]);i++}this.nbrs=l,null!=this.indices&&(this.indices=t.maskGet(this.indices,e)),null!=this.labels&&(this.labels=t.maskGet(this.labels,e)),null!=this.props&&(this.props=t.maskGet(this.props,e))}keepNodesIndex(e){this.keepNodesMask(t.idxMask(e,this.numNodes))}removeNodesMask(e){this.keepNodesMask(t.notMask(e))}removeNodesIndex(e){this.removeNodesMask(t.idxMask(e,this.numNodes))}subgraphIndex(t){const e=t.length;let n=new Q(e);if(null!=this.indices||null!=this.labels||null!=this.props)for(let i=0;i<e;i++)null!=this.indices&&n.setIndex(i,this.indices[t[i]]),null!=this.labels&&n.setLabel(i,this.labels[t[i]]),null!=this.props&&n.setProperty(i,this.props[t[i]]);for(let i=0;i<e;i++)for(let e of this.nbrs[t[i]]){let s=t.indexOf(e);s>i&&n.addEdge(i,s)}return n}subgraphMask(t){let e=this.clone();return e.keepNodesMask(t),e}calculateComponents(){const e=this.nbrs.length;if(0==e)return[];let n=t.numberArray(0,e);n[0]=1;let i=1,s=1;for(;;){for(;i<e&&n[i]>0;)i++;if(i>=e)break;let t=!1;for(let s=i;s<e;s++)if(0==n[s])for(let e=0;e<this.nbrs[s].length;e++)0!=n[this.nbrs[s][e]]&&(n[s]=n[this.nbrs[s][e]],t=!0);t||(n[i]=++s)}return n}calculateComponentGroups(){if(0==this.nbrs.length)return[];let e=this.calculateComponents(),n=t.max(e),i=[];for(let t=0;t<n;t++)i.push([]);for(let t=0;t<e.length;t++)i[e[t]-1].push(t);return i}calculateRingBlocks(){let e=this.numNodes,n=this.nbrs;if(0==e)return[[],0];let i=new Array(this.numNodes),s=t.booleanArray(!1,e);t.setTo(i,0);let l=new Array(e+1),r=0,o=0;for(;;){let t,a;if(0==r)for(t=-1,a=0;s[a];a++);else{t=l[r-1],a=-1;for(let e=0;e<n[t].length;e++)if(!s[n[t][e]]){a=n[t][e];break}}if(a>=0&&r>=2){let o=l[r-1];for(let h=0;h<n[a].length;h++){let u=n[a][h];if(u!=o&&s[u]){l[r]=a;for(let n=r;n==r||l[n+1]!=u;n--){let s=i[l[n]];if(0==s)i[l[n]]=t;else if(s!=t)for(let n=0;n<e;n++)i[n]==s&&(i[n]=t)}}}}if(a>=0?(s[a]=!0,l[r++]=a,o++):r--,o==e)break}let a=0;for(let t=0;t<e;t++)if(i[t]>0){a--;for(let n=e-1;n>=t;n--)i[n]==i[t]&&(i[n]=a)}for(let t=0;t<e;t++)i[t]=-i[t];return[i,-a]}calculateRingBlockGroups(){let[e,n]=this.calculateRingBlocks();if(0==n)return[];let i=t.numberArray(0,n);for(let t=0;t<e.length;t++)e[t]>0&&i[e[t]-1]++;let s=new Array(n);for(let t=0;t<n;t++)s[t]=new Array(i[t]),i[t]=0;for(let t=0;t<e.length;t++){let n=e[t]-1;n<0||(s[n][i[n]++]=t)}return s}findRingsOfSize(t){let[e,n]=this.calculateRingBlocks();if(0==n)return[];let i=[],s=new Array(this.numNodes);for(let l=1;l<=n;l++){for(let t=0;t<this.numNodes;t++)s[t]=e[t]==l;let n=this.findRingsOfSizeMask(t,s);for(let t=0;t<n.length;t++)i.push(n[t])}return i}findRingsOfSizeMask(t,e){let n=[];for(let i=0;i<this.numNodes;i++)if(e[i]){let s=new Array(t);s[0]=i,this.recursiveRingFind(s,1,t,e,n)}return n}calculateBFS(e){let n=t.numberArray(-1,this.numNodes);n[e]=0;let i=0,s=1,l=0,r=t.numberArray(0,this.numNodes);for(r[0]=e;;){let t=s;for(let e=l;e<s;e++)for(let s=0;s<this.nbrs[r[e]].length;s++){let l=this.nbrs[r[e]][s];n[l]<0&&(n[l]=i+1,r[t++]=l)}if(t==s)break;l=s,s=t,i++}return n}calculateGravity(){const e=this.numNodes,{nbrs:n}=this;let i=t.numberArray(1,e);for(let s=0;s<e;s++){let s=t.numberArray(0,e);for(let t=0;t<e;t++)for(let e=n[t].length-1;e>=0;e--)s[t]+=i[n[t][e]];i=s}return i}calculateShortestPath(e,n){const i=this.numNodes;let s=new Set;for(let t=0;t<i;t++)s.add(t);let l=t.numberArray(Number.MAX_SAFE_INTEGER,i),r=t.numberArray(-1,i);for(l[e]=0;s.size>0;){let t=-1;for(let e of s)(t<0||l[e]<l[t])&&(t=e);if(s.delete(t),t==n)break;for(let e of this.nbrs[t]){let n=l[t]+1;n<l[e]&&(l[e]=n,r[e]=t)}}let o=[];for(let t=n;r[t]>=0;t=r[t])o.unshift(t);return o.length>0&&o.unshift(e),o.length>0?o:null}adjacencyMatrix(){const e=this.numNodes;let n=[];for(let i=0;i<e;i++)n.push(t.numberArray(0,e));for(let t=0;t<e;t++)for(let e of this.nbrs[t])n[t][e]=n[e][t]=1;return n}distanceMatrix(){const e=this.numNodes;let n=[];for(let i=0;i<e;i++)n.push(t.numberArray(Number.POSITIVE_INFINITY,e));for(let t=0;t<e;t++){n[t][t]=0;for(let e of this.nbrs[t])n[t][e]=n[e][t]=1}for(let t=0;t<e;t++)for(let i=0;i<e;i++)for(let s=0;s<e;s++)Number.isFinite(n[t][s])&&Number.isFinite(n[i][t])&&(n[i][s]=Math.min(n[i][s],n[i][t]+n[t][s]));return n}recursiveRingFind(e,n,i,s,l){if(n<i){let r=e[n-1];for(let o=0;o<this.nbrs[r].length;o++){let a=this.nbrs[r][o];if(!s[a])continue;let h=!1;for(let t=0;t<n;t++)if(e[t]==a){h=!0;break}if(!h){let r=t.duplicate(e);r[n]=a,this.recursiveRingFind(r,n+1,i,s,l)}}return}let r=e[n-1],o=!1;for(let t=0;t<this.nbrs[r].length;t++)if(this.nbrs[r][t]==e[0]){o=!0;break}if(!o)return;for(let t=0;t<e.length;t++){let n=0,i=e[t];for(let t=0;t<this.nbrs[i].length;t++)e.indexOf(this.nbrs[i][t])>=0&&n++;if(2!=n)return}let a=0;for(let t=1;t<n;t++)e[t]<e[a]&&(a=t);let h=(a+1)%n,u=e[(a-1+n)%n]<e[h];if(0!=a||u){let t=new Array(n);for(let i=0;i<n;i++)t[i]=e[(a+(u?n-i:i))%n];e=t}for(let t=0;t<l.length;t++){let i=l[t],s=!0;for(let t=0;t<n;t++)if(i[t]!=e[t]){s=!1;break}if(s)return}l.push(e)}}class K{constructor(t,e,n=[]){this.mol=t,this.resBonds=e,this.atomHyd=n,this.maxIter=1e3,this.bondOrders=[],this.tolerant=!1,this.mol=t,this.resBonds=e,this.atomHyd=n;for(let e=1;e<=t.numBonds;e++)this.bondOrders.push(t.bondOrder(e))}perform(){const{mol:t}=this;if(null==this.atomHyd){this.atomHyd=[];for(let e=1;e<=t.numAtoms;e++)this.atomHyd.push(t.atomHExplicit(e))}this.correctInputMask();let e=new Q(t.numAtoms);for(let n=1;n<=t.numBonds;n++)this.resBonds[n-1]&&e.addEdge(t.bondFrom(n)-1,t.bondTo(n)-1);let n=e.calculateComponentGroups();for(let t=0;t<n.length;t++)n[t].length>=2&&this.processComponent(n[t])}correctInputMask(){const{mol:e,atomHyd:n}=this,i=e.numAtoms,l=e.numBonds;let r=t.booleanArray(!1,i);for(let t=1;t<=i;t++){let i=e.atomicNumber(t),l=i==s.ELEMENT_C?4:i==s.ELEMENT_N||i==s.ELEMENT_P||i==s.ELEMENT_B?3:i==s.ELEMENT_O||i==s.ELEMENT_S?2:-1;l<0?r[t-1]=!0:(l+=e.atomCharge(t),n[t-1]>0&&(l-=n[t-1]),e.atomAdjCount(t)>=l&&(r[t-1]=!0))}for(let t=1;t<=l;t++)this.resBonds[t-1]||1==e.bondOrder(t)||(r[e.bondFrom(t)-1]=!0,r[e.bondTo(t)-1]=!0);this.resBonds=this.resBonds.slice(0);for(let t=0;t<l;t++)this.resBonds[t]&&(r[e.bondFrom(t+1)-1]||r[e.bondTo(t+1)-1])&&(this.bondOrders[t]=1,this.resBonds[t]=!1)}processComponent(e){const{mol:n,resBonds:i,bondOrders:s,atomHyd:l}=this;let r=e.length;if(2==r)return void(s[n.findBond(e[0]+1,e[1]+1)-1]=2);let o=t.booleanArray(!1,r);for(let t=0;t<r;t++){let i=e[t],s=i+1;o[t]=l[i]==qt.HEXPLICIT_UNKNOWN&&"N"==n.atomElement(s)&&n.atomAdjCount(s)-n.atomCharge(s)<=2}let a=new Q(r),h=a.calculateGravity(),u=t.idxMask(e,n.numAtoms),m=0;for(let t=1;t<=n.numBonds;t++)i[t-1]&&u[n.bondFrom(t)-1]&&u[n.bondTo(t)-1]&&m++;let c=t.numberArray(0,m),d=t.numberArray(0,m),f=t.numberArray(0,m),p=t.numberArray(0,m);m=0;for(let t=1;t<=n.numBonds;t++)if(i[t-1]&&u[n.bondFrom(t)-1]&&u[n.bondTo(t)-1]){let i=e.indexOf(n.bondFrom(t)-1),s=e.indexOf(n.bondTo(t)-1);c[m]=i,d[m]=s,f[m]=h[i]+h[s],p[m]=t,a.addEdge(i,s),m++}let C=t.numberArray(0,m);C[0]=t.idxMax(f);let g=t.booleanArray(!1,m);g[C[0]]=!0;for(let t=1;t<m;t++){let e=-1;for(let n=t-1;n>=0;n--){for(let t=0;t<m;t++)g[t]||c[t]!=c[C[n]]&&c[t]!=d[C[n]]&&d[t]!=c[C[n]]&&d[t]!=d[C[n]]||(e<0||f[t]>f[e])&&(e=t);if(e>=0)break}if(e<0)throw"Graph walk failed";C[t]=e,g[e]=!0}let A=[];A.push([!0]),A.push([!1]);let b=null,y=0,E=Math.ceil(.5*m),x=0;for(;A.length>0;){let e=A[0],n=t.append(e,!1),i=t.append(e,!0);if(this.validPath(n,C,c,d,a,o)||(n=null),this.validPath(i,C,c,d,a,o)||(i=null),t.len(n)==m){let e=t.maskCount(n);e>y&&(b=n,y=e),n=null}if(t.len(i)==m){let e=t.maskCount(i);e>y&&(b=i,y=e),i=null}if(y>=E)break;if(null==n&&null==i?A.shift():null!=n&&null!=i?(A[0]=n,A.splice(1,0,i)):A[0]=null!=n?n:i,x++,x>this.maxIter){if(null!=b)break;if(this.tolerant)return;throw"Resonance localisation exceeded maximum iteration count"}}if(null==b){if(this.tolerant)return;throw"Unable to find a solution to the resonance block."}for(let t=0;t<m;t++)s[p[C[t]]-1]=b[t]?2:1}validPath(e,n,i,s,l,r){let o=l.numNodes,a=t.numberArray(0,o),h=t.numberArray(0,o);for(let t=0;t<e.length;t++){let l=i[n[t]],r=s[n[t]];e[t]?(h[l]++,h[r]++):(a[l]++,a[r]++)}for(let t=0;t<o;t++){if(h[t]>1)return!1;if(!r[t]&&l.numEdges(t)>1&&a[t]==l.numEdges(t))return!1}return!0}}const $="xRESPATH:",Z="xRESRING:",J="xARENE:";class tt{constructor(t){this.mol=t,this.resPaths=new Map,this.resRings=new Map,this.arenes=new Map;for(let t=1;t<=this.mol.numAtoms;t++)for(let e of this.mol.atomExtra(t))e.startsWith($)?this.appendResPath(t,e.substring(9).split(":")):e.startsWith(Z)?this.appendResRing(t,e.substring(9).split(":")):e.startsWith(J)&&this.appendArene(t,e.substring(7).split(":"));for(let[t,e]of this.resPaths.entries())e.atoms=this.pack(e.atoms),this.pathify(e.atoms,!1)||this.resPaths.delete(t);for(let[t,e]of this.resRings.entries())e.atoms=this.pack(e.atoms),this.pathify(e.atoms,!0)||this.resRings.delete(t);for(let[t,e]of this.arenes.entries())e.atoms=this.pack(e.atoms),e.atoms.length>1&&(e.centre=e.atoms.shift()),this.pathify(e.atoms,!1)||this.arenes.delete(t)}getPathBlocks(){return Array.from(this.resPaths.keys())}getRingBlocks(){return Array.from(this.resRings.keys())}getAreneBlocks(){return Array.from(this.arenes.keys())}getResPaths(){let e=[];for(let n of t.sorted(Array.from(this.resPaths.keys())))e.push(this.resPaths.get(n));return e}getResRings(){let e=[];for(let n of t.sorted(Array.from(this.resRings.keys())))e.push(this.resRings.get(n));return e}getArenes(){let e=[];for(let n of t.sorted(Array.from(this.arenes.keys())))e.push(this.arenes.get(n));return e}rewriteMolecule(){const t=this.mol;for(let e=1;e<=t.numAtoms;e++){let n=t.atomExtra(e),i=!1;for(let t=n.length-1;t>=0;t--)(n[t].startsWith($)||n[t].startsWith(Z)||n[t].startsWith(J))&&(n.splice(t),i=!0);i&&t.setAtomExtra(e,n)}for(let[e,n]of this.resPaths.entries())for(let i=0;i<n.atoms.length;i++){let s=t.atomExtra(n.atoms[i]);s.push($+e+":"+(i+1)),t.setAtomExtra(n.atoms[i],s)}for(let[e,n]of this.resRings.entries())for(let i=0;i<n.atoms.length;i++){let s=t.atomExtra(n.atoms[i]);s.push(Z+e+":"+(i+1)),t.setAtomExtra(n.atoms[i],s)}for(let[e,n]of this.arenes.entries())for(let i=-1;i<n.atoms.length;i++){let s=i<0?n.centre:n.atoms[i],l=t.atomExtra(s);l.push(J+e+":"+(i+2)),t.setAtomExtra(s,l)}}harmoniseNumbering(t){let e=t.getPathBlocks(),n=this.getResPaths();this.resPaths.clear();for(let t of n){let n=this.nextIdentifier(e);this.resPaths.set(n,t),e.push(n)}e=t.getRingBlocks();let i=this.getResRings();this.resRings.clear();for(let t of i){let n=this.nextIdentifier(e);this.resRings.set(n,t),e.push(n)}e=t.getAreneBlocks();let s=this.getArenes();this.arenes.clear();for(let t of s){let n=this.nextIdentifier(e);this.arenes.set(n,t),e.push(n)}}createPath(t){if(this.alreadyExists(t))return!1;let e=this.atomsAsPath(t);if(e){let t=this.nextIdentifier(Array.from(this.resPaths.keys()));return this.resPaths.set(t,e),!0}return!1}createRing(t){if(this.alreadyExists(t))return!1;let e=this.atomsAsRing(t);if(e){let t=this.nextIdentifier(Array.from(this.resRings.keys()));return this.resRings.set(t,e),!0}return!1}createArene(t){if(this.alreadyExists(t))return!1;let e=this.atomsAsArene(t);if(e){let t=this.nextIdentifier(Array.from(this.arenes.keys()));return this.arenes.set(t,e),!0}return!1}removeArtifact(t){let e=0,n=0,i=0;for(let[s,l]of this.resPaths.entries()){let r=0;for(let e of l.atoms)t.indexOf(e)>=0&&r++;r>i&&(e=1,n=s,i=r)}for(let[s,l]of this.resRings.entries()){let r=0;for(let e of l.atoms)t.indexOf(e)>=0&&r++;r>i&&(e=2,n=s,i=r)}for(let[s,l]of this.arenes.entries()){let r=t.indexOf(l.centre)>=0?1:0;for(let e of l.atoms)t.indexOf(e)>=0&&r++;r>i&&(e=3,n=s,i=r)}return 0!=e&&(1==e?this.resPaths.delete(n):2==e?this.resRings.delete(n):3==e&&this.arenes.delete(n),!0)}static removeAll(e){for(let n=1;n<=e.numAtoms;n++){let i=e.atomExtra(n),s=!1;for(let e=i.length-1;e>=0;e--)(i[e].startsWith($)||i[e].startsWith(Z)||i[e].startsWith(J))&&(i=t.remove(i,e),s=!0);s&&e.setAtomExtra(n,i)}}appendResPath(e,n){let i=b(n[0],0);if(i<=0)return;let s=this.resPaths.get(i);null==s&&this.resPaths.set(i,s={atoms:t.numberArray(0,this.mol.numAtoms)});let l=n.length>=2?b(n[1],0):0;s.atoms.indexOf(e)>=0||(l>=1&&l<=this.mol.numAtoms?s.atoms[l-1]=e:s.atoms.push(e))}appendResRing(e,n){let i=b(n[0],0);if(i<=0)return;let s=this.resRings.get(i);null==s&&this.resRings.set(i,s={atoms:t.numberArray(0,this.mol.numAtoms)});let l=n.length>=2?b(n[1],0):0;s.atoms.indexOf(e)>=0||(l>=1&&l<=this.mol.numAtoms?s.atoms[l-1]=e:s.atoms.push(e))}appendArene(e,n){let i=b(n[0],0);if(i<=0)return;let s=this.arenes.get(i);null==s&&this.arenes.set(i,s={centre:0,atoms:t.numberArray(0,this.mol.numAtoms)});let l=n.length>=2?b(n[1],0):0;s.atoms.indexOf(e)>=0||(l>=1&&l<=this.mol.numAtoms?s.atoms[l-1]=e:s.atoms.push(e))}pack(t){let e=[];for(let n of t)0!=n&&e.push(n);return e}pathify(e,n){let i=e.length;if(i<2)return!1;let s=Q.fromMolecule(this.mol);for(let t=0;t<this.mol.numAtoms;t++)s.setIndex(t,t+1);s=s.subgraphIndex(t.add(e,-1));let l=0;for(let t=1;t<i;t++)s.numEdges(t)<s.numEdges(l)&&(l=t);t.setTo(e,-1);for(let t=0;t<i;t++)if(e[t]=l,t==i-1){if(n&&s.getEdges(l).indexOf(e[0])<0)return!1}else{let t=i;for(let n of s.getEdges(l))e.indexOf(n)<0&&n<t&&(t=n);if(t==i)return!1;l=t}for(let t=0;t<i;t++)e[t]=s.getIndex(e[t]);return!0}alreadyExists(e){e=t.sorted(e);for(let n of this.resPaths.values())if(t.equals(e,t.sorted(n.atoms)))return!0;for(let n of this.resRings.values())if(t.equals(e,t.sorted(n.atoms)))return!0;for(let n of this.arenes.values()){let i=t.append(n.atoms,n.centre);if(t.equals(e,t.sorted(i)))return!0}return!1}atomsAsPath(t){if(t.length<2)return null;let e={atoms:t};return this.pathify(e.atoms,!1)?e:null}atomsAsRing(t){if(t.length<3)return null;let e={atoms:t};return this.pathify(e.atoms,!0)?e:null}atomsAsArene(e){const n=e.length;if(n<3)return null;let i=Q.fromMolecule(this.mol).subgraphIndex(t.add(e,-1)),s=0;if(3==n){let l=[0,0,0];for(let r=0;r<n;r++){if(2!=i.numEdges(r))return null;for(let t of i.getEdges(r))l[r]+=this.mol.bondOrder(this.mol.findBond(e[r],e[t]));s=t.idxMin(l)}}else for(let t=1;t<n;t++)i.numEdges(t)>i.numEdges(s)&&(s=t);let l={centre:e[s],atoms:t.remove(e,s)};return this.pathify(l.atoms,!1)?l:null}nextIdentifier(e){if(0==e.length)return 1;let n=t.sorted(e);for(let t=0;t<n.length-1;t++)if(n[t+1]!=n[t]+1)return n[t]+1;return n[n.length-1]+1}}var et,nt;!function(t){t.Molecule="molecule",t.String="string",t.Real="real",t.Integer="integer",t.Boolean="boolean",t.Extend="extend"}(et||(et={}));class it{constructor(e){e||(e={}),e.title||(e.title=""),e.description||(e.description=""),null==e.numCols&&(e.numCols=t.len(e.colData)),null==e.numRows&&(e.numRows=t.len(e.rowData)),null==e.numExtens&&(e.numExtens=t.len(e.extData)),null==e.colData&&(e.colData=[]),null==e.rowData&&(e.rowData=[]),null==e.extData&&(e.extData=[]),this.data=e}clone(t=!0){let{numCols:e,numRows:n,colData:i,rowData:s}=this.data,l={title:this.data.title,description:this.data.description,numCols:e,numRows:t?n:0,numExtens:this.data.numExtens,colData:W(i),rowData:t?new Array(n):[],extData:W(this.data.extData)};if(t)for(let t=0;t<n;t++){let n=s[t],r=new Array(e);for(let t=0;t<e;t++)null!=n[t]&&"molecule"==i[t].type&&n[t]instanceof qt?r[t]=n[t].clone():r[t]=n[t];l.rowData[t]=r}return new it(l)}cloneMask(e,n=null,i=!0){let{numCols:s,numRows:l,colData:r,rowData:o}=this.data,a={title:this.data.title,description:this.data.description,numCols:t.maskCount(e),numRows:n?t.maskCount(n):0,numExtens:i?this.data.numExtens:0,colData:W(t.maskGet(r,e)),rowData:[],extData:i?W(this.data.extData):[]};if(n)for(let i=0;i<l;i++)if(n[i]){let n=o[i],s=t.maskGet(n,e);a.rowData.push(s)}const{colData:h,rowData:u}=a;for(let t=h.length-1;t>=0;t--)if("molecule"==h[t].type)for(let e=u.length-1;e>=0;e--)null!=u[e][t]&&u[e][t]instanceof qt&&(u[e][t]=u[e][t].clone());return new it(a)}getData(){return this.data}get numCols(){return this.data.numCols}get numRows(){return this.data.numRows}get title(){return this.data.title}set title(t){this.data.title=t}get description(){return this.data.description}set description(t){this.data.description=t}get numExtensions(){return this.data.numExtens}getExtName(t){return this.data.extData[t].name}getExtType(t){return this.data.extData[t].type}getExtData(t){return this.data.extData[t].data}setExtName(t,e){this.data.extData[t].name=e}setExtType(t,e){this.data.extData[t].type=e}setExtData(t,e){this.data.extData[t].data=e}appendExtension(t,e,n){return this.data.numExtens++,this.data.extData.push({name:t,type:e,data:n}),this.data.numExtens-1}insertExtension(t,e,n,i){this.data.numExtens++,this.data.extData.splice(t,0,{name:e,type:n,data:i})}deleteExtension(t){this.data.extData.splice(t,1),this.data.numExtens--}colName(t){return this.data.colData[t].name}colType(t){return this.data.colData[t].type}colDescr(t){return this.data.colData[t].descr}isNull(t,e){return"string"==typeof e&&(e=this.findColByName(e)),e<0?null:null==this.data.rowData[t][e]}notNull(t,e){return!this.isNull(t,e)}isBlank(t,e){if("string"==typeof e&&(e=this.findColByName(e)),this.isNull(t,e))return!0;let n=this.colType(e);return"molecule"==n?0==this.getMolecule(t,e).numAtoms:"string"==n?0==this.getString(t,e).length:"extend"==n&&0==this.getExtend(t,e).length}notBlank(t,e){return!this.isBlank(t,e)}getObject(t,e){return"string"==typeof e&&(e=this.findColByName(e)),this.data.rowData[t][e]}getMolecule(t,e){if("string"==typeof e&&(e=this.findColByName(e)),e<0)return null;let n=this.data.rowData[t][e];return null==n?null:("string"==typeof n&&(n=qt.fromString(n),this.data.rowData[t][e]=n),n)}getMoleculeClone(t,e){let n=this.getMolecule(t,e);return null==n?null:n.clone()}getMoleculeBlank(t,e){return this.getMolecule(t,e)||new qt}getString(t,e){if("string"==typeof e&&(e=this.findColByName(e)),e<0)return null;let n=this.data.rowData[t][e];return null==n?"":n}getInteger(t,e){return"string"==typeof e&&(e=this.findColByName(e)),e<0?null:this.data.rowData[t][e]}getReal(t,e){return"string"==typeof e&&(e=this.findColByName(e)),e<0?null:this.data.rowData[t][e]}getBoolean(t,e){return"string"==typeof e&&(e=this.findColByName(e)),e<0?null:this.data.rowData[t][e]}getExtend(t,e){return"string"==typeof e&&(e=this.findColByName(e)),e<0?null:this.data.rowData[t][e]}setToNull(t,e){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=null)}setObject(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n)}setMolecule(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n?n.clone():null)}setString(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n)}setInteger(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n)}setReal(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n)}setBoolean(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n)}setExtend(t,e,n){"string"==typeof e&&(e=this.findColByName(e)),e<0||(this.data.rowData[t][e]=n)}isEqualMolecule(t,e,n){return"string"==typeof e&&(e=this.findColByName(e)),this.isNull(t,e)==(null==n)&&(null==n||0==this.getMolecule(t,e).compareTo(n))}isEqualString(t,e,n){return"string"==typeof e&&(e=this.findColByName(e)),this.isNull(t,e)==(null==n||""==n)&&(null==n||""==n||this.getString(t,e)==n)}isEqualInteger(t,e,n){return"string"==typeof e&&(e=this.findColByName(e)),this.isNull(t,e)==(null==n)&&(null==n||this.getInteger(t,e)==n)}isEqualReal(t,e,n){return"string"==typeof e&&(e=this.findColByName(e)),this.isNull(t,e)==(null==n)&&(null==n||this.getReal(t,e)==n)}isEqualBoolean(t,e,n){return"string"==typeof e&&(e=this.findColByName(e)),this.isNull(t,e)==(null==n)&&(null==n||this.getBoolean(t,e)==n)}appendColumn(t,e,n){this.data.numCols++,this.data.colData.push({name:t,type:e,descr:n});for(let t=0;t<this.data.numRows;t++)this.data.rowData[t].push(null);return this.data.numCols-1}insertColumn(t,e,n,i){this.data.numCols++,this.data.colData.splice(t,0,{name:e,type:n,descr:i});for(let e=0;e<this.data.numRows;e++)this.data.rowData[e].splice(t,0,null)}deleteColumn(t){this.data.numCols--,this.data.colData.splice(t,1);for(let e=0;e<this.data.numRows;e++)this.data.rowData[e].splice(t,1)}changeColumnName(t,e,n){this.data.colData[t].name=e,this.data.colData[t].descr=n}changeColumnType(t,e){let n=this.colType(t);if(n==e)return;let i="molecule"==n||"molecule"==e||"extend"==n||"extend"==e;for(let s=this.data.rowData.length-1;s>=0;s--){let l=this.data.rowData[s];if(null==l[t])continue;if(i){l[t]=null;continue}let r="";if("string"==n?r=l[t]:"integer"==n||"real"==n?r=l[t].toString():"boolean"==n&&(r=l[t]?"true":"false"),l[t]=null,"string"==e)l[t]=r;else if("integer"==e){let e=parseInt(r);l[t]=isFinite(e)?e:null}else if("real"==e){let e=parseFloat(r);l[t]=isFinite(e)?e:null}else"boolean"==e&&(l[t]="true"==r.toLowerCase())}this.data.colData[t].type=e}ensureColumn(t,e,n){for(let i=0;i<this.data.numCols;i++)if(this.data.colData[i].name==t)return this.data.colData[i].type!=e&&this.changeColumnType(i,e),this.data.colData[i].descr=n,i;return this.appendColumn(t,e,n)}reorderColumns(e){let n=!0;for(let t=0;t<e.length-1;t++)if(e[t]!=e[t+1]-1){n=!1;break}if(!n){this.data.colData=t.idxGet(this.data.colData,e);for(let n=0;n<this.data.numRows;n++)this.data.rowData[n]=t.idxGet(this.data.rowData[n],e)}}appendRow(){this.data.numRows++;let t=new Array;for(let e=0;e<this.data.numCols;e++)t.push(null);return this.data.rowData.push(t),this.data.numRows-1}appendRowFrom(t,e){return this.data.numRows++,this.data.rowData.push(t.data.rowData[e].slice(0)),this.data.numRows-1}insertRow(t){this.data.numRows++;let e=new Array;for(let t=0;t<this.data.numCols;t++)e.push(null);this.data.rowData.splice(t,0,e)}deleteRow(t){this.data.numRows--,this.data.rowData.splice(t,1)}deleteAllRows(){this.data.numRows=0,this.data.rowData=new Array}moveRowUp(t){let e=this.data.rowData[t];this.data.rowData[t]=this.data.rowData[t-1],this.data.rowData[t-1]=e}moveRowDown(t){let e=this.data.rowData[t];this.data.rowData[t]=this.data.rowData[t+1],this.data.rowData[t+1]=e}swapRows(e,n){t.swap(this.data.rowData,e,n)}exciseSingleRow(t){let e={title:this.data.title,description:this.data.description,numCols:this.data.numCols,numRows:1,numExtens:this.data.numExtens,colData:this.data.colData.slice(0),rowData:[this.data.rowData[t].slice(0)],extData:this.data.extData.slice(0)};return new it(e)}colIsPrimitive(t){"string"==typeof t&&(t=this.findColByName(t));let e=this.data.colData[t].type;return"string"==e||"real"==e||"integer"==e||"boolean"==e}findColByName(t,e){for(let n=0;n<this.data.numCols;n++)if(this.data.colData[n].name==t&&(null==e||this.data.colData[n].type==e))return n;return-1}firstColOfType(t){for(let e=0;e<this.data.numCols;e++)if(this.data.colData[e].type==t)return e;return-1}copyCell(t,e,n,i,s){if(this.setToNull(t,e),n.isNull(i,s))return;let l=n.getObject(i,s);this.setObject(t,e,it.convertType(l,n.colType(s),this.colType(e)))}static convertType(t,e,n){const i=e,s=n;if(null==t||i==s||"string"==typeof t&&""==t)return t;if("string"==s){if("integer"==i)return t.toString();if("real"==i)return t.toString();if("boolean"==i)return t?"true":"false"}else if("real"==s){if("string"==i)return function(t,e=0){if(null==t||0==t.length)return e;let n=parseFloat(t);return isNaN(n)?e:n}(t,null);if("integer"==i)return t;if("boolean"==i)return t?1:0}else if("integer"==s){if("string"==i)return b(t,null);if("real"==i)return Math.round(t);if("boolean"==i)return t?1:0}else if("boolean"==s){if("string"==i)return"true"==t.toLowerCase();if("integer"==i)return t>0;if("real"==i)return t>=.5}return null}toString(t,e){"string"==typeof e&&(e=this.findColByName(e));let n=this.data.rowData[t][e];return null==n?null:n.toString()}toInt(t,e){if(!this.colIsPrimitive(e))return null;let n=this.data.rowData[t][e];return null==n?null:parseInt(n)}toReal(t,e){if(!this.colIsPrimitive(e))return null;let n=this.data.rowData[t][e];return null==n?null:parseFloat(n)}}!function(t){t.AtomAromatic="yAROMATIC",t.BondAromatic="yAROMATIC",t.BondZeroDative="yZERO_DATIVE",t.BondZeroHydrogen="yZERO_HYDROGEN",t.AtomChiralMDLOdd="yCHIRAL_MDL_ODD",t.AtomChiralMDLEven="yCHIRAL_MDL_EVEN",t.AtomChiralMDLRacemic="yCHIRAL_MDL_RACEMIC",t.AtomExplicitValence="yMDL_EXPLICIT_VALENCE",t.AtomSgroupMultiAttach="yMDL_SGROUP_MULTIATTACH",t.AtomSgroupMultiRepeat="yMDL_SGROUP_MULTIREPEAT",t.AtomSgroupData="yMDL_SGROUP_DATA",t.AtomSCSRClass="yMDL_SCSR_CLASS",t.AtomSCSRSeqID="yMDL_SCSR_SEQID",t.AtomSCSRAttchOrd="yMDL_SCSR_ATTCHORD"}(nt||(nt={}));class st{static noteAromaticAtoms(e){const n=e.numAtoms;let i=t.booleanArray(!1,n);for(let t=1;t<=n;t++)i[t-1]=e.atomTransient(t).indexOf(nt.AtomAromatic)>=0;return i}static noteAromaticBonds(e){const n=e.numBonds;let i=t.booleanArray(!1,n);for(let t=1;t<=n;t++)i[t-1]=e.bondTransient(t).indexOf(nt.BondAromatic)>=0;return i}static noteZeroDativeBonds(e){const n=e.numBonds;let i=t.booleanArray(!1,n);for(let t=1;t<=n;t++)i[t-1]=e.bondTransient(t).includes(nt.BondZeroDative);return i}static noteZeroHydrogenBonds(e){const n=e.numBonds;let i=t.booleanArray(!1,n);for(let t=1;t<=n;t++)i[t-1]=e.bondTransient(t).includes(nt.BondZeroHydrogen);return i}static markExplicitValence(t,e,n){let i=t.atomTransient(e).filter((t=>!t.startsWith(nt.AtomExplicitValence+":")));i.push(`${nt.AtomExplicitValence}:${n}`),t.setAtomTransient(e,i)}static noteExplicitValence(t,e){let n=t.atomTransient(e);for(let t of n)if(t.startsWith(nt.AtomExplicitValence+":"))return parseInt(t.substring(nt.AtomExplicitValence.length+1));return null}static markSgroupMultiAttach(e,n,i,s={}){let l=0;for(let t=1;t<=e.numAtoms;t++)for(let n of e.atomTransient(t))if(n.startsWith(nt.AtomSgroupMultiAttach+":")){let t=n.substring(nt.AtomSgroupMultiAttach.length+1),e=(t.indexOf(","),t.split(",")),i=parseInt(e[0]);if(!(i>0))continue;l=Math.max(l,i)}let r=`${nt.AtomSgroupMultiAttach}:${l+1},${n}`;for(let[t,e]of Object.entries(s))r+=","+t+"="+e;for(let n of i)e.setAtomTransient(n,t.append(e.atomTransient(n),r))}static hasAnySgroupMultiAttach(t){for(let e=1;e<=t.numAtoms;e++)if(t.atomTransient(e).some((t=>t.startsWith(nt.AtomSgroupMultiAttach+":"))))return!0;return!1}static noteAllSgroupMultiAttach(t){let e={};for(let n=1;n<=t.numAtoms;n++)for(let i of t.atomTransient(n))if(i.startsWith(nt.AtomSgroupMultiAttach+":")){let t=i.substring(nt.AtomSgroupMultiAttach.length+1).split(",");if(t.length<2)continue;let s=parseInt(t[0]),l=t[1];if(!(s>0&&l))continue;let r={};for(let e=2;e<t.length;e++){let n=t[e].indexOf("=");n<0||(r[t[e].substring(0,n)]=t[e].substring(n+1))}let o=e[s];o?o.atoms.push(n):e[s]={name:l,atoms:[n],keyval:r}}return Object.values(e)}static markSgroupMultiRepeat(e,n,i){let s=0;for(let t=1;t<=e.numAtoms;t++)for(let n of e.atomTransient(t))if(n.startsWith(nt.AtomSgroupMultiRepeat+":")){let t=n.substring(nt.AtomSgroupMultiRepeat.length+1),e=t.indexOf(",");if(e<=0)continue;let i=parseInt(t.substring(0,e));if(i<=0)continue;s=Math.max(s,i)}let l=i.length/n,r=`${nt.AtomSgroupMultiRepeat}:${s+1},${n},${l},`;for(let n=0;n<i.length;n++)e.setAtomTransient(i[n],t.append(e.atomTransient(i[n]),r+(n+1)))}static hasAnySgroupMultiRepeat(t){for(let e=1;e<=t.numAtoms;e++)if(t.atomTransient(e).some((t=>t.startsWith(nt.AtomSgroupMultiRepeat+":"))))return!0;return!1}static noteAllSgroupMultiRepeat(e){let n={};for(let i=1;i<=e.numAtoms;i++)for(let s of e.atomTransient(i))if(s.startsWith(nt.AtomSgroupMultiRepeat+":")){let e=s.substring(nt.AtomSgroupMultiRepeat.length+1).split(",");if(e.length<4)continue;let l=parseInt(e[0]),r=parseInt(e[1]),o=parseInt(e[2]),a=parseInt(e[3]);if(!(l>0)||r<2||o<1||a<1||a>r*o)continue;let h=n[l];if(null==h)n[l]=h={mult:r,unit:o,atoms:t.numberArray(0,r*o)};else if(h.mult!=r||h.unit!=o)continue;h.atoms[a-1]=i}return Object.values(n)}static markSgroupData(e,n,i,s,l,r){var o;let a=0;for(let t=1;t<=e.numAtoms;t++)for(let n of e.atomTransient(t))if(n.startsWith(nt.AtomSgroupData+":")){let t=n.substring(nt.AtomSgroupData.length+1),e=t.indexOf(",");if(e<=0)continue;let i=parseInt(t.substring(0,e));if(i<=0)continue;a=Math.max(a,i)}let h=[(a+1).toString(),n,i,s,l];for(let t=1;t<h.length;t++)h[t]=(null!==(o=h[t])&&void 0!==o?o:"").replace(/\,/g,"@@");let u=nt.AtomSgroupData+":"+h.join(",");for(let n=0;n<r.length;n++)e.setAtomTransient(r[n],t.append(e.atomTransient(r[n]),u))}static hasAnySgroupData(t){for(let e=1;e<=t.numAtoms;e++)if(t.atomTransient(e).some((t=>t.startsWith(nt.AtomSgroupData+":"))))return!0;return!1}static noteAllSgroupData(t){let e={};for(let n=1;n<=t.numAtoms;n++)for(let i of t.atomTransient(n))if(i.startsWith(nt.AtomSgroupData+":")){let t=i.substring(nt.AtomSgroupData.length+1).split(",");if(t.length<5)continue;let s=parseInt(t[0]);for(let e=1;e<5;e++)t[e]=t[e].replace(/\@\@/g,",");if(!(s>0))continue;let l=e[s];l?l.atoms.push(n):e[s]={name:t[1],value:t[2],unit:t[3],query:t[4],atoms:[n]}}return Object.values(e)}}const lt="xPOLYMER:";var rt,ot,at;!function(t){t.HeadToTail="ht",t.HeadToHead="hh",t.Random="rnd"}(rt||(rt={}));class ht{constructor(t){this.atoms=t,this.connect=null,this.bondConn=null,this.atomName=new Map,this.bondIncl=new Map,this.bondExcl=new Map}clone(){let t=new ht(this.atoms.slice(0));t.connect=this.connect,this.bondConn&&(t.bondConn=this.bondConn.slice(0));for(let[e,n]of this.atomName.entries())t.atomName.set(e,n.slice(0));for(let[e,n]of this.bondIncl.entries())t.bondIncl.set(e,n.slice(0));for(let[e,n]of this.bondExcl.entries())t.bondExcl.set(e,n.slice(0));return t}}class ut{constructor(e){this.mol=e,this.units=new Map;let n=new Map;for(let t=1;t<=e.numAtoms;t++){let i=e.atomExtra(t);for(let e of i)if(e.startsWith(lt)){let i=e.substring(9).split(":"),s=parseInt(i[0]);if(s>0){let e=n.get(s);e?e.push(t):e=[t],n.set(s,e)}}}for(let e of t.sorted(Array.from(n.keys())))this.appendBlock(e,n.get(e))}getIDList(){return t.sorted(Array.from(this.units.keys()))}getUnit(t){return this.units.get(t)}getUnits(){return Array.from(this.units.values())}rewriteMolecule(){this.purgeExtraFields();for(let e of t.sorted(Array.from(this.units.keys())))this.writeUnit(e,this.units.get(e))}harmoniseNumbering(t){let e=t.getIDList();for(let t of this.getIDList())if(e.includes(t)){let n=this.units.get(t);this.units.delete(t),t=this.nextIdentifier(e),this.units.set(t,n),e.push(t)}}removeUnit(e){let n=this.units.get(e);if(null==n)return;this.units.delete(e);let i=lt+e+":";for(let e of n.atoms){let n=this.mol.atomExtra(e);for(let e=n.length-1;e>=0;e--)n[e].startsWith(i)&&(n=t.remove(n,e));this.mol.setAtomExtra(e,n)}for(let e=1;e<=this.mol.numBonds;e++){let n=this.mol.bondExtra(e);if(!t.isBlank(n)){for(let e=n.length-1;e>=0;e--)n[e].startsWith(i)&&(n=t.remove(n,e));this.mol.setBondExtra(e,n)}}}removeAll(){this.units.clear(),this.purgeExtraFields()}createUnit(t){let e=this.nextIdentifier();return this.units.set(e,t.clone()),this.writeUnit(e,t),e}static hasPolymerExtensions(t){for(let e=1;e<=t.numAtoms;e++){let n=t.atomExtra(e);if(null!=n)for(let t of n)if(t.startsWith(lt))return!0}return!1}static getPolymerExtensions(e,n){let i=e.atomExtra(n),s=null;if(null==i)return null;for(let e of i)e.startsWith(lt)&&(s=t.append(s,e));return s}static removePolymerExtensions(e,n){let i=e.atomExtra(n);if(null==i)return;let s=!1;for(let e=i.length-1;e>=0;e--)i[e].startsWith(lt)&&(i=t.remove(i,e),s=!0);s&&e.setAtomExtra(n,i)}appendBlock(e,n){const{mol:i}=this;let s=0,l=new ht(n);for(let t of n)for(let r of i.atomExtra(t))if(r.startsWith(lt)){let o=r.substring(9).split(":");if(o.length<2||parseInt(o[0])!=e)continue;s=parseInt(o[1]);for(let e=2;e<o.length;e++)if(o[e]==rt.HeadToTail)l.connect=rt.HeadToTail;else if(o[e]==rt.HeadToHead)l.connect=rt.HeadToHead;else if(o[e]==rt.Random)l.connect=rt.Random;else if(o[e].startsWith("n")){let s=!1;for(let e of i.atomAdjList(t))if(!n.includes(e)){s=!0;break}if(s){let n=o[e].substring(1).split(",");l.atomName.set(t,n.map((t=>parseInt(t))))}}}if(s<0)return;for(let t=1;t<=i.numBonds;t++){let e=n.indexOf(i.bondFrom(t))>=0,l=n.indexOf(i.bondTo(t))>=0;(e&&!l||!e&&l)&&s--}if(0!=s)return;let r=null,o=null;for(let n=1;n<=i.numBonds;n++)for(let s of i.bondExtra(n))if(s.startsWith(lt)){let i=s.substring(9).split(":");if(i.length<2||parseInt(i[0])!=e)continue;for(let e=1;e<i.length;e++)if(i[e].startsWith("i")){let t=i[e].substring(1).split(",");l.bondIncl.set(n,t.map((t=>parseInt(t))))}else if(i[e].startsWith("e")){let t=i[e].substring(1).split(",");l.bondExcl.set(n,t.map((t=>parseInt(t))))}else{let s=parseInt(i[e]);s>0&&(r=t.append(r,n),o=t.append(o,s))}}if(null!=r){if(r.length%2==1)return;l.bondConn=t.idxGet(r,t.idxSort(o))}this.units.set(e,l)}formatBlockAtom(e,n,i){let s=0;for(let t=1;t<=this.mol.numBonds;t++){let e=n.atoms.indexOf(this.mol.bondFrom(t))>=0,i=n.atoms.indexOf(this.mol.bondTo(t))>=0;(e&&!i||!e&&i)&&s++}let l=lt+e+":"+s;null!=n.connect&&(l+=":"+n.connect);let r=n.atomName.get(i);return t.notBlank(r)&&(l+=":n"+r.join(",")),l}formatBlockBond(e,n,i){let s=n.atoms.includes(this.mol.bondFrom(i)),l=n.atoms.includes(this.mol.bondTo(i));if(!(s&&!l||l&&!s))return null;let r=n.bondConn?n.bondConn.indexOf(i):-1,o=n.bondIncl.get(i),a=n.bondExcl.get(i);if(r<0&&t.isBlank(o)&&t.isBlank(a))return null;let h=lt+e;return r>=0&&(h+=":"+(r+1)),t.notBlank(o)&&(h+=":i"+o.join(",")),t.notBlank(a)&&(h+=":e"+a.join(",")),h}purgeExtraFields(){for(let e=1;e<=this.mol.numAtoms;e++){let n=this.mol.atomExtra(e),i=!1;for(let e=n.length-1;e>=0;e--)n[e].startsWith(lt)&&(n=t.remove(n,e),i=!0);i&&this.mol.setAtomExtra(e,n)}for(let e=1;e<=this.mol.numBonds;e++){let n=this.mol.bondExtra(e),i=!1;for(let e=n.length-1;e>=0;e--)n[e].startsWith(lt)&&(n=t.remove(n,e),i=!0);i&&this.mol.setBondExtra(e,n)}}writeUnit(e,n){const{mol:i}=this;for(let s of n.atoms){let l=this.formatBlockAtom(e,n,s);i.setAtomExtra(s,t.append(i.atomExtra(s),l))}for(let s=1;s<=i.numBonds;s++){let l=this.formatBlockBond(e,n,s);l&&i.setBondExtra(s,t.append(i.bondExtra(s),l))}}nextIdentifier(t){if(t||(t=this.getIDList()),0==t.length)return 1;for(let e=0;e<t.length-1;e++)if(t[e+1]!=t[e]+1)return t[e]+1;return t[t.length-1]+1}}!function(t){t.Charges="qC:",t.Aromatic="qA:",t.Unsaturated="qU:",t.Elements="qE:",t.ElementsNot="qE!",t.RingSizes="qR:",t.RingSizesNot="qR!",t.RingBlock="qB:",t.NumRings="qN:",t.RingBonds="qG:",t.Adjacency="qJ:",t.BondSums="qO:",t.Valences="qV:",t.Hydrogens="qH:",t.Isotopes="qI:",t.SubFrags="qX:",t.SubFragsNot="qX!"}(ot||(ot={})),function(t){t.RingSizes="qR:",t.RingSizesNot="qR!",t.RingBlock="qB:",t.NumRings="qN:",t.Orders="qO:"}(at||(at={}));class mt{static hasAnyQueryAtom(t,e){let n=t.atomExtra(e);for(let t=n.length-1;t>=0;t--)if(n[t].startsWith("q"))return!0;return!1}static hasAnyQueryBond(t,e){let n=t.bondExtra(e);for(let t=n.length-1;t>=0;t--)if(n[t].startsWith("q"))return!0;return!1}static hasQueryAtom(t,e,n){let i=t.atomExtra(e);for(let t=i.length-1;t>=0;t--)if(i[t].startsWith(n))return!0;return!1}static hasQueryBond(t,e,n){let i=t.bondExtra(e);for(let t=i.length-1;t>=0;t--)if(i[t].startsWith(n))return!0;return!1}static deleteQueryAtom(t,e,n){let i=t.atomExtra(e),s=!1;for(let t=i.length-1;t>=0;t--)i[t].startsWith(n)&&(i.splice(t,1),s=!0);s&&t.setAtomExtra(e,i)}static deleteQueryBond(t,e,n){let i=t.bondExtra(e),s=!1;for(let t=i.length-1;t>=0;t--)i[t].startsWith(n)&&(i.splice(t,1),s=!0);s&&t.setBondExtra(e,i)}static deleteQueryAtomAll(t,e){t.setAtomExtra(e,t.atomExtra(e).filter((t=>!t.startsWith("q"))))}static deleteQueryBondAll(t,e){t.setBondExtra(e,t.bondExtra(e).filter((t=>!t.startsWith("q"))))}static queryAtomString(t,e,n){let i=t.atomExtra(e);for(let t=i.length-1;t>=0;t--)if(i[t].startsWith(n))return i[t].substring(n.length);return null}static queryAtomStringList(e,n,i){let s=e.atomExtra(n),l=null;if(null!=s)for(let e of s)e.startsWith(i)&&(l=t.append(l,e.substring(i.length)));return l}static queryBondString(t,e,n){let i=t.bondExtra(e);for(let t=i.length-1;t>=0;t--)if(i[t].startsWith(n))return i[t].substring(n.length);return null}static setQueryAtom(t,e,n,i){if(!i)return void this.deleteQueryAtom(t,e,n);let s=n+i,l=t.atomExtra(e);for(let t=l.length-1;t>=0;t--)l[t].startsWith(n)&&(null!=s?(l[t]=s,s=null):l.splice(t,1));null!=s&&l.push(s),t.setAtomExtra(e,l)}static setQueryAtomList(e,n,i,s){if(t.isBlank(s))return void this.deleteQueryAtom(e,n,i);let l=e.atomExtra(n);for(let t=l.length-1;t>=0;t--)l[t].startsWith(i)&&l.splice(t,1);for(let t of s)l.push(i+t);e.setAtomExtra(n,l)}static setQueryBond(t,e,n,i){if(!i)return void this.deleteQueryBond(t,e,n);let s=n+i,l=t.bondExtra(e);for(let t=l.length-1;t>=0;t--)l[t].startsWith(n)&&(null!=s?(l[t]=s,s=null):l.splice(t,1));null!=s&&l.push(s),t.setBondExtra(e,l)}static queryAtomCharges(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.Charges))}static queryAtomAromatic(t,e){return this.parseBoolean(this.queryAtomString(t,e,ot.Aromatic))}static queryAtomUnsaturated(t,e){return this.parseBoolean(this.queryAtomString(t,e,ot.Unsaturated))}static queryAtomElements(t,e){return this.parseStrings(this.queryAtomString(t,e,ot.Elements))}static queryAtomElementsNot(t,e){return this.parseStrings(this.queryAtomString(t,e,ot.ElementsNot))}static queryAtomRingSizes(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.RingSizes))}static queryAtomRingSizesNot(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.RingSizesNot))}static queryAtomRingBlock(t,e){return this.parseBoolean(this.queryAtomString(t,e,ot.RingBlock))}static queryAtomNumRings(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.NumRings))}static queryAtomRingBonds(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.RingBonds))}static queryAtomAdjacency(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.Adjacency))}static queryAtomBondSums(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.BondSums))}static queryAtomValences(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.Valences))}static queryAtomHydrogens(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.Hydrogens))}static queryAtomIsotope(t,e){return this.parseIntegers(this.queryAtomString(t,e,ot.Isotopes))}static queryAtomSubFrags(t,e){return this.parseMolecules(this.queryAtomStringList(t,e,ot.SubFrags))}static queryAtomSubFragsNot(t,e){return this.parseMolecules(this.queryAtomStringList(t,e,ot.SubFragsNot))}static queryBondRingSizes(t,e){return this.parseIntegers(this.queryBondString(t,e,at.RingSizes))}static queryBondRingSizesNot(t,e){return this.parseIntegers(this.queryBondString(t,e,at.RingSizesNot))}static queryBondRingBlock(t,e){return this.parseBoolean(this.queryBondString(t,e,at.RingBlock))}static queryBondNumRings(t,e){return this.parseIntegers(this.queryBondString(t,e,at.NumRings))}static queryBondOrders(t,e){return this.parseIntegers(this.queryBondString(t,e,at.Orders))}static setQueryAtomCharges(t,e,n){this.setQueryAtom(t,e,ot.Charges,this.formatIntegers(n))}static setQueryAtomAromatic(t,e,n){this.setQueryAtom(t,e,ot.Aromatic,this.formatBoolean(n))}static setQueryAtomUnsaturated(t,e,n){this.setQueryAtom(t,e,ot.Unsaturated,this.formatBoolean(n))}static setQueryAtomElements(t,e,n){this.setQueryAtom(t,e,ot.Elements,this.formatStrings(n))}static setQueryAtomElementsNot(t,e,n){this.setQueryAtom(t,e,ot.ElementsNot,this.formatStrings(n))}static setQueryAtomRingSizes(t,e,n){this.setQueryAtom(t,e,ot.RingSizes,this.formatIntegers(n))}static setQueryAtomRingSizesNot(t,e,n){this.setQueryAtom(t,e,ot.RingSizesNot,this.formatIntegers(n))}static setQueryAtomRingBlock(t,e,n){this.setQueryAtom(t,e,ot.RingBlock,this.formatBoolean(n))}static setQueryAtomNumRings(t,e,n){this.setQueryAtom(t,e,ot.NumRings,this.formatIntegers(n))}static setQueryAtomRingBonds(t,e,n){this.setQueryAtom(t,e,ot.RingBonds,this.formatIntegers(n))}static setQueryAtomAdjacency(t,e,n){this.setQueryAtom(t,e,ot.Adjacency,this.formatIntegers(n))}static setQueryAtomBondSums(t,e,n){this.setQueryAtom(t,e,ot.BondSums,this.formatIntegers(n))}static setQueryAtomValences(t,e,n){this.setQueryAtom(t,e,ot.Valences,this.formatIntegers(n))}static setQueryAtomHydrogens(t,e,n){this.setQueryAtom(t,e,ot.Hydrogens,this.formatIntegers(n))}static setQueryAtomIsotope(t,e,n){this.setQueryAtom(t,e,ot.Isotopes,this.formatIntegers(n))}static setQueryAtomSubFrags(t,e,n){this.setQueryAtomList(t,e,ot.SubFrags,this.formatMolecules(n))}static setQueryAtomSubFragsNot(t,e,n){this.setQueryAtomList(t,e,ot.SubFragsNot,this.formatMolecules(n))}static setQueryBondRingSizes(t,e,n){this.setQueryBond(t,e,at.RingSizes,this.formatIntegers(n))}static setQueryBondRingSizesNot(t,e,n){this.setQueryBond(t,e,at.RingSizesNot,this.formatIntegers(n))}static setQueryBondRingBlock(t,e,n){this.setQueryBond(t,e,at.RingBlock,this.formatBoolean(n))}static setQueryBondNumRings(t,e,n){this.setQueryBond(t,e,at.NumRings,this.formatIntegers(n))}static setQueryBondOrders(t,e,n){this.setQueryBond(t,e,at.Orders,this.formatIntegers(n))}static parseIntegers(t){if(!t)return null;let e=t.split(","),n=new Array(e.length);for(let t=0;t<e.length;t++)n[t]=parseInt(e[t]);return n}static parseStrings(t){return t?t.split(","):null}static parseBoolean(t){return t?"yes"==t:null}static parseMolecules(t){if(!t)return null;let e=[];for(let n of t){let t=qt.fromString(n);Dt.notBlank(t)&&e.push(t)}return e}static formatIntegers(e){if(t.isBlank(e))return null;let n="";for(let t=0;t<e.length;t++)t>0&&(n+=","),n+=e[t];return n}static formatStrings(e){if(t.isBlank(e))return null;let n="";for(let t=0;t<e.length;t++)t>0&&(n+=","),n+=e[t];return n}static formatBoolean(t){return t?"yes":"no"}static formatMolecules(e){if(t.isBlank(e))return null;let n=[];for(let t of e)Dt.notBlank(t)&&n.push(t.toString());return n}}const ct="xCHIRAC:",dt="xCHIREL:";class ft{static hasStereoGroups(t){for(let e=1;e<=t.numAtoms;e++){let n=t.atomExtra(e);if(null!=n)for(let t of n)if(t.startsWith(ct)||t.startsWith(dt))return!0}return!1}constructor(e){this.mol=e,this.chiRac=new Map,this.chiRel=new Map,this.mol=e;for(let n=1;n<=e.numAtoms;n++){let i=e.atomExtra(n);if(null!=i)for(let e of i)if(e.startsWith(ct)){let i=parseInt(e.substring(8));i>0&&this.chiRac.set(i,t.append(this.chiRac.get(i),n))}else if(e.startsWith(dt)){let i=parseInt(e.substring(8));i>0&&this.chiRel.set(i,t.append(this.chiRel.get(i),n))}}for(let[t,e]of this.chiRac.entries()){for(let t=e.length-1;t>=0;t--)this.atomHasWedge(e[t])||e.splice(t,1);e.length>0?this.chiRac.set(t,e):this.chiRac.delete(t)}for(let[t,e]of this.chiRel.entries()){for(let t=e.length-1;t>=0;t--)this.atomHasWedge(e[t])||e.splice(t,1);e.length>0?this.chiRel.set(t,e):this.chiRel.delete(t)}}getRacemicGroups(){return Array.from(this.chiRac.keys())}getRelativeGroups(){return Array.from(this.chiRel.keys())}getRacemicAtoms(){return Array.from(this.chiRac.values())}getRelativeAtoms(){return Array.from(this.chiRel.values())}getRacemicGroupAtoms(t){return this.chiRac.get(t)}getRelativeGroupAtoms(t){return this.chiRel.get(t)}rewriteMolecule(){for(let t=1;t<=this.mol.numAtoms;t++){let e=this.mol.atomExtra(t),n=!1;for(let t=e.length-1;t>=0;t--)(e[t].startsWith(ct)||e[t].startsWith(dt))&&(e.splice(t,1),n=!0);n&&this.mol.setAtomExtra(t,e)}for(let[t,e]of this.chiRac.entries())for(let n of e)this.mol.setAtomExtra(n,[...this.mol.atomExtra(n),ct+t]);for(let[t,e]of this.chiRel.entries())for(let n of e)this.mol.setAtomExtra(n,[...this.mol.atomExtra(n),dt+t])}harmoniseNumbering(t){let e=t.getRacemicGroups(),n=this.getRacemicAtoms();this.chiRac.clear();for(let t of n){let n=this.nextIdentifier(e);this.chiRac.set(n,t),e.push(n)}e=t.getRelativeGroups(),n=this.getRelativeAtoms(),this.chiRel.clear();for(let t of n){let n=this.nextIdentifier(e);this.chiRel.set(n,t),e.push(n)}}createRacemic(t){let e=this.nextIdentifier(this.getRacemicGroups());return this.chiRac.set(e,t),e}createRelative(t){let e=this.nextIdentifier(this.getRelativeGroups());return this.chiRel.set(e,t),e}removeRacemic(t){this.chiRac.delete(t)}removeRelative(t){this.chiRel.delete(t)}static removeAll(t){for(let e=1;e<=t.numAtoms;e++){let n=t.atomExtra(e),i=!1;for(let t=n.length-1;t>=0;t--)(n[t].startsWith(ct)||n[t].startsWith(dt))&&(n.splice(t,1),i=!0);i&&t.setAtomExtra(e,n)}}atomHasWedge(t){if(this.mol.is3D())return!0;let e=!1;for(let n of this.mol.atomAdjBonds(t)){let i=this.mol.bondType(n);if(i==qt.BONDTYPE_UNKNOWN)return!1;this.mol.bondFrom(n)==t&&(i!=qt.BONDTYPE_INCLINED&&i!=qt.BONDTYPE_DECLINED||(e=!0))}return e}nextIdentifier(e){if(0==e.length)return 1;let n=t.sorted(e);for(let t=0;t<n.length-1;t++)if(n[t+1]!=n[t]+1)return n[t]+1;return n[n.length-1]+1}}const pt={H:[1],B:[3],C:[4],Si:[4],N:[3],P:[3,5],As:[3,5],O:[2],S:[2,4,6],Se:[2,4,6],Te:[2,4,6],F:[1],Cl:[1,3,5,7],Br:[1],I:[1,3,5,7],At:[1,3,5,7]};class Ct{constructor(t){this.parseHeader=!0,this.parseExtended=!0,this.allowV3000=!0,this.considerRescale=!0,this.keepAromatic=!1,this.keepParity=!1,this.keepQuery=!0,this.mol=null,this.molName="",this.overallStereoAbsolute=!0,this.resBonds=null,this.groupAttachAny=new Map,this.groupAttachAll=new Map,this.groupStereoAbsolute=[],this.groupStereoRacemic=[],this.groupStereoRelative=[],this.groupLinkNodes=[],this.groupMixtures=[],this.scsrTemplates=null,this.pos=0,this.lines=t.split(/\r?\n/)}parse(){return this.parseHeader&&(this.molName=this.lines[0],this.pos=3),this.parseCTAB(),this.mol}nextLine(){if(this.pos>=this.lines.length)throw"MDL Molfile parser: premature end, at line "+(this.pos+1);return this.lines[this.pos++]}parseCTAB(){this.mol=new qt,this.mol.keepTransient=!0;let e=this.nextLine(),n=e.length>=39?e.substring(34,39):"";if(this.allowV3000&&"V3000"==n)return this.parseV3000(),void(this.mol.keepTransient=!1);if("V2000"!=n)throw"Invalid MDL MOL: no Vx000 tag.";let i=parseInt(e.substring(0,3).trim()),s=parseInt(e.substring(3,6).trim());e.length>=15&&(this.overallStereoAbsolute=1==parseInt(e.substring(12,15).trim()));for(let n=0;n<i;n++){if(e=this.nextLine(),e.length<34)throw"Invalid MDL MOL: atom line"+(n+1);let i=parseFloat(e.substring(0,10).trim()),s=parseFloat(e.substring(10,20).trim()),l=parseFloat(e.substring(20,30).trim()),r=e.substring(31,34).trim(),o=e.length<39?0:parseInt(e.substring(36,39).trim()),a=0,h=e.length<42?0:parseInt(e.substring(39,42).trim()),u=e.length<45?0:parseInt(e.substring(42,45).trim()),m=e.length<51?0:parseInt(e.substring(48,51).trim()),c=e.length<63?0:parseInt(e.substring(60,63).trim());o>=1&&o<=3?o=4-o:4==o?(o=0,a=2):o=o>=5&&o<=7?4-o:0;let d=this.mol.addAtom(r,i,s,o,a);if(0!=l&&(this.mol.setAtomZ(d,l),this.mol.setIs3D(!0)),this.mol.setAtomMapNum(d,c),u>0&&mt.setQueryAtomHydrogens(this.mol,d,[u-1]),h>0&&this.keepParity){let e=this.mol.atomTransient(d);1==h?this.mol.setAtomTransient(d,t.append(e,nt.AtomChiralMDLOdd)):2==h?this.mol.setAtomTransient(d,t.append(e,nt.AtomChiralMDLEven)):3==h&&this.mol.setAtomTransient(d,t.append(e,nt.AtomChiralMDLRacemic))}0!=m&&st.markExplicitValence(this.mol,n+1,m>14?0:m)}for(let n=0;n<s;n++){if(e=this.nextLine(),e.length>=9&&e.length<12&&(e=e.substring(0,9)+"  0"),e.length<12)throw"Invalid MDL MOL: bond line"+(n+1);let l=parseInt(e.substring(0,3).trim()),r=parseInt(e.substring(3,6).trim()),o=parseInt(e.substring(6,9).trim()),a=parseInt(e.substring(9,12).trim());if(l==r||l<1||l>i||r<1||r>i)throw"Invalid MDL MOL: bond line"+(n+1);let h=o>=1&&o<=3?o:8==o||9==o||10==o?0:1,u=qt.BONDTYPE_NORMAL;1==a?u=qt.BONDTYPE_INCLINED:6==a?u=qt.BONDTYPE_DECLINED:3!=a&&4!=a||(u=qt.BONDTYPE_UNKNOWN);let m=this.mol.addBond(l,r,h,u);9==o&&this.mol.appendBondTransient(m,nt.BondZeroDative),9==o&&this.mol.appendBondTransient(m,nt.BondZeroHydrogen),this.keepQuery?4==o?mt.setQueryBondOrders(this.mol,m,[-1]):5==o?mt.setQueryBondOrders(this.mol,m,[1,2]):6==o?mt.setQueryBondOrders(this.mol,m,[-1,1]):7==o?mt.setQueryBondOrders(this.mol,m,[-1,2]):8==o&&mt.setQueryBondOrders(this.mol,m,[-1,0,1,2,3]):4==o&&(this.keepAromatic?this.mol.setBondTransient(m,t.append(this.mol.bondTransient(m),nt.BondAromatic)):(null==this.resBonds&&(this.resBonds=t.booleanArray(!1,s)),this.resBonds[n]=!0))}let l=new Map,r=new Map,o=new Map,a=new Map,h=new Map;for(;e=this.nextLine(),!e.startsWith("M  END");){let n=0;if(e.startsWith("M  CHG"))n=1;else if(e.startsWith("M  RAD"))n=2;else if(e.startsWith("M  ISO"))n=3;else if(e.startsWith("M  RGP"))n=4;else if(this.parseExtended&&e.startsWith("M  HYD"))n=5;else if(this.parseExtended&&e.startsWith("M  ZCH"))n=6;else if(this.parseExtended&&e.startsWith("M  ZBO"))n=7;else if(this.parseExtended&&e.startsWith("M  ZPA"))n=8;else if(this.parseExtended&&e.startsWith("M  ZRI"))n=9;else if(this.parseExtended&&e.startsWith("M  ZAR"))n=10;else if(this.parseExtended&&e.startsWith("M  RBC"))n=11;else if(this.parseExtended&&e.startsWith("M  SUB"))n=12;else if(this.parseExtended&&e.startsWith("M  UNS"))n=13;else if(e.startsWith("A  ")&&e.length>=6){let t=parseInt(e.substring(3,6).trim());if(t>=1&&t<=this.mol.numAtoms){if(e=this.nextLine(),null==e)break;this.mol.setAtomElement(t,e);continue}}else if(e.startsWith("M  STY")){let t=parseInt(e.substring(6,9).trim());for(let n=0;n<t;n++){let t=parseInt(e.substring(9+8*n,13+8*n).trim()),i=e.substring(14+8*n,17+8*n);"SUP"==i?a.set(t,{atoms:[],name:null}):"MIX"==i||"FOR"==i?h.set(t,{index:t,parent:0,atoms:[],type:i}):"SRU"!=i&&"COP"!=i&&"MUL"!=i&&"DAT"!=i||a.set(t,{atoms:[],name:null,bracketType:i})}}else if(e.startsWith("M  SPL")){let t=parseInt(e.substring(6,9).trim());for(let n=0;n<t;n++){let t=parseInt(e.substring(9+8*n,13+8*n).trim()),i=parseInt(e.substring(13+8*n,17+8*n).trim()),s=h.get(t);null!=s&&(s.parent=i)}}else if(e.startsWith("M  SAL")){let n=parseInt(e.substring(6,10).trim()),i=a.get(n);if(null!=i){let n=parseInt(e.substring(10,13).trim()),s=t.numberArray(0,n);for(let t=0;t<n;t++)s[t]=parseInt(e.substring(13+4*t,17+4*t).trim());i.atoms=t.concat(i.atoms,s)}let s=h.get(n);if(null!=s){let n=parseInt(e.substring(10,13).trim()),i=t.numberArray(0,n);for(let t=0;t<n;t++)i[t]=parseInt(e.substring(13+4*t,17+4*t).trim());s.atoms=t.concat(s.atoms,i)}}else if(e.startsWith("M  SBL")){let n=parseInt(e.substring(6,10).trim()),i=a.get(n);if(null!=i){let n=parseInt(e.substring(10,13).trim()),s=t.numberArray(0,n);for(let t=0;t<n;t++)s[t]=parseInt(e.substring(13+4*t,17+4*t).trim());i.bonds=t.concat(i.bonds,s)}}else if(e.startsWith("M  SMT")){let t=parseInt(e.substring(6,10).trim()),n=a.get(t);null!=n&&(n.name=e.substring(11).trim())}else if(e.startsWith("M  SDT")){let t=parseInt(e.substring(6,10).trim()),n=a.get(t);n&&(n.name=e.substring(11,41).trim(),n.unit=e.substring(43,63).trim(),n.query=e.substring(63).trim())}else if(e.startsWith("M  SED")){let t=parseInt(e.substring(6,10).trim()),n=a.get(t);n&&(n.value=e.substring(11).trim())}else if(e.startsWith("M  SCN")){let t=parseInt(e.substring(6,9).trim());for(let n=0;n<t;n++){let t=parseInt(e.substring(9+8*n,13+8*n).trim()),i=e.substring(14+8*n,17+8*n),s=a.get(t);null!=s&&(s.connectType=i.trim())}}else if(e.startsWith("M  CRS")){let n=parseInt(e.substring(6,10).trim()),i=a.get(n);if(null!=i){let n=parseInt(e.substring(10,13).trim());i.bondConn=t.numberArray(0,n);for(let t=0;t<n;t++)i.bondConn[t]=parseInt(e.substring(13+4*t,17+4*t).trim())}}else if(e.startsWith("M  LIN")){let t=parseInt(e.substring(6,9).trim());for(let n=0;n<t;n++){let t={atom:parseInt(e.substring(9+8*n,13+8*n).trim()),nbrs:[],minRep:1,maxRep:parseInt(e.substring(13+8*n,17+8*n).trim())},i=parseInt(e.substring(17+8*n,21+8*n).trim()),s=parseInt(e.substring(21+8*n,25+8*n).trim());i>0&&t.nbrs.push(i),s>0&&t.nbrs.push(s),this.groupLinkNodes.push(t)}}else if(e.startsWith("M  ALS")){let t=parseInt(e.substring(7,10).trim()),n=parseInt(e.substring(10,13).trim()),i=e.charAt(14),s=[];for(let t=0;t<n;t++)s.push(e.substring(16+4*t,20+4*t).trim());this.mol.setAtomElement(t,"*"),"F"==i?mt.setQueryAtomElements(this.mol,t,s):"T"==i&&mt.setQueryAtomElementsNot(this.mol,t,s)}if(8==n||9==n||10==n){let t=parseInt(e.substring(6,9).trim()),s=parseInt(e.substring(9,13).trim()),a=8==n?l:9==n?r:o;for(let n=0;n<t;n++){let t=parseInt(e.substring(13+4*n,17+4*n).trim());if(t<1||t>i)throw"Invalid MDL MOL: M-block";let l=a.get(s);l||a.set(s,l=[]),l.push(t)}}else if(n>0){let t=parseInt(e.substring(6,9).trim());for(let i=0;i<t;i++){let t=parseInt(e.substring(9+8*i,13+8*i).trim()),s=parseInt(e.substring(13+8*i,17+8*i).trim());if(t<1)throw"Invalid MDL MOL: M-block";1==n?this.mol.setAtomCharge(t,s):2==n?1==s||3==s?this.mol.setAtomUnpaired(t,2):2==s&&this.mol.setAtomUnpaired(t,1):3==n?this.mol.setAtomIsotope(t,s):4==n?this.mol.setAtomElement(t,"R"+s):5==n?this.mol.setAtomHExplicit(t,s):6==n?this.mol.setAtomCharge(t,s):7==n?this.mol.setBondOrder(t,s):11==n&&0!=s?(-2==s?s=this.countRingBonds(t):-1==s&&(s=0),mt.setQueryAtomRingBonds(this.mol,t,[s])):12==n&&0!=s?(-2==s?s=this.countSubstitutions(t):-1==s&&(s=0),mt.setQueryAtomAdjacency(this.mol,t,[s])):13==n&&1==s&&mt.setQueryAtomUnsaturated(this.mol,t,!0)}}}if(this.postFix(),this.parseExtended){let t=new tt(this.mol);for(let e of l.values())t.createPath(e);for(let e of r.values())t.createRing(e);for(let e of o.values())t.createArene(e);t.rewriteMolecule()}for(let e of t.sorted(Array.from(a.keys()))){let t=a.get(e);t.bracketType&&(a.delete(e),this.applyPolymerBlock(t))}for(let e of t.sorted(Array.from(a.keys()))){let t=a.get(e);a.delete(e),this.applySuperAtom(t,Array.from(a.values()))}for(let e of t.sorted(Array.from(h.keys())))this.groupMixtures.push(h.get(e));this.mol.keepTransient=!1}postFix(){const e=this.mol;for(let t=1;t<=e.numAtoms;t++){if(Dt.hasAbbrev(e,t)||e.atomTransient(t).some((t=>t.startsWith(nt.AtomSCSRClass))))continue;let n=e.atomElement(t);"D"==n?(e.setAtomElement(t,"H"),e.setAtomIsotope(t,2)):"T"==n&&(e.setAtomElement(t,"H"),e.setAtomIsotope(t,3)),e.is3D&&void 0===e.atomZ(t)&&e.setAtomZ(t,0);let i=st.noteExplicitValence(this.mol,t),s=pt[n];if(null!=i){let n=i<0||i>14?0:i;for(let i of e.atomAdjBonds(t))n-=e.bondOrder(i);n!=e.atomHydrogens(t)&&e.setAtomHExplicit(t,Math.max(0,n))}else if(s){let i=e.atomCharge(t),l="C"==n||"H"==n?Math.abs(i):"B"==n?-Math.abs(i):-i,r=e.atomUnpaired(t);r>0&&("C"==n||"O"==n||"S"==n||"N"==n||"P"==n)&&(l+=r);for(let n of e.atomAdjBonds(t))l+=e.bondOrder(n);for(let n of s)if(l<=n){let i=n-l;i!=e.atomHydrogens(t)&&e.setAtomHExplicit(t,Math.max(0,i));break}}}if(this.considerRescale&&t.isBlank(this.scsrTemplates)&&St.normaliseBondDistances(e),null!=this.resBonds){let t=new K(e,this.resBonds,null);try{t.perform();for(let n=0;n<e.numBonds;n++)e.setBondOrder(n+1,t.bondOrders[n])}catch(t){}}}parseV3000(){var e;let n;!function(t){t[t.Atom=0]="Atom",t[t.Bond=1]="Bond",t[t.Coll=2]="Coll",t[t.SGroup=3]="SGroup",t[t.Template=4]="Template"}(n||(n={}));let i=!1,s=!1,l=null,r=null,o=[],a=[],h=[],u=[],m=[],c=[],d=[];const f="Invalid MDL MOL V3000: ";for(;;){let e=this.nextLine();if("M  END"==e)break;if(!e.startsWith("M  V30 "))continue;let m=e.substring(7);if(m.startsWith("BEGIN TEMPLATE"))s=!0;else if(m.startsWith("END TEMPLATE"))s=!1;else if(m.startsWith("TEMPLATE ")&&s)d.push([e]);else if(s&&null!=d)t.last(d).push(e);else if(m.startsWith("COUNTS "))r=m.substring(7);else if(m.startsWith("BEGIN CTAB"))i=!0;else if(m.startsWith("BEGIN ATOM"))l=n.Atom;else if(m.startsWith("BEGIN BOND"))l=n.Bond;else if(m.startsWith("BEGIN COLLECTION"))l=n.Coll;else if(m.startsWith("BEGIN SGROUP"))l=n.SGroup;else if(m.startsWith("END "))l=null;else if(i&&l==n.Atom)o.push(m);else if(i&&l==n.Bond)a.push(m);else if(i&&l==n.Coll)h.push(m);else if(i&&l==n.SGroup)u.push(m);else if(i&&null==l&&m.startsWith("LINKNODE ")){let e=this.splitWithQuotes(m.substring(9)),n={atom:0,nbrs:[],minRep:parseInt(e[0]),maxRep:parseInt(e[1])},i=parseInt(e[2]),s=[];for(let t=0;t<2*i;t++)s.push(parseInt(e[3+t]));t.sort(s);for(let t=0;t<s.length;t++)t<s.length-1&&s[t]==s[t+1]?n.atom=s[t++]:n.nbrs.push(s[t]);this.groupLinkNodes.push(n)}}let p=r.trim().split(/\s+/);if(p.length<2)throw f+"counts line malformatted";let C=parseInt(p[0]),g=parseInt(p[1]);if(C<0||C>o.length)throw f+"unreasonable atom count: "+C;if(g<0||g>a.length)throw f+"unreasonable bond count: "+g;let A=[],b=[];for(let t=0;t<o.length;t++){let e=o[t];for(;t<o.length-1&&e.endsWith("-");)t++,e=e.substring(0,e.length-1)+o[t];let n=this.splitWithQuotes(e);if(n.length<6)throw f+"atom line has too few components: "+e;let i=parseInt(n[0],0);if(i<1||i>C)throw f+"invalid atom index: "+n[0];if(null!=A[i-1])throw f+"duplicate atom index: "+i;A[i-1]=n}for(let t=0;t<a.length;t++){let e=a[t];for(;t<a.length-1&&e.endsWith("-");)t++,e=e.substring(0,e.length-1)+a[t];let n=this.splitWithQuotes(e);if(n.length<4)throw f+"bond line has too few components: "+e;let i=parseInt(n[0],0);if(i<1||i>g)throw f+"invalid bond index: "+n[0];if(null!=b[i-1])throw f+"duplicate bond index: "+i;b[i-1]=n}for(let t=1;t<=C;t++){let e=A[t-1];if(null==e)throw f+"atom definition missing for #"+t;let n=e[1];n.length>2&&n.startsWith('"')&&n.endsWith('"')&&(n=n.substring(1,n.length-1));let i=parseFloat(e[2]),s=parseFloat(e[3]),l=parseFloat(e[4]),r=parseInt(e[5]);this.mol.addAtom(n,i,s),0!=l&&(this.mol.setAtomZ(t,l),this.mol.setIs3D(!0)),this.mol.setAtomMapNum(t,r),this.parseQueryAtomList(this.mol,t);for(let n=6;n<e.length;n++){let i=e[n].indexOf("=");if(i<0)continue;let s=e[n].substring(0,i),l=e[n].substring(i+1);if("CHG"==s)this.mol.setAtomCharge(t,parseInt(l));else if("RAD"==s){let e=parseInt(l);1==e||3==e?this.mol.setAtomUnpaired(t,2):2==e&&this.mol.setAtomUnpaired(t,1)}else if("MASS"==s)this.mol.setAtomIsotope(t,parseInt(l));else if("CFG"==s)parseInt(l)>0&&this.keepParity;else if("VAL"==s)st.markExplicitValence(this.mol,t,parseInt(l));else if("CLASS"==s)this.mol.appendAtomTransient(t,nt.AtomSCSRClass+":"+l);else if("SEQID"==s)this.mol.appendAtomTransient(t,nt.AtomSCSRSeqID+":"+l);else if("ATTCHORD"==s){let e=this.unpackStrings(l);null!=e&&this.mol.appendAtomTransient(t,nt.AtomSCSRAttchOrd+":"+e.join(","))}else if("HCOUNT"==s){let e=parseInt(l);0!=e&&mt.setQueryAtomHydrogens(this.mol,t,[Math.max(e,0)])}else if("RBCNT"==s){let e=parseInt(l);-2==e?m.push(t):0!=e&&mt.setQueryAtomRingBonds(this.mol,t,[Math.max(e,0)])}else if("SUBST"==s){let e=parseInt(l);-2==e?c.push(t):0!=e&&mt.setQueryAtomAdjacency(this.mol,t,[Math.max(e,0)])}else"UNSAT"==s&&1==parseInt(l)&&mt.setQueryAtomUnsaturated(this.mol,t,!0)}}for(let e=1;e<=g;e++){let n=b[e-1];if(null==n)throw f+"bond definition missing for #"+e;let i=parseInt(n[1]),s=parseInt(n[2]),l=parseInt(n[3]),r=i>=1&&i<=3?i:9==i||10==i?0:1;this.mol.addBond(s,l,r),9==i&&this.mol.appendBondTransient(e,nt.BondZeroDative),10==i&&this.mol.appendBondTransient(e,nt.BondZeroHydrogen),this.keepQuery?4==i?mt.setQueryBondOrders(this.mol,e,[-1]):5==i?mt.setQueryBondOrders(this.mol,e,[1,2]):6==i?mt.setQueryBondOrders(this.mol,e,[-1,1]):7==i?mt.setQueryBondOrders(this.mol,e,[-1,2]):8==i&&mt.setQueryBondOrders(this.mol,e,[-1,0,1,2,3]):4==i&&(this.keepAromatic?this.mol.setBondTransient(e,t.append(this.mol.bondTransient(e),nt.BondAromatic)):(null==this.resBonds&&(this.resBonds=t.booleanArray(!1,g)),this.resBonds[e-1]=!0));let o=null,a=null;for(let t=4;t<n.length;t++){let i=n[t].indexOf("=");if(i<0)continue;let s=n[t].substring(0,i),l=n[t].substring(i+1);if("CFG"==s){let t=parseInt(l);this.mol.setBondType(e,1==t?qt.BONDTYPE_INCLINED:2==t?qt.BONDTYPE_UNKNOWN:3==t?qt.BONDTYPE_DECLINED:qt.BONDTYPE_NORMAL)}else"DISP"==s?"COORD"==l&&this.mol.setBondOrder(e,0):"ENDPTS"==s?o=this.unpackList(l):"ATTACH"==s&&(a=l)}null!=a&&null!=o&&("ALL"==a?this.groupAttachAll.set(e,o):"ANY"==a&&this.groupAttachAny.set(e,o))}for(let t of m)mt.setQueryAtomRingBonds(this.mol,t,[this.countRingBonds(t)]);for(let t of c)mt.setQueryAtomAdjacency(this.mol,t,[this.countSubstitutions(t)]);this.postFix();for(let t=0;t<h.length;t++){let e=h[t];for(;t<h.length-1&&e.endsWith("-");)t++,e=e.substring(0,e.length-1)+h[t];let n=this.splitWithQuotes(e);n[0].startsWith("MDLV30/STEABS")?n[1].startsWith("ATOMS=")&&(this.groupStereoAbsolute=this.unpackList(n[1].substring(5))):n[0].startsWith("MDLV30/STERAC")?n[1].startsWith("ATOMS=")&&this.groupStereoRacemic.push(this.unpackList(n[1].substring(6))):n[0].startsWith("MDLV30/STEREL")&&n[1].startsWith("ATOMS=")&&this.groupStereoRelative.push(this.unpackList(n[1].substring(6)))}let y=new ft(this.mol);for(let t of this.groupStereoRacemic)y.createRacemic(t);for(let t of this.groupStereoRelative)y.createRelative(t);y.rewriteMolecule();let E=new Map;for(let t=0;t<u.length;t++){let n=u[t];for(;t<u.length-1&&n.endsWith("-");)t++,n=n.substring(0,n.length-1)+u[t];let i=this.splitWithQuotes(n),s=parseInt(i[0]);if(i.length>3&&s>0&&"SUP"==i[1]){let t={atoms:[],name:null};for(let n=3;n<i.length;n++)if(i[n].startsWith("ATOMS="))t.atoms=this.unpackList(i[n].substring(6));else if(i[n].startsWith("LABEL="))t.name=this.withoutQuotes(i[n].substring(6));else if(i[n].startsWith("XBONDS="))t.bonds=this.unpackList(i[n].substring(7));else if(i[n].startsWith("CLASS="))t.templateClass=this.withoutQuotes(i[n].substring(6));else if(i[n].startsWith("NATREPLACE="))t.natReplace=this.withoutQuotes(i[n].substring(11));else if(i[n].startsWith("SAP=")){const s=this.unpackStrings(i[n].substring(4));t.attachPoints=[...null!==(e=t.attachPoints)&&void 0!==e?e:[],...s]}E.set(s,t)}else if(i.length>3&&s>0&&("MIX"==i[1]||"FOR"==i[1])&&parseInt(i[2])==s){let t={index:s,parent:0,atoms:null,type:i[1]};for(let e=3;e<i.length;e++)i[e].startsWith("ATOMS=")?t.atoms=this.unpackList(i[e].substring(6)):i[e].startsWith("PARENT=")&&(t.parent=parseInt(i[e].substring(7)));this.groupMixtures.push(t)}else if(i.length>3&&s>0&&("SRU"==i[1]||"COP"==i[1]||"MUL"==i[1]||"DAT"==i[1])){let t={atoms:[],name:null,bracketType:i[1]};for(let e=3;e<i.length;e++)i[e].startsWith("ATOMS=")?t.atoms=this.unpackList(i[e].substring(6)):i[e].startsWith("BONDS=")?t.bonds=this.unpackList(i[e].substring(6)):i[e].startsWith("LABEL=")?t.name=this.withoutQuotes(i[e].substring(6)):i[e].startsWith("CONNECT=")?t.connectType=i[e].substring(8):i[e].startsWith("XBCORR=")?t.bondConn=this.unpackList(i[e].substring(7)):i[e].startsWith("MULT=")?t.name=this.withoutQuotes(i[e].substring(5)):i[e].startsWith("FIELDNAME=")?t.name=this.withoutQuotes(i[e].substring(10)):i[e].startsWith("FIELDDATA=")&&(t.value=this.withoutQuotes(i[e].substring(10)));E.set(s,t)}}for(let e of t.sorted(Array.from(E.keys()))){let t=E.get(e);t.bracketType&&(E.delete(e),this.applyPolymerBlock(t))}for(let e of t.sorted(Array.from(E.keys()))){let t=E.get(e);E.delete(e),this.applySuperAtom(t,Array.from(E.values()))}d.length>0&&(this.scsrTemplates=d.map((t=>this.parseV3000Template(t))))}parseQueryAtomList(t,e){let n=t.atomElement(e),i=!1;if(n.startsWith("NOT ")&&(n=n.substring(4),i=!0),n.length<2||!n.startsWith("[")||!n.endsWith("]"))return;n=n.substring(1,n.length-1);let s=n.split(",");t.setAtomElement(e,"*"),i?mt.setQueryAtomElementsNot(t,e,s):mt.setQueryAtomElements(t,e,s)}applySuperAtom(e,n){if(null==e.name||t.isBlank(e.atoms))return;let i=t.booleanArray(!0,this.mol.numAtoms);for(let t of e.atoms)i[t-1]=!1;let s,l=e.name;for(;(s=l.indexOf("\\S"))>=0;)l=l.substring(0,s)+"{^"+l.substring(s+2);for(;(s=l.indexOf("\\s"))>=0;)l=l.substring(0,s)+"{"+l.substring(s+2);for(;(s=l.indexOf("\\n"))>=0;)l=l.substring(0,s)+"}"+l.substring(s+2);let[r,o]=e.templateClass?[null,null]:Dt.convertToAbbrevIndex(this.mol,i,l);if(null==r){let t={};return e.bonds&&(t.bonds=e.bonds.join(" ")),e.templateClass&&(t.templateClass=e.templateClass),e.natReplace&&(t.natReplace=e.natReplace),e.attachPoints&&(t.attachPoints=e.attachPoints.join(" ")),void st.markSgroupMultiAttach(this.mol,l,e.atoms,t)}this.mol=r;let a=t.maskMap(i);for(let e of n){let n=!1;for(let i=e.atoms.length-1;i>=0;i--){let s=a[e.atoms[i]-1]+1;0==s?(e.atoms=t.remove(e.atoms,i),n=!0):e.atoms[i]=s}n&&(e.atoms=t.sorted(t.append(e.atoms,o)))}}applyPolymerBlock(e){if("MUL"==e.bracketType){let t=parseInt(e.name);return void st.markSgroupMultiRepeat(this.mol,t,e.atoms)}if("DAT"==e.bracketType)return void(null!=e.atoms&&st.markSgroupData(this.mol,e.name,e.value,e.unit,e.query,e.atoms));let n=new ut(this.mol),i=null;if(null==e.connectType);else if("HT"==e.connectType)i=rt.HeadToTail;else if("HH"==e.connectType)i=rt.HeadToHead;else{if("EU"!=e.connectType)return;i=rt.Random}let s=null;if(3==t.len(e.bondConn)){let t=e.bondConn[0],n=e.bondConn[2],i=e.bondConn[1],l=0;for(let s=1;s<=this.mol.numBonds;s++)if(s!=t&&s!=n&&s!=i){let t=e.atoms.indexOf(this.mol.bondFrom(s))>=0,n=e.atoms.indexOf(this.mol.bondTo(s))>=0;if(t&&!n||!t&&n){if(l>0){l=0;break}l=s}}s=[t,n,i,l]}else 4==t.len(e.bondConn)&&(s=e.bondConn);let l=new ht(e.atoms);l.connect=i,l.bondConn=s,n.createUnit(l)}parseV3000Template(t){let e=t[0],n=this.splitWithQuotes(e.substring(16)),i=n[1],s=null;for(let t=2;t<n.length;t++)n[t].startsWith("NATREPLACE=")&&(s=n[t].substring(11));t[0]="  0  0  0  0  0  0  0  0  0  0  0 V3000",t.push("M  END");let l=new Ct(t.join("\n"));return l.parseHeader=!1,l.parse(),{name:i,natReplace:s,mol:l.mol}}withoutQuotes(t){return t.length>=2&&t.startsWith('"')&&t.endsWith('"')?t.substring(1,t.length-1):t}splitWithQuotes(t){let e=[],n="",i=0,s=!1;for(let l=0;l<t.length;l++){let r=t.charAt(l);" "!=r||0!=i||s?(n+=r,'"'==r?s=!s:"("==r||"["==r?i++:")"!=r&&"]"!=r||i--):(n.length>0&&e.push(n),n="")}return n.length>0&&e.push(n),e}unpackList(e){if(!e.startsWith("(")||!e.endsWith(")"))return null;e=e.substring(1,e.length-1);let n=[];for(let t of e.split(" "))n.push(parseInt(t));return n[0]!=n.length-1?null:t.remove(n,0)}unpackStrings(e){if(!e.startsWith("(")||!e.endsWith(")"))return null;let n=(e=e.substring(1,e.length-1)).split(" ");return parseInt(n[0])!=n.length-1?null:t.remove(n,0)}countRingBonds(t){let e=0;for(let n of this.mol.atomAdjBonds(t))this.mol.bondInRing(n)&&e++;return e}countSubstitutions(t){let e=0;for(let n of this.mol.atomAdjList(t))"H"!=this.mol.atomElement(n)&&e++;return e}}class gt{constructor(t){this.ds=new it,this.upcastColumns=!0,this.pos=0,this.lines=t.split(/\r?\n/)}parse(){return this.parseStream(),this.upcastColumns&&this.upcastStringColumns(),this.ds}parseStream(){let t=this.ds;t.appendColumn("Molecule","molecule","Molecular structure");let e=-1,n=[];for(;this.pos<this.lines.length;){let i=this.lines[this.pos++];if(!i.startsWith("$$$$")){n.push(i);continue}let s=t.appendRow(),l="",r=0;for(;r<n.length&&(i=n[r],!i.startsWith("> "))&&(l+=i+"\n",r++,!i.startsWith("M\tEND")););let o=null,a=null;try{if(l.length>0){let t=new Ct(l);t.parse(),o=t.mol,a=t.molName}}catch(t){}if(null!=o&&t.setMolecule(s,0,o),a&&(e<0&&(e=t.appendColumn("Name","string","Molecule name")),t.setString(s,e,a)),0==s&&null!=o){let e=n[0],i=n[2];e.length>=7&&e.startsWith("$name=")&&t.changeColumnName(0,e.substring(6),t.colDescr(0)),i.length>=8&&i.startsWith("$title=")&&(t.title=i.substring(7))}for(;r+1<n.length;r+=3){let e=n[r],i=n[r+1];if(!e.startsWith(">"))continue;let l=e.indexOf("<");if(l<0)continue;if(e=e.substring(l+1),l=e.indexOf(">"),l<0)continue;if(e=e.substring(0,l),0==e.length)continue;for(;r+2<n.length&&n[r+2].length>0;)i+="\n"+n[r+2],r++;let o=t.findColByName(e);o<0&&(o=t.appendColumn(e,"string","")),0==i.length?t.setToNull(s,o):t.setString(s,o,i)}n=[]}0==t.numRows&&(this.ds=null)}upcastStringColumns(){let t=this.ds;for(let e=0;e<t.numCols;e++)if("string"==t.colType(e)){let n=!0,i=!0,s=!0,l=!0;for(let r=0;r<t.numRows&&(i||s||l);r++){if(t.isNull(r,e))continue;n=!1;let o=t.getString(r,e);if(l){let t=o.toLowerCase();"true"!=t&&"false"!=t&&(l=!1)}if(s){let t=parseInt(o);isFinite(t)&&t==parseFloat(o)||(s=!1)}i&&(isFinite(parseFloat(o))||(i=!1))}n||(s?t.changeColumnType(e,"integer"):i?t.changeColumnType(e,"real"):l&&t.changeColumnType(e,"boolean"))}}}const At="M  V30 ";class bt{constructor(t){this.mol=t,this.includeHeader=!0,this.includeCounts=!0,this.includeEnd=!0,this.overallStereoAbsolute=!0,this.enhancedFields=!1,this.chargeSeparate=!1,this.abbrevSgroups=!0,this.polymerBlocks=!0,this.molName="",this.scsrTemplates=null,this.sgroups=[],this.lines=[]}write(){return this.includeHeader&&(this.lines.push(this.molName),this.lines.push("Generated by WebMolKit"),this.lines.push("")),this.writeCTAB(),this.lines.join("\n")}writeV3000(){return this.includeHeader&&(this.lines.push(this.molName),this.lines.push("Generated by WebMolKit"),this.lines.push("")),this.writeCTAB3000(),this.lines.join("\n")}writeEither(){let e=ft.hasStereoGroups(this.mol)||this.mol.numAtoms>=1e3||this.mol.numBonds>=1e3||t.notBlank(this.scsrTemplates);if(!e)for(let t=1;t<=this.mol.numBonds;t++)if(0==this.mol.bondOrder(t)&&null==mt.queryBondOrders(this.mol,t)){e=!0;break}return e?this.writeV3000():this.write()}getResult(){return this.lines.join("\n")}writeCTAB(){var e;let n=this.mol=this.mol.clone();n.keepTransient=!0,(Dt.hasAnyAbbrev(n)||st.hasAnySgroupMultiAttach(n)||st.hasAnySgroupMultiRepeat(n)||st.hasAnySgroupData(n))&&(this.abbrevSgroups?this.partialAbbrevExpansion():Dt.expandAbbrevs(n,!0),this.prepareSgroups());let i=[],s=[];for(let t=1;t<=n.numAtoms;t++){let e=null,l="F";if(e=mt.queryAtomElements(n,t),null==e&&(e=mt.queryAtomElementsNot(n,t),l="T"),null==e)continue;n.setAtomElement(t,"L");let r=this.intrpad(t,3)+" "+l+"  "+this.intrpad(e.length,3);for(let t of e)r+=this.intrpad(qt.elementAtomicNumber(t),4);i.push(r),r="M  ALS "+this.intrpad(t,3)+this.intrpad(e.length,3)+" "+l+" ";for(let t of e)r+=this.pad(t,4);s.push(r)}this.lines.push(this.intrpad(n.numAtoms,3)+this.intrpad(n.numBonds,3)+this.intrpad(i.length,3)+"  0"+(this.overallStereoAbsolute?"  1":"  0")+"  0  0  0  0  0999 V2000");let l=[],r=[],o=[],a=[],h=[],u=[],m=[],c=[],d=[],f=[],p=[],C=[],g=[],A=[],b=[],y=[],E=[],x=[];for(let e=1;e<=n.numAtoms;e++){let i=n.atomX(e),s=n.atomY(e),p=n.is3D()?n.atomZ(e):0,C=this.rpad(i.toFixed(4),10)+this.rpad(s.toFixed(4),10)+this.rpad(p.toFixed(4),10),M=n.atomElement(e);for(M.length>3&&(M=M.substring(0,3)),M.length>1&&"R"==M.charAt(0)&&M.charAt(1)>="0"&&M.charAt(1)<="9"&&(m.push(e),c.push(parseInt(M.substring(1))),M="R#");M.length<4;)M+=" ";C+=" "+M+"0";let v=n.atomCharge(e),T=n.atomUnpaired(e),N=n.atomMapNum(e);v=v>=-3&&v<=-1?4-v:0==v&&2==T?4:v>=1&&v<=3?4-v:0;let q=mt.queryAtomHydrogens(n,e),S=0;1==t.len(q)&&(S=q[0]+1);let w=this.mdlValence(n,e,15);C+=this.intrpad(v,3)+"  0"+this.intrpad(S,3)+"  0"+this.intrpad(w,3)+"  0  0  0"+this.intrpad(N,3)+"  0  0",this.lines.push(C),0!=n.atomCharge(e)&&(l.push(e),r.push(n.atomCharge(e))),this.enhancedFields&&n.atomHExplicit(e)!=qt.HEXPLICIT_UNKNOWN&&(d.push(e),f.push(n.atomHExplicit(e))),1==T&&(o.push(e),a.push(2)),2==T&&(o.push(e),a.push(1)),n.atomIsotope(e)!=qt.ISOTOPE_NATURAL&&(h.push(e),u.push(n.atomIsotope(e)));let O=mt.queryAtomRingBonds(n,e),D=mt.queryAtomAdjacency(n,e),R=mt.queryAtomUnsaturated(n,e);1==t.len(O)&&(g.push(e),A.push(0==O[0]?-1:O[0])),1==t.len(D)&&(b.push(e),y.push(0==D[0]?-1:D[0])),1==R&&(E.push(e),x.push(1))}let M=st.noteAromaticBonds(n);for(let i=1;i<=n.numBonds;i++){let s=n.bondOrder(i),l=s,r=t.sorted(null!==(e=mt.queryBondOrders(n,i))&&void 0!==e?e:[]);M[i-1]||t.equals(r,[-1])?l=4:t.equals(r,[1,2])?l=5:t.equals(r,[-1,1])?l=6:t.equals(r,[-1,2])?l=7:t.equals(r,[-1,0,1,2,3])?l=8:l>3&&(l=3);let o=n.bondType(i);o==qt.BONDTYPE_NORMAL||(o=o==qt.BONDTYPE_INCLINED?1:o==qt.BONDTYPE_DECLINED?6:o==qt.BONDTYPE_UNKNOWN?1==l?4:3:0);let a=this.intrpad(n.bondFrom(i),3)+this.intrpad(n.bondTo(i),3)+this.intrpad(l,3)+this.intrpad(o,3)+"  0  0  0";this.lines.push(a),this.enhancedFields&&(s<1||s>3||l!=s&&t.isBlank(r))&&(p.push(i),C.push(s))}if(this.lines.push(...i),this.lines.push(...s),this.writeMBlockPair("CHG",l,r),this.writeMBlockPair("RAD",o,a),this.writeMBlockPair("ISO",h,u),this.writeMBlockPair("RGP",m,c),this.writeMBlockPair("HYD",d,f),this.writeMBlockPair("ZCH",[],[]),this.writeMBlockPair("ZBO",p,C),this.writeMBlockPair("RBC",g,A),this.writeMBlockPair("SUB",b,y),this.writeMBlockPair("UNS",E,x),this.enhancedFields){let e=new tt(this.mol),n=0;for(let t of e.getResPaths())this.writeMBlockFlat("ZPA",++n,t.atoms);for(let t of e.getResRings())this.writeMBlockFlat("ZRI",++n,t.atoms);for(let i of e.getArenes())this.writeMBlockFlat("ZAR",++n,t.prepend(i.atoms,i.centre))}let v=t.booleanArray(!1,n.numAtoms);for(let t=0;t<this.sgroups.length;t++){let e=this.sgroups[t];for(let t of e.atoms)v[t-1]=!0;let n=this.intrpad(t+1,4);this.lines.push("M  STY  1"+n+" "+e.type);for(let t=0;t<e.atoms.length;t+=15){let i=Math.min(e.atoms.length-t,15),s="M  SAL"+n+this.intrpad(i,3);for(let n=0;n<i;n++)s+=this.intrpad(e.atoms[t+n],4);this.lines.push(s)}if("DAT"!=e.type&&this.lines.push("M  SMT"+n+" "+e.name),"MUL"==e.type){let t=parseInt(e.name),i=e.atoms.length/t;for(let t=0;t<i;t+=15){let s=Math.min(i-t,15),l="M  SPA"+n+this.intrpad(s,3);for(let n=0;n<s;n++)l+=this.intrpad(e.atoms[t+n],4);this.lines.push(l)}e.parent>0&&this.lines.push("M  SPL    1"+n+this.intrpad(e.parent,4))}"DAT"==e.type&&(this.lines.push("M  SDT"+n+" "+this.pad(e.name,32)+this.pad(e.unit,20)+e.query),this.lines.push("M  SED"+n+" "+e.value))}this.polymerBlocks&&this.encodePolymerBlocks(this.sgroups.length);for(let t=1;t<=n.numAtoms;t++)n.atomElement(t).length>2&&(this.lines.push("A  "+this.intrpad(t,3)),this.lines.push(n.atomElement(t)));this.includeEnd&&this.lines.push("M  END")}writeMBlockPair(t,e,n){const i=e.length;for(let s=0;s<i;s+=8){let l=Math.min(8,i-s),r="M  "+t+this.intrpad(l,3);for(let t=0;t<l;t++)r+=this.intrpad(e[s+t],4)+this.intrpad(n[s+t],4);this.lines.push(r)}}writeMBlockFlat(t,e,n){const i=n.length;for(let s=0;s<i;s+=15){let l=Math.min(15,i-s),r="M  "+t+this.intrpad(l,3)+this.intrpad(e,4);for(let t=0;t<l;t++)r+=this.intrpad(n[s+t],4);this.lines.push(r)}}writeMBlockFlatIdxFirst(t,e,n){const i=n.length;for(let s=0;s<i;s+=15){let l=Math.min(15,i-s),r="M  "+t+this.intrpad(e,4)+this.intrpad(l,3);for(let t=0;t<l;t++)r+=this.intrpad(n[s+t],4);this.lines.push(r)}}intrpad(t,e){return this.rpad(t.toString(),e)}rpad(t,e){for(;t.length<e;)t=" "+t;return t}pad(t,e){for(;t.length<e;)t+=" ";return t}mdlValence(t,e,n){let i=st.noteExplicitValence(t,e);if(null!=i)return i>0?i:n;let s=t.atomHydrogens(e),l=t.atomElement(e),r=pt[l];if(null==r&&0==s)return 0;let o=t.atomCharge(e),a="C"==l||"H"==l?Math.abs(o):"B"==l?-Math.abs(o):-o,h=0;for(let n of t.atomAdjBonds(e))h+=t.bondOrder(n);let u=a+s+h;if(r)for(let t of r)if(t>=a+h){if(t==u)return 0;break}let m=u-a;return m<=0||m>14?n:m}partialAbbrevExpansion(){const{mol:t}=this;for(let e=1;e<=t.numAtoms;e++)if(Dt.hasAbbrev(t,e)){let n=Dt.getAbbrev(t,e);if(null==n||1!=t.atomAdjCount(e)){Dt.clearAbbrev(t,e);continue}Dt.hasAnyAbbrev(n)&&(Dt.expandAbbrevs(n,!0),Dt.setAbbrev(t,e,n));let i=t.bondOrder(t.atomAdjBonds(e)[0]);if(1==n.atomAdjCount(1)&&i==n.bondOrder(n.atomAdjBonds(1)[0]))continue;Dt.expandOneAbbrev(t,e,!0),e--}}prepareSgroups(){const{mol:t}=this;for(let e=1;e<=t.numAtoms;e++)t.atomMapNum(e)<0&&t.setAtomMapNum(e,0);let e=0;for(let n=1;n<=t.numAtoms;n++)if(Dt.hasAbbrev(t,n)){this.sgroups.push({type:"SUP",name:t.atomElement(n),atoms:null});let i=Dt.expandOneAbbrev(t,n,!0);if(null==i)continue;e--;for(let n=0;n<i.length;n++)i[n]&&t.setAtomMapNum(n+1,e);n--}for(let n=-1,i=0;n>=e;n--,i++){let e=[];for(let i=1;i<=t.numAtoms;i++)t.atomMapNum(i)==n&&(e.push(i),t.setAtomMapNum(i,0));this.sgroups[i].atoms=e}for(let e of st.noteAllSgroupMultiAttach(t)){let t={type:"SUP",name:e.name,atoms:e.atoms},n=e.keyval.bonds;n&&(t.bonds=n.split(" ").map((t=>parseInt(t)))),t.templateClass=e.keyval.templateClass,t.natReplace=e.keyval.natReplace,n=e.keyval.attachPoints,n&&(t.attachPoints=n.split(" ")),this.sgroups.push(t)}for(let e of st.noteAllSgroupMultiRepeat(t))this.sgroups.push({type:"MUL",name:e.mult.toString(),atoms:e.atoms});for(let e of st.noteAllSgroupData(t))this.sgroups.push({type:"DAT",name:e.name,value:e.value,unit:e.unit,query:e.query,atoms:e.atoms});for(let t=0;t<this.sgroups.length;t++){let e=this.sgroups[t];if("MUL"!=e.type)continue;let n=-1,i=Number.MAX_SAFE_INTEGER;t:for(let s=0;s<this.sgroups.length;s++)if(s!=t){let t=this.sgroups[s];if("MUL"!=t.type||t.atoms.length>=i)continue;for(let n of e.atoms)if(!t.atoms.includes(n))continue t;n=s,i=t.atoms.length}n>=0&&(e.parent=n+1)}}encodePolymerBlocks(e){let n=new ut(this.mol);for(let i of n.getIDList()){let s=n.getUnit(i),l=this.intrpad(++e,4);this.lines.push("M  STY  1"+l+" SRU"),s.connect==rt.HeadToTail?this.lines.push("M  SCN  1"+l+" HT "):s.connect==rt.HeadToHead?this.lines.push("M  SCN  1"+l+" HH "):s.connect==rt.Random&&this.lines.push("M  SCN  1"+l+" EU "),this.writeMBlockFlatIdxFirst("SAL",e,s.atoms);let r=null;for(let e=1;e<=this.mol.numBonds;e++){let n=s.atoms.indexOf(this.mol.bondFrom(e))>=0,i=s.atoms.indexOf(this.mol.bondTo(e))>=0;(n&&!i||!n&&i)&&(r=t.append(r,e))}if(null!=r&&this.writeMBlockFlatIdxFirst("SBL",e,r),4==t.len(s.bondConn)){let t=[s.bondConn[0],s.bondConn[2],s.bondConn[1]];this.writeMBlockFlatIdxFirst("CRS",e,t)}this.lines.push("M  SMT"+l+" n")}}writeCTAB3000(){var e;let n=this.mol;(Dt.hasAnyAbbrev(n)||st.hasAnySgroupMultiAttach(n)||st.hasAnySgroupMultiRepeat(n)||st.hasAnySgroupData(n))&&(n=this.mol=n.clone(),n.keepTransient=!0,this.abbrevSgroups?this.partialAbbrevExpansion():Dt.expandAbbrevs(n,!0),this.prepareSgroups());let i=this.populateV3000Sgroups();this.includeCounts&&this.lines.push("  0  0  0     0  0            999 V3000"),this.lines.push(At+"BEGIN CTAB"),this.lines.push(At+`COUNTS ${n.numAtoms} ${n.numBonds} ${i.length} 0 ${this.overallStereoAbsolute?1:0}`),this.lines.push(At+"BEGIN ATOM");for(let e=1;e<=n.numAtoms;e++){let i=n.atomElement(e),s=mt.queryAtomElements(n,e);null!=s?i="["+s.join(",")+"]":(s=mt.queryAtomElementsNot(n,e),null!=s&&(i="NOT ["+s.join(",")+"]")),i.includes(" ")&&(i=`"${i}"`);let l=n.atomX(e),r=n.atomY(e),o=n.is3D()?n.atomZ(e):0,a=n.atomMapNum(e),h=n.atomCharge(e),u=n.atomUnpaired(e),m=n.atomIsotope(e),c=this.mdlValence(n,e,-1),d=`${At}${e} ${i} ${l.toFixed(4)} ${r.toFixed(4)} ${o.toFixed(4)} ${a}`;0!=h&&(d+=" CHG="+h),1==u?d+=" RAD=2":2==u&&(d+=" RAD=1"),0!=m&&(d+=" MASS="+m),0!=c&&(d+=" VAL="+c);let f=mt.queryAtomHydrogens(n,e),p=mt.queryAtomRingBonds(n,e),C=mt.queryAtomAdjacency(n,e),g=mt.queryAtomUnsaturated(n,e);1==t.len(f)&&(d+=" HCOUNT="+(0==f[0]?-1:f[0])),1==t.len(p)&&(d+=" RBCNT="+(0==p[0]?-1:p[0])),1==t.len(C)&&(d+=" SUBST="+(0==C[0]?-1:C[0])),1==g&&(d+=" UNSAT=1");for(let t of n.atomTransient(e))if(t.startsWith(nt.AtomSCSRClass))d+=" CLASS="+t.substring(nt.AtomSCSRClass.length+1);else if(t.startsWith(nt.AtomSCSRSeqID))d+=" SEQID="+t.substring(nt.AtomSCSRSeqID.length+1);else if(t.startsWith(nt.AtomSCSRAttchOrd)){let e=t.substring(nt.AtomSCSRAttchOrd.length+1).split(",");d+=" ATTCHORD="+this.packV3000Strings(e)}this.lines.push(d)}if(this.lines.push(At+"END ATOM"),n.numBonds>0){this.lines.push(At+"BEGIN BOND");let i=st.noteAromaticBonds(n),s=st.noteZeroHydrogenBonds(n);for(let l=1;l<=n.numBonds;l++){let r=n.bondFrom(l),o=n.bondTo(l),a=n.bondOrder(l),h=a,u=t.sorted(null!==(e=mt.queryBondOrders(n,l))&&void 0!==e?e:[]);i[l-1]||t.equals(u,[-1])?h=4:t.equals(u,[1,2])?h=5:t.equals(u,[-1,1])?h=6:t.equals(u,[-1,2])?h=7:t.equals(u,[-1,0,1,2,3])?h=8:0==h?h=s[l-1]?10:9:h>3&&(h=3);let m=n.bondType(l),c=`${At}${l} ${h} ${r} ${o}`;m==qt.BONDTYPE_INCLINED?c+=" CFG=1":m==qt.BONDTYPE_DECLINED?c+=" CFG=3":m==qt.BONDTYPE_UNKNOWN&&(c+=" CFG=2"),0!=a||s[l-1]||(c+=" DISP=COORD"),this.lines.push(c)}this.lines.push(At+"END BOND")}i.length>0&&(this.lines.push(At+"BEGIN SGROUP"),this.lines.push(...i),this.lines.push(At+"END SGROUP"));let s=[],l=new ft(n),r=0,o=0;for(let t of l.getRacemicAtoms())s.push(At+"MDLV30/STERAC"+ ++r+" ATOMS="+this.packV3000List(t));for(let t of l.getRelativeAtoms())s.push(At+"MDLV30/STEREL"+ ++o+" ATOMS="+this.packV3000List(t));s.length>0&&(this.lines.push(At+"BEGIN COLLECTION"),this.lines.push(...s),this.lines.push(At+"END COLLECTION")),this.lines.push(At+"END CTAB"),t.notBlank(this.scsrTemplates)&&this.populateSCSRTemplates(),this.includeEnd&&this.lines.push("M  END")}populateV3000Sgroups(){let t=this.mol,e=[];for(let t=0;t<this.sgroups.length;t++){let n=this.sgroups[t],i=e.length+1,s=`${At}${i} ${n.type} 0`;if("SUP"==n.type){if(s+=" LABEL="+(n.name.includes(" ")?`"${n.name}"`:n.name),s+=" ATOMS="+this.packV3000List(n.atoms),n.bonds&&(s+=" XBONDS="+this.packV3000List(n.bonds)),n.templateClass&&(s+=" CLASS="+n.templateClass),n.natReplace&&(s+=" NATREPLACE="+n.natReplace),n.attachPoints)for(let t=0;t+2<n.attachPoints.length;t+=3)s+=` SAP=(3 ${n.attachPoints[t]} ${n.attachPoints[t+1]} ${n.attachPoints[t+2]})`}else if("MUL"==n.type){let t=parseInt(n.name),e=n.atoms.length/t;s+=" MULT="+n.name,s+=" ATOMS="+this.packV3000List(n.atoms),s+=" PATOMS="+this.packV3000List(n.atoms.slice(0,e)),n.parent>0&&(s+=" PARENT="+n.parent)}else"DAT"==n.type&&(s+=" ATOMS="+this.packV3000List(n.atoms),s+=" FIELDNAME="+(n.name.includes(" ")?`"${n.name}"`:n.name),s+=" FIELDDATA="+(n.value.includes(" ")?`"${n.value}"`:n.value));e.push(s)}if(this.polymerBlocks){let n=new ut(t);for(let i of n.getIDList()){let s=e.length+1,l=n.getUnit(i),r=`${At}${s} SRU 0`;r+=" ATOMS="+this.packV3000List(l.atoms),l.connect==rt.HeadToTail?r+=" CONNECT=HT":l.connect==rt.HeadToHead?r+=" CONNECT=HH":l.connect==rt.Random&&(r+=" CONNECT=EU");let o=[];for(let e=1;e<=t.numBonds;e++){let n=l.atoms.includes(t.bondFrom(e)),i=l.atoms.includes(t.bondTo(e));(n&&!i||!n&&i)&&o.push(e)}o.length>0&&(r+=" BONDS="+this.packV3000List(o)),null!=l.bondConn&&(r+=" XBCORR="+this.packV3000List(l.bondConn)),e.push(r)}}return e}populateSCSRTemplates(){this.lines.push(At+"BEGIN TEMPLATE");for(let n=0;n<this.scsrTemplates.length;n++){var t=this.scsrTemplates[n];let i=At+"TEMPLATE "+(n+1)+" "+t.name;t.natReplace&&(i+=" NATREPLACE="+t.natReplace),this.lines.push(i);var e=new bt(t.mol);e.includeHeader=!1,e.includeCounts=!1,e.includeEnd=!1;let s=e.writeV3000();for(i of s.trimEnd().split("\n"))this.lines.push(i)}this.lines.push(At+"END TEMPLATE")}packV3000List(t){let e="("+t.length;for(let n of t)e+=" "+n;return e+")"}packV3000Strings(t){let e="("+t.length;for(let n of t)e+=" "+n;return e+")"}}class yt{constructor(t){this.ds=t,this.enhancedFields=!0,this.chargeSeparate=!1,this.abbrevSgroups=!0,this.lines=[]}write(){let t=this.ds,e=this.lines,n=this.ds.firstColOfType("molecule");for(let i=0;i<t.numRows;i++){let s=n<0?null:t.getMolecule(i,n);if(null!=s){let t=new bt(s);t.enhancedFields=this.enhancedFields,t.chargeSeparate=this.chargeSeparate,t.abbrevSgroups=this.abbrevSgroups;let n=t.write();e.push(n)}for(let s=0;s<t.numCols;s++)if(s!=n&&t.notNull(i,s)){let n=t.colType(s),l="";"string"==n?l=t.getString(i,s):"integer"==n?l=t.getInteger(i,s).toString():"real"==n?l=t.getReal(i,s).toString():"boolean"==n&&(l=t.getBoolean(i,s)?"true":"false"),""!=l&&(e.push("> <"+t.colName(s)+">"),e.push(l),e.push(""))}e.push("$$$$")}return e.join("\n")}getResult(){return this.lines.join("\n")}}function Et(t){let e=null;for(let n=0;n<t.length;n++){let i=t.charAt(n),s="\n\t\\,=".includes(i),l=i.charCodeAt(0)<32;null==e&&(s||l)&&(e=t.substring(0,n)),s?e+="\n"==i?"\\n":"\t"==i?"\\t":"\\"+i:l||null!=e&&(e+=i)}return null!=e?e:t}function xt(t){let e="",n=[];for(let i of t)i.includes("\n")?n.push(i):e+=","+Et(i);e+="\n";for(let t of n){let n=t.trimEnd().split("\n");for(let t=0;t<n.length;t++)e+=`${0==t?".":":"}${n[t]}\n`}return e}function Mt(t,e,n,i){let s=e,l=t.length;if(e>=l){if(i)throw new Error("Molecule missing line fragment");return null}let r=!1;for(;s<l;){let e=t.charAt(s);if("\\"==e){if(s==l-1)throw new Error("Escape character \\ at end of line");r=!0,s+=2}else{if(e==n)break;s++}}if(!r)return{str:t.substring(e,s),pos:s};var o="";for(let n=e;n<s;n++){let e=t.charAt(n);"\\"==e?(e=t.charAt(++n),o+="n"==e?"\n":"t"==e?"\t":e):o+=e}return{str:o,pos:s}}class vt{static readUnknown(t){if(t.startsWith('"'))try{let e=JSON.parse(t),n=vt.readNative(e);if(n)return n}catch(t){}let e=vt.readNative(t);if(e)return e;try{e=vt.readMDLMOL(t)}catch(t){}return e}static readNative(t){if(t.startsWith("SketchEl!"))return this.readNativeLegacy(t);let e=new qt;e.keepTransient=!0;let n=t.split(/\r?\n/),i=n[0].match(/^Elements\!\((\d+),(\d+)\)$/);if(!i)return null;let s=parseInt(i[1]),l=parseInt(i[2]);if(!(s>=0))throw new Error(`Invalid atom count: ${i[1]}`);if(!(l>=0))throw new Error(`Invalid bond count: ${i[2]}`);const r="Molecule atom content ends prematurely",o="Molecule unexpected end tag",a=t=>{let e=parseInt(t);if(Number.isNaN(e))throw new Error(`Malformed integer: ${t}`);return e},h=t=>{let e=parseFloat(t);if(Number.isNaN(e))throw new Error(`Malformed float: ${t}`);return e},u=(t,n)=>{if(!n)return;let i=n.charAt(0);"z"==i?e.setAtomZ(t,h(n.substring(1))):"c"==i?e.setAtomCharge(t,a(n.substring(1))):"u"==i?e.setAtomUnpaired(t,a(n.substring(1))):"h"==i?e.setAtomHExplicit(t,a(n.substring(1))):"i"==i?e.setAtomIsotope(t,a(n.substring(1))):"m"==i?e.setAtomMapNum(t,a(n.substring(1))):"y"==i?e.appendAtomTransient(t,n):e.appendAtomExtra(t,n)},m=(t,n)=>{if(!n)return;let i=n.charAt(0);"i"==i?e.setBondType(t,qt.BONDTYPE_INCLINED):"d"==i?e.setBondType(t,qt.BONDTYPE_DECLINED):"u"==i?e.setBondType(t,qt.BONDTYPE_UNKNOWN):"y"==i?e.appendBondTransient(t,n):e.appendBondExtra(t,n)};let c=1;for(let t=1;t<=s;t++){if(!n[c])throw new Error(r);let i=Mt(n[c],0,"=",!0),a=Mt(n[c],i.pos+1,",",!0),m=Mt(n[c],a.pos+1,",",!0),f=h(a.str),p=h(m.str);e.addAtom(i.str,f,p);let C=m.pos+1;for(;null!=(g=Mt(n[c],C,",",!1));)u(t,g.str),C=g.pos+1;for(c++;;){if(!n[c])throw new Error(r);if("!End"==n[c]){if(t==s&&0==l)break;throw new Error(o)}if(!n[c].startsWith("."))break;for(var d=n[c].substring(1);;){if(c++,!n[c])throw new Error(r);if(!n[c].startsWith(":"))break;d+="\n"+n[c].substring(1)}u(t,d)}}for(let t=1;t<=l;t++){if(!n[c])throw new Error(r);var f=Mt(n[c],0,"-",!0),p=Mt(n[c],f.pos+1,"=",!0),C=Mt(n[c],p.pos+1,",",!0);let i=a(f.str),h=a(p.str),u=a(C.str);if(i<1||i>s||h<1||h>s||u<0||u>4)throw new Error("Invalid bond specification");e.addBond(i,h,u);let d=C.pos+1;for(;;){var g;if(null==(g=Mt(n[c],d,",",!1)))break;m(t,g.str),d=g.pos+1}for(c++;;){if(!n[c])throw new Error(r);if("!End"==n[c]){if(t==l)break;throw new Error(o)}if(!n[c].startsWith("."))break;let e=n[c].substring(1);for(;;){if(c++,!n[c])throw new Error(r);if(!n[c].startsWith(":"))break;e+="\n"+n[c].substring(1)}m(t,e)}}if("!End"!=n[c])throw new Error("Molecule end tag missing");return e.keepTransient=!1,e}static readNativeLegacy(t){let e=new qt;e.keepTransient=!0;let n=t.split(/\r?\n/);if(n.length<2)return null;if(!n[0].startsWith("SketchEl!")&&n.length>=4&&n[3].indexOf("V2000")>=0){let e=t.indexOf("SketchEl!");if(e<0)return null;n=t.substring(e).split(/r?\n/)}let i=n[0].match(/^SketchEl\!\((\d+)\,(\d+)\)/);if(!i)return null;let s=parseInt(i[1]),l=parseInt(i[2]);if(n.length<2+s+l)return null;if(!n[1+s+l].match(/^!End/))return null;for(let t=0;t<s;t++){let i=n[1+t].split(/[=,;]/),s=e.addAtom(vt.skUnescape(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseInt(i[3]),parseInt(i[4])),l=[],r=[];for(let t=5;t<i.length;t++)i[t].charAt(0),"i"==i[t].charAt(0)||("e"==i[t].charAt(0)?e.setAtomHExplicit(s,parseInt(i[t].substring(1))):"m"==i[t].charAt(0)?e.setAtomIsotope(s,parseInt(i[t].substring(1))):"n"==i[t].charAt(0)?e.setAtomMapNum(s,parseInt(i[t].substring(1))):"x"==i[t].charAt(0)?l.push(vt.skUnescape(i[t])):"y"==i[t].charAt(0)?r.push(vt.skUnescape(i[t])):"z"==i[t].charAt(0)?(e.setAtomZ(s,parseFloat(i[t].substring(1))),e.setIs3D(!0)):l.push(vt.skUnescape(i[t])));e.setAtomExtra(s,l),e.setAtomTransient(s,r)}for(let t=0;t<l;t++){let i=n[1+s+t].split(/[=,]/),l=i[0].split("-"),r=parseInt(l[0].trim()),o=parseInt(l[1].trim());if(r==o)continue;let a=e.addBond(r,o,parseInt(i[1]),parseInt(i[2])),h=new Array,u=new Array;for(let t=3;t<i.length;t++)i[t].charAt(0),"x"==i[t].charAt(0)?h.push(vt.skUnescape(i[t])):"y"==i[t].charAt(0)?u.push(vt.skUnescape(i[t])):h.push(vt.skUnescape(i[t]));e.setBondExtra(a,h),e.setBondTransient(a,u)}return e.keepTransient=!1,e}static writeNative(t){if(!this.formatV2Elements)return this.writeNativeLegacy(t);let e=[`Elements!(${t.numAtoms},${t.numBonds})\n`];const n=t=>(1e-4*Math.round(1e4*t)).toFixed(4);for(let i=1;i<=t.numAtoms;i++){let s=t.atomElement(i),l=n(t.atomX(i)),r=n(t.atomY(i));e.push(`${Et(s)}=${l},${r}`);let o=[];t.is3D()&&o.push(`z${n(t.atomZ(i))}`);let a=t.atomCharge(i),h=t.atomUnpaired(i),u=t.atomHExplicit(i),m=t.atomIsotope(i),c=t.atomMapNum(i);0!=a&&o.push(`c${a}`),0!=h&&o.push(`u${h}`),u!=qt.HEXPLICIT_UNKNOWN&&o.push(`h${u}`),m!=qt.ISOTOPE_NATURAL&&o.push(`i${m}`),c>0&&o.push(`m${c}`),o.push(...t.atomExtra(i)),o.push(...t.atomTransient(i)),e.push(xt(o))}for(let n=1;n<=t.numBonds;n++){let i=t.bondFrom(n),s=t.bondTo(n),l=t.bondOrder(n);e.push(`${i}-${s}=${l}`);let r=[],o=t.bondType(n);o==qt.BONDTYPE_INCLINED?r.push("i"):o==qt.BONDTYPE_DECLINED?r.push("d"):o==qt.BONDTYPE_UNKNOWN&&r.push("u"),r.push(...t.bondExtra(n)),r.push(...t.bondTransient(n)),e.push(xt(r))}return e.push("!End\n"),e.join("")}static writeNativeLegacy(t){let e="SketchEl!("+t.numAtoms+","+t.numBonds+")\n";for(let n=1;n<=t.numAtoms;n++){let i=t.atomElement(n),s=t.atomX(n),l=t.atomY(n),r=t.atomCharge(n),o=t.atomUnpaired(n),a=t.atomHExplicit(n)!=qt.HEXPLICIT_UNKNOWN?"e"+t.atomHExplicit(n):"i"+t.atomHydrogens(n);e+=vt.skEscape(i)+"="+s.toFixed(4)+","+l.toFixed(4)+";"+r+","+o+","+a,t.is3D()&&(e+=",z"+t.atomZ(n)),t.atomIsotope(n)!=qt.ISOTOPE_NATURAL&&(e+=",m"+t.atomIsotope(n)),t.atomMapNum(n)>0&&(e+=",n"+t.atomMapNum(n)),e+=vt.skEncodeExtra(t.atomExtra(n)),e+=vt.skEncodeExtra(t.atomTransient(n)),e+="\n"}for(let n=1;n<=t.numBonds;n++)e+=t.bondFrom(n)+"-"+t.bondTo(n)+"="+t.bondOrder(n)+","+t.bondType(n),e+=vt.skEncodeExtra(t.bondExtra(n)),e+=vt.skEncodeExtra(t.bondTransient(n)),e+="\n";return e+="!End\n",e}static readMDLMOL(t){let e=new Ct(t);return e.parseHeader=!0,e.parse(),e.mol}static writeMDLMOL(t){return new bt(t).write()}static skUnescape(t){let e,n="";for(;e=t.match(/^(.*?)\\([0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f])(.*)/);)n+=e[1]+String.fromCharCode(parseInt("0x"+e[2])),t=e[3];return n+t}static skEscape(t){let e="";for(let n=0;n<t.length;n++){let i=t.charAt(n),s=t.charCodeAt(n);if(s<=32||s>127||"\\"==i||","==i||";"==i||"="==i){let t=(65535&s).toString(16).toUpperCase();e+="\\";for(let n=4-t.length;n>0;n--)e+="0";e+=t}else e+=i}return e}static skEncodeExtra(t){let e="";for(let n=0;n<t.length;n++)e+=","+vt.skEscape(t[n]);return e}}vt.formatV2Elements=!1;class Tt{}class Nt{}class qt{constructor(){this.atoms=[],this.bonds=[],this.hasZCoord=!1,this.keepTransient=!1,this.hasTransient=!1,this.graph=null,this.graphBond=null,this.ringID=null,this.compID=null,this.ring3=null,this.ring4=null,this.ring5=null,this.ring6=null,this.ring7=null}clone(){let t=new qt;return t.atoms=W(this.atoms),t.bonds=W(this.bonds),t.hasZCoord=this.hasZCoord,t.keepTransient=this.keepTransient,t.hasTransient=this.hasTransient,t.graph=this.graph,t.graphBond=this.graphBond,t.ringID=this.ringID,t.compID=this.compID,t.ring3=this.ring3,t.ring4=this.ring4,t.ring5=this.ring5,t.ring6=this.ring6,t.ring7=this.ring7,t}static fromString(t){return vt.readNative(t)}toString(){return vt.writeNative(this)}append(t){let e=this.atoms.length;for(let e=1;e<=t.numAtoms;e++){let n=this.addAtom(t.atomElement(e),t.atomX(e),t.atomY(e),t.atomCharge(e),t.atomUnpaired(e));this.setAtomIsotope(n,t.atomIsotope(e)),this.setAtomHExplicit(n,t.atomHExplicit(e)),this.setAtomMapNum(n,t.atomMapNum(e)),this.setAtomExtra(n,t.atomExtra(e)),this.setAtomTransient(n,t.atomTransient(e))}for(let n=1;n<=t.numBonds;n++){let i=this.addBond(t.bondFrom(n)+e,t.bondTo(n)+e,t.bondOrder(n),t.bondType(n));this.setBondExtra(i,t.bondExtra(n)),this.setBondTransient(i,t.bondTransient(n))}this.trashTransient()}get numAtoms(){return this.atoms.length}getAtom(t){if(t<1||t>this.atoms.length)throw new Error(`Molecule.getAtom: index ${t} out of range (#atoms=${this.atoms.length})`);return this.atoms[t-1]}atomElement(t){return this.getAtom(t).element}atomX(t){return this.getAtom(t).x}atomY(t){return this.getAtom(t).y}atomCharge(t){return this.getAtom(t).charge}atomUnpaired(t){return this.getAtom(t).unpaired}atomIsotope(t){return this.getAtom(t).isotope}atomHExplicit(t){return this.getAtom(t).hExplicit}atomMapNum(t){return this.getAtom(t).mapNum}atomExtra(t){return this.getAtom(t).extra.slice(0)}atomTransient(t){return this.getAtom(t).transient.slice(0)}get numBonds(){return this.bonds.length}getBond(t){if(t<1||t>this.bonds.length)throw new Error(`Molecule.getBond: index ${t} out of range (#bonds=${this.bonds.length})`);return this.bonds[t-1]}bondFrom(t){return this.getBond(t).from}bondTo(t){return this.getBond(t).to}bondOrder(t){return this.getBond(t).order}bondType(t){return this.getBond(t).type}bondExtra(t){return this.getBond(t).extra.slice(0)}bondTransient(t){return this.getBond(t).transient.slice(0)}bondFromTo(t){let e=this.getBond(t);return[e.from,e.to]}addAtom(t,e,n,i=0,s=0){let l=new Tt;return l.element=t,l.x=e,l.y=n,l.charge=i,l.unpaired=s,l.isotope=qt.ISOTOPE_NATURAL,l.hExplicit=qt.HEXPLICIT_UNKNOWN,l.mapNum=0,l.extra=[],l.transient=[],this.atoms.push(l),this.trashTransient(),this.trashGraph(),this.atoms.length}setAtomElement(t,e){this.getAtom(t).element=e,this.trashTransient()}setAtomPos(t,e,n,i){let s=this.getAtom(t);s.x=e,s.y=n,s.z=null==i?0:i,this.trashTransient()}setAtomX(t,e){this.getAtom(t).x=e,this.trashTransient()}setAtomY(t,e){this.getAtom(t).y=e,this.trashTransient()}setAtomCharge(t,e){this.getAtom(t).charge=e,this.trashTransient()}setAtomUnpaired(t,e){this.getAtom(t).unpaired=e,this.trashTransient()}setAtomIsotope(t,e){this.getAtom(t).isotope=e,this.trashTransient()}setAtomHExplicit(t,e){this.getAtom(t).hExplicit=e,this.trashTransient()}setAtomMapNum(t,e){this.getAtom(t).mapNum=e,this.trashTransient()}setAtomExtra(t,e){this.getAtom(t).extra=e.slice(0)}setAtomTransient(t,e){this.getAtom(t).transient=e.slice(0),e.length>0&&(this.hasTransient=!0)}swapAtoms(t,e){let n=this.atoms[t-1];this.atoms[t-1]=this.atoms[e-1],this.atoms[e-1]=n;for(let n=0;n<this.bonds.length;n++){let i=this.bonds[n];i.from==e?i.from=t:i.from==t&&(i.from=e),i.to==e?i.to=t:i.to==t&&(i.to=e)}this.trashGraph()}addBond(t,e,n,i=qt.BONDTYPE_NORMAL){let s=new Nt;return s.from=t,s.to=e,s.order=n,s.type=i,s.extra=[],s.transient=[],this.bonds.push(s),this.trashTransient(),this.trashGraph(),this.bonds.length}setBondFrom(t,e){this.getBond(t).from=e,this.trashTransient(),this.trashGraph()}setBondTo(t,e){this.getBond(t).to=e,this.trashTransient(),this.trashGraph()}setBondFromTo(t,e,n){this.getBond(t).from=e,this.getBond(t).to=n,this.trashTransient(),this.trashGraph()}setBondOrder(t,e){this.getBond(t).order=e,this.trashTransient()}setBondType(t,e){this.getBond(t).type=e,this.trashTransient()}setBondExtra(t,e){this.getBond(t).extra=e.slice(0)}setBondTransient(t,e){this.getBond(t).transient=e.slice(0),e.length>0&&(this.hasTransient=!0)}deleteAtomAndBonds(t){for(let e=this.numBonds;e>=1;e--)this.bondFrom(e)==t||this.bondTo(e)==t?this.deleteBond(e):(this.bondFrom(e)>t&&this.setBondFrom(e,this.bondFrom(e)-1),this.bondTo(e)>t&&this.setBondTo(e,this.bondTo(e)-1));this.atoms.splice(t-1,1),this.trashTransient(),this.trashGraph()}deleteBond(t){this.bonds.splice(t-1,1),this.trashTransient(),this.trashGraph()}atomHydrogens(t){let e=this.atomHExplicit(t);if(e!=qt.HEXPLICIT_UNKNOWN)return e;for(let n=0;n<qt.HYVALENCE_EL.length;n++)if(qt.HYVALENCE_EL[n]==this.atomElement(t)){e=qt.HYVALENCE_VAL[n];break}if(e==qt.HEXPLICIT_UNKNOWN)return 0;let n=this.atomCharge(t);"C"==this.atomElement(t)&&(n=-Math.abs(n)),e+=n-this.atomUnpaired(t);let i=this.atomAdjBonds(t);for(let t=0;t<i.length;t++)e-=this.bondOrder(i[t]);return e<0?0:e}findBond(t,e){for(let n=1;n<=this.numBonds;n++){let i=this.bondFrom(n),s=this.bondTo(n);if(t==i&&e==s||t==s&&e==i)return n}return 0}bondOther(t,e){let n=this.bondFrom(t),i=this.bondTo(t);return n==e?i:i==e?n:0}atomExplicit(t){let e=this.atoms[t-1];return e.isotope!=qt.ISOTOPE_NATURAL||"C"!=e.element||0!=e.charge||0!=e.unpaired||0==this.atomAdjCount(t)}atomRingBlock(t){return null==this.graph&&this.buildGraph(),null==this.ringID&&this.buildRingID(),this.ringID[t-1]}bondInRing(t){let e=this.atomRingBlock(this.bondFrom(t)),n=this.atomRingBlock(this.bondTo(t));return e>0&&e==n}atomConnComp(t){return null==this.graph&&this.buildGraph(),null==this.compID&&this.buildConnComp(),this.compID[t-1]}atomAdjCount(t){return this.buildGraph(),this.graph[t-1].length}atomAdjList(t){this.buildGraph();let e=this.graph[t-1].slice(0);for(let t=e.length-1;t>=0;t--)e[t]++;return e}atomAdjBonds(t){return this.buildGraph(),this.graphBond[t-1].slice(0)}findRingsOfSize(e){let n=null;if(3==e&&null!=this.ring3&&(n=this.ring3),4==e&&null!=this.ring4&&(n=this.ring4),5==e&&null!=this.ring5&&(n=this.ring5),6==e&&null!=this.ring6&&(n=this.ring6),7==e&&null!=this.ring7&&(n=this.ring7),null==n){null==this.graph&&this.buildGraph(),null==this.ringID&&this.buildRingID(),n=[];for(let i=1;i<=this.atoms.length;i++)if(this.ringID[i-1]>0){let s=t.numberArray(0,e);s[0]=i,this.recursiveRingFind(s,1,e,this.ringID[i-1],n)}3==e&&(this.ring3=n),4==e&&(this.ring4=n),5==e&&(this.ring5=n),6==e&&(this.ring6=n),7==e&&(this.ring7=n)}let i=[];for(let t=0;t<n.length;t++)i.push(n[t].slice(0));return i}boundary(){if(0==this.atoms.length)return d.zero();let t=this.atoms[0].x,e=t,n=this.atoms[0].y,i=n;for(let s=1;s<this.atoms.length;s++)t=Math.min(t,this.atoms[s].x),n=Math.min(n,this.atoms[s].y),e=Math.max(e,this.atoms[s].x),i=Math.max(i,this.atoms[s].y);return new d(t,n,e-t,i-n)}atomicNumber(t){return qt.elementAtomicNumber(this.atomElement(t))}static elementAtomicNumber(t){return Math.max(0,s.ELEMENTS.indexOf(t))}is3D(){return this.hasZCoord}setIs3D(t){this.hasZCoord=t}atomZ(t){return this.getAtom(t).z}setAtomZ(t,e){this.getAtom(t).z=e}compareTo(t){if(null==t||0==t.numAtoms)return 0==this.numAtoms?0:1;if(this.numAtoms<t.numAtoms)return-1;if(this.numAtoms>t.numAtoms)return 1;if(this.numBonds<t.numBonds)return-1;if(this.numBonds>t.numBonds)return 1;for(let e=1;e<=this.numAtoms;e++){if(this.atomElement(e)<t.atomElement(e))return-1;if(this.atomElement(e)>t.atomElement(e))return 1;if(this.atomX(e)<t.atomX(e))return-1;if(this.atomX(e)>t.atomX(e))return 1;if(this.atomY(e)<t.atomY(e))return-1;if(this.atomY(e)>t.atomY(e))return 1;if(this.atomCharge(e)<t.atomCharge(e))return-1;if(this.atomCharge(e)>t.atomCharge(e))return 1;if(this.atomUnpaired(e)<t.atomUnpaired(e))return-1;if(this.atomUnpaired(e)>t.atomUnpaired(e))return 1;if(this.atomHExplicit(e)<t.atomHExplicit(e))return-1;if(this.atomHExplicit(e)>t.atomHExplicit(e))return 1;if(this.atomIsotope(e)<t.atomIsotope(e))return-1;if(this.atomIsotope(e)>t.atomIsotope(e))return 1;if(this.atomMapNum(e)<t.atomMapNum(e))return-1;if(this.atomMapNum(e)>t.atomMapNum(e))return 1;let n=this.atomExtra(e).map((t=>t.trimEnd())),i=t.atomExtra(e).map((t=>t.trimEnd()));if(n.length<i.length)return-1;if(n.length>i.length)return 1;for(let t=0;t<n.length;t++){if(n[t]<i[t])return-1;if(n[t]>i[t])return 1}if(n=this.atomTransient(e).map((t=>t.trimEnd())),i=t.atomTransient(e).map((t=>t.trimEnd())),n.length<i.length)return-1;if(n.length>i.length)return 1;for(let t=0;t<n.length;t++){if(n[t]<i[t])return-1;if(n[t]>i[t])return 1}}for(let e=1;e<=this.numBonds;e++){if(this.bondFrom(e)<t.bondFrom(e))return-1;if(this.bondFrom(e)>t.bondFrom(e))return 1;if(this.bondTo(e)<t.bondTo(e))return-1;if(this.bondTo(e)>t.bondTo(e))return 1;if(this.bondOrder(e)<t.bondOrder(e))return-1;if(this.bondOrder(e)>t.bondOrder(e))return 1;if(this.bondType(e)<t.bondType(e))return-1;if(this.bondType(e)>t.bondType(e))return 1;let n=this.bondExtra(e),i=t.bondExtra(e);if(n.length<i.length)return-1;if(n.length>i.length)return 1;for(let t=0;t<n.length;t++){if(n[t]<i[t])return-1;if(n[t]>i[t])return 1}if(n=this.bondTransient(e),i=t.bondTransient(e),n.length<i.length)return-1;if(n.length>i.length)return 1;for(let t=0;t<n.length;t++){if(n[t]<i[t])return-1;if(n[t]>i[t])return 1}}return 0}trashTransient(){if(!this.keepTransient&&this.hasTransient){for(let t of this.atoms)t.transient=[];for(let t of this.bonds)t.transient=[];this.hasTransient=!1}}appendAtomExtra(t,e){this.getAtom(t).extra.push(e)}appendAtomTransient(t,e){this.getAtom(t).transient.push(e)}appendBondExtra(t,e){this.getBond(t).extra.push(e)}appendBondTransient(t,e){this.getBond(t).transient.push(e)}getAtomCloned(t){return W(this.getAtom(t))}getBondCloned(t){return W(this.getBond(t))}setAtom(e,n){if(!n)return;let i=this.getAtom(e);n.element!=i.element&&this.setAtomElement(e,n.element),n.x!=i.x&&this.setAtomX(e,n.x),n.y!=i.y&&this.setAtomY(e,n.y),n.z!=i.z&&this.setAtomZ(e,n.z),n.charge!=i.charge&&this.setAtomCharge(e,n.charge),n.unpaired!=i.unpaired&&this.setAtomUnpaired(e,n.unpaired),n.isotope!=i.isotope&&this.setAtomIsotope(e,n.isotope),n.hExplicit!=i.hExplicit&&this.setAtomHExplicit(e,n.hExplicit),n.mapNum!=i.mapNum&&this.setAtomMapNum(e,n.mapNum),t.equals(n.extra,i.extra)||this.setAtomExtra(e,n.extra),t.equals(n.transient,i.transient)||this.setAtomTransient(e,n.transient)}setBond(e,n){if(null==n)return;let i=this.getBond(e);n.from!=i.from&&this.setBondFrom(e,n.from),n.to!=i.to&&this.setBondTo(e,n.to),n.order!=i.order&&this.setBondOrder(e,n.order),n.type!=i.type&&this.setBondType(e,n.type),t.equals(n.extra,i.extra)||this.setBondExtra(e,n.extra),t.equals(n.transient,i.transient)||this.setBondTransient(e,n.transient)}modifyAtoms(t){for(let n=1;n<=this.numAtoms;n++){var e=t(n,this.getAtomCloned(n));null!=e&&this.setAtom(n,e)}}modifyAtomsIndices(t,e){for(let i of t){var n=e(i,this.getAtomCloned(i));null!=n&&this.setAtom(i,n)}}modifyBonds(t){for(let n=1;n<=this.numBonds;n++){var e=t(n,this.getBondCloned(n));null!=e&&this.setBond(n,e)}}modifyBondsIndices(t,e){for(let i of t){var n=e(i,this.getBondCloned(i));null!=n&&this.setBond(i,n)}}findAtomMatch(t){for(let e=1;e<=this.numAtoms;e++)if(t(this.getAtom(e)))return e;return 0}findBondMatch(t){for(let e=1;e<=this.numBonds;e++)if(t(this.getBond(e)))return e;return 0}findAllAtoms(t){let e=[];for(let n=1;n<=this.numAtoms;n++)t(this.getAtom(n))&&e.push(n);return e}findAllBonds(t){let e=[];for(let n=1;n<=this.numBonds;n++)t(this.getBond(n))&&e.push(n);return e}mapAtoms(t){let e=new Array(this.numAtoms);for(let n=1;n<=this.numAtoms;n++)e[n-1]=t(this.getAtom(n));return e}mapBonds(t){let e=new Array(this.numBonds);for(let n=1;n<=this.numBonds;n++)e[n-1]=t(this.getBond(n));return e}mapAtomsIndices(t,e){let n=new Array(t.length),i=0;for(let s of t)n[i++]=e(this.getAtom(s));return n}mapBondsIndices(t,e){let n=new Array(t.length),i=0;for(let s of t)n[i++]=e(this.getBond(s));return n}trashGraph(){this.graph=null,this.graphBond=null,this.ringID=null,this.compID=null,this.ring3=null,this.ring4=null,this.ring5=null,this.ring6=null,this.ring7=null}buildGraph(){if(null!=this.graph&&null!=this.graphBond)return;let t=[],e=[],n=this.numAtoms,i=this.numBonds;for(let i=0;i<n;i++)t.push([]),e.push([]);for(let n=1;n<=i;n++){let i=this.getBond(n);t[i.from-1].push(i.to-1),t[i.to-1].push(i.from-1),e[i.from-1].push(n),e[i.to-1].push(n)}this.graph=t,this.graphBond=e}buildConnComp(){const e=this.atoms.length;this.compID=t.numberArray(0,e);for(let t=0;t<e;t++)this.compID[t]=0;let n=1;for(this.compID[0]=n;;){let t=!1;for(let i=0;i<e;i++)if(this.compID[i]==n)for(let e=0;e<this.graph[i].length;e++)0==this.compID[this.graph[i][e]]&&(this.compID[this.graph[i][e]]=n,t=!0);if(!t){for(let i=0;i<e;i++)if(0==this.compID[i]){this.compID[i]=++n,t=!0;break}if(!t)break}}}buildRingID(){const e=this.atoms.length;if(this.ringID=t.numberArray(0,e),0==e)return;let n=t.booleanArray(!1,e);for(let t=0;t<e;t++)this.ringID[t]=0,n[t]=!1;let i=t.numberArray(0,e+1),s=0,l=0;for(;;){let t,r;if(0==s)for(t=-1,r=0;n[r];r++);else{t=i[s-1],r=-1;for(let e=0;e<this.graph[t].length;e++)if(!n[this.graph[t][e]]){r=this.graph[t][e];break}}if(r>=0&&s>=2){let l=i[s-1];for(let o=0;o<this.graph[r].length;o++){let a=this.graph[r][o];if(a!=l&&n[a]){i[s]=r;for(let n=s;n==s||i[n+1]!=a;n--){let s=this.ringID[i[n]];if(0==s)this.ringID[i[n]]=t;else if(s!=t)for(let n=0;n<e;n++)this.ringID[n]==s&&(this.ringID[n]=t)}}}}if(r>=0?(n[r]=!0,i[s++]=r,l++):s--,l==e)break}let r=0;for(let t=0;t<e;t++)if(this.ringID[t]>0){r--;for(let n=e-1;n>=t;n--)this.ringID[n]==this.ringID[t]&&(this.ringID[n]=r)}for(let t=0;t<e;t++)this.ringID[t]=-this.ringID[t]}recursiveRingFind(e,n,i,s,l){const{graph:r}=this;if(n<i){let t=e[n-1];for(let o=0;o<r[t-1].length;o++){let a=r[t-1][o]+1;if(this.ringID[a-1]!=s)continue;let h=!1;for(let t=0;t<n;t++)if(e[t]==a){h=!0;break}if(!h){let t=e.slice(0);t[n]=a,this.recursiveRingFind(t,n+1,i,s,l)}}return}let o=e[n-1],a=!1;for(let t=0;t<r[o-1].length;t++)if(r[o-1][t]+1==e[0]){a=!0;break}if(!a)return;for(let t=0;t<e.length;t++){let n=0,i=e[t]-1;for(let t=0;t<r[i].length;t++)e.indexOf(r[i][t]+1)>=0&&n++;if(2!=n)return}let h=0;for(let t=1;t<n;t++)e[t]<e[h]&&(h=t);let u=(h+1)%n,m=e[(h-1+n)%n]<e[u];if(0!=h||m){let i=t.numberArray(0,n);for(let t=0;t<n;t++)i[t]=e[(h+(m?n-t:t))%n];e=i}for(let t=0;t<l.length;t++){let i=l[t],s=!0;for(let t=0;t<n;t++)if(i[t]!=e[t]){s=!1;break}if(s)return}l.push(e)}}qt.IDEALBOND=1.5,qt.HEXPLICIT_UNKNOWN=-1,qt.ISOTOPE_NATURAL=0,qt.BONDTYPE_NORMAL=0,qt.BONDTYPE_INCLINED=1,qt.BONDTYPE_DECLINED=2,qt.BONDTYPE_UNKNOWN=3,qt.HYVALENCE_EL=["C","N","O","S","P"],qt.HYVALENCE_VAL=[4,3,2,2,3],qt.PREFIX_EXTRA="x",qt.PREFIX_TRANSIENT="y";class St{static atomAtPoint(t,e,n,i){null==i&&(i=St.OVERLAP_THRESHOLD);const s=i*i;for(let i=1;i<=t.numAtoms;i++)if(q(t.atomX(i)-e,t.atomY(i)-n)<s)return i;return 0}static sketchEquivalent(e,n,i){null==i&&(i=St.DEFAULT_EQUIV_TOLERANCE);const s=e.numAtoms,l=e.numBonds;if(s!=n.numAtoms||l!=n.numBonds)return!1;const r=i*i;let o=e.boundary(),a=n.boundary();if(Math.abs(o.minX()-a.minX())>i)return!1;if(Math.abs(o.minY()-a.minY())>i)return!1;if(Math.abs(o.maxX()-a.maxX())>i)return!1;if(Math.abs(o.maxY()-a.maxY())>i)return!1;let h=Dt.arrayAtomX(e),u=Dt.arrayAtomY(e),m=Dt.arrayAtomX(n),c=Dt.arrayAtomY(n),d=t.numberArray(0,s),f=t.booleanArray(!1,s);for(let t=0;t<s;t++){let i=-1;if(q(h[t]-m[t],u[t]-c[t])<r&&(i=t),i<0){let e=Number.MAX_VALUE;for(let n=0;n<s;n++)if(!f[n]){let s=q(h[t]-m[n],u[t]-c[n]);s<e&&(e=s,i=n)}if(i<0||e>r)return!1}if(d[t]=i+1,f[i]=!0,e.atomElement(t+1)!=n.atomElement(i+1))return!1;if(e.atomCharge(t+1)!=n.atomCharge(i+1))return!1;if(e.atomUnpaired(t+1)!=n.atomUnpaired(i+1))return!1;if(e.atomHExplicit(t+1)!=n.atomHExplicit(i+1)&&e.atomHExplicit(t+1)!=qt.HEXPLICIT_UNKNOWN&&n.atomHExplicit(i+1)!=qt.HEXPLICIT_UNKNOWN)return!1}for(let t=1;t<=l;t++){let i=e.bondFrom(t),s=e.bondTo(t),l=d[i-1],r=d[s-1],o=n.findBond(l,r);if(0==o)return!1;if(e.bondOrder(t)!=n.bondOrder(o)||e.bondType(t)!=n.bondType(o))return!1;if(n.bondFrom(o)==l&&n.bondTo(o)==r);else if(n.bondType(o)==qt.BONDTYPE_INCLINED||n.bondType(o)==qt.BONDTYPE_DECLINED||n.bondFrom(o)!=r||n.bondTo(o)!=l)return!1}return!0}static sketchMappable(t,e,n){null==n&&(n=St.DEFAULT_EQUIV_TOLERANCE);let i=t.boundary(),s=e.boundary(),l=i.minX()-s.minX(),r=i.minY()-s.minY();if(Math.abs(l)>.1*n||Math.abs(r)>.1*n){e=e.clone();for(let t=1;t<=e.numAtoms;t++)e.setAtomPos(t,e.atomX(t)+l,e.atomY(t)+r)}return St.sketchEquivalent(t,e,n)}static atomBondAngles(t,e,n){null==n&&(n=t.atomAdjList(e));let i=[],s=t.atomX(e),l=t.atomY(e);for(let e of n)i.push(Math.atan2(t.atomY(e)-l,t.atomX(e)-s));return i}static overlapsAtom(t,e,n,i){const s=i*i;for(let i=1;i<=t.numAtoms;i++)if(q(t.atomX(i)-e,t.atomY(i)-n)<s)return!0;return!1}static overlappingAtomMask(e,n){null==n&&(n=St.OVERLAP_THRESHOLD);const i=e.numAtoms;let s,l,r=e.boundary();r.w>r.h?(s=Dt.arrayAtomX(e),l=Dt.arrayAtomY(e)):(s=Dt.arrayAtomY(e),l=Dt.arrayAtomX(e));let o=t.booleanArray(!1,i),a=t.idxSort(s);const h=n*n;for(let t=1;t<i-1;t++){for(let e=t-1;e>=0;e--){let i=s[a[t]]-s[a[e]];if(i>n)break;q(i,l[a[t]]-l[a[e]])<h&&(o[a[t]]=!0,o[a[e]]=!0)}for(let e=t+1;e<i;e++){let i=s[a[e]]-s[a[t]];if(i>n)break;q(i,l[a[e]]-l[a[t]])<h&&(o[a[t]]=!0,o[a[e]]=!0)}}return o}static overlappingAtomList(e,n){return null==n&&(n=St.OVERLAP_THRESHOLD),t.add(t.maskIdx(St.overlappingAtomMask(e,n)),1)}static congestionPoint(t,e,n,i){null==i&&(i=1e-5);let s=0,l=t.numAtoms;for(let r=1;r<=l;r++)s+=1/(i+q(t.atomX(r)-e,t.atomY(r)-n));return s}static congestionMolecule(t,e){null==e&&(e=1e-5);let n=0;const i=t.numAtoms;let s=Dt.arrayAtomX(t),l=Dt.arrayAtomY(t);for(let t=0;t<i-1;t++)for(let r=t+1;r<i;r++)n+=1/(e+q(s[t]-s[r],l[t]-l[r]));return n}static translateMolecule(t,e,n){for(let i=1;i<=t.numAtoms;i++)t.setAtomPos(i,t.atomX(i)+e,t.atomY(i)+n)}static rotateMolecule(t,e,n,i){if(null==n||null==i){let e=t.boundary();n=e.midX(),i=e.midY()}let s=Math.cos(e),l=Math.sin(e);for(let e=1;e<=t.numAtoms;e++){let r=t.atomX(e)-n,o=t.atomY(e)-i;t.setAtomPos(e,n+r*s-o*l,i+r*l+o*s)}}static rotateBond(t,e,n,i){if(i=P(i),Math.abs(i)<.1*_)return;let s=Q.fromMolecule(t);s.isolateNode(e-1);let l=s.calculateComponents(),r=t.atomX(e),o=t.atomY(e),a=Math.cos(i),h=Math.sin(i);for(let e=1;e<=t.numAtoms;e++)if(l[e-1]==l[n-1]){let n=t.atomX(e)-r,i=t.atomY(e)-o;t.setAtomPos(e,r+n*a-i*h,o+n*h+i*a)}}static rotateAtoms(t,e,n,i,s){let l=Math.cos(s),r=Math.sin(s);for(let s=1;s<=t.numAtoms;s++)if(e[s-1]){let e=t.atomX(s)-n,o=t.atomY(s)-i;t.setAtomPos(s,n+e*l-o*r,i+e*r+o*l)}}static angleNeighbours(e,n){let i=e.atomAdjList(n);if(i.length<=1)return null;let s=[];for(let t=0;t<i.length;t++)s.push(Math.atan2(e.atomY(i[t])-e.atomY(n),e.atomX(i[t])-e.atomX(n)));if(2==i.length)return z(s[1],s[0])>0?i:[i[1],i[0]];let l=t.idxSort(s);return t.idxGet(i,l)}static mergeAtoms(t,e,n){for(let i=1;i<=t.numBonds;i++)t.bondFrom(i)==e&&t.setBondFrom(i,n),t.bondTo(i)==e&&t.setBondTo(i,n);t.deleteAtomAndBonds(e)}static normaliseBondDistances(e){const n=e.numBonds;if(0==n)return;let i=[];for(let t=1;t<=n;t++){let n=e.bondFrom(t),s=e.bondTo(t);i.push(q(e.atomX(s)-e.atomX(n),e.atomY(s)-e.atomY(n)))}t.sort(i);let s=1&~n?.5*(Math.sqrt(i[n>>1])+Math.sqrt(i[(n>>1)-1])):Math.sqrt(i[n>>1]);if(s<.1||s>.9*qt.IDEALBOND&&s<1.1*qt.IDEALBOND)return;let l=e.boundary(),r=l.midX(),o=l.midY(),a=qt.IDEALBOND/s;for(let t=e.numAtoms;t>=1;t--){let n=(e.atomX(t)-r)*a+r,i=(e.atomY(t)-o)*a+o;e.setAtomPos(t,n,i)}}static centreMolecule(e){if(Dt.isBlank(e))return;let n=Dt.arrayAtomX(e),i=Dt.arrayAtomY(e),s=n.length,l=1/s,r=t.sum(n)*l,o=t.sum(i)*l,a=Number.POSITIVE_INFINITY,h=0,u=0;for(let t=0;t<s;t++){let e=q(n[t]-r,i[t]-o);e<a&&(h=-n[t],u=-i[t],a=e)}for(let t=0;t<s;t++)e.setAtomPos(t+1,n[t]+h,i[t]+u)}static mirrorImage(t){t=t.clone();for(let e=1;e<=t.numAtoms;e++)t.setAtomX(e,-t.atomX(e));for(let e=1;e<=t.numBonds;e++)t.bondType(e)==qt.BONDTYPE_DECLINED?t.setBondType(e,qt.BONDTYPE_INCLINED):t.bondType(e)==qt.BONDTYPE_INCLINED&&t.setBondType(e,qt.BONDTYPE_DECLINED);return t}static alignOrientFlip(t,e,n,i){if(e.length<2||e.length!=i.length)throw"Invalid mapping indices.";let s=t.atomX(e[0]),l=t.atomY(e[0]);St.translateMolecule(n,s-n.atomX(i[0]),l-n.atomY(i[0]));const r=e.length-1;let o=[],a=[],h=0,u=0;for(let m=0;m<r;m++){o.push(Math.atan2(t.atomY(e[m+1])-l,t.atomX(e[m+1])-s)),a.push(Math.atan2(n.atomY(i[m+1])-l,n.atomX(i[m+1])-s));let r=z(o[m],a[m]),c=z(o[m],-a[m]);r<-175*_&&h>0?r+=I:r>175*_&&h<0&&(r-=I),c<-175*_&&u>0?c+=I:c>175*_&&u<0&&(c-=I),h+=r,u+=c}if(r>1){let t=1/r;h*=t,u*=t}let m=0,c=0;for(let t=0;t<r;t++)m+=Math.abs(z(o[t],a[t]+h)),c+=Math.abs(z(o[t],-a[t]+u));if(c<m){for(let t=1;t<=n.numAtoms;t++)n.setAtomY(t,2*l-n.atomY(t));for(let t=1;t<=n.numBonds;t++)n.bondType(t)==qt.BONDTYPE_DECLINED?n.setBondType(t,qt.BONDTYPE_INCLINED):n.bondType(t)==qt.BONDTYPE_INCLINED&&n.setBondType(t,qt.BONDTYPE_DECLINED);St.rotateMolecule(n,s,l,u)}else St.rotateMolecule(n,s,l,h)}static atomIsWeirdLinear(t,e){let n=t.atomAdjBonds(e);if(2!=n.length)return!1;for(let e=0;e<n.length;e++)if(3==t.bondOrder(n[e]))return!1;let i=t.atomAdjList(e),s=Math.atan2(t.atomY(i[0])-t.atomY(e),t.atomX(i[0])-t.atomX(e)),l=Math.atan2(t.atomY(i[1])-t.atomY(e),t.atomX(i[1])-t.atomX(e));return Math.abs(z(s,l))>=175*_}}var wt;St.OVERLAP_THRESHOLD=.2,St.OVERLAP_THRESHOLD_SQ=St.OVERLAP_THRESHOLD*St.OVERLAP_THRESHOLD,St.DEFAULT_EQUIV_TOLERANCE=.2,function(t){t[t.Linear=0]="Linear",t[t.Bent=1]="Bent",t[t.Trigonal=2]="Trigonal",t[t.Tetra1=3]="Tetra1",t[t.Tetra2=4]="Tetra2",t[t.SqPlan=5]="SqPlan",t[t.BasePyram=6]="BasePyram",t[t.TrigBip=7]="TrigBip",t[t.Octa1=8]="Octa1",t[t.Octa2=9]="Octa2"}(wt||(wt={}));class Ot{static placeNewAtom(t,e){let n=t.boundary(),i=n.maxX()+qt.IDEALBOND,s=n.maxY();return t.addAtom(e,i,s)}static placeNewFragment(e,n){if(0==n.numAtoms)return;let i=[1,0,-1,1,-1,1,0,-1],s=[1,1,1,0,0,-1,-1,-1],l=t.numberArray(0,8),r=t.numberArray(0,8),o=t.numberArray(0,8),a=e.boundary(),h=n.boundary();for(let t=0;t<8;t++){let u=i[t],m=s[t];l[t]=0==t||3==t||5==t?a.minX()-h.maxX():2==t||4==t||7==t?a.maxX()-h.minX():.5*(a.minX()+a.maxX()-h.minX()-h.maxX()),r[t]=5==t||6==t||7==t?a.minY()-h.maxY():0==t||1==t||2==t?a.maxY()-h.minY():.5*(a.minY()+a.maxY()-h.minY()-h.maxY()),l[t]-=u,r[t]-=m,o[t]=Ot.fragPosScore(e,n,l[t],r[t]),u*=.25,m*=.25;for(let i=100;i>0;i--){let i=Ot.fragPosScore(e,n,l[t]+u,r[t]+m);if(i<=o[t])break;o[t]=i,l[t]+=u,r[t]+=m}for(let a=100;a>0;a--)for(let a=0;a<8;a++){u=.1*i[a],m=.1*s[a];let h=Ot.fragPosScore(e,n,l[t]+u,r[t]+m);if(h<=o[t])break;o[t]=h,l[t]+=u,r[t]+=m}}let u=0;for(let t=1;t<8;t++)o[t]>o[u]&&(u=t);n=n.clone();for(let t=1;t<=n.numAtoms;t++)n.setAtomPos(t,n.atomX(t)+l[u],n.atomY(t)+r[u]);e.append(n)}static fragPosScore(t,e,n,i){let s=0;for(let l=1;l<=t.numAtoms;l++)for(let r=1;r<=e.numAtoms;r++){let o=e.atomX(r)+n-t.atomX(l),a=e.atomY(r)+i-t.atomY(l),h=o*o+a*a;if(h<1)return 0;s+=1/h}let l=t.boundary(),r=e.boundary(),o=Math.min(r.minX()+n,l.minX()),a=Math.max(r.maxX()+n,l.maxX()),h=Math.min(r.minY()+i,l.minY()),u=Math.max(r.maxY()+i,l.maxY()),m=Math.max(1,a-o),c=Math.max(1,u-h);return s/Math.max(m/c,c/m)}static mergeOverlappingAtoms(t){return Ot.mergeFragmentsDiv(t,0)}static mergeFragmentsDiv(e,n){const i=e.numAtoms;let s=St.overlappingAtomMask(e),l=t.booleanArray(!1,i),r=Dt.arrayAtomX(e),o=Dt.arrayAtomY(e),a=[];for(let t=0;t<i;t++)a.push(t+1);let h=n,u=n+1;0==n&&(h=i);for(let t=1;t<=h;t++)if(s[t-1]&&!l[t-1]){0==n&&(u=t+1);for(let n=u;n<=i;n++)if(s[n-1]&&!l[n-1]){if(q(r[t-1]-r[n-1],o[t-1]-o[n-1])>St.OVERLAP_THRESHOLD_SQ)continue;let i=n,s=t,h=[0,0];for(let i=0;i<2;i++){let s=0==i?t:n;h[i]=("C"==e.atomElement(s)?0:1)+("X"==e.atomElement(s)?-100:0)+(0!=e.atomCharge(s)?1:0)+(0!=e.atomUnpaired(s)?1:0)+(e.atomIsotope(s)!=qt.ISOTOPE_NATURAL?1:0)+(e.atomHExplicit(s)!=qt.HEXPLICIT_UNKNOWN?1:0)+(Dt.hasAbbrev(e,s)?1e3:0)}h[1]>h[0]&&(i=t,s=n);for(let t=1;t<=e.numBonds;t++)e.bondFrom(t)==i&&e.setBondFrom(t,s),e.bondTo(t)==i&&e.setBondTo(t,s);l[i-1]=!0,a[i-1]=s}}for(let t=i;t>=1;t--)if(l[t-1]){t<=n&&n--,e.deleteAtomAndBonds(t);for(let e=0;e<i;e++)a[e]>t&&a[e]--}for(let t=e.numAtoms;t>n;t--)if("X"==e.atomElement(t)){e.deleteAtomAndBonds(t);for(let e=0;e<i;e++)a[e]>t&&a[e]--}return Dt.removeDuplicateBonds(e),a}static mergeFragmentsMask(e,n){let i=t.booleanArray(!1,e.numAtoms),s=e.numAtoms,l=Dt.arrayAtomX(e),r=Dt.arrayAtomY(e);for(let o=1;o<=s;o++)if(n[o-1])for(let a=1;a<=s;a++)if(!n[a-1]&&!i[a-1]&&q(l[o-1]-l[a-1],r[o-1]-r[a-1])<St.OVERLAP_THRESHOLD_SQ){let n=a,s=o;"C"==e.atomElement(o)&&"C"!=e.atomElement(a)&&"X"!=e.atomElement(a)&&([n,s]=[o,a]),e.atomHExplicit(s)==qt.HEXPLICIT_UNKNOWN&&e.setAtomHExplicit(s,e.atomHExplicit(n)),e.setAtomUnpaired(s,e.atomUnpaired(s)+e.atomUnpaired(n)),e.setAtomCharge(s,e.atomCharge(s)+e.atomCharge(n)),e.setAtomExtra(s,t.concat(e.atomExtra(n),e.atomExtra(s)));for(let t=1;t<=e.numBonds;t++)e.bondFrom(t)==n&&e.setBondFrom(t,s),e.bondTo(t)==n&&e.setBondTo(t,s);i[n-1]=!0}for(let t=i.length;t>=1;t--)i[t-1]&&e.deleteAtomAndBonds(t);Dt.removeDuplicateBonds(e)}static matchAngleGeometry(e,n){if(n.length<=1)return!0;let i=Ot.GEOM_ANGLES[e],s=t.numberArray(0,n.length),l=t.booleanArray(!1,i.length);for(let e=0;e<n.length;e++)for(let e=1;e>=-1;e-=2){for(let t=0;t<n.length;t++)s[t]=(n[t]-n[0])*e;t.setTo(l,!1);let r=!0;for(let t=0;t<s.length;t++){let e=!1;for(let n=0;n<i.length;n++)if(!l[n]&&Math.abs(z(s[t],i[n]))<3*_){l[n]=!0,e=!0;break}if(!e){r=!1;break}}if(r)return!0}return!1}static primeDirections(t,e){let n=Ot.calculateNewBondAngles(t,e,1),i=Ot.exitVectors(t,e);return h.uniqueAngles(n.concat(i),2*_)}static exitVectors(t,e){let n=t.atomAdjList(e),i=n.length;if(0==i)return[0,90*_,180*_,-90*_];if(1==i)return[];let s=[],l=h.sortAngles(St.atomBondAngles(t,e,n));for(let t=0;t<i;t++){let e=t<i-1?t+1:0;s.push(P(l[t]+.5*F(l[e],l[t])))}return s}static calculateNewBondAngles(t,e,n){let i=t.atomAdjList(e);if(0==i.length){let n=t.atomicNumber(e);return s.ELEMENT_BLOCKS[n]<=2?[0,90*_,180*_,-90*_]:[90*_,-90*_,30*_,150*_,210*_,-30*_,180*_,0*_]}let l=Ot.guessAtomGeometry(t,e,n),r=St.atomBondAngles(t,e,i);for(let t=0;t<l.length;t++){let e=Ot.mapAngleSubstituent(l[t],r);if(null!=e)return e}return[]}static guessAtomGeometry(e,n,i){let l=e.atomAdjList(n),r=l.length,o=e.atomicNumber(n),a=s.ELEMENT_BLOCKS[o],h=s.ELEMENT_ROWS[o],u=e.atomElement(n),m=[],c=[],d=[],f=!0;for(let t=0;t<r;t++)m.push(e.bondOrder(e.findBond(n,l[t]))),c.push(e.atomicNumber(l[t])),d.push(200*m[t]+c[t]),1!=m[t]&&(f=!0);for(let e=0;e<r-1;)d[e]>d[e+1]?(t.swap(l,e,e+1),t.swap(m,e,e+1),t.swap(c,e,e+1),t.swap(d,e,e+1),e>0&&e--):e++;let p=St.atomBondAngles(e,n,l);if(1==r){if("C"==u||"N"==u){if(2==m[0]&&2==i)return[wt.Linear];if(3==m[0]&&1==i||1==m[0]&&3==i)return[wt.Linear]}return a>2?[wt.Octa1,wt.Octa2]:0==i||"C"!=u&&"N"!=u&&"O"!=u?[wt.Trigonal,wt.Linear]:[wt.Trigonal]}if(2==r&&Math.abs(z(p[0],p[1]))>=175*_)return a<=2?[wt.SqPlan]:[wt.Octa1,wt.Octa2];let C=[];0==a?C=[wt.Trigonal,wt.SqPlan]:1==a?C=[wt.Trigonal,wt.SqPlan,wt.Octa1,wt.Octa2]:2==a?(C.push(wt.Trigonal),"C"==u&&f?(C.push(wt.Tetra1),C.push(wt.Tetra2),C.push(wt.SqPlan)):("C"!=u||f)&&(h<=3?(C.push(wt.Tetra1),C.push(wt.Tetra2),C.push(wt.SqPlan)):(C.push(wt.Tetra1),C.push(wt.Tetra2),C.push(wt.SqPlan),C.push(wt.Octa1),C.push(wt.Octa2)))):(C.push(wt.Octa1),C.push(wt.Octa2));for(let t=C.length-1;t>=0;t--)Ot.matchAngleGeometry(C[t],p)||C.splice(t,1);return C}static mapAngleSubstituent(e,n){let i=Ot.GEOM_ANGLES[e];const s=n.length,l=i.length;if(s>=l)return null;if(0==s)return i.slice(0);let r=[];for(let e=0;e<s;e++)for(let o=0;o<l;o++)for(let a=1;a>=-1;a-=2){let h=[];for(let t=0;t<l;t++)h.push(P(n[e]+a*(i[t]-i[o])));let u=t.booleanArray(!1,l),m=0;for(let t=0;t<l;t++)if(!u[t])for(let e=0;e<s;e++)if(Math.abs(z(h[t],n[e]))<3*_){u[t]=!0,m++;break}if(m==s)for(let t=0;t<l;t++)u[t]||r.push(h[t])}if(0==r.length)return null;r=h.sortAngles(r);for(let t=0;t<r.length-1;t++){let e=r[t],n=z(r[t+1],e);Math.abs(n)<5*_&&(r[t]=e+.5*n,r.splice(t+1,1),t--)}return r}static refitAtomGeometry(e,n,i){let s=Ot.GEOM_ANGLES[i],l=s.length,r=e.atomAdjList(n),o=r.length;if(o<=1||o>l)return null;let a=St.atomBondAngles(e,n,r),h=t.booleanArray(!1,o),u=!0;for(let t=0;t<o;t++)h[t]=e.bondInRing(e.findBond(n,r[t])),h[t]||(u=!1);if(u)return null;let m=null,c=0,d=Dt.calculateWalkWeight(e,n);for(let e=0;e<l;e++)for(let n=0;n<o;n++)for(let i=1;i>=-1;i-=2){let u=t.numberArray(0,o),f=t.booleanArray(!1,l);for(let t=0;t<o;t++){let r=-1,o=0;for(let h=0;h<l;h++)if(!f[h]){let l=P(s[h]*i-s[e]+a[n]),m=Math.abs(z(l,a[t]));(r<0||m<o)&&(r=h,o=m,u[t]=l)}f[r]=!0}let p=!1;for(let t=0;t<o;t++)if(h[t]&&Math.abs(z(u[t],a[t]))>2*_){p=!0;break}if(p)continue;let C=0;for(let t=0;t<o;t++)C+=d[r[t]-1]*Math.abs(z(u[t],a[t]));(null==m||C<c)&&(m=u,c=C)}if(null==m)return null;let f=!0;for(let t=0;t<o;t++)if(Math.abs(z(m[t],a[t]))>2*_){f=!1;break}if(f)return null;e=e.clone();for(let t=0;t<o;t++)h[t]||St.rotateBond(e,n,r[t],m[t]-a[t]);return e}static switchAtomGeometry(e,n,i,s){let l=0,r=0,o=0,a=0,h=e.atomAdjList(n),u=St.atomBondAngles(e,n,h),m=t.numberArray(0,u.length-1),c=e.atomX(n),d=e.atomY(n);for(let t=0;t<i.length;t++){let n=h.indexOf(i[t]),f=u[n];for(let t=0,e=0;t<h.length;t++)t!=n&&(m[e++]=u[t]);let p=N(e.atomX(i[t])-c,e.atomY(i[t])-d);for(let n=0;n<s.length;n++){if(h.length>=Ot.GEOM_ANGLES[s[n]].length)continue;let u=Ot.mapAngleSubstituent(s[n],m);if(null!=u)for(let n=0;n<u.length;n++){let s=z(u[n],f);if(!(Math.abs(s)<3*_)&&(s<0&&(s+=I),0==l||s<r-2*_||s<r+2*_&&i[t]<l)){let h=c+p*Math.cos(u[n]),m=d+p*Math.sin(u[n]);if(0!=St.atomAtPoint(e,h,m))continue;l=i[t],r=s,o=h,a=m}}break}}return 0==l?null:((e=e.clone()).setAtomPos(l,o,a),e)}static pickAtomsToConnect(t,e){if(e.length<2)return null;if(2==e.length)return t.findBond(e[0],e[1])>0?null:e;const n=O(qt.IDEALBOND+.1);let i=Number.MAX_VALUE,s=0,l=0,r=[];for(let o=0;o<e.length-1;o++)for(let a=o+1;a<e.length;a++){if(t.findBond(e[o],e[a])>0)continue;let h=q(t.atomX(e[o])-t.atomX(e[a]),t.atomY(e[o])-t.atomY(e[a]));h<n?(r.push(e[o]),r.push(e[a])):h<i&&(i=h,s=e[o],l=e[a])}return 0==r.length&&0!=s&&(r.push(s),r.push(l)),0==r.length?null:r}static pickNewAtomDirection(t,e,n){if(1==n.length)return n[0];let i=n[0],s=Number.MAX_VALUE;for(let l=0;l<n.length;l++){let r=t.atomX(e)+qt.IDEALBOND*Math.cos(n[l]),o=t.atomY(e)+qt.IDEALBOND*Math.sin(n[l]),a=St.congestionPoint(t,r,o);a>s||(St.overlapsAtom(t,r,o,.2)&&(a+=1e5),a<s&&(i=n[l],s=a))}return i}static joinOverlappingAtoms(e,n){e=e.clone(),n=n.slice(0);const i=e.numAtoms;let s=Dt.arrayAtomX(e),l=Dt.arrayAtomY(e),r=[],o=[],a=[];for(let t=0;t<i-1;t++)if(n[t]){let h=[t+1],u=s[t],m=l[t];for(let r=t+1;r<i;r++)if(n[r]){if(q(s[r]-s[t],l[r]-l[t])>St.OVERLAP_THRESHOLD_SQ)continue;h.push(r+1),u+=s[r],m+=l[r];let n=e.atomAdjBonds(r+1);for(let i=0;i<n.length;i++)e.bondFrom(n[i])==r+1?e.setBondFrom(n[i],t+1):e.bondTo(n[i])==r+1&&e.setBondTo(n[i],t+1)}if(1==h.length)continue;r.push(h),o.push(u/h.length),a.push(m/h.length)}if(0==r.length)return null;let h=t.booleanArray(!0,i);for(let t=0;t<r.length;t++){let n=r[t];e.setAtomPos(n[0],o[t],a[t]);for(let t=1;t<n.length;t++)h[n[t]-1]=!1}return e=Dt.subgraphMask(e,h),Dt.removeDuplicateBonds(e),e}static moveToEdge(t,e,n,i){let s=!1,l=!1,r=0,o=0,a=0,h=0,u=0,m=0,c=0,d=0;for(let n=1;n<=t.numAtoms;n++){let i=t.atomX(n),f=t.atomY(n);e[n-1]?((!s||i<r)&&(r=i),(!s||f<o)&&(o=f),(!s||i>a)&&(a=i),(!s||f>h)&&(h=f),s=!0):((!l||i<u)&&(u=i),(!l||f<m)&&(m=f),(!l||i>c)&&(c=i),(!l||f>d)&&(d=f),l=!0)}const f=.9;if(n<0&&0==i&&a<=u-f||n>0&&0==i&&r>=c+f||0==n&&i<0&&h<=m-f||0==n&&i>0&&o>=d+f)return null;t=t.clone();let p=0,C=0;n<0&&(p=u-a-1),n>0&&(p=c-r+1),i<0&&(C=m-h-1),i>0&&(C=d-o+1);for(let n=1;n<=t.numAtoms;n++)e[n-1]&&t.setAtomPos(n,t.atomX(n)+p,t.atomY(n)+C);return t}static placeAdditionalHydrogens(t,e,n){let i=t.numAtoms;const s=t.atomX(e),l=t.atomY(e);let r=t.atomAdjList(e);if(2==r.length&&2==n){const n=Math.atan2(t.atomY(r[0])-l,t.atomX(r[0])-s),o=Math.atan2(t.atomY(r[1])-l,t.atomX(r[1])-s);if(Math.abs(z(n,o))<170*_){let r=.5*(n+o)+Math.PI,a=r-30*_,h=r+30*_;return t.addAtom("H",s+qt.IDEALBOND*Math.cos(a),l+qt.IDEALBOND*Math.sin(a)),t.addAtom("H",s+qt.IDEALBOND*Math.cos(h),l+qt.IDEALBOND*Math.sin(h)),t.addBond(e,i+1,1),void t.addBond(e,i+2,1)}}if(1==r.length&&3==n){let n=Math.atan2(t.atomY(r[0])-l,t.atomX(r[0])-s),o=n+90*_,a=n+180*_,h=n+270*_;return t.addAtom("H",s+qt.IDEALBOND*Math.cos(o),l+qt.IDEALBOND*Math.sin(o)),t.addAtom("H",s+qt.IDEALBOND*Math.cos(a),l+qt.IDEALBOND*Math.sin(a)),t.addAtom("H",s+qt.IDEALBOND*Math.cos(h),l+qt.IDEALBOND*Math.sin(h)),t.addBond(e,i+1,1),t.addBond(e,i+2,1),void t.addBond(e,i+3,1)}let o=Ot.pickNewAtomDirection(t,e,Ot.primeDirections(t,e));t.addAtom("H",s+qt.IDEALBOND*Math.cos(o),l+qt.IDEALBOND*Math.sin(o)),t.addBond(e,i+1,1),n>1&&Ot.placeAdditionalHydrogens(t,e,n-1)}static allViableDirections(t,e,n){if(0==t.atomAdjCount(e)){let t=[];for(let e=0;e<12;e++)t.push(30*_);return t}let i=t.atomAdjList(e),s=Ot.exitVectors(t,e),l=Ot.guessAtomGeometry(t,e,n);1==i.length&&l.indexOf(wt.Linear)<0&&l.push(wt.Linear);let r=St.atomBondAngles(t,e,i);for(let t of l){let e=Ot.mapAngleSubstituent(t,r);if(null!=e)for(let t of e)s.push(t)}return h.uniqueAngles(s,2*_)}static proposeNewRing(t,e,n,i,s,l,r){let o=0==l&&0==s?.5*Math.PI:Math.atan2(l,s);if(r){const t=30*_;o=Math.round(o/t)*t}return Ot.positionSimpleRing(t,e,n,i,o)}static proposeAtomRing(e,n,i,s,l){let r=[],o=e.atomX(i),a=e.atomY(i);if(0==e.atomAdjCount(i))for(let t=0;t<12;t++)r.push(I*t/12);else if(1==e.atomAdjCount(i)){let t=e.atomAdjList(i)[0];r.push(P(Math.atan2(e.atomY(t)-a,e.atomX(t)-o)+Math.PI))}else{let n=[];for(let t of e.atomAdjList(i))n.push(Math.atan2(e.atomY(t)-a,e.atomX(t)-o));n=function(e){if(null==e||e.length<2)return e;e=e.slice(0);for(let t=0;t<e.length;t++)e[t]=P(e[t]);for(t.sort(e);;){let t=e[e.length-1],n=e[0],i=e[1];if(z(n,t)<=z(i,n))break;for(let t=e.length-1;t>0;t--)e[t]=e[t-1];e[0]=t}return e}(n);for(let t=0;t<n.length;t++){let e=n[t],i=n[t<n.length-1?t+1:0];r.push(e+.5*F(i,e))}}let h=Math.atan2(l,s),u=0,m=Number.MAX_VALUE;for(let t of r){let e=Math.abs(z(t,h));e<m&&(u=t,m=e)}return Ot.positionSimpleRing(e,n,e.atomX(i),e.atomY(i),u)}static proposeBondRing(t,e,n,i,s){let l=t.bondFrom(n),r=t.bondTo(n),o=t.atomX(r)-t.atomX(l),a=t.atomY(r)-t.atomY(l),h=i*a-s*o,u=h>0?-90*_:90*_,m=Math.atan2(a,o)+u,c=I/e,d=qt.IDEALBOND/(2*Math.sin(.5*c)),f=d*Math.cos(.5*c),p=.5*(t.atomX(l)+t.atomX(r))+f*Math.cos(m),C=.5*(t.atomY(l)+t.atomY(r))+f*Math.sin(m),g=[],A=[];for(let t=0;t<e;t++){let e=m-Math.PI+(t-.5)*c;g.push(p+Math.cos(e)*d),A.push(C+Math.sin(e)*d)}let[b,y]=h<0?[l,r]:[r,l];return g[0]=t.atomX(b),A[0]=t.atomY(b),g[1]=t.atomX(y),A[1]=t.atomY(y),[g,A]}static positionSimpleRing(t,e,n,i,s){let l=I/e,r=qt.IDEALBOND/(2*Math.sin(.5*l)),o=n+r*Math.cos(s),a=i+r*Math.sin(s),h=[],u=[];for(let t=0;t<e;t++){let e=s-Math.PI+t*l;h.push(o+Math.cos(e)*r),u.push(a+Math.sin(e)*r)}return[h,u]}static guidelineSprouts(e,n){let i=[],s=[],l=[];for(let i=0;i<3;i++){s.push(Ot.allViableDirections(e,n,i+1)),l.push([i+1]);for(let e=0;e<i;e++)null!=s[e]&&t.equals(s[i],s[e])&&(s[i]=null,l[e].push(i+1))}const r=e.atomX(n),o=e.atomY(n);for(let t=0;t<3;t++)if(null!=s[t]){let e={atom:n,orders:l[t],x:[],y:[]};for(let n=0;n<s[t].length;n++)e.x[n]=r+Math.cos(s[t][n])*qt.IDEALBOND,e.y[n]=o+Math.sin(s[t][n])*qt.IDEALBOND;i.push(e)}return i}}Ot.GEOM_ANGLES=[[0,180*_],[0,120*_],[0,120*_,240*_],[0,90*_,150*_,240*_],[0,120*_,180*_,240*_],[0,90*_,180*_,270*_],[0,90*_,150*_,210*_,270*_],[0,60*_,90*_,180*_,210*_],[0,60*_,120*_,180*_,240*_,300*_],[0,45*_,90*_,180*_,225*_,270*_]];class Dt{static isBlank(t){return null==t||0==t.numAtoms}static notBlank(t){return null!=t&&t.numAtoms>0}static orBlank(t){return null==t?new qt:t}static hasAnyAbbrev(t){for(let e=1;e<=t.numAtoms;e++)if(Dt.hasAbbrev(t,e))return!0;return!1}static hasAbbrev(t,e){let n=t.atomExtra(e);for(let t=0;t<(null==n?0:n.length);t++)if(n[t].startsWith("a"))return!0;return!1}static getAbbrev(t,e){let n=t.atomExtra(e);for(let t=0;t<(null!=n?n.length:0);t++)if(n[t].startsWith("a"))return qt.fromString(n[t].substring(1));return null}static setAbbrev(t,e,n){let i=0;for(let t=1;t<=n.numAtoms;t++)if(n.atomElement(t)==Dt.ABBREV_ATTACHMENT){i=t;break}if(0==i)throw"No attachment points indicated.";if(i>=2&&(n=n.clone()).swapAtoms(i,1),t.atomAdjList(e).length>1)throw"Setting abbreviation for non-terminal atom.";if(1==n.atomAdjCount(1)&&t.atomAdjCount(e)>0){let i=t.findBond(e,t.atomAdjList(e)[0]),s=n.findBond(1,n.atomAdjList(1)[0]);t.setBondOrder(i,n.bondOrder(s))}let s=t.atomExtra(e),l=-1;for(let t=0;t<(null!=s?s.length:0);t++)if(s[t].startsWith("a")){l=t;break}l<0&&(l=s.push(null)-1),s[l]="a"+n.toString(),t.setAtomExtra(e,s)}static validateAbbrevs(t){for(let e=1;e<=t.numAtoms;e++)Dt.hasAbbrev(t,e)&&(t.atomAdjCount(e)>1&&Dt.clearAbbrev(t,e),0!=t.atomCharge(e)&&t.setAtomCharge(e,0),0!=t.atomUnpaired(e)&&t.setAtomUnpaired(e,0),0!=t.atomIsotope(e)&&t.setAtomIsotope(e,qt.ISOTOPE_NATURAL),t.atomHExplicit(e)!=qt.HEXPLICIT_UNKNOWN&&t.setAtomHExplicit(e,qt.HEXPLICIT_UNKNOWN))}static convertToAbbrev(t,e,n){let i=this.convertToAbbrevIndex(t,e,n);return i?i[0]:null}static convertToAbbrevIndex(e,n,i){let s=0,l=null;for(let t=1;t<=e.numBonds;t++){let i=e.bondFrom(t),r=e.bondTo(t),o=0;if(n[i-1]&&!n[r-1]?(o=i,l=ut.getPolymerExtensions(e,r)):!n[i-1]&&n[r-1]&&(o=r,l=ut.getPolymerExtensions(e,i)),0!=o){if(s>0&&o!=s)return[null,null];s=o}}if(0==s)return[null,null];let r=e.numAtoms,o=0,a=0,h=t.booleanArray(!1,r),u=t.booleanArray(!1,r);for(let t=0;t<r;t++)h[t]=n[t],u[t]=!n[t]||t+1==s,h[t]&&t+1<=s&&o++,u[t]&&t+1<=s&&a++;let m=qt.BONDTYPE_NORMAL,c=0;for(let t of e.atomAdjList(s))if(!n[t-1]){if(0!=c){m=qt.BONDTYPE_NORMAL;break}let n=e.findBond(s,t);e.bondFrom(n)==s&&(m=e.bondType(n)),c++}let d=Dt.subgraphMask(e,u);d.setAtomElement(a,Dt.ABBREV_ATTACHMENT),d.setAtomCharge(a,0),d.setAtomUnpaired(a,0),d.setAtomHExplicit(a,qt.HEXPLICIT_UNKNOWN);for(let t=1;t<=d.numAtoms;t++)d.setAtomMapNum(t,0);d.setAtomExtra(a,[]),d.setAtomTransient(a,[]);let f=d.atomAdjList(a),p=0,C=0,g=1/f.length,A=1;for(let t=0;t<f.length;t++){p+=d.atomX(f[t]),C+=d.atomY(f[t]);let e=d.findBond(a,f[t]);0==t?A=d.bondOrder(e):A!=d.bondOrder(e)&&(A=1)}p*=g,C*=g,a>1&&d.swapAtoms(a,1);let b=Dt.subgraphMask(e,h),y=b.addAtom(i,p,C);return b.addBond(o,y,A,m),Dt.setAbbrev(b,y,d),null!=l&&b.setAtomExtra(y,t.concat(b.atomExtra(y),l)),[b,y]}static expandAbbrevs(t,e){for(;;){let n=!1;for(let i=1;i<=t.numAtoms;i++)Dt.hasAbbrev(t,i)&&(Dt.expandOneAbbrev(t,i,e)&&(n=!0),i--);if(!n)break}}static expandedAbbrevs(t){return this.hasAnyAbbrev(t)?(t=t.clone(),this.expandAbbrevs(t,!0),t):t}static expandOneAbbrev(t,e,n){let i=Dt.getAbbrev(t,e);if(null==i)return null;if(1!=t.atomAdjCount(e)||0==i.numAtoms)return Dt.clearAbbrev(t,e),null;let s=t.atomMapNum(e);for(let t=1;t<=i.numAtoms;t++)i.setAtomMapNum(t,0);if(s>0)for(let t of i.atomAdjList(1))i.setAtomMapNum(t,s);return Dt.expandOneAbbrevFrag(t,e,i,n)}static expandOneAbbrevFrag(e,n,i,s){let l=ut.getPolymerExtensions(e,n),r=1==e.atomAdjCount(n)?e.atomAdjList(n)[0]:0,o=e.findBond(n,r),a=qt.BONDTYPE_NORMAL;if(o>0&&(a=e.bondType(o),e.bondFrom(o)==r||a!=qt.BONDTYPE_INCLINED&&a!=qt.BONDTYPE_DECLINED||(a=qt.BONDTYPE_NORMAL)),s){let t=e.atomX(n)-e.atomX(r),s=e.atomY(n)-e.atomY(r),l=i.atomAdjList(1),o=0,a=0,h=1/l.length;for(let t=0;t<l.length;t++)o+=i.atomX(l[t])-i.atomX(1),a+=i.atomY(l[t])-i.atomY(1);o*=h,a*=h;let u=Math.atan2(s,t),m=Math.atan2(a,o);St.rotateMolecule(i,u-m),St.translateMolecule(i,e.atomX(r)-i.atomX(1),e.atomY(r)-i.atomY(1))}if(null!=l)for(let e=1;e<=i.numAtoms;e++){let n=i.atomExtra(e);for(let t=n.length-1;t>=0;t--)l.indexOf(n[t])>=0&&n.splice(t,1);i.setAtomExtra(e,t.concat(n,l))}let h=e.numAtoms+1;e.append(i);for(let t=1;t<=e.numBonds;t++)e.bondFrom(t)==h?(e.setBondFrom(t,r),e.setBondType(t,a)):e.bondTo(t)==h&&(e.setBondFromTo(t,r,e.bondFrom(t)),e.setBondType(t,a));let u=t.booleanArray(!1,e.numAtoms);for(let t=u.length-i.numAtoms;t<u.length;t++)u[t]=!0;return e.deleteAtomAndBonds(h),e.deleteAtomAndBonds(n),u.splice(h-1,1),u.splice(n-1,1),u}static clearAbbrev(t,e){let n=t.atomExtra(e);for(let i=0;i<(null!=n?n.length:0);i++)if(n[i].startsWith("a"))return n.splice(i,1),t.setAtomExtra(e,n),void t.setAtomElement(e,"C")}static setAtomElement(t,e,n){t.atomElement(e)!=n&&(this.clearAbbrev(t,e),t.setAtomElement(e,n))}static addBond(t,e,n,i,s){null==s&&(s=qt.BONDTYPE_NORMAL),t.atomAdjCount(e)>=1&&this.clearAbbrev(t,e),t.atomAdjCount(n)>=1&&this.clearAbbrev(t,n);let l=t.findBond(e,n);return l>0&&t.deleteBond(l),t.addBond(e,n,i,s)}static subgraphMask(t,e){let n=[],i=0;for(let s=0;s<t.numAtoms;s++)e[s]?n.push(++i):n.push(0);if(0==i)return new qt;if(i==t.numAtoms)return t.clone();let s=new qt;s.keepTransient=!0;for(let n=1;n<=t.numAtoms;n++)if(e[n-1]){let e=s.addAtom(t.atomElement(n),t.atomX(n),t.atomY(n),t.atomCharge(n),t.atomUnpaired(n));s.setAtomIsotope(e,t.atomIsotope(n)),s.setAtomHExplicit(e,t.atomHExplicit(n)),s.setAtomMapNum(e,t.atomMapNum(n)),s.setAtomExtra(e,t.atomExtra(n)),s.setAtomTransient(e,t.atomTransient(n))}for(let e=1;e<=t.numBonds;e++){let i=n[t.bondFrom(e)-1],l=n[t.bondTo(e)-1];if(i>0&&l>0){let n=s.addBond(i,l,t.bondOrder(e),t.bondType(e));s.setBondExtra(n,t.bondExtra(e)),s.setBondTransient(n,t.bondTransient(e))}}return s.keepTransient=t.keepTransient,s}static subgraphIndex(e,n){let i=t.numberArray(0,e.numAtoms);for(let t=0;t<i.length;t++)i[t]=0;for(let t=0;t<n.length;t++)i[n[t]-1]=t+1;let s=new qt;s.keepTransient=!0;for(let t=0;t<n.length;t++){let i=s.addAtom(e.atomElement(n[t]),e.atomX(n[t]),e.atomY(n[t]),e.atomCharge(n[t]),e.atomUnpaired(n[t]));s.setAtomIsotope(i,e.atomIsotope(n[t])),s.setAtomHExplicit(i,e.atomHExplicit(n[t])),s.setAtomMapNum(i,e.atomMapNum(n[t])),s.setAtomExtra(i,e.atomExtra(n[t])),s.setAtomTransient(i,e.atomTransient(n[t]))}for(let t=1;t<=e.numBonds;t++){let n=i[e.bondFrom(t)-1],l=i[e.bondTo(t)-1];if(n>0&&l>0){let i=s.addBond(n,l,e.bondOrder(t),e.bondType(t));s.setBondExtra(i,e.bondExtra(t)),s.setBondTransient(i,e.bondTransient(t))}}return s.keepTransient=e.keepTransient,s}static subgraphWithAttachments(t,e){let n=e.slice(0);for(let i=1;i<=t.numBonds;i++){let s=t.bondFrom(i)-1,l=t.bondTo(i)-1;e[s]&&!e[l]?n[l]=!0:e[l]&&!e[s]&&(n[s]=!0)}let i=t.clone();for(let t=1;t<=i.numAtoms;t++)n[t-1]&&!e[t-1]&&(i.setAtomElement(t,"X"),i.setAtomCharge(t,0),i.setAtomUnpaired(t,0),i.setAtomHExplicit(t,qt.HEXPLICIT_UNKNOWN),i.setAtomExtra(t,[]));return Dt.subgraphMask(i,n)}static append(t,e){let n=t.boundary(),i=e.boundary(),s=n.maxX()+qt.IDEALBOND-i.minX(),l=.5*(n.minY()+n.maxY()-i.minY()-i.maxY()),r=t.numAtoms;t.append(e);for(let e=r+1;e<=t.numAtoms;e++)t.setAtomPos(e,t.atomX(e)+s,t.atomY(e)+l)}static deleteAtoms(e,n){let i=t.booleanArray(!0,e.numAtoms);for(let t=0;t<n.length;t++)i[n[t]-1]=!1;return Dt.subgraphMask(e,i)}static componentList(e){if(0==e.numAtoms)return null;let n=Q.fromMolecule(e).calculateComponentGroups();for(let e of n)t.addTo(e,1);return n}static getAtomSides(e,n){let i=Q.fromMolecule(e),s=i.calculateComponents(),l=[];for(let t=0;t<s.length;t++)l.push(s[t]==s[n-1]);l[n-1]=!1;let r=t.maskIdx(l);i.keepNodesMask(l),s=i.calculateComponents();let o=t.max(s),a=[];for(let t=0;t<o;t++)a.push([n]);for(let t=0;t<s.length;t++)a[s[t]-1].push(r[t]+1);return a}static getBondSides(e,n){let i=e.bondFrom(n),s=e.bondTo(n),l=e.bondInRing(n),r=Q.fromMolecule(e),o=r.calculateComponents(),a=[];for(let t=0;t<o.length;t++)a.push(o[t]==o[i-1]);l?(a[i-1]=!1,a[s-1]=!1):r.removeEdge(i-1,s-1);let h=t.maskIdx(a);r.keepNodesMask(a),o=r.calculateComponents();let u=t.max(o),m=[];for(let t=0;t<u;t++)m[t]=[],l&&(m[t].push(i),m[t].push(s));for(let t=0;t<o.length;t++)m[o[t]-1].push(h[t]+1);return m}static arrayAtomX(e){let n=t.numberArray(0,e.numAtoms);for(let t=n.length-1;t>=0;t--)n[t]=e.atomX(t+1);return n}static arrayAtomY(e){let n=t.numberArray(0,e.numAtoms);for(let t=n.length-1;t>=0;t--)n[t]=e.atomY(t+1);return n}static arrayAtomMapNum(e){let n=t.numberArray(0,e.numAtoms);for(let t=n.length-1;t>=0;t--)n[t]=e.atomMapNum(t+1);return n}static molecularFormula(e,n){let i="",s="",l="",r="";1==n?[i,s]=["{","}","{^","}"]:n instanceof Array&&(i=n[0],s=n[1],l=n[2],r=n[3]);for(let t=1;t<=e.numAtoms;t++)if(Dt.hasAbbrev(e,t)){e=e.clone(),Dt.expandAbbrevs(e,!1);break}let o=0,a=0,h=t.stringArray("",e.numAtoms);for(let t=1;t<=e.numAtoms;t++){a+=e.atomHydrogens(t);let n=e.atomElement(t);e.atomIsotope(t)!=qt.ISOTOPE_NATURAL&&(n=l+e.atomIsotope(t)+r+n),"C"==n?o++:"H"==n?a++:h[t-1]=n}h.sort();let u="";o>0&&(u+="C"),o>1&&(n&&(u+=i),u+=o,n&&(u+=s)),a>0&&(u+="H"),a>1&&(n&&(u+=i),u+=a,n&&(u+=s));for(let t=0;t<h.length;t++)if(h[t].length>0){let e=1;for(;t+1<h.length&&h[t]==h[t+1];t++)e++;u+=h[t],e>1&&(n&&(u+=i),u+=e,n&&(u+=s))}return u.toString()}static molecularWeight(t){for(let e=1;e<=t.numAtoms;e++)if(Dt.hasAbbrev(t,e)){t=t.clone(),Dt.expandAbbrevs(t,!1);break}let e=0;for(let n=1;n<=t.numAtoms;n++){e+=t.atomHydrogens(n)*s.NATURAL_ATOMIC_WEIGHTS[1];let i=t.atomIsotope(n);if(i!=qt.ISOTOPE_NATURAL){e+=i;continue}let l=qt.elementAtomicNumber(t.atomElement(n));l>0&&l<s.NATURAL_ATOMIC_WEIGHTS.length&&(e+=s.NATURAL_ATOMIC_WEIGHTS[l])}return e}static removeDuplicateBonds(e){let n=[];for(let t=1;t<=e.numBonds;t++){let i=Math.min(e.bondFrom(t),e.bondTo(t))*e.numAtoms+Math.max(e.bondFrom(t),e.bondTo(t));n.push(i)}let i=t.idxSort(n),s=t.booleanArray(!1,i.length),l=0;for(;l<i.length;){let t=1;for(;l+t<i.length&&n[i[l]]==n[i[l+t]];)t++;let r=l;for(let n=l+1;n<l+t;n++){let t=i[r]+1,s=i[n]+1,l=e.bondFrom(t),o=e.bondTo(t),a=e.atomElement(l),h=e.atomElement(o),u=0,m=0;if("C"==a||"N"==a?u=4:"O"==a&&(u=3),"C"==h||"N"==h?m=4:"O"==h&&(m=3),u>0||m>0){let i=0,a=0,h=0,c=0;for(let n=1;n<=e.numBonds;n++)n==s||e.bondFrom(n)!=l&&e.bondTo(n)!=l||(i+=e.bondOrder(n)),n==s||e.bondFrom(n)!=o&&e.bondTo(n)!=o||(a+=e.bondOrder(n)),n==t||e.bondFrom(n)!=l&&e.bondTo(n)!=l||(h+=e.bondOrder(n)),n==t||e.bondFrom(n)!=o&&e.bondTo(n)!=o||(c+=e.bondOrder(n));let d=0,f=0;if(u>0&&i>u&&d++,m>0&&a>m&&d++,u>0&&h>u&&f++,m>0&&c>m&&f++,d<f)continue;if(d>f){r=n;continue}}let c=2*e.bondOrder(t),d=2*e.bondOrder(s);c+=(0==c?4:0)+(e.bondType(t)!=qt.BONDTYPE_NORMAL?1:0),d+=(0==d?4:0)+(e.bondType(s)!=qt.BONDTYPE_NORMAL?1:0),d>c&&(r=n)}s[i[r]]=!0,l+=t}for(let t=e.numBonds;t>=1;t--)s[t-1]&&e.bondFrom(t)!=e.bondTo(t)||e.deleteBond(t)}static calculateWalkWeight(e,n){let i=0,s=Q.fromMolecule(e).calculateComponents();for(let t=0;t<s.length;t++)s[t]==s[n-1]&&i++;let l=t.numberArray(1,e.numAtoms),r=t.numberArray(0,e.numAtoms);for(l[n-1]=0;i>0;i--){for(let t=0;t<e.numAtoms;t++)r[t]=l[t];for(let t=1;t<=e.numBonds;t++){let n=e.bondFrom(t)-1,i=e.bondTo(t)-1;l[n]+=.1*r[i],l[i]+=.1*r[n]}l[n-1]=0}return l}static totalHydrogens(t,e){let n=t.atomHydrogens(e),i=t.atomAdjList(e);for(let e=0;e<i.length;e++)"H"==t.atomElement(i[e])&&n++;return n}static stripHydrogens(t,e=!1){for(let n=t.numAtoms;n>=1;n--)(e&&"H"==t.atomElement(n)||this.boringHydrogen(t,n))&&t.deleteAtomAndBonds(n)}static boringHydrogen(e,n){if("H"!=e.atomElement(n))return!1;if(0!=e.atomCharge(n)||0!=e.atomUnpaired(n))return!1;if(e.atomIsotope(n)!=qt.ISOTOPE_NATURAL)return!1;if(t.notBlank(e.atomExtra(n))||t.notBlank(e.atomTransient(n)))return!1;if(1!=e.atomAdjCount(n))return!1;let i=e.atomAdjList(n)[0];if("H"==e.atomElement(i))return!1;let s=e.atomAdjBonds(n)[0];return 1==e.bondOrder(s)&&e.bondType(s)==qt.BONDTYPE_NORMAL&&e.atomHExplicit(i)==qt.HEXPLICIT_UNKNOWN&&!(qt.HYVALENCE_EL.indexOf(e.atomElement(i))<0)}static createHydrogens(t,e){null==e&&(e=!1);let n=t.numAtoms;for(let i=1;i<=n;i++){let n=t.atomHydrogens(i);if(0!=n)if(t.atomHExplicit(i)!=qt.HEXPLICIT_UNKNOWN&&t.setAtomHExplicit(i,0),e)Ot.placeAdditionalHydrogens(t,i,n);else for(;n>0;n--){let e=t.addAtom("H",t.atomX(i),t.atomY(i));t.addBond(i,e,1)}}return t.numAtoms-n}static atomVec3(t,e){return t.is3D()?[t.atomX(e),t.atomY(e),t.atomZ(e)]:[t.atomX(e),t.atomY(e),0]}static atomOxidationState(t,e){if(0==t.atomAdjCount(e))return null;if(this.hasAbbrev(t,e))return null;let n=t.atomicNumber(e);if(0==n)return null;let i=n==s.ELEMENT_H||2==s.ELEMENT_BLOCKS[n],l=t.atomHydrogens(e)+(i?-t.atomCharge(e):t.atomCharge(e));for(let n of t.atomAdjBonds(e)){let s=t.bondOrder(n),r=t.bondOther(n,e),o=["O","S","Se","Te"].includes(t.atomElement(r));l+=i||o?s:s%2}return n==s.ELEMENT_H&&1==l||n==s.ELEMENT_B&&3==l||n==s.ELEMENT_C&&4==l||n==s.ELEMENT_N&&3==l||n==s.ELEMENT_O&&2==l?null:(n!=s.ELEMENT_S||2!=l&&4!=l&&6!=l)&&(n!=s.ELEMENT_P||3!=l&&5!=l)&&(n!=s.ELEMENT_F&&n!=s.ELEMENT_Cl&&n!=s.ELEMENT_Br&&n!=s.ELEMENT_I||1!=l)?l:null}static oxidationStateText(t){if(0==t)return"0";let e=t<0?"-":"",n=Math.abs(t);return 1==n?e+="I":2==n?e+="II":3==n?e+="III":4==n?e+="IV":5==n?e+="V":6==n?e+="VI":7==n?e+="VII":8==n?e+="VIII":9==n?e+="IX":10==n?e+="X":11==n?e+="XI":12==n?e+="XII":e=(t>0?"+":"")+t,e}}Dt.TEMPLATE_ATTACHMENT="X",Dt.ABBREV_ATTACHMENT="*";var Rt=n(896),Bt=n(606);class It{generate(t){return e=this,n=void 0,s=function*(){throw new Error("InChI not implemented.")},new((i=void 0)||(i=Promise))((function(t,l){function r(t){try{a(s.next(t))}catch(t){l(t)}}function o(t){try{a(s.throw(t))}catch(t){l(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(t){t(n)}))).then(r,o)}a((s=s.apply(e,n||[])).next())}));var e,n,i,s}}let kt=null,_t=null;class Lt extends It{constructor(){if(super(),this.available=!1,this.inchiPath=kt,this.inchiPath||(this.inchiPath=(0,Bt.getGlobal)("INCHI_EXEC")),this.inchiPath)try{Rt.accessSync(this.inchiPath,Rt.constants.X_OK),this.available=!0}catch(t){}}static hasExecutable(){return!!kt}static setExecutable(t){kt=t}static isAvailable(){return null!=this.nativeMolfileToInChI||(_t||(_t=new Lt),_t.available)}generate(t){return e=this,i=void 0,l=function*(){t=t.clone(),Dt.expandAbbrevs(t,!0);for(let e=1;e<=t.numBonds;e++)(t.bondOrder(e)<1||t.bondOrder(e)>3)&&t.setBondOrder(e,1);let e=new bt(t);e.enhancedFields=!1;let i=e.write();if(null!=Lt.nativeMolfileToInChI)return{inchi:yield Lt.nativeMolfileToInChI(i,"-AuxNone -NoLabels"),inchiKey:null};if(_t||(_t=new Lt),!_t.available)throw"InChI executable is not available.";const s=n(317);let l=_t.inchiPath.replace(/ /g,"\\ "),r=s.spawnSync(l,["-STDIO","-AuxNone","-NoLabels","-Key"],{input:i}).stdout.toString(),o=r.split("\n");if(o.length<2||!o[0].startsWith("InChI="))throw console.log("InChI command returned result:\n"+r),console.log("Molecule:\n"+t),console.log("MDL Molfile:\n"+i),"Invalid returned by InChI generator: "+r;return{inchi:o[0],inchiKey:o[1]}},new((s=void 0)||(s=Promise))((function(t,n){function r(t){try{a(l.next(t))}catch(t){n(t)}}function o(t){try{a(l.throw(t))}catch(t){n(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(r,o)}a((l=l.apply(e,i||[])).next())}));var e,i,s,l}}Lt.nativeMolfileToInChI=null;class Pt{constructor(t){if(t)this.data=H(t);else{t={name:"default",pointScale:20,resolutionDPI:100,fontSize:.65,lineSize:.075,bondSep:.2,defaultPadding:.2,foreground:0,background:16777215,atomCols:new Array(112)};for(let e=0;e<=111;e++)t.atomCols[e]=0;this.data=t}}clone(){return new Pt(this.data)}static defaultBlackOnWhite(t){let e=new Pt;return t&&(e.data.pointScale=t),e}static defaultWhiteOnBlack(t){let e=new Pt;t&&(e.data.pointScale=t),e.data.foreground=16777215,e.data.background=0;for(let t=0;t<=111;t++)e.data.atomCols[t]=16777215;return e}static defaultColourOnWhite(t){let e=Pt.defaultBlackOnWhite(t);return e.data.atomCols[0]=4210752,e.data.atomCols[1]=8421504,e.data.atomCols[6]=0,e.data.atomCols[7]=255,e.data.atomCols[8]=16711680,e.data.atomCols[9]=16744576,e.data.atomCols[15]=16744448,e.data.atomCols[16]=8421376,e.data.atomCols[17]=49152,e.data.atomCols[35]=12599296,e}static defaultColourOnBlack(t){let e=Pt.defaultWhiteOnBlack(t);return e.data.atomCols[0]=10526880,e.data.atomCols[1]=8421504,e.data.atomCols[6]=16777215,e.data.atomCols[7]=4210943,e.data.atomCols[8]=16728128,e.data.atomCols[9]=16744576,e.data.atomCols[15]=16744448,e.data.atomCols[16]=16776960,e.data.atomCols[17]=4259648,e.data.atomCols[35]=16744512,e}static defaultPrintedPublication(){let t=Pt.defaultBlackOnWhite(9.6);return t.data.resolutionDPI=600,t.data.fontSize=.8,t.data.bondSep=.27,t.data.lineSize=.0625,t}}class zt{constructor(){this.colAtom={},this.colBond={},this.dottedRectOutline={},this.dottedBondCross={},this.hideAtoms=new Set,this.hideBonds=new Set,this.atomFrameDotSz=[],this.atomFrameCol=[],this.atomCircleSz=[],this.atomCircleCol=[],this.atomDecoText=[],this.atomDecoCol=[],this.atomDecoSize=[],this.bondDecoText=[],this.bondDecoCol=[],this.bondDecoSize=[],this.overlapAtoms=[]}}var Ft,Xt;!function(t){t.Atom="A",t.Bond="B",t.Artifact="R",t.Effect="E"}(Ft||(Ft={}));class Ut{constructor(t){this.mol=t,this.bondMask=null,this.crossings=[]}calculateCrossings(){const{mol:e,bondMask:n,crossings:i}=this;let s=e.numAtoms,l=e.numBonds,r=t.booleanArray(!1,s);for(let t=1;t<l;t++){if(n&&!n[t-1])continue;let s=e.atomX(e.bondFrom(t)),o=e.atomY(e.bondFrom(t)),a=e.atomX(e.bondTo(t)),u=e.atomY(e.bondTo(t)),m=a-s,c=u-o;s+=.001*m,o+=.001*c,a-=.001*m,u-=.001*c;for(let d=t+1;d<=l;d++){if(n&&!n[d-1])continue;let l=e.atomX(e.bondFrom(d)),f=e.atomY(e.bondFrom(d)),p=e.atomX(e.bondTo(d)),C=e.atomY(e.bondTo(d));m=p-l,c=C-f,l+=.001*m,f+=.001*c,p-=.001*m,C-=.001*c,h.doLineSegsIntersect(s,o,a,u,l,f,p,C)&&(i.push({bond1:t,bond2:d,higher:0}),r[e.bondFrom(t)-1]=!0,r[e.bondTo(t)-1]=!0,r[e.bondFrom(d)-1]=!0,r[e.bondTo(d)-1]=!0)}}if(0==i.length)return;let o=new Set;for(let t=1;t<=s;t++){let n=e.atomRingBlock(t);n>0&&o.add(n)}for(let t=1;t<=s;t++)if(!r[t-1]){let n=e.atomRingBlock(t);n>0&&o.has(n)&&(r[t-1]=!0)}let a=this.connectMaskedComponents(r),u=Q.fromMoleculeMask(e,a),m=u.calculateComponentGroups();for(let t=0;t<m.length;t++){for(let e=0;e<m[t].length;e++)m[t][e]=u.getIndex(m[t][e]);this.embedComponent(m[t])}}connectMaskedComponents(e){const{mol:n}=this;let i=t.duplicate(e),s=Q.fromMolecule(n),l=n.numAtoms,r=n.numBonds,o=t.booleanArray(!1,l);for(;;){let t=!1;for(let e=1;e<=r;e++){let r=n.bondFrom(e),a=n.bondTo(e),h=0;if(i[r-1]&&!i[a-1])h=a;else{if(!i[a-1]||i[r-1])continue;h=r}if(o[h-1])continue;let u=s.clone();u.removeEdge(r-1,a-1);let m=u.calculateComponents(),c=!1;for(let t=0;t<l;t++)if(i[t]&&m[t]==m[h-1]){c=!0;break}c?(i[h-1]=!0,t=!0):o[h-1]=!0}if(!t)break}return i}embedComponent(e){const{mol:n,crossings:i}=this;let s=n.numAtoms,l=e.length,r=t.booleanArray(!1,s);for(let t=0;t<l;t++)r[e[t]-1]=!0;let o=t.numberArray(0,l),a=new Array(l);if(this.seedFromInternalWedges(e,r,o));else if(this.seedFromExternalWedges(e,r,o));else if(this.seedFromPerspective(e,r,o));else if(!this.seedFromDensity(e,r,o))return;let h=this.normaliseHeights(o);for(;h<l;){this.expandOutward(o,a,e,r);let t=this.normaliseHeights(a);if(t==h)break;for(let t=0;t<l;t++)o[t]=a[t];h=t}for(let t of i)r[n.bondFrom(t.bond1)-1]&&this.updateCrossing(t,e,o)}seedFromInternalWedges(t,e,n){const{mol:i}=this;let s=i.numBonds,l=!1;for(let r=1;r<=s;r++){let s=i.bondType(r);if(s!=qt.BONDTYPE_INCLINED&&s!=qt.BONDTYPE_DECLINED)continue;let o=i.bondFrom(r),a=i.bondTo(r);e[o-1]&&e[a-1]&&(s==qt.BONDTYPE_INCLINED?(n[t.indexOf(o)]-=.5,n[t.indexOf(a)]+=.5):(n[t.indexOf(o)]+=.5,n[t.indexOf(a)]-=.5),l=!0)}return l}seedFromExternalWedges(t,e,n){const{mol:i}=this;let s=i.numBonds,l=!1;for(let r=1;r<=s;r++){let s=i.bondType(r);if(s!=qt.BONDTYPE_INCLINED&&s!=qt.BONDTYPE_DECLINED)continue;let o=i.bondFrom(r),a=i.bondTo(r);e[o-1]?(n[t.indexOf(o)]+=s==qt.BONDTYPE_INCLINED?1:-1,l=!0):e[a-1]&&(n[t.indexOf(a)]+=s==qt.BONDTYPE_INCLINED?-1:1,l=!0)}return l}seedFromPerspective(t,e,n){const{mol:i}=this;let s=i.numBonds,l=0,r=0,o=0,a=0;for(let t=1;t<=s;t++){let n=i.bondFrom(t),s=i.bondTo(t);if(!e[n-1]||!e[s-1])continue;let h=N(i.atomX(n)-i.atomX(s),i.atomY(n)-i.atomY(s));l+=h,o++,h>r&&(r=h,a=t)}return 0!=o&&0!=a&&(l/=o,!(r<1.02*l||(n[t.indexOf(i.bondFrom(a))]=1,n[t.indexOf(i.bondTo(a))]=1,0)))}seedFromDensity(t,e,n){const{mol:i}=this;let s=0,l=0;for(let e=0;e<t.length;e++){let n=i.atomX(t[e]),r=i.atomY(t[e]),o=0;for(let s=0;s<t.length;s++)e!=s&&(o+=1/(.001+q(i.atomX(t[s])-n,i.atomY(t[s])-r)));o>l&&(s=t[e],l=o)}return 0!=s&&(n[t.indexOf(s)]=1,!0)}normaliseHeights(e){t.addTo(e,-t.min(e));let n=1e-6*t.max(e),i=t.idxSort(e),s=-1,l=0;for(let t=0;t<i.length;t++)(s<0||Math.abs(s-e[i[t]])>n)&&l++,s=e[i[t]],e[i[t]]=l;return t.addTo(e,-.5*(1+t.max(e))),l}expandOutward(t,e,n,i){const{mol:s}=this;let l=n.length;for(let n=0;n<l;n++)e[n]=t[n];for(let r=0;r<l;r++){let l=s.atomAdjList(n[r]);for(let s=0;s<l.length;s++)i[l[s]-1]&&(e[n.indexOf(l[s])]+=.1*t[r])}}updateCrossing(t,e,n){const{mol:i}=this;let s=i.bondFrom(t.bond1),l=i.bondTo(t.bond1),r=i.bondFrom(t.bond2),o=i.bondTo(t.bond2),a=e.indexOf(s),u=e.indexOf(l),m=e.indexOf(r),c=e.indexOf(o);if(a<0||u<0||m<0||c<0)return;let d=i.atomX(s),f=i.atomY(s),p=i.atomX(l),C=i.atomY(l),g=i.atomX(r),A=i.atomY(r),b=i.atomX(o),y=i.atomY(o),E=h.lineIntersect(d,f,p,C,g,A,b,y),x=p-d,M=C-f,v=b-g,T=y-A,N=Math.abs(x)>Math.abs(M)?(E[0]-d)/x:(E[1]-f)/M,q=Math.abs(v)>Math.abs(T)?(E[0]-g)/v:(E[1]-A)/T;if(N<0||N>1||q<0||q>1)return;let S=n[a],w=n[u],O=n[m],D=S+N*(w-S),R=O+q*(n[c]-O);t.higher=D>R?1:2}}class Yt{constructor(t,e,n){this.px=t,this.py=e,this.margin=n,this.theta=0,this.stop=!1,this.hashKey=JSON.stringify([this.px,this.py])}calculate(){this.lookupCache()||(this.setupParameters(),this.stop||(this.currentScore=this.calculateScore(this.cx,this.cy,this.rw,this.rh),this.coarseDiscovery(),this.fineImprovement(),this.theta=-this.theta,this.saveCache()))}getSpline(){return h.createBezierEllipse(this.cx,this.cy,this.rw,this.rh,this.theta)}lookupCache(){let t=this.hashKey,e=Yt.cacheMap.get(t);if(e){this.cx=e.cx,this.cy=e.cy,this.rw=e.rw,this.rh=e.rh,this.theta=e.theta;const{cacheVal:n}=Yt;for(let e=n.length-1;e>=0;e--)if(n[e].hashKey==t){e<n.length-1&&(n.push(n[e]),n.splice(e,1));break}return!0}return!1}saveCache(){let t=this.hashKey;const{cacheVal:e,cacheMap:n}=Yt;for(e.push(this),n.set(t,this);e.length>1e3;)n.delete(e[0].hashKey),e.splice(0)}setupParameters(){const e=this.psz=this.px.length,n=this.invpsz=1/e;this.cx=t.sum(this.px)*n,this.cy=t.sum(this.py)*n;let i=new Array(e),s=new Array(e);for(let t=0;t<e;t++)i[t]=Math.atan2(this.py[t]-this.cy,this.px[t]-this.cx),s[t]=N(this.px[t]-this.cx,this.py[t]-this.cy);let l=t.idxSort(i);this.px=t.idxGet(this.px,l),this.py=t.idxGet(this.py,l),i=t.idxGet(i,l),s=t.idxGet(s,l);let r=new Array(e),o=new Array(e);const a=(i,s,l)=>{for(let t=0;t<e;t++)r[t]=s[t]*Math.cos(i[t]+l),o[t]=s[t]*Math.sin(i[t]+l);let a=t.sum(r)*n,h=t.sum(o)*n,u=0,m=0;for(let t=0;t<e;t++)u+=O(r[t]-a),m+=Math.abs(o[t]-h);return m/(1+u)};let h=Number.POSITIVE_INFINITY;for(let t=0;t<360;t++){let e=t*_,n=a(i,s,e);n<h&&(this.theta=e,h=n)}for(let t=-1;t<=1;t+=.05){let e=this.theta+t*_,n=a(i,s,e);n<h&&(this.theta=e,h=n)}for(let t=0;t<e;t++)this.px[t]=this.cx+s[t]*Math.cos(i[t]+this.theta),this.py[t]=this.cy+s[t]*Math.sin(i[t]+this.theta);this.cx=t.sum(this.px)*n,this.cy=t.sum(this.py)*n,this.rw=this.rh=1}coarseDiscovery(){const{margin:t}=this;let e=.1*t,n=.5*e;const i=[{dx:-1,dy:0,dw:0,dh:0},{dx:1,dy:0,dw:0,dh:0},{dx:0,dy:-1,dw:0,dh:0},{dx:0,dy:1,dw:0,dh:0},{dx:0,dy:0,dw:-1,dh:0},{dx:0,dy:0,dw:1,dh:0},{dx:0,dy:0,dw:0,dh:-1},{dx:0,dy:0,dw:0,dh:1}];for(let t=0;t<1e3;t++){let t=!1,s=this.currentScore,l=this.cx,r=this.cy,o=this.rw,a=this.rh;for(let h of i){let i=this.cx+h.dx*e,u=this.cy+h.dy*e,m=this.rw+h.dw*n,c=this.rh+h.dh*n,d=this.calculateScore(i,u,m,c);d>s&&!R(d,s)&&(t=!0,s=d,l=i,r=u,o=m,a=c)}if(!t)break;this.currentScore=s,this.cx=l,this.cy=r,this.rw=o,this.rh=a}}fineImprovement(){const{margin:t}=this;let e=.1*t,n=.5*e;const i=2/3;for(let t=0;t<20;t++){let s=!1,l=this.currentScore,r=this.cx,o=this.cy,a=this.rw,h=this.rh;for(let t=-1;t<=1;t++){let i=this.cx+t*e;for(let u=-1;u<=1;u++){let m=this.cy+u*e;for(let e=-1;e<=1;e++){let c=this.rw+e*n;for(let d=-1;d<=1;d++){let f=this.rh+d*n;if(0==t&&0==u&&0==e&&0==d)continue;let p=this.calculateScore(i,m,c,f);p>l&&!R(p,l)&&(s=!0,l=p,r=i,o=m,a=c,h=f)}}}}s?(this.currentScore=l,this.cx=r,this.cy=o,this.rw=a,this.rh=h):(t++,e*=i,n*=i)}}calculateScore(e,n,i,s){const{px:l,py:r,margin:o}=this,a=l.length;let u=I/24,m=t.numberArray(Number.POSITIVE_INFINITY,a);for(let t=0;t<24;t++){let c=t*u,d=Math.cos(c),f=Math.sin(c),p=i*d*1-s*f*0,C=i*d*0+s*f*1,g=N(p,C)+o,A=Math.atan2(C,p),b=e+g*Math.cos(A),y=n+g*Math.sin(A);for(let t=0;t<a;t++){let i=t==a-1?0:t+1;if(h.doLineSegsIntersect(e,n,b,y,l[t],r[t],l[i],r[i]))return 0}for(let t=0;t<a;t++)m[t]=Math.min(m[t],q(b-l[t],y-r[t]))}let c=0;for(let t of m)c+=1/(1+Math.sqrt(t));return i*s+c}}Yt.cacheVal=[],Yt.cacheMap=new Map;class jt{constructor(){this.UNITS_PER_EM=2048,this.INV_UNITS_PER_EM=1/this.UNITS_PER_EM,this.PANOSE_1="2 11 6 4 3 5 4 4 2 4",this.ASCENT=1638,this.DESCENT=-410,this.MISSING_HORZ=2048,this.MISSING_DATA="M256 0v1536h1536v-1536h-1536zM384 128h1280v1280h-1280v-1280z",this.ASCENT_FUDGE=.9,this.UNICODE=[" ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],this.HORIZ_ADV_X=[720,806,940,1676,1302,2204,1488,550,930,930,1302,1676,745,930,745,930,1302,1302,1302,1302,1302,1302,1302,1302,1302,1302,930,930,1676,1676,1676,1117,2048,1400,1404,1430,1578,1295,1177,1588,1539,862,931,1419,1140,1726,1532,1612,1235,1612,1424,1400,1262,1499,1400,2025,1403,1260,1403,930,930,930,1676,1302,1302,1230,1276,1067,1276,1220,720,1276,1296,562,705,1212,562,1992,1296,1243,1276,1276,874,1067,807,1296,1212,1676,1212,1212,1076,1300,930,1300,1676,720,806,1302,1302,1302,1302,930,1302,1302,2048,1117,1320,1676,930,2048,1302,1110,1676,1110,1110,1302,1314,1302,745,1302,1110,1117,1320,2048,2048,2048,1117,1400,1400,1400,1400,1400,1400,2016,1430,1295,1295,1295,1295,862,862,862,862,1588,1532,1612,1612,1612,1612,1612,1676,1612,1499,1499,1499,1499,1260,1240,1270,1230,1230,1230,1230,1230,1230,1956,1067,1220,1220,1220,1220,562,562,562,562,1253,1296,1243,1243,1243,1243,1243,1676,1243,1296,1296,1296,1296,1212,1276,930,1302,1302,1400,930,1538,1782,1105,1804,1543,1859,562,1400,1404,1160,1440,1295,1403,1539,1612,862,1419,1404,1726,1532,1329,1612,1539,1235,1377,1262,1260,1677,1403,1783,1676,862,1260,1276,1050,1296,562,1293,1276,1270,1212,1245,1050,937,1296,1278,562,1212,1212,1310,1212,1030,1243,1305,1280,1040,1291,1016,1293,1618,1208,1683,1666,562,1293,1243,1293,1666,1302,1489,1676,1489,1676,740,745,1676,2048,1302,1676,1676,1676,1676],this.GLYPH_DATA=["","M515 1489l-26 -1079h-170l-28 1079h224zM505 0h-204v211h204v-211z","M772 1556l-43 -579h-132l-43 579h218zM386 1556l-43 -579h-132l-43 579h218z","M1481 932h-333l-92 -376h308v-135h-343l-104 -421h-129l104 421h-270l-104 -421h-129l104 421h-298v135h333l92 376h-308v135h343l105 422h129l-105 -422h270l105 422h129l-105 -422h298v-135zM1022 934h-274l-94 -380h274z","M1160 380q0 -155 -121 -257.5t-317 -121.5v-362h-118v357q-132 1 -248 25.5t-201 63.5v198h16q19 -14 68 -40.5t95 -43.5q52 -19 121.5 -35.5t148.5 -19.5v433q-40 8 -74 15.5t-63 15.5q-163 41 -234 123.5t-71 203.5q0 148 116.5 250t325.5 119v272h118v-270 q101 -2 207 -24t178 -51v-196h-14q-75 46 -156.5 81.5t-214.5 44.5v-431q30 -5 65 -13.5t61 -13.5q149 -32 230.5 -110t81.5 -213zM604 747v413q-107 -8 -180 -58.5t-73 -140.5q0 -91 54 -137t199 -77zM971 354q0 94 -58.5 137.5t-190.5 68.5v-414q120 12 184.5 61t64.5 147 z","M884 1076q0 -224 -94.5 -333t-272.5 -109q-182 0 -275 109t-93 332q0 224 95 333t273 109q181 0 274 -110t93 -331zM1575 1489l-780 -1489h-165l780 1489h165zM2055 413q0 -224 -95 -333t-273 -109q-181 0 -274 110t-93 331q0 224 94.5 333t272.5 109q182 0 275 -109 t93 -332zM706 1076q0 172 -44.5 240t-144.5 68q-102 0 -146 -68t-44 -241t44 -240.5t146 -67.5q100 0 144.5 67.5t44.5 241.5zM1877 413q0 172 -44.5 240t-144.5 68q-102 0 -146 -68t-44 -241t44 -240.5t146 -67.5q100 0 144.5 67.5t44.5 241.5z","M792 1191q0 95 -56.5 149.5t-144.5 54.5q-92 0 -150 -61.5t-58 -150.5q0 -75 39.5 -133t170.5 -137q98 35 148.5 102.5t50.5 175.5zM986 315l-478 466q-31 -15 -62 -39.5t-62 -66.5q-28 -39 -46 -94t-18 -124q0 -146 85.5 -235.5t242.5 -89.5q93 0 184.5 45.5 t153.5 137.5zM1287 909v-96q0 -96 -25 -216t-85 -229l378 -368h-246l-229 224q-115 -142 -235 -198.5t-247 -56.5q-208 0 -345.5 121.5t-137.5 318.5q0 92 26 159t61 116q35 47 87 88.5t105 72.5q-110 72 -158.5 145t-48.5 184q0 67 26.5 127.5t79.5 110.5q50 48 130.5 78 t177.5 30q173 0 280 -87.5t107 -221.5q0 -44 -12 -99.5t-41 -99.5q-32 -49 -91 -94t-153 -77l371 -362q14 40 21 88t8 100q2 56 1.5 125t-0.5 117h195z","M386 1556l-43 -579h-136l-43 579h222z","M783 -412h-229q-177 203 -275 443t-98 541t98 541t275 443h229v-10q-81 -73 -154.5 -168.5t-136.5 -222.5q-60 -123 -97.5 -271t-37.5 -312q0 -171 36.5 -313t98.5 -270q60 -123 137 -222.5t154 -168.5v-10z","M749 572q0 -301 -98 -541t-275 -443h-229v10q77 69 154.5 168.5t136.5 222.5q62 128 98.5 270t36.5 313q0 164 -37 312t-98 271q-63 127 -136.5 222.5t-154.5 168.5v10h229q177 -203 275 -443t98 -541z","M1137 887l-64 -110l-362 213l6 -360h-129l5 360l-361 -214l-65 110l381 207l-381 207l65 110l362 -213l-6 359h129l-7 -359l363 212l64 -110l-380 -205z","M1466 572h-545v-545h-166v545h-545v160h545v545h166v-545h545v-160z","M575 285l-282 -655h-146l174 655h254z","M777 561h-624v181h624v-181z","M492 0h-239v285h239v-285z","M860 1556l-717 -1860h-173l714 1860h176z","M1167 745q0 -401 -125.5 -588.5t-389.5 -187.5q-268 0 -391.5 190t-123.5 584q0 397 125 586.5t390 189.5q268 0 391.5 -192.5t123.5 -581.5zM904 291q35 81 47.5 190.5t12.5 263.5q0 152 -12.5 264t-48.5 190q-35 77 -95.5 116t-155.5 39q-94 0 -155.5 -39t-97.5 -118 q-34 -74 -46.5 -193t-12.5 -261q0 -156 11 -261t47 -188q33 -78 93.5 -119t160.5 -41q94 0 156 39t96 118z","M1084 0h-806v152h310v998h-310v136q63 0 135 10.5t109 30.5q46 25 72.5 63.5t30.5 103.5h155v-1342h304v-152z","M1169 0h-1008v209q105 90 210.5 180t196.5 179q192 186 263 295.5t71 236.5q0 116 -76.5 181.5t-213.5 65.5q-91 0 -197 -32t-207 -98h-10v210q71 35 189.5 64t229.5 29q229 0 359 -110.5t130 -299.5q0 -85 -21.5 -158.5t-63.5 -139.5q-39 -62 -91.5 -122t-127.5 -133 q-107 -105 -221 -203.5t-213 -182.5h801v-171z","M1038 717q48 -43 79 -108t31 -168q0 -102 -37 -187t-104 -148q-75 -70 -176.5 -103.5t-222.5 -33.5q-124 0 -244 29.5t-197 64.5v209h15q85 -56 200 -93t222 -37q63 0 134 21t115 62q46 44 68.5 97t22.5 134q0 80 -25.5 132.5t-70.5 82.5q-45 31 -109 42.5t-138 11.5h-90 v166h70q152 0 242.5 63.5t90.5 185.5q0 54 -23 94.5t-64 66.5q-43 26 -92 36t-111 10q-95 0 -202 -34t-202 -96h-10v209q71 35 189.5 64.5t229.5 29.5q109 0 192 -20t150 -64q72 -48 109 -116t37 -159q0 -124 -87.5 -216.5t-206.5 -116.5v-14q48 -8 110 -33.5t105 -63.5z ","M1203 419h-221v-419h-192v419h-713v230l721 840h184v-910h221v-160zM790 579v672l-577 -672h577z","M1157 473q0 -104 -38 -199t-104 -160q-72 -70 -171.5 -107.5t-230.5 -37.5q-122 0 -235 25.5t-191 61.5v211h14q82 -52 192 -88.5t216 -36.5q71 0 137.5 20t118.5 70q44 43 66.5 103t22.5 139q0 77 -26.5 130t-73.5 85q-52 38 -126.5 53.5t-166.5 15.5q-88 0 -169.5 -12 t-140.5 -24v767h896v-175h-703v-396q43 4 88 6t78 2q121 0 212 -20.5t167 -72.5q80 -55 124 -142t44 -218z","M1191 483q0 -227 -149.5 -370.5t-366.5 -143.5q-110 0 -200 34t-159 101q-86 83 -132.5 220t-46.5 330q0 198 42.5 351t135.5 272q88 113 227 176.5t324 63.5q59 0 99 -5t81 -18v-191h-10q-28 15 -84.5 28.5t-115.5 13.5q-215 0 -343 -134.5t-149 -363.5 q84 51 165.5 77.5t188.5 26.5q95 0 167.5 -17.5t148.5 -70.5q88 -61 132.5 -154t44.5 -226zM988 475q0 93 -27.5 154t-90.5 106q-46 32 -102 42t-117 10q-85 0 -158 -20t-150 -62q-2 -22 -3 -42.5t-1 -51.5q0 -158 32.5 -249.5t89.5 -144.5q46 -44 99.5 -64.5t116.5 -20.5 q145 0 228 88.5t83 254.5z","M1173 1266l-674 -1266h-214l717 1314h-848v175h1019v-223z","M1180 415q0 -193 -150.5 -321t-378.5 -128q-242 0 -385.5 125t-143.5 320q0 124 72 224.5t203 159.5v6q-120 64 -177.5 140t-57.5 190q0 168 138 280t351 112q223 0 356 -107t133 -272q0 -101 -63 -198.5t-185 -152.5v-6q140 -60 214 -148t74 -224zM943 1142 q0 107 -82.5 170.5t-210.5 63.5q-126 0 -206.5 -60t-80.5 -162q0 -72 40.5 -124.5t122.5 -93.5q37 -18 106.5 -47t135.5 -48q99 66 137 137t38 164zM974 396q0 92 -40.5 147.5t-158.5 111.5q-47 22 -103 41t-149 53q-90 -49 -144.5 -133t-54.5 -190q0 -135 93 -223t236 -88 q146 0 233.5 75t87.5 206z","M1167 834q0 -195 -44.5 -354t-134.5 -271q-91 -114 -228 -176t-322 -62q-52 0 -98 5.5t-82 17.5v191h10q29 -15 82 -28.5t118 -13.5q221 0 346.5 132.5t145.5 365.5q-93 -56 -175 -80t-179 -24q-92 0 -166.5 18t-149.5 70q-88 61 -132.5 155t-44.5 225q0 228 150 371 t366 143q108 0 200 -33.5t161 -100.5q85 -83 131 -213.5t46 -337.5zM965 877q0 155 -32 249t-88 146q-47 45 -101 64.5t-117 19.5q-144 0 -227.5 -90t-83.5 -253q0 -95 27 -155t91 -105q45 -31 99 -41.5t120 -10.5q78 0 158 21t150 61q1 21 2.5 41.5t1.5 52.5z","M585 832h-239v285h239v-285zM585 0h-239v285h239v-285z","M585 832h-239v285h239v-285zM658 285l-282 -655h-146l174 655h254z","M1408 77l-1154 513v124l1154 513v-180l-910 -395l910 -395v-180z","M1431 782h-1186v160h1186v-160zM1431 362h-1186v160h1186v-160z","M1422 590l-1154 -513v180l910 395l-910 395v180l1154 -513v-124z","M1005 1139q0 -98 -35 -174.5t-92 -135.5q-56 -57 -129 -107t-155 -97v-225h-179v305q65 37 140.5 81t123.5 89q58 52 90 107.5t32 141.5q0 113 -76.5 168.5t-197.5 55.5q-108 0 -204.5 -34t-152.5 -69h-10v204q70 27 177.5 48.5t203.5 21.5q215 0 339.5 -104.5 t124.5 -275.5zM610 0h-204v211h204v-211z","M1870 663q0 -139 -40.5 -269t-115.5 -237h-440l-27 116q-74 -60 -142 -92t-156 -32q-168 0 -268.5 127t-100.5 355q0 227 123 362t294 135q73 0 129 -16.5t121 -49.5v48h159v-842h243q42 75 63.5 187.5t21.5 201.5q0 164 -45.5 298t-133.5 230t-218 147.5t-295 51.5 q-160 0 -292.5 -58t-227.5 -156q-96 -98 -150.5 -234.5t-54.5 -290.5q0 -165 52 -301.5t147 -233.5q99 -101 232 -152.5t290 -51.5q86 0 177.5 11t175.5 35v-142q-97 -21 -181 -28.5t-173 -7.5q-186 0 -345 63.5t-273 177.5q-115 115 -179 276t-64 356q0 185 67 344.5 t183 276.5t275 184t340 67q196 0 350 -62t260 -174t162.5 -269.5t56.5 -350.5zM1245 408v518q-63 29 -113 41.5t-107 12.5q-129 0 -202 -90t-73 -256q0 -163 58 -246.5t181 -83.5q67 0 134 31t122 73z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523z","M1323 458q0 -111 -42 -196t-113 -140q-84 -66 -184.5 -94t-255.5 -28h-528v1489h441q163 0 244 -12t155 -50q82 -43 119 -110.5t37 -161.5q0 -106 -54 -180.5t-144 -119.5v-8q151 -31 238 -132.5t87 -256.5zM990 1129q0 54 -18 91t-58 60q-47 27 -114 33.5t-166 6.5h-236 v-430h256q93 0 148 9.5t102 39.5t66.5 77.5t19.5 112.5zM1117 450q0 90 -27 143t-98 90q-48 25 -116.5 32.5t-166.5 7.5h-311v-554h262q130 0 213 13.5t136 49.5q56 39 82 89t26 129z","M1350 108q-55 -24 -99.5 -45t-116.5 -44q-61 -19 -132.5 -32.5t-157.5 -13.5q-162 0 -294.5 45.5t-230.5 142.5q-96 95 -150 241.5t-54 340.5q0 184 52 329t150 245q95 97 229.5 148t298.5 51q120 0 239.5 -29t265.5 -102v-235h-15q-123 103 -244 150t-259 47 q-113 0 -203.5 -36.5t-161.5 -113.5q-69 -75 -107.5 -189.5t-38.5 -264.5q0 -157 42.5 -270t109.5 -184q70 -74 163.5 -109.5t197.5 -35.5q143 0 268 49t234 147h14v-232z","M1458 743q0 -203 -88.5 -368t-235.5 -256q-102 -63 -227.5 -91t-330.5 -28h-376v1489h372q218 0 346.5 -31.5t217.5 -86.5q152 -95 237 -253t85 -375zM1251 746q0 175 -61 295t-182 189q-88 50 -187 69.5t-237 19.5h-186v-1149h186q143 0 249.5 21t195.5 78 q111 71 166.5 187t55.5 290z","M1181 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176z","M1151 1313h-753v-420h647v-176h-647v-717h-198v1489h951v-176z","M1442 110q-122 -56 -266.5 -97.5t-279.5 -41.5q-174 0 -319 48t-247 144q-103 97 -159 242.5t-56 340.5q0 357 208.5 563.5t572.5 206.5q127 0 259.5 -30.5t285.5 -103.5v-235h-18q-31 24 -90 63t-116 65q-69 31 -156.5 51.5t-198.5 20.5q-250 0 -395.5 -160.5 t-145.5 -434.5q0 -289 152 -449.5t414 -160.5q96 0 191.5 19t167.5 49v365h-399v174h595v-639z","M1339 0h-198v729h-743v-729h-198v1489h198v-584h743v584h198v-1489z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152z","M746 387q0 -196 -119.5 -302t-320.5 -106q-48 0 -128 8.5t-134 20.5v185h11q41 -14 101 -29t123 -15q92 0 146.5 21t80.5 60q27 40 34.5 98t7.5 134v869h-315v158h513v-1102z","M1397 0h-257l-589 663l-148 -158v-505h-198v1489h198v-777l723 777h240l-665 -700z","M1142 0h-942v1489h198v-1313h744v-176z","M1526 0h-198v1283l-414 -873h-118l-411 873v-1283h-185v1489h270l397 -829l384 829h275v-1489z","M1336 0h-245l-706 1332v-1332h-185v1489h307l644 -1216v1216h185v-1489z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5z","M1174 1039q0 -99 -34.5 -183.5t-96.5 -146.5q-77 -77 -182 -115.5t-265 -38.5h-198v-555h-198v1489h404q134 0 227 -22.5t165 -70.5q85 -57 131.5 -142t46.5 -215zM968 1034q0 77 -27 134t-82 93q-48 31 -109.5 44.5t-155.5 13.5h-196v-595h167q120 0 195 21.5t122 68.5 q47 48 66.5 101t19.5 119z","M1528 -365q-60 -15 -118.5 -21.5t-119.5 -6.5q-174 0 -279.5 95.5t-114.5 273.5q-24 -4 -46.5 -5.5t-43.5 -1.5q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5 q91 -100 139.5 -245t48.5 -329q0 -273 -111.5 -460t-299.5 -262q4 -114 54 -177t182 -63q41 0 97.5 12.5t80.5 22.5h27v-182zM1292 744q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5z","M1432 0h-257l-498 592h-279v-592h-198v1489h417q135 0 225 -17.5t162 -62.5q81 -51 126.5 -128.5t45.5 -196.5q0 -161 -81 -269.5t-223 -163.5zM969 1070q0 64 -22.5 113.5t-74.5 83.5q-43 29 -102 40.5t-139 11.5h-233v-562h200q94 0 164 16.5t119 61.5q45 42 66.5 96.5 t21.5 138.5z","M1282 425q0 -87 -40.5 -172t-113.5 -144q-80 -64 -186.5 -100t-256.5 -36q-161 0 -289.5 30t-261.5 89v248h14q113 -94 261 -145t278 -51q184 0 286.5 69t102.5 184q0 99 -48.5 146t-147.5 73q-75 20 -162.5 33t-185.5 33q-198 42 -293.5 143.5t-95.5 264.5 q0 187 158 306.5t401 119.5q157 0 288 -30t232 -74v-234h-14q-85 72 -223.5 119.5t-283.5 47.5q-159 0 -255.5 -66t-96.5 -170q0 -93 48 -146t169 -81q64 -14 182 -34t200 -41q166 -44 250 -133t84 -249z","M1262 1313h-532v-1313h-198v1313h-532v176h1262v-176z","M1321 598q0 -162 -35.5 -282.5t-116.5 -200.5q-77 -76 -180 -111t-240 -35q-140 0 -244 37t-175 109q-81 82 -116.5 198t-35.5 285v891h198v-901q0 -121 16.5 -191t55.5 -127q44 -65 119.5 -98t181.5 -33q107 0 182 32.5t120 98.5q39 57 55.5 130.5t16.5 182.5v906h198 v-891z","M1374 1489l-542 -1489h-264l-542 1489h212l467 -1310l467 1310h202z","M1933 1489l-387 -1489h-223l-313 1236l-306 -1236h-218l-394 1489h203l313 -1238l308 1238h201l311 -1250l311 1250h194z","M1336 1489l-514 -736l513 -753h-229l-406 613l-416 -613h-216l519 744l-507 745h228l401 -605l410 605h217z","M1254 1489l-524 -836v-653h-198v632l-526 857h219l407 -666l411 666h211z","M1288 0h-1162v184l913 1129h-879v176h1106v-179l-922 -1134h944v-176z","M759 -392h-520v1948h520v-143h-346v-1662h346v-143z","M960 -304h-173l-717 1860h176z","M691 -392h-520v143h346v1662h-346v143h520v-1948z","M1490 684h-198l-455 627l-454 -629h-197l589 807h126z","M1306 -300h-1310v120h1310v-120z","M762 1302h-149l-273 374h243z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5z","M1168 567q0 -140 -39.5 -252t-106.5 -188q-71 -79 -156 -118.5t-187 -39.5q-95 0 -166 22.5t-140 60.5l-12 -52h-176v1556h188v-556q79 65 168 106.5t200 41.5q198 0 312.5 -152t114.5 -429zM974 562q0 200 -66 303.5t-213 103.5q-82 0 -166 -35.5t-156 -91.5v-640 q80 -36 137.5 -50t130.5 -14q156 0 244.5 102.5t88.5 321.5z","M1011 70q-94 -45 -178.5 -70t-179.5 -25q-121 0 -222 35.5t-173 107.5q-73 72 -113 182t-40 257q0 274 150.5 430t397.5 156q96 0 188.5 -27t169.5 -66v-209h-10q-86 67 -177.5 103t-178.5 36q-160 0 -252.5 -107.5t-92.5 -315.5q0 -202 90.5 -310.5t254.5 -108.5 q57 0 116 15t106 39q41 21 77 44.5t57 40.5h10v-207z","M1091 0h-188v117q-81 -70 -169 -109t-191 -39q-200 0 -317.5 154t-117.5 427q0 142 40.5 253t109.5 189q68 76 158.5 116t187.5 40q88 0 156 -18.5t143 -57.5v484h188v-1556zM903 275v641q-76 34 -136 47t-131 13q-158 0 -246 -110t-88 -312q0 -199 68 -302.5t218 -103.5 q80 0 162 35.5t153 91.5z","M1120 539h-823q0 -103 31 -179.5t85 -125.5q52 -48 123.5 -72t157.5 -24q114 0 229.5 45.5t164.5 89.5h10v-205q-95 -40 -194 -67t-208 -27q-278 0 -434 150.5t-156 427.5q0 274 149.5 435t393.5 161q226 0 348.5 -132t122.5 -375v-102zM937 683q-1 148 -74.5 229 t-223.5 81q-151 0 -240.5 -89t-101.5 -221h640z","M786 1374h-10q-31 9 -81 18.5t-88 9.5q-121 0 -175.5 -53.5t-54.5 -193.5v-38h339v-158h-333v-959h-188v959h-127v158h127v37q0 199 99 305.5t286 106.5q63 0 113.5 -6t92.5 -14v-172z","M1091 127q0 -284 -129 -417t-397 -133q-89 0 -173.5 12.5t-166.5 35.5v192h10q46 -18 146 -44.5t200 -26.5q96 0 159 23t98 64q35 39 50 94t15 123v102q-85 -68 -162.5 -101.5t-197.5 -33.5q-200 0 -317.5 144.5t-117.5 407.5q0 144 40.5 248.5t110.5 180.5 q65 71 158 110.5t185 39.5q97 0 162.5 -19.5t138.5 -59.5l12 48h176v-990zM903 307v609q-75 34 -139.5 48.5t-128.5 14.5q-155 0 -244 -104t-89 -302q0 -188 66 -285t219 -97q82 0 164.5 31.5t151.5 84.5z","M1119 0h-188v636q0 77 -9 144.5t-33 105.5q-25 42 -72 62.5t-122 20.5q-77 0 -161 -38t-161 -97v-834h-188v1556h188v-563q88 73 182 114t193 41q181 0 276 -109t95 -314v-725z","M387 1304h-212v195h212v-195zM375 0h-188v1117h188v-1117z","M533 1304h-212v195h212v-195zM521 -27q0 -196 -100 -296t-268 -100q-40 0 -105.5 8t-109.5 20v179h10q28 -11 75.5 -25t92.5 -14q72 0 116 20t66 60t28.5 96.5t6.5 137.5v900h-233v158h421v-1144z","M1199 0h-248l-448 489l-122 -116v-373h-188v1556h188v-998l543 559h237l-519 -516z","M375 0h-188v1556h188v-1556z","M1815 0h-188v636q0 72 -6.5 139t-27.5 107q-23 43 -66 65t-124 22q-79 0 -158 -39.5t-158 -100.5q3 -23 5 -53.5t2 -60.5v-715h-188v636q0 74 -6.5 140.5t-27.5 106.5q-23 43 -66 64.5t-124 21.5q-77 0 -154.5 -38t-154.5 -97v-834h-188v1117h188v-124q88 73 175.5 114 t186.5 41q114 0 193.5 -48t118.5 -133q114 96 208 138.5t201 42.5q184 0 271.5 -111.5t87.5 -311.5v-725z","M1119 0h-188v636q0 77 -9 144.5t-33 105.5q-25 42 -72 62.5t-122 20.5q-77 0 -161 -38t-161 -97v-834h-188v1117h188v-124q88 73 182 114t193 41q181 0 276 -109t95 -314v-725z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z","M1168 572q0 -136 -39 -248.5t-110 -190.5q-66 -74 -155.5 -114.5t-189.5 -40.5q-87 0 -157.5 19t-143.5 59v-468h-188v1529h188v-117q75 63 168.5 105.5t199.5 42.5q202 0 314.5 -152.5t112.5 -423.5zM974 567q0 202 -69 302t-212 100q-81 0 -163 -35t-157 -92v-633 q80 -36 137.5 -49t130.5 -13q157 0 245 106t88 314z","M1091 -412h-188v538q-87 -75 -173 -111.5t-186 -36.5q-199 0 -317.5 153.5t-118.5 423.5q0 144 41.5 254.5t109.5 185.5q66 73 155 113t188 40q90 0 159.5 -20t141.5 -59l12 48h176v-1529zM903 284v632q-78 35 -138 49t-130 14q-163 0 -248 -110.5t-85 -304.5 q0 -196 68.5 -301.5t215.5 -105.5q82 0 164 35.5t153 91.5z","M882 912h-10q-42 10 -81.5 14.5t-93.5 4.5q-87 0 -168 -38.5t-156 -99.5v-793h-188v1117h188v-165q112 90 197.5 127.5t174.5 37.5q49 0 71 -2.5t66 -9.5v-193z","M983 322q0 -153 -126.5 -251t-345.5 -98q-124 0 -227.5 29.5t-173.5 64.5v211h10q89 -67 198 -106.5t209 -39.5q124 0 194 40t70 126q0 66 -38 100t-146 58q-40 9 -104.5 21t-117.5 26q-147 39 -208.5 114.5t-61.5 185.5q0 69 28.5 130t86.5 109q56 47 142.5 74.5 t193.5 27.5q100 0 202.5 -24.5t170.5 -59.5v-201h-10q-72 53 -175 89.5t-202 36.5q-103 0 -174 -39.5t-71 -117.5q0 -69 43 -104q42 -35 136 -57q52 -12 116.5 -24t107.5 -22q131 -30 202 -103q71 -74 71 -196z","M765 10q-53 -14 -115.5 -23t-111.5 -9q-171 0 -260 92t-89 295v594h-127v158h127v321h188v-321h388v-158h-388v-509q0 -88 4 -137.5t28 -92.5q22 -40 60.5 -58.5t117.5 -18.5q46 0 96 13.5t72 22.5h10v-169z","M1111 0h-188v124q-95 -75 -182 -115t-192 -40q-176 0 -274 107.5t-98 315.5v725h188v-636q0 -85 8 -145.5t34 -103.5q27 -44 70 -64t125 -20q73 0 159.5 38t161.5 97v834h188v-1117z","M1151 1117l-452 -1117h-189l-449 1117h204l346 -889l343 889h197z","M1590 1117l-291 -1117h-174l-287 861l-285 -861h-173l-294 1117h196l205 -865l279 865h155l286 -865l194 865h189z","M1152 0h-237l-317 429l-319 -429h-219l436 557l-432 560h237l315 -422l316 422h220l-439 -550z","M1151 1117l-652 -1529h-201l208 466l-445 1063h204l343 -828l346 828h197z","M995 0h-902v139l651 821h-637v157h871v-134l-654 -824h671v-159z","M1113 -392h-150q-179 0 -290.5 99.5t-111.5 287.5v149q0 169 -83 264.5t-254 95.5h-51v156h51q171 0 254 95.5t83 264.5v149q0 188 111.5 287.5t290.5 99.5h150v-138h-114q-136 0 -197.5 -63t-61.5 -203v-175q0 -139 -77 -233.5t-214 -149.5v-24q137 -55 214 -149.5 t77 -233.5v-175q0 -140 61.5 -203t197.5 -63h114v-138z","M552 -392h-174v1948h174v-1948z","M1127 504h-51q-171 0 -254 -95.5t-83 -264.5v-149q0 -188 -111.5 -287.5t-290.5 -99.5h-150v138h114q136 0 197.5 63t61.5 203v175q0 139 77 233.5t214 149.5v24q-137 55 -214 149.5t-77 233.5v175q0 140 -61.5 203t-197.5 63h-114v138h150q179 0 290.5 -99.5 t111.5 -287.5v-149q0 -169 83 -264.5t254 -95.5h51v-156z","M1489 927q-2 -99 -22.5 -195t-65.5 -171q-46 -77 -111 -121t-165 -44q-94 0 -167 39.5t-157 141.5q-102 125 -148 157t-96 32q-94 0 -144 -87.5t-59 -283.5h-167q2 100 22.5 194.5t64.5 171.5q43 74 112 119.5t165 45.5q93 0 166.5 -38.5t158.5 -142.5q80 -98 131 -143.5 t112 -45.5q103 0 151.5 101t51.5 270h167z","","M505 1278h-204v211h204v-211zM515 0h-224l26 1079h170z","M1120 74q-71 -30 -161 -53.5t-194 -26.5v-355h-118v359q-227 21 -357.5 165t-130.5 394q0 242 133.5 391.5t354.5 171.5v355h118v-351q104 -3 197 -25t158 -53v-203h-11q-55 44 -142 85t-202 50v-839q120 10 206.5 52.5t137.5 83.5h11v-201zM647 142v834 q-135 -20 -216 -125t-81 -294q0 -181 76 -286t221 -129z","M1163 0h-1026v207q118 32 169.5 126.5t51.5 279.5h-176v138h176v310q0 200 126.5 328.5t331.5 128.5q105 0 181 -17t140 -34v-206h-10q-62 42 -138 66t-162 24q-140 0 -209.5 -82.5t-69.5 -226.5v-291h415v-138h-415v-61q0 -126 -62 -219.5t-160 -150.5v-11h837v-171z ","M1168 257l-110 -110l-236 234q-44 -26 -81 -37t-89 -11q-46 0 -89.5 12.5t-79.5 35.5l-236 -236l-109 113l233 234q-23 37 -35 81.5t-12 87.5q0 52 11 88.5t37 79.5l-234 237l111 110l235 -235q36 23 79.5 35.5t88.5 12.5q44 0 88 -12t81 -35l234 234l113 -109l-235 -237 q24 -38 36 -79.5t12 -89.5q0 -45 -12.5 -89t-35.5 -80zM832 661q0 73 -52.5 129t-127.5 56q-73 0 -126.5 -55t-53.5 -130q0 -74 52.5 -129.5t127.5 -55.5q73 0 126.5 54.5t53.5 130.5z","M1191 1489l-448 -831v-94h372v-138h-370v-426h-188v426h-370v138h372v73l-451 852h212l332 -659l336 659h203z","M552 758h-174v798h174v-798zM552 -392h-174v798h174v-798z","M1128 601q0 -106 -59 -187t-158 -136v-7q97 -46 141 -118.5t44 -162.5q0 -77 -33 -146t-98 -119q-72 -56 -169 -83t-221 -27q-87 0 -170.5 13.5t-175.5 44.5v194h10q79 -37 169 -62t198 -25q134 0 215 48.5t81 135.5q0 56 -19.5 88.5t-64.5 57.5q-41 23 -113 41.5 t-154 38.5q-214 52 -296 133q-83 81 -83 210q0 98 57 182.5t159 141.5v7q-101 48 -143 121t-42 162q0 81 32 146.5t99 117.5q64 50 163.5 79t227.5 29q87 0 171 -14t175 -43v-194h-10q-58 27 -152.5 57t-215.5 30q-127 0 -211.5 -46t-84.5 -133q0 -57 21.5 -92.5t64.5 -58.5 t109 -41.5t157 -39.5q200 -46 290 -125q89 -79 89 -218zM881 399q28 33 43 65.5t15 90.5q0 51 -16.5 86t-45.5 58q-28 24 -67 39.5t-83 27.5q-39 11 -85.5 21.5t-116.5 30.5q-18 -9 -49 -31.5t-53 -46.5q-24 -26 -43 -69t-19 -92q0 -50 15.5 -85t44.5 -59q27 -23 67.5 -39 t84.5 -27q38 -10 86 -22t115 -31q20 11 53 34.5t54 48.5z","M958 1304h-199v195h199v-195zM545 1304h-199v195h199v-195z","M1889 655q0 -358 -253.5 -611.5t-611.5 -253.5t-611.5 253.5t-253.5 611.5t253.5 611.5t611.5 253.5t611.5 -253.5t253.5 -611.5zM1773 655q0 310 -219.5 532t-529.5 222t-529.5 -222t-219.5 -532t219.5 -532t529.5 -222t529.5 222t219.5 532zM1375 258 q-86 -39 -165.5 -58.5t-157.5 -19.5q-227 0 -359 123t-132 357q0 225 134.5 354t356.5 129q89 0 175 -24t148 -52v-181h-16q-54 40 -138.5 75t-173.5 35q-142 0 -221.5 -85.5t-79.5 -250.5q0 -159 76.5 -246t224.5 -87q83 0 161.5 29t150.5 81h16v-179z","M944 554h-170v94q-28 -20 -52.5 -38.5t-68.5 -37.5q-45 -20 -85.5 -30.5t-113.5 -10.5q-128 0 -215.5 85t-87.5 217q0 106 46.5 173.5t123.5 103.5q78 36 197.5 51.5t255.5 21.5v18q0 53 -18 85t-51 51q-34 18 -77.5 23t-91.5 5q-84 0 -168 -24t-123 -38h-14v172 q45 13 137 29t169 16q217 0 312 -84.5t95 -243.5v-638zM774 796v245q-69 -4 -160.5 -12t-145.5 -23q-64 -18 -103 -56.5t-39 -106.5q0 -76 45.5 -114t139.5 -38q82 0 147.5 33.5t115.5 71.5z","M1146 191l-528 419v85l528 418v-188l-357 -273l357 -273v-188zM716 162l-550 446v89l550 445v-196l-371 -294l371 -294v-196z","M1456 57h-171v545h-1075v160h1246v-705z","M777 561h-624v181h624v-181z","M1889 655q0 -358 -253.5 -611.5t-611.5 -253.5t-611.5 253.5t-253.5 611.5t253.5 611.5t611.5 253.5t611.5 -253.5t253.5 -611.5zM1773 655q0 310 -219.5 532t-529.5 222t-529.5 -222t-219.5 -532t219.5 -532t529.5 -222t529.5 222t219.5 532zM1581 215h-223l-331 355 h-162v-355h-165v915h312q94 0 155 -8t120 -39q63 -34 92.5 -82.5t29.5 -121.5q0 -97 -56.5 -161.5t-155.5 -102.5zM1229 868q0 36 -14 64t-47 46q-31 17 -66 22t-88 5h-149v-309h127q62 0 107 9.5t74 32.5q31 25 43.5 55t12.5 75z","M1306 1668h-1305l-5 120h1310v-120z","M956 1116q0 -168 -116 -284t-285 -116t-285 115.5t-116 284.5q0 168 116 284t285 116q170 0 285.5 -116t115.5 -284zM791 1116q0 102 -67 171.5t-169 69.5t-169 -69.5t-67 -171.5q0 -104 68.5 -172.5t167.5 -68.5q102 0 169 70t67 171z","M1461 179h-1246v158h540v422h-540v158h540v545h166v-545h540v-158h-540v-422h540v-158z","M967 566h-760v156q100 62 183.5 117t134.5 96q131 103 168 154.5t37 135.5q0 69 -53.5 107t-143.5 38q-89 0 -175 -30.5t-134 -61.5h-13v180q71 26 158.5 43.5t174.5 17.5q180 0 273.5 -78.5t93.5 -203.5q0 -99 -48.5 -174.5t-163.5 -165.5q-55 -43 -132.5 -94 t-143.5 -92h544v-145z","M956 817q0 -75 -33 -131.5t-89 -90.5q-57 -35 -131 -51.5t-163 -16.5q-94 0 -176.5 15t-156.5 43v179h14q41 -36 138.5 -65.5t190.5 -29.5q100 0 166.5 35.5t66.5 110.5q0 85 -59 115t-171 30h-143v141h128q112 0 165.5 38.5t53.5 106.5q0 61 -49.5 96.5t-153.5 35.5 q-77 0 -174.5 -31t-141.5 -67h-14v178q74 27 160.5 44.5t176.5 17.5q175 0 271.5 -68t96.5 -174q0 -89 -55 -146t-144 -83v-8q95 -17 160.5 -72.5t65.5 -151.5z","M963 1676l-273 -374h-149l179 374h243z","M1124 0h-178l-10 118q-59 -65 -123.5 -102t-155.5 -37q-86 0 -149.5 35t-129.5 99v-525h-188v1529h188v-838q32 -39 109.5 -80t168.5 -41q93 0 159.5 33.5t120.5 93.5v832h188v-1117z","M1106 -363h-148v1722h-214v-1722h-149v956q-206 5 -332 129t-126 328q0 207 130 323t373 116h466v-1852z","M492 511h-239v283h239v-283z","M880 -89q0 -162 -91.5 -248t-237.5 -86q-37 0 -95 7t-103 19v160h9q26 -10 70 -23t94 -13q104 0 153 39t49 127q0 29 -3 65.5t-6 61.5h153q2 -19 5 -45t3 -64z","M914 566h-615v122h234v568h-242v112q45 0 99 6.5t84 18.5q37 16 59 38t25 62h135v-805h221v-122z","M996 1025q0 -235 -122 -364.5t-315 -129.5q-201 0 -319.5 132.5t-118.5 361.5t118.5 362t319.5 133q193 0 315 -130t122 -365zM814 1025q0 172 -67.5 258t-187.5 86q-122 0 -189 -87t-67 -257t67 -256.5t189 -86.5q120 0 187.5 85.5t67.5 257.5z","M1154 608l-550 -446v196l371 294l-371 294v196l550 -445v-89zM702 610l-528 -419v188l357 273l-357 273v188l528 -418v-85z","M545 565h-165v681h-209v117q102 0 165 22t72 108h137v-928zM1410 1489l-780 -1489h-165l780 1489h165zM1857 220h-163v-220h-150v220h-465v185l466 539h149v-591h163v-133zM1548 353v400l-353 -400h353z","M545 565h-165v681h-209v117q102 0 165 22t72 108h137v-928zM1410 1489l-780 -1489h-165l780 1489h165zM1955 0h-688v148q91 69 158 121t106 89q109 103 141 157.5t32 136.5q0 70 -44 107t-120 37q-70 0 -141.5 -30t-112.5 -62h-15v179q65 27 140.5 44t152.5 17 q157 0 241.5 -79t84.5 -201q0 -93 -41 -167t-147 -168q-49 -43 -119.5 -96t-125.5 -94h498v-139z","M793 826q0 -71 -30 -127t-78 -90q-53 -37 -114.5 -53t-140.5 -16q-82 0 -153.5 15t-136.5 43v175h17q37 -35 114 -64.5t156 -29.5q84 0 139 36.5t55 108.5q0 83 -50 112.5t-141 29.5h-140v139h125q87 0 134.5 38t47.5 104q0 60 -41 95.5t-128 35.5q-66 0 -142.5 -31 t-113.5 -66h-17v175q64 27 139 44t154 17q152 0 237 -70t85 -168q0 -87 -48.5 -143.5t-125.5 -82.5v-8q80 -16 138.5 -70.5t58.5 -148.5zM1500 1489l-780 -1489h-165l780 1489h165zM1913 220h-163v-220h-150v220h-465v185l466 539h149v-591h163v-133zM1604 353v400 l-353 -400h353z","M712 1278h-204v211h204v-211zM958 40q-83 -30 -176 -50t-205 -20q-215 0 -339.5 104.5t-124.5 275.5q0 98 34.5 173t93.5 137q58 62 136.5 112.5t146.5 91.5v225h179v-305q-60 -33 -139 -81.5t-125 -88.5q-54 -47 -88 -109t-34 -140q0 -113 76.5 -168.5t197.5 -55.5 q103 0 201.5 33t155.5 70h10v-204z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523zM862 1675h-149l-273 374h243z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523zM955 2049l-273 -374h-149l179 374h243z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523zM1033 1670h-159l-185 256l-184 -256h-155l228 379h227z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523zM1119 1992q-11 -152 -77 -229t-177 -77q-54 0 -100 19.5t-87 56.5q-47 43 -79.5 64.5t-71.5 21.5q-52 0 -78 -45t-30 -121h-131q8 151 79 228t174 77q50 0 96.5 -19.5 t88.5 -55.5q47 -41 83.5 -61.5t69.5 -20.5q51 0 79.5 46t31.5 116h129z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523zM1005 1677h-199v195h199v-195zM592 1677h-199v195h199v-195z","M1374 0h-211l-148 415h-640l-148 -415h-201l519 1407q-89 44 -142.5 123.5t-53.5 181.5q0 143 102 240t248 97q147 0 248.5 -97t101.5 -240q0 -100 -52.5 -181.5t-141.5 -123.5zM899 1710q0 86 -57 143.5t-143 57.5t-143 -58t-57 -143q0 -86 57.5 -143.5t142.5 -57.5 q86 0 143 57.5t57 143.5zM953 585l-258 715l-259 -715h517z","M1901 0h-944v556h-524l-212 -556h-207l594 1489h1293v-176h-749v-408h749v-176h-749v-553h749v-176zM957 723v601h-219l-239 -601h458z","M1350 108q-55 -24 -99.5 -45t-116.5 -44q-11 -3 -24 -7.5t-31 -7.5q2 -19 3.5 -44.5t1.5 -48.5q0 -162 -93.5 -248t-240.5 -86q-38 0 -97.5 7t-104.5 19v162h9q26 -10 71.5 -24t95.5 -14q106 0 155 40t49 126q0 19 -1 41.5t-3 42.5q-19 -2 -40.5 -3t-39.5 -1 q-162 0 -294.5 45.5t-230.5 142.5q-96 95 -150 241.5t-54 340.5q0 184 52 329t150 245q95 97 229.5 148t298.5 51q120 0 239.5 -29t265.5 -102v-235h-15q-123 103 -244 150t-259 47q-113 0 -203.5 -36.5t-161.5 -113.5q-69 -75 -107.5 -189.5t-38.5 -264.5q0 -157 42.5 -270 t109.5 -184q70 -74 163.5 -109.5t197.5 -35.5q143 0 268 49t234 147h14v-232z","M1181 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176zM822 1675h-149l-273 374h243z","M1181 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176zM993 2049l-273 -374h-149l179 374h243z","M1181 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176zM1031 1670h-159l-185 256l-184 -256h-155l228 379h227z","M1181 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176zM1038 1677h-199v195h199v-195zM625 1677h-199v195h199v-195z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152zM568 1675h-149l-273 374h243z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152zM725 2049l-273 -374h-149l179 374h243z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152zM776 1670h-159l-185 256l-184 -256h-155l228 379h227z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152zM738 1677h-199v195h199v-195zM325 1677h-199v195h199v-195z","M1468 743q0 -203 -88.5 -368t-235.5 -256q-102 -63 -227.5 -91t-330.5 -28h-376v740h-196v143h196v606h372q218 0 347 -31.5t217 -86.5q152 -95 237 -253t85 -375zM1261 746q0 175 -61 295t-182 189q-88 50 -187 69.5t-237 19.5h-188v-436h361v-143h-361v-570h188 q143 0 249.5 21t195.5 78q111 71 166.5 187t55.5 290z","M1336 0h-245l-706 1332v-1332h-185v1489h307l644 -1216v1216h185v-1489zM1208 1992q-11 -152 -77 -229t-177 -77q-54 0 -100 19.5t-87 56.5q-47 43 -79.5 64.5t-71.5 21.5q-52 0 -78 -45t-30 -121h-131q8 151 79 228t174 77q50 0 96.5 -19.5t88.5 -55.5 q47 -41 83.5 -61.5t69.5 -20.5q51 0 79.5 46t31.5 116h129z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM932 1675h-149l-273 374h243z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM1083 2049l-273 -374h-149l179 374h243z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM1136 1670h-159l-185 256l-184 -256h-155l228 379h227z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM1207 1992q-11 -152 -77 -229t-177 -77q-54 0 -100 19.5t-87 56.5q-47 43 -79.5 64.5t-71.5 21.5q-52 0 -78 -45t-30 -121h-131q8 151 79 228 t174 77q50 0 96.5 -19.5t88.5 -55.5q47 -41 83.5 -61.5t69.5 -20.5q51 0 79.5 46t31.5 116h129z","M1307 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1289 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM1108 1677h-199v195h199v-195zM695 1677h-199v195h199v-195z","M1385 216l-111 -111l-436 440l-436 -440l-111 111l440 436l-440 436l111 111l436 -440l436 440l111 -111l-440 -436z","M1498 744q0 -184 -49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-115 0 -215.5 29t-179.5 84l-159 -228h-132l205 294q-101 100 -155.5 250t-54.5 346q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q118 0 215 -27.5t179 -82.5l142 201h132 l-188 -268q101 -100 156.5 -248.5t55.5 -350.5zM1097 1260q-57 46 -129 68.5t-161 22.5q-110 0 -200 -38.5t-156 -116.5q-64 -76 -98.5 -190.5t-34.5 -261.5q0 -140 29.5 -252t87.5 -188zM1295 744q0 139 -30 253t-88 189l-664 -957q60 -45 132.5 -68t161.5 -23 q110 0 201.5 40t153.5 116q67 82 100 194.5t33 255.5z","M1321 598q0 -162 -35.5 -282.5t-116.5 -200.5q-77 -76 -180 -111t-240 -35q-140 0 -244 37t-175 109q-81 82 -116.5 198t-35.5 285v891h198v-901q0 -121 16.5 -191t55.5 -127q44 -65 119.5 -98t181.5 -33q107 0 182 32.5t120 98.5q39 57 55.5 130.5t16.5 182.5v906h198 v-891zM932 1675h-149l-273 374h243z","M1321 598q0 -162 -35.5 -282.5t-116.5 -200.5q-77 -76 -180 -111t-240 -35q-140 0 -244 37t-175 109q-81 82 -116.5 198t-35.5 285v891h198v-901q0 -121 16.5 -191t55.5 -127q44 -65 119.5 -98t181.5 -33q107 0 182 32.5t120 98.5q39 57 55.5 130.5t16.5 182.5v906h198 v-891zM1073 2049l-273 -374h-149l179 374h243z","M1321 598q0 -162 -35.5 -282.5t-116.5 -200.5q-77 -76 -180 -111t-240 -35q-140 0 -244 37t-175 109q-81 82 -116.5 198t-35.5 285v891h198v-901q0 -121 16.5 -191t55.5 -127q44 -65 119.5 -98t181.5 -33q107 0 182 32.5t120 98.5q39 57 55.5 130.5t16.5 182.5v906h198 v-891zM1084 1670h-159l-185 256l-184 -256h-155l228 379h227z","M1321 598q0 -162 -35.5 -282.5t-116.5 -200.5q-77 -76 -180 -111t-240 -35q-140 0 -244 37t-175 109q-81 82 -116.5 198t-35.5 285v891h198v-901q0 -121 16.5 -191t55.5 -127q44 -65 119.5 -98t181.5 -33q107 0 182 32.5t120 98.5q39 57 55.5 130.5t16.5 182.5v906h198 v-891zM1056 1677h-199v195h199v-195zM643 1677h-199v195h199v-195z","M1254 1489l-524 -836v-653h-198v632l-526 857h219l407 -666l411 666h211zM935 2049l-273 -374h-149l179 374h243z","M1174 787q0 -92 -35 -176.5t-95 -141.5q-78 -75 -187.5 -111t-260.5 -36h-198v-322h-198v1489h198v-270h205q133 0 230 -22.5t164 -66.5q83 -53 130 -138t47 -205zM968 782q0 72 -26 125.5t-82 88.5q-48 30 -112 42.5t-154 12.5h-196v-563h167q119 0 195 20.5t123 65.5 q44 41 64.5 92t20.5 116z","M1165 481q0 -214 -135.5 -359.5t-354.5 -145.5q-44 0 -101.5 7.5t-93.5 20.5v165h10q42 -24 91.5 -33t105.5 -9q74 0 129 29t88 78q35 52 50.5 115.5t15.5 139.5q0 166 -105.5 250.5t-303.5 84.5v150q157 0 234 59.5t77 188.5q0 35 -11 68t-41 64q-27 29 -71 46.5 t-105 17.5q-57 0 -103 -14.5t-86 -53.5q-37 -36 -59.5 -102t-22.5 -161v-1087h-188v1080q0 124 36 215.5t100 153.5q60 58 149.5 87.5t183.5 29.5q183 0 297.5 -87t114.5 -238q0 -112 -71 -201t-184 -121v-9q164 -37 259 -148.5t95 -280.5z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5zM738 1302h-149l-273 374h243z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5zM934 1676l-273 -374h-149l179 374h243z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5zM961 1297h-159l-185 256l-184 -256h-155l228 379h227z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5zM1038 1619q-11 -152 -77 -229t-177 -77q-54 0 -100 19.5t-87 56.5 q-47 43 -79.5 64.5t-71.5 21.5q-52 0 -78 -45t-30 -121h-131q8 151 79 228t174 77q50 0 96.5 -19.5t88.5 -55.5q47 -41 83.5 -61.5t69.5 -20.5q51 0 79.5 46t31.5 116h129z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5zM926 1304h-199v195h199v-195zM513 1304h-199v195h199v-195z","M1053 0h-187v119q-25 -17 -67.5 -47.5t-82.5 -48.5q-47 -23 -108 -38.5t-143 -15.5q-151 0 -256 100t-105 255q0 127 54.5 205.5t155.5 123.5q102 45 245 61t307 24v29q0 64 -22.5 106t-64.5 66q-40 23 -96 31t-117 8q-74 0 -165 -19.5t-188 -56.5h-10v191q55 15 159 33 t205 18q118 0 205.5 -19.5t151.5 -66.5q63 -46 96 -119t33 -181v-758zM866 275v311q-86 -5 -202.5 -15t-184.5 -29q-81 -23 -131 -71.5t-50 -133.5q0 -96 58 -144.5t177 -48.5q99 0 181 38.5t152 92.5zM956 1630q0 -143 -102 -242t-248 -99q-144 0 -247 98.5t-103 242.5 q0 143 102 241t248 98q147 0 248.5 -98t101.5 -241zM811 1630q0 86 -58.5 145.5t-146.5 59.5t-146.5 -59t-58.5 -146t59 -146t146 -59q88 0 146.5 59t58.5 146z","M1855 559h-819q0 -114 30 -195t85 -133q52 -48 123 -70.5t157 -22.5q111 0 217.5 41.5t172.5 93.5h12v-205q-78 -35 -184.5 -64.5t-215.5 -29.5q-166 0 -284.5 52t-194.5 155q-21 -19 -67 -59t-96 -68q-63 -36 -137 -59.5t-189 -23.5q-150 0 -255.5 97t-105.5 249 q0 124 54 200.5t155 118.5q95 39 241 53t308 17v61q0 65 -23 107.5t-64 65.5q-40 23 -96 31.5t-116 8.5q-79 0 -168.5 -21t-179.5 -57h-13v191q55 15 158 34t204 19q159 0 264.5 -46.5t162.5 -137.5q69 82 170 134t226 52q217 0 342.5 -128t125.5 -379v-82zM1673 703 q-5 68 -23.5 119t-50.5 88q-34 39 -88.5 61t-133.5 22q-133 0 -223 -75t-115 -215h634zM894 298q-20 53 -30.5 119t-10.5 141q-105 -3 -201 -7.5t-178 -25.5q-79 -20 -127.5 -65.5t-48.5 -128.5q0 -95 58 -141t176 -46q99 0 195.5 43t166.5 111z","M1011 70q-33 -15 -71.5 -30.5t-67.5 -24.5q3 -19 5.5 -47.5t2.5 -56.5q0 -162 -91.5 -248t-237.5 -86q-37 0 -95 7t-103 19v160h9q26 -10 70 -23t94 -13q104 0 153 39t49 127q0 22 -1.5 45t-3.5 43q-16 -2 -30.5 -4t-39.5 -2q-121 0 -222 35.5t-173 107.5 q-73 72 -113 182t-40 257q0 274 150.5 430t397.5 156q96 0 188.5 -27t169.5 -66v-209h-10q-86 67 -177.5 103t-178.5 36q-160 0 -252.5 -107.5t-92.5 -315.5q0 -202 90.5 -310.5t254.5 -108.5q57 0 116 15t106 39q41 21 77 44.5t57 40.5h10v-207z","M1120 539h-823q0 -103 31 -179.5t85 -125.5q52 -48 123.5 -72t157.5 -24q114 0 229.5 45.5t164.5 89.5h10v-205q-95 -40 -194 -67t-208 -27q-278 0 -434 150.5t-156 427.5q0 274 149.5 435t393.5 161q226 0 348.5 -132t122.5 -375v-102zM937 683q-1 148 -74.5 229 t-223.5 81q-151 0 -240.5 -89t-101.5 -221h640zM759 1302h-149l-273 374h243z","M1120 539h-823q0 -103 31 -179.5t85 -125.5q52 -48 123.5 -72t157.5 -24q114 0 229.5 45.5t164.5 89.5h10v-205q-95 -40 -194 -67t-208 -27q-278 0 -434 150.5t-156 427.5q0 274 149.5 435t393.5 161q226 0 348.5 -132t122.5 -375v-102zM937 683q-1 148 -74.5 229 t-223.5 81q-151 0 -240.5 -89t-101.5 -221h640zM960 1676l-273 -374h-149l179 374h243z","M1120 539h-823q0 -103 31 -179.5t85 -125.5q52 -48 123.5 -72t157.5 -24q114 0 229.5 45.5t164.5 89.5h10v-205q-95 -40 -194 -67t-208 -27q-278 0 -434 150.5t-156 427.5q0 274 149.5 435t393.5 161q226 0 348.5 -132t122.5 -375v-102zM937 683q-1 148 -74.5 229 t-223.5 81q-151 0 -240.5 -89t-101.5 -221h640zM986 1297h-159l-185 256l-184 -256h-155l228 379h227z","M1120 539h-823q0 -103 31 -179.5t85 -125.5q52 -48 123.5 -72t157.5 -24q114 0 229.5 45.5t164.5 89.5h10v-205q-95 -40 -194 -67t-208 -27q-278 0 -434 150.5t-156 427.5q0 274 149.5 435t393.5 161q226 0 348.5 -132t122.5 -375v-102zM937 683q-1 148 -74.5 229 t-223.5 81q-151 0 -240.5 -89t-101.5 -221h640zM951 1304h-199v195h199v-195zM538 1304h-199v195h199v-195z","M375 0h-188v1117h188v-1117zM401 1302h-149l-273 374h243z","M375 0h-188v1117h188v-1117zM582 1676l-273 -374h-149l179 374h243z","M572 1297h-151l-143 267l-142 -267h-147l178 379h227zM375 0h-188v1117h188v-1117z","M557 1304h-189v195h189v-195zM194 1304h-189v195h189v-195zM375 0h-188v1117h188v-1117z","M1137 637q0 -324 -142 -496t-383 -172q-229 0 -367.5 135t-138.5 380q0 226 137 358t339 132q108 0 185.5 -26.5t163.5 -79.5q-32 112 -99.5 219t-154.5 181l-264 -162l-66 97l237 142q-84 67 -156 107.5t-165 87.5v16h295q35 -25 84 -58.5t86 -59.5l210 128l66 -97 l-186 -109q153 -147 236 -325.5t83 -397.5zM847 226q49 59 75 143.5t26 234.5q0 32 -1.5 59.5t-3.5 57.5q-75 45 -157.5 66.5t-168.5 21.5q-147 0 -231.5 -87.5t-84.5 -239.5q0 -180 84.5 -267t227.5 -87q66 0 127.5 22t106.5 76z","M1119 0h-188v636q0 77 -9 144.5t-33 105.5q-25 42 -72 62.5t-122 20.5q-77 0 -161 -38t-161 -97v-834h-188v1117h188v-124q88 73 182 114t193 41q181 0 276 -109t95 -314v-725zM1075 1619q-11 -152 -77 -229t-177 -77q-54 0 -100 19.5t-87 56.5q-47 43 -79.5 64.5 t-71.5 21.5q-52 0 -78 -45t-30 -121h-131q8 151 79 228t174 77q50 0 96.5 -19.5t88.5 -55.5q47 -41 83.5 -61.5t69.5 -20.5q51 0 79.5 46t31.5 116h129z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z M732 1302h-149l-273 374h243z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z M933 1676l-273 -374h-149l179 374h243z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z M963 1297h-159l-185 256l-184 -256h-155l228 379h227z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z M1038 1619q-11 -152 -77 -229t-177 -77q-54 0 -100 19.5t-87 56.5q-47 43 -79.5 64.5t-71.5 21.5q-52 0 -78 -45t-30 -121h-131q8 151 79 228t174 77q50 0 96.5 -19.5t88.5 -55.5q47 -41 83.5 -61.5t69.5 -20.5q51 0 79.5 46t31.5 116h129z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z M928 1304h-199v195h199v-195zM515 1304h-199v195h199v-195z","M957 1022h-238v275h238v-275zM1466 572h-1256v160h1256v-160zM957 7h-238v275h238v-275z","M1137 558q0 -273 -140 -431t-375 -158q-84 0 -155.5 21t-130.5 60l-133 -198h-110l171 256q-75 77 -116.5 190t-41.5 260q0 273 139.5 431.5t376.5 158.5q87 0 158 -22t125 -57l116 172h111l-155 -231q76 -76 118 -188t42 -264zM813 930q-37 29 -86.5 43.5t-104.5 14.5 q-155 0 -240 -110t-85 -320q0 -97 17 -171t52 -128zM946 558q0 97 -17.5 173t-51.5 130l-448 -671q39 -31 86.5 -46t106.5 -15q150 0 237 108.5t87 320.5z","M1111 0h-188v124q-95 -75 -182 -115t-192 -40q-176 0 -274 107.5t-98 315.5v725h188v-636q0 -85 8 -145.5t34 -103.5q27 -44 70 -64t125 -20q73 0 159.5 38t161.5 97v834h188v-1117zM764 1302h-149l-273 374h243z","M1111 0h-188v124q-95 -75 -182 -115t-192 -40q-176 0 -274 107.5t-98 315.5v725h188v-636q0 -85 8 -145.5t34 -103.5q27 -44 70 -64t125 -20q73 0 159.5 38t161.5 97v834h188v-1117zM945 1676l-273 -374h-149l179 374h243z","M1111 0h-188v124q-95 -75 -182 -115t-192 -40q-176 0 -274 107.5t-98 315.5v725h188v-636q0 -85 8 -145.5t34 -103.5q27 -44 70 -64t125 -20q73 0 159.5 38t161.5 97v834h188v-1117zM985 1297h-159l-185 256l-184 -256h-155l228 379h227z","M1111 0h-188v124q-95 -75 -182 -115t-192 -40q-176 0 -274 107.5t-98 315.5v725h188v-636q0 -85 8 -145.5t34 -103.5q27 -44 70 -64t125 -20q73 0 159.5 38t161.5 97v834h188v-1117zM955 1304h-199v195h199v-195zM542 1304h-199v195h199v-195z","M1151 1117l-652 -1529h-201l208 466l-445 1063h204l343 -828l346 828h197zM928 1676l-273 -374h-149l179 374h243z","M1168 572q0 -136 -39 -248.5t-110 -190.5q-66 -74 -155.5 -114.5t-189.5 -40.5q-87 0 -157.5 19t-143.5 59v-468h-188v1968h188v-556q75 63 168.5 105.5t199.5 42.5q202 0 314.5 -152.5t112.5 -423.5zM974 567q0 202 -69 302t-212 100q-81 0 -163 -35t-157 -92v-633 q80 -36 137.5 -49t130.5 -13q157 0 245 106t88 314z","M585 832h-239v285h239v-285zM658 285l-282 -655h-146l174 655h254z","M773 1676l-49 -384h-145l-49 384h243z","M765 1676l-49 -384h-128l-49 384h226zM1048 1304h-191v195h191v-195zM447 1304h-191v195h191v-195z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523zM250 1489l-49 -384h-145l-49 384h243z","M585 832h-239v285h239v-285z","M1424 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176zM243 1489l-49 -384h-145l-49 384h243z","M1582 0h-198v729h-743v-729h-198v1489h198v-584h743v584h198v-1489zM243 1489l-49 -384h-145l-49 384h243z","M968 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152zM243 1489l-49 -384h-145l-49 384h243z","M1501 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1483 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM243 1489l-49 -384h-145l-49 384h243z","M1537 1489l-524 -836v-653h-198v632l-526 857h219l407 -666l411 666h211zM243 1489l-49 -384h-145l-49 384h243z","M1751 0h-576v387q60 38 119.5 82t103.5 101q45 59 71 138.5t26 185.5q0 206 -127 330.5t-347 124.5t-347 -124.5t-127 -330.5q0 -106 26 -185.5t71 -138.5q45 -57 104 -101t119 -82v-387h-576v174h410v124q-157 90 -258.5 246t-101.5 350q0 276 187.5 451t492.5 175 t492.5 -175t187.5 -451q0 -194 -101.5 -350t-258.5 -246v-124h410v-174zM243 1489l-49 -384h-145l-49 384h243z","M375 0h-188v1117h188v-1117zM379 1676l-56 -384h-84l-56 384h196zM615 1304h-171v195h171v-195zM118 1304h-171v195h171v-195z","M1374 0h-211l-146 415h-644l-146 -415h-201l542 1489h264zM956 585l-261 731l-262 -731h523z","M1323 458q0 -111 -42 -196t-113 -140q-84 -66 -184.5 -94t-255.5 -28h-528v1489h441q163 0 244 -12t155 -50q82 -43 119 -110.5t37 -161.5q0 -106 -54 -180.5t-144 -119.5v-8q151 -31 238 -132.5t87 -256.5zM990 1129q0 54 -18 91t-58 60q-47 27 -114 33.5t-166 6.5h-236 v-430h256q93 0 148 9.5t102 39.5t66.5 77.5t19.5 112.5zM1117 450q0 90 -27 143t-98 90q-48 25 -116.5 32.5t-166.5 7.5h-311v-554h262q130 0 213 13.5t136 49.5q56 39 82 89t26 129z","M1162 1313h-764v-1313h-198v1489h962v-176z","M1414 0h-1388l562 1489h264zM1147 168l-432 1147l-431 -1147h863z","M1181 0h-981v1489h981v-176h-783v-408h783v-176h-783v-553h783v-176z","M1288 0h-1162v184l913 1129h-879v176h1106v-179l-922 -1134h944v-176z","M1339 0h-198v729h-743v-729h-198v1489h198v-584h743v584h198v-1489z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5zM1120 713h-627v179h627v-179z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152z","M1397 0h-257l-589 663l-148 -158v-505h-198v1489h198v-777l723 777h240l-665 -700z","M1378 0h-213l-468 1285l-468 -1285h-203l556 1489h240z","M1526 0h-198v1283l-414 -873h-118l-411 873v-1283h-185v1489h270l397 -829l384 829h275v-1489z","M1336 0h-245l-706 1332v-1332h-185v1489h307l644 -1216v1216h185v-1489z","M1215 1313h-1101v176h1101v-176zM1163 729h-997v176h997v-176zM1215 0h-1101v176h1101v-176z","M1310 1318q91 -100 139.5 -245t48.5 -329t-49.5 -329.5t-138.5 -242.5q-92 -101 -217.5 -152t-286.5 -51q-157 0 -285.5 52t-218.5 151t-138.5 243t-48.5 329q0 182 48 326.5t140 247.5q88 98 218.5 150t284.5 52q160 0 287.5 -52.5t216.5 -149.5zM1292 744 q0 290 -130 447.5t-355 157.5q-227 0 -356.5 -157.5t-129.5 -447.5q0 -293 132 -448.5t354 -155.5t353.5 155.5t131.5 448.5z","M1339 0h-198v1313h-743v-1313h-198v1489h1139v-1489z","M1174 1039q0 -99 -34.5 -183.5t-96.5 -146.5q-77 -77 -182 -115.5t-265 -38.5h-198v-555h-198v1489h404q134 0 227 -22.5t165 -70.5q85 -57 131.5 -142t46.5 -215zM968 1034q0 77 -27 134t-82 93q-48 31 -109.5 44.5t-155.5 13.5h-196v-595h167q120 0 195 21.5t122 68.5 q47 48 66.5 101t19.5 119z","M1280 0h-1162v184l620 600l-600 526v179h1096v-176h-832l586 -506v-26l-630 -605h922v-176z","M1262 1313h-532v-1313h-198v1313h-532v176h1262v-176z","M1254 1489l-524 -836v-653h-198v632l-526 857h219l407 -666l411 666h211z","M1572 755q0 -140 -44.5 -248.5t-123.5 -181.5q-85 -79 -207 -125.5t-260 -49.5v-166h-197v166q-134 3 -257 48t-210 127q-79 74 -123.5 182t-44.5 248q0 136 43 238t119 178q81 81 202.5 128t270.5 51v155h197v-155q148 -3 271 -52t202 -127q75 -73 118.5 -177t43.5 -239 zM1366 763q0 99 -32 182t-91 140q-58 56 -129 82t-177 28v-890q94 2 171 30.5t127 75.5q65 60 98 147t33 205zM740 305v890q-106 -1 -177 -28t-129 -82t-90.5 -140t-32.5 -182q0 -112 33.5 -203t97.5 -149q49 -45 126.5 -75t171.5 -31z","M1336 1489l-514 -736l513 -753h-229l-406 613l-416 -613h-216l519 744l-507 745h228l401 -605l410 605h217z","M1604 910q0 -157 -40.5 -264.5t-117.5 -174.5q-80 -69 -192.5 -104t-263.5 -45v-322h-197v322q-154 11 -267 47t-188 102q-78 69 -118.5 176t-40.5 263v579h198v-602q0 -109 29.5 -180t81.5 -115q53 -45 130 -68.5t175 -30.5v996h197v-996q97 8 175 30.5t131 68.5 q56 49 83 115.5t27 179.5v602h198v-579z","M1568 0h-576v387q60 38 119.5 82t103.5 101q45 59 71 138.5t26 185.5q0 206 -127 330.5t-347 124.5t-347 -124.5t-127 -330.5q0 -106 26 -185.5t71 -138.5q45 -57 104 -101t119 -82v-387h-576v174h410v124q-157 90 -258.5 246t-101.5 350q0 276 187.5 451t492.5 175 t492.5 -175t187.5 -451q0 -194 -101.5 -350t-258.5 -246v-124h410v-174z","M725 0h-588v152h195v1185h-195v152h588v-152h-195v-1185h195v-152zM738 1677h-199v195h199v-195zM325 1677h-199v195h199v-195z","M1254 1489l-524 -836v-653h-198v632l-526 857h219l407 -666l411 666h211zM939 1677h-199v195h199v-195zM526 1677h-199v195h199v-195z","M1091 0h-188v117q-81 -70 -169 -109t-191 -39q-200 0 -317.5 154t-117.5 427q0 142 40.5 253t109.5 189q68 76 158.5 116t187.5 40q88 0 156 -22t143 -61v52h188v-1117zM903 275v636q-76 34 -136 49.5t-131 15.5q-158 0 -246 -110t-88 -312q0 -199 68 -302.5t218 -103.5 q80 0 162 35.5t153 91.5zM743 1676l-49 -384h-145l-49 384h243z","M1006 64q-107 -48 -210 -69t-218 -21q-79 0 -161 16t-152 56q-69 39 -112.5 102.5t-43.5 157.5q0 96 56.5 168t177.5 110v7q-91 24 -145 90t-54 158q0 89 47.5 147.5t112.5 92.5q64 33 145 49t160 16q98 0 180 -16.5t172 -44.5v-207h-13q-66 51 -163.5 79t-197.5 28 q-45 0 -84 -5.5t-81 -25.5q-35 -15 -60.5 -48.5t-25.5 -77.5q0 -61 28 -95t76 -49q45 -14 97 -15.5t105 -1.5h111v-166h-158q-62 0 -112 -4.5t-92 -21.5q-41 -17 -65.5 -54t-24.5 -96q0 -53 26 -90t67 -58q37 -19 87.5 -29t106.5 -10q102 0 218 36t187 98h13v-206zM721 1676 l-49 -384h-145l-49 384h243z","M1119 -412h-188v1048q0 77 -9 144.5t-33 105.5q-25 42 -72 62.5t-122 20.5q-77 0 -161 -38t-161 -97v-834h-188v1117h188v-124q88 73 182 114t193 41q181 0 276 -109t95 -314v-1137zM802 1676l-49 -384h-145l-49 384h243z","M375 0h-188v1117h188v-1117zM403 1676l-49 -384h-145l-49 384h243z","M1116 407q0 -218 -122 -327.5t-348 -109.5q-223 0 -346 107.5t-123 329.5v710h188v-641q0 -93 10 -153t42 -106q31 -43 84.5 -64.5t145.5 -21.5q86 0 143.5 22t87.5 66q29 44 39.5 105.5t10.5 151.5v641h188v-710zM760 1676l-49 -384h-128l-49 384h226zM1043 1304h-191 v195h191v-195zM442 1304h-191v195h191v-195z","M1091 0h-188v117q-81 -70 -169 -109t-191 -39q-200 0 -317.5 154t-117.5 427q0 142 40.5 253t109.5 189q68 76 158.5 116t187.5 40q88 0 156 -22t143 -61v52h188v-1117zM903 275v636q-76 34 -136 49.5t-131 15.5q-158 0 -246 -110t-88 -312q0 -199 68 -302.5t218 -103.5 q80 0 162 35.5t153 91.5z","M1165 444q0 -202 -134.5 -334t-339.5 -132q-79 0 -167 22t-151 64v-476h-188v1490q0 224 126.5 351t349.5 127q90 0 164.5 -21.5t133.5 -67.5q57 -43 91 -112t34 -160q0 -127 -69.5 -221.5t-196.5 -131.5v-17q159 -26 253 -125.5t94 -255.5zM971 449q0 89 -34.5 144.5 t-92.5 86.5q-59 32 -132 43t-146 11h-36v160h36q66 0 131 14.5t104 44.5q46 34 68.5 83t22.5 134q0 112 -69 170t-178 58q-73 0 -125 -26.5t-85 -70.5q-32 -44 -47 -102.5t-15 -120.5v-862q66 -38 141 -53.5t147 -15.5q149 0 229.5 78.5t80.5 223.5z","M1151 1117l-457 -1061v-468h-188v468l-445 1061h204l343 -828l346 828h197z","M1139 551q0 -272 -138.5 -427t-376.5 -155q-241 0 -379.5 151.5t-138.5 413.5q0 141 43 239.5t107 162.5q69 72 159 113t182 58q-76 63 -166 130.5t-192 139.5v179h810v-158h-561v-10q68 -46 179 -124t204 -162q150 -136 209 -261.5t59 -289.5zM945 551q0 135 -55 249 t-165 200q-66 -8 -138.5 -32t-138.5 -77q-63 -50 -105.5 -137t-42.5 -214q0 -201 85 -305t241 -104q153 0 236 105.5t83 314.5z","M1006 64q-107 -48 -210 -69t-218 -21q-79 0 -161 16t-152 56q-69 39 -112.5 102.5t-43.5 157.5q0 96 56.5 168t177.5 110v7q-91 24 -145 90t-54 158q0 89 47.5 147.5t112.5 92.5q64 33 145 49t160 16q98 0 180 -16.5t172 -44.5v-207h-13q-66 51 -163.5 79t-197.5 28 q-45 0 -84 -5.5t-81 -25.5q-35 -15 -60.5 -48.5t-25.5 -77.5q0 -61 28 -95t76 -49q45 -14 97 -15.5t105 -1.5h111v-166h-158q-62 0 -112 -4.5t-92 -21.5q-41 -17 -65.5 -54t-24.5 -96q0 -53 26 -90t67 -58q37 -19 87.5 -29t106.5 -10q102 0 218 36t187 98h13v-206z","M922 75q32 -40 46 -85.5t14 -85.5q0 -84 -45 -168.5t-112 -147.5h-179v14q90 79 128 138.5t38 128.5q0 57 -30.5 95t-77.5 38h-145q-229 0 -340 116t-111 345q0 140 46 268t124 247q75 112 173.5 214.5t206.5 196.5v9h-460v158h744v-135q-117 -78 -231.5 -181 t-204.5 -223q-89 -117 -146 -257t-57 -283q0 -34 3 -70t15 -76q10 -38 34.5 -75.5t63.5 -61.5q36 -22 96.5 -24.5t116.5 -2.5h86q71 0 122 -26t82 -66z","M1119 -412h-188v1048q0 77 -9 144.5t-33 105.5q-25 42 -72 62.5t-122 20.5q-77 0 -161 -38t-161 -97v-834h-188v1117h188v-124q88 73 182 114t193 41q181 0 276 -109t95 -314v-1137z","M1141 768q0 -190 -23 -316.5t-59 -210.5q-58 -135 -163 -203.5t-257 -68.5t-257 68.5t-163 203.5q-37 84 -59.5 210.5t-22.5 316.5q0 174 22.5 305.5t60.5 214.5q57 130 162.5 199t256.5 69t256.5 -69t162.5 -199q37 -84 60 -215t23 -305zM952 858q-4 143 -28.5 250 t-56.5 161q-41 70 -95 98.5t-133 28.5t-133 -28.5t-95 -98.5q-34 -55 -57.5 -161.5t-27.5 -249.5h626zM952 697h-626q0 -142 23 -258.5t59 -178.5q40 -69 96 -100t135 -31t135 31t96 100q36 62 59 178.5t23 258.5z","M375 0h-188v1117h188v-1117z","M1192 0h-248l-451 489l-112 -109v-380h-188v1117h188v-550l384 417q72 79 135.5 107t126.5 28q28 0 58 -1t37 -1v-166h-11q-16 2 -39.5 3t-36.5 1q-47 0 -85.5 -23.5t-67.5 -56.5l-251 -271z","M1151 0h-205l-328 829l-361 -829h-196l465 1056l-215 500h211z","M1125 0h-186v118q-74 -78 -141.5 -108.5t-145.5 -30.5q-75 0 -135 27t-144 107v-525h-188v1529h188v-838q32 -39 111 -80t170 -41q93 0 161 33.5t122 93.5v832h188v-1117z","M1151 1117l-452 -1117h-189l-449 1117h204l346 -889l343 889h197z","M1041 -96q0 -85 -45.5 -169t-111.5 -147h-180v14q92 79 129.5 139t37.5 128q0 55 -29 94t-75 39h-140q-140 0 -232.5 27t-155.5 84q-66 60 -100.5 135.5t-34.5 163.5q0 78 25 144t73 119q44 49 112.5 83.5t144.5 53.5v11q-125 28 -200 110.5t-75 186.5q0 83 43.5 150.5 t133.5 125.5v6h-228v154h824v-158h-256q-68 0 -122.5 -14.5t-102.5 -48.5q-45 -32 -72 -83t-27 -118q0 -79 32.5 -128t83.5 -75q45 -23 104 -34t139 -11h170v-165h-295q-66 0 -118.5 -20t-99.5 -59q-43 -37 -68.5 -90t-25.5 -112q0 -102 37.5 -159t101.5 -82 q63 -25 139.5 -28.5t166.5 -3.5h28q68 0 119.5 -23.5t84.5 -60.5q31 -35 48 -82.5t17 -96.5z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z","M1120 0h-188v955h-559v-955h-188v1117h935v-1117z","M1172 577q0 -258 -138.5 -428.5t-360.5 -170.5q-65 0 -146.5 18t-153.5 61v-469h-188v1058q0 123 35.5 215.5t101.5 158.5q62 62 155.5 95t195.5 33q243 0 371 -147t128 -424zM978 565q0 218 -80 320t-226 102q-158 0 -228.5 -96t-70.5 -278v-403q73 -34 132.5 -48.5 t134.5 -14.5q162 0 250 111t88 307z","M1018 -96q0 -87 -47 -172t-109 -144h-177v14q86 75 124.5 135.5t38.5 131.5q0 54 -30 93.5t-75 39.5h-92q-117 0 -216 30t-174 97q-73 66 -114.5 170t-41.5 250q0 270 155.5 432t414.5 162q84 0 164 -18.5t147 -45.5v-211h-12q-94 62 -172.5 87t-146.5 25 q-166 0 -260.5 -119t-94.5 -312q0 -112 28.5 -183t78.5 -116q50 -44 114.5 -63.5t139.5 -19.5h100q115 0 186 -76.5t71 -186.5z","M1137 558q0 -281 -140.5 -435t-373.5 -154q-241 0 -379 158t-138 431q0 275 141 432.5t378 157.5q55 0 108 -11t82 -20h480v-165h-288q62 -73 96 -170t34 -224zM943 558q0 215 -82 322t-236 107q-161 0 -243 -112t-82 -317q0 -209 83.5 -318t239.5 -109q152 0 236 107.5 t84 319.5z","M1006 952h-404v-952h-188v952h-404v165h996v-165z","M1116 407q0 -218 -122 -327.5t-348 -109.5q-223 0 -346 107.5t-123 329.5v710h188v-641q0 -93 10 -153t42 -106q31 -43 84.5 -64.5t145.5 -21.5q86 0 143.5 22t87.5 66q29 44 39.5 105.5t10.5 151.5v641h188v-710z","M1514 576q0 -259 -171.5 -417t-440.5 -173v-398h-187v398q-130 6 -240.5 46.5t-191.5 109.5q-85 74 -132 172t-47 232q0 159 59 296t192 275h229v-17q-136 -99 -210 -232t-74 -300q0 -189 112.5 -304t301.5 -121v1000q33 2 70.5 2.5t76.5 0.5q304 0 478.5 -149.5 t174.5 -420.5zM1319 586q0 184 -112 293.5t-305 109.5v-846q206 10 311.5 126t105.5 317z","M1160 -412h-213l-346 619l-350 -619h-203l444 770l-433 759h213l335 -600l339 600h203l-433 -751z","M1507 446q0 -114 -48 -198t-127 -137q-82 -55 -182 -82.5t-215 -32.5v-408h-187v408q-115 6 -214.5 32t-182.5 83q-80 54 -127.5 137.5t-47.5 197.5v671h188v-612q0 -113 37.5 -180.5t89.5 -102.5q56 -38 123 -53t134 -19v967h187v-967q67 5 134 19t123 53 q59 40 93 101.5t34 181.5v612h188v-671z","M1553 503q0 -96 -23.5 -192.5t-74.5 -171.5q-55 -80 -133.5 -124.5t-193.5 -44.5q-96 0 -177 49.5t-118 116.5h-6q-39 -68 -113 -117t-176 -49q-113 0 -194.5 46.5t-132.5 122.5t-74.5 171.5t-23.5 192.5q0 170 57 308.5t201 305.5h228v-17q-135 -108 -214.5 -262 t-79.5 -337q0 -66 8 -122.5t38 -119.5q26 -55 72.5 -91.5t117.5 -36.5q51 0 86.5 12.5t55.5 29.5q22 18 36.5 40t20.5 37v584h186v-584q9 -17 23 -39t35 -39q24 -19 52.5 -30t86.5 -11q70 0 117 35.5t74 92.5q25 55 36 116t11 126q0 182 -78.5 336t-215.5 263v17h228 q144 -167 201 -305.5t57 -308.5z","M557 1304h-189v195h189v-195zM194 1304h-189v195h189v-195zM375 0h-188v1117h188v-1117z","M1116 407q0 -218 -122 -327.5t-348 -109.5q-223 0 -346 107.5t-123 329.5v710h188v-641q0 -93 10 -153t42 -106q31 -43 84.5 -64.5t145.5 -21.5q86 0 143.5 22t87.5 66q29 44 39.5 105.5t10.5 151.5v641h188v-710zM953 1304h-199v195h199v-195zM540 1304h-199v195h199 v-195z","M1137 558q0 -273 -140 -431t-375 -158q-237 0 -376.5 158t-139.5 431t139.5 431.5t376.5 158.5q235 0 375 -158.5t140 -431.5zM943 558q0 217 -85 322.5t-236 105.5q-153 0 -237.5 -105.5t-84.5 -322.5q0 -210 85 -318.5t237 -108.5q150 0 235.5 107.5t85.5 319.5z M743 1676l-49 -384h-145l-49 384h243z","M1116 407q0 -218 -122 -327.5t-348 -109.5q-223 0 -346 107.5t-123 329.5v710h188v-641q0 -93 10 -153t42 -106q31 -43 84.5 -64.5t145.5 -21.5q86 0 143.5 22t87.5 66q29 44 39.5 105.5t10.5 151.5v641h188v-710zM768 1676l-49 -384h-145l-49 384h243z","M1553 503q0 -96 -23.5 -192.5t-74.5 -171.5q-55 -80 -133.5 -124.5t-193.5 -44.5q-96 0 -177 49.5t-118 116.5h-6q-39 -68 -113 -117t-176 -49q-113 0 -194.5 46.5t-132.5 122.5t-74.5 171.5t-23.5 192.5q0 170 57 308.5t201 305.5h228v-17q-135 -108 -214.5 -262 t-79.5 -337q0 -66 8 -122.5t38 -119.5q26 -55 72.5 -91.5t117.5 -36.5q51 0 86.5 12.5t55.5 29.5q22 18 36.5 40t20.5 37v584h186v-584q9 -17 23 -39t35 -39q24 -19 52.5 -30t86.5 -11q70 0 117 35.5t74 92.5q25 55 36 116t11 126q0 182 -78.5 336t-215.5 263v17h228 q144 -167 201 -305.5t57 -308.5zM955 1676l-49 -384h-145l-49 384h243z","M1145 837q0 -164 -39 -344t-121 -303q-85 -124 -186.5 -173t-214.5 -49q-192 0 -313.5 126.5t-121.5 329.5q0 228 134.5 372.5t336.5 144.5q90 0 169.5 -26t158.5 -91q2 26 3 55.5t1 55.5q0 217 -79 318t-231 101q-78 0 -169.5 -31.5t-169.5 -86.5h-11v194 q81 44 181.5 66.5t196.5 22.5q137 0 239.5 -54.5t164.5 -178.5q42 -86 56.5 -189t14.5 -260zM942 678q-60 47 -136 74t-148 27q-141 0 -225 -91t-84 -261q0 -145 67.5 -221.5t179.5 -76.5q128 0 209.5 97t115.5 287q6 33 11.5 73t9.5 92z","M1438 0h-1388l562 1489h264zM1171 168l-432 1147l-431 -1147h863z","M1532 1315h-200v-1508h-198v1508h-592v-1508h-198v1508h-200v174h1388v-174z","M1369 -189h-1182v191l673 668l-663 631v188h1133v-176h-891l648 -601v-72l-666 -653h948v-176z","M1456 572h-1236v160h1236v-160z","M843 1489l-780 -1489h-165l780 1489h165z","M492 511h-239v283h239v-283z","M1737 1788l-880 -1939h-102l-384 993h-237v139h393l313 -821l730 1628h167z","M1887 663q0 -239 -122.5 -372.5t-329.5 -133.5q-133 0 -244 76.5t-180 222.5q-79 -151 -184.5 -225t-248.5 -74q-191 0 -304 135.5t-113 349.5q0 238 125 372t327 134q134 0 245 -77t179 -222q79 150 185.5 224.5t247.5 74.5q191 0 304 -135.5t113 -349.5zM967 729 q-63 117 -155 175.5t-188 58.5q-138 0 -216 -83.5t-78 -237.5q0 -133 63.5 -216t182.5 -83q110 0 172 48.5t119 142.5q34 57 52.5 92.5t47.5 102.5zM1718 663q0 134 -64 216.5t-182 82.5q-88 0 -152.5 -35.5t-138.5 -155.5q-30 -48 -55.5 -99.5t-44.5 -95.5 q60 -115 153.5 -174.5t189.5 -59.5q138 0 216 83t78 238z","M1168 1367h-10q-32 8 -89.5 18.5t-89.5 10.5q-129 0 -181 -61q-53 -61 -53 -210v-1123q0 -206 -104 -315q-105 -110 -293 -110q-52 0 -106.5 5.5t-103.5 15.5v178h10q33 -8 87 -18.5t88 -10.5q129 0 182 61q52 61 52 210v1123q0 204 104 315q104 110 293 110 q58 0 109 -5.5t105 -15.5v-178z","M1431 1104q-20 -194 -111 -293t-249 -99q-77 0 -147 37.5t-126 82.5q-65 52 -117 79.5t-96 27.5q-75 0 -117 -48t-70 -172h-155q23 182 112.5 280t248.5 98q72 0 143 -37t130 -83q61 -48 114.5 -77.5t98.5 -29.5q76 0 120.5 54.5t63.5 179.5h157zM1432 588 q-25 -184 -112 -281.5t-250 -97.5q-72 0 -144 37.5t-129 82.5q-39 31 -103 69t-110 38q-78 0 -121 -55t-63 -179h-157q19 192 110.5 292t249.5 100q77 0 146 -37t127 -83q35 -28 97 -67.5t116 -39.5q75 0 117 49.5t69 171.5h157z","M1431 362h-608l-104 -335h-153l104 335h-425v156h474l84 268h-558v156h606l105 335h153l-105 -335h427v-156h-476l-83 -268h559v-156z","M1408 303l-1154 483v124l1154 483v-183l-889 -362l889 -362v-183zM1408 0h-1154v160h1154v-160z","M1422 786l-1154 -483v183l889 362l-889 362v183l1154 -483v-124zM1422 0h-1154v160h1154v-160z"],this.OUTLINE_X=[[],[291,301,505,515],[168,211,729,772,554],[195,389,917,1364,1481,1481,1288,760,312,195],[155,604,722,1129.8,1160,1107,722,604,278.5,191.1,162,155],[149,172.3,242,630,1687,1844.3,1960,2031.3,2055,2031.8,1962,1575,517,359.8,244,172.8],[115,149.4,252.5,407.6,598,1555,1287,961.3,881,757.5,601,423.5,293,213.5,187],[164,207,343,386],[181,205.5,279,554,783,783,554,279,205.5],[147,376,651,724.5,749,724.5,651,376,147],[167,232,588,717,1073,1137,1137,1073,717,588,232,167],[210,755,921,1466,1466,921,755,210],[147,293,575,321],[153,777,777,153],[253,492,492,253],[-30,143,860,684],[137,167.9,260.5,420.1,652,881.4,1041.5,1135.6,1167,1136.1,1043.5,883.9,652,422,262,168.3],[278,1084,1084,780,625,278],[161,1169,1169,1106,1073.5,976,821.3,617,387.5,198,161],[167,364,608,830.5,1007,1111,1148,1117,1080,971,821,629,399.5,210,167],[77,790,982,1203,1203,982,798,77],[187,378,613,843.5,1015,1119,1157,1147,251,187],[137,183.5,316,475,675,875.1,1041.5,1153.6,1191,1046,965,866,542,315,179.5],[154,285,499,1173,1173,154],[122,157.9,265.5,433.6,651,859.6,1029.5,1142.4,1180,1140,1106.8,1007,851.5,651,456.8,300,196.5,162],[113,258,340,438,760,988,1122.5,1167,1121,990,829,629,429.5,263,150.5],[346,585,585,346],[230,376,658,585,346],[254,1408,1408,254],[245,1431,1431,245],[268,1422,1422,268],[160,406,610,970,1005,973.9,880.5,733.4,541,337.5,160],[176,240,419,692,1037,1210,1391,1714,1829.5,1870,1813.5,1651,1391,1041,701,426,243],[26,1374,832,568],[200,728,983.5,1168,1281,1323,1196,1159,1040,885,641,200],[115,169,319,549.5,844,1001.5,1134,1250.5,1350,1350,1084.5,845,546.5,317,167],[200,576,906.5,1134,1369.5,1458,1373,1136,918.5,572,200],[200,1181,1181,200],[200,398,1045,1151,1151,200],[115,171,330,577,896,1175.5,1442,1442,1441,1155.5,896,570.9,323.5,167.1],[200,1339,1339,200],[137,725,725,137],[44,178,306,486.6,626.5,716.1,746,746,233,44],[205,1397,1366,205],[200,1142,1142,398,200],[200,1526,1526,200],[200,1336,1336,200],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1310,1093.5,806,521.5,303,163],[200,398,1043,1139.5,1174,1127.5,996,831,604,200],[115,163.5,302,520.5,1010.5,1133.1,1290,1409.5,1528,1528,1498,1449.5,1310,1093.5,806,521.5,303,163],[200,1432,1130.5,1004,842,617,200],[134,395.5,685,941.5,1128,1241.5,1282,1222,990,702,480.3,301,182.5,143,134],[0,532,730,1262,1262,0],[178,213.5,330,505,749,989,1169,1285.5,1321,1321,178],[26,568,832,1374,238],[92,486,1546,1933,295],[68,1335,1336,80],[6,532,730,1254,225],[126,1288,1288,1266,160,126],[239,759,759,239],[70,787,960,246],[171,691,691,171],[186,383,1490,901,775],[-4,1306,1306,-4],[340,613,762,583],[104,130.3,209,325.5,465,1053,1053,1020,924,772.5,567,362,203],[185,679,866,1022,1128.5,1168,1139.4,1053.5,918.1,373,185],[105,145,258,431,653,832.5,1011,1011,841.5,653,430.1,255.5,142.6],[108,137.4,225.5,363.6,543,1091,1091,903,258,148.5],[106,145,262,448.5,696,904,1098,1120,1120,1089.4,997.5,849.1,649,428.6,255.5,143.4],[68,195,383,716,786,786,693.5,580,415,294,68],[108,225,391.5,565,798.3,962,1058.8,1091,1091,602,417,259,148.5],[185,1119,1119,1095.3,1024,373,185],[175,187,375,387,387,175],[-62,47.5,153,304,421,496,521,533,533,321,100,-62],[193,1199,1161,381,193],[187,375,375,187],[185,1815,1815,1793.1,1727.5,1615.9,1456,735,185],[185,1119,1119,1095.3,1024,907.5,748,185],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,997,833.3,622,409.4,245.5,140.9],[185,373,1019,1129,1168,1139.9,1055.5,920.6,741,185],[108,137.6,226.5,365.1,903,1091,1091,602,414,259,149.5],[185,373,882,882,816,745,185],[110,283.5,511,706.9,856.5,951.4,983,939,768.5,566,372.5,230,143.5,115,110],[62,211.3,278,387.5,538,649.5,765,765,377,189,62],[177,201.5,275,392.5,549,1111,1111,177],[61,510,699,1151,265],[86,380,1299,1590,766],[60,1152,1152,64],[61,298,499,1151,265],[93,995,995,978,107,93],[173,588.9,672.5,800.9,963,1113,1113,963,800.9,672.5,588.9,173],[378,552,552,378],[187,337,499.1,627.5,711.1,1127,1127,711.1,627.5,499.1,337,187],[187,354,1125,1290,1401,1466.5,1489,1322,551,386,274,209.5],[],[291,515,505,301],[159,191.6,289.5,647,765,1120,1120,765,647,292.5,192.4],[137,1163,1163,1137,997,816,630.6,484.5,389.6,182,137],[138,247,1058,1168,1168,1055,249,138],[108,187,557,745,1115,1191,320],[378,552,552,378],[172,229,404.5,575,796,965,1063,1096,1128,1071,896,725,497.5,334,235,203],[346,958,958,346],[159,222.4,412.5,692.1,1024,1355.9,1635.5,1825.6,1889,1825.6,1635.5,1355.9,1024,692.1,412.5,222.4],[151,238.5,454,944,944,920.3,849,723.5,537,368,231],[166,716,1146,1146,716,166],[210,1285,1456,1456,210],[153,777,777,153],[159,222.4,412.5,692.1,1024,1355.9,1635.5,1825.6,1889,1825.6,1635.5,1355.9,1024,692.1,412.5,222.4],[-4,1,1306,1306],[154,183,270,399.3,555,710.8,840,927,956,927.1,840.5,711.4,555,399.3,270,183],[215,1461,1461,921,755,215],[207,967,967,911,887.6,817.5,544,369.5,211,207],[207,363.5,540,703,834,923,956,929,904.9,832.5,561,384.5,224,207],[541,690,963,720],[190,378,1124,1124,190],[137,168.5,595,1106,1106,640,425.3,267,169.5],[253,492,492,253],[353,456,551,788.5,857.1,880,877,872,719,353],[291,299,914,914,693,558,291],[121,150.6,239.5,378.6,559,734.3,874,965.5,996,965.5,874,734.3,559,378.6,239.5,150.6],[174,604,1154,1154,604,174],[171,465,1694,1857,1857,1694,1410,545,408,171],[171,465,1955,1955,1890,1805.5,1410,545,408,171],[140,555,1750,1913,1913,1750,1500,448,294,155,140],[113,144.1,237.5,384.6,577,782,958,958,712,508,147.5],[26,1374,862,683,440],[26,1374,955,712,533],[26,1374,1033,805,578,350],[26,1374,1119,990,541,367,288],[26,1374,1005,806,393],[26,1374,1049,1023.6,947.5,834.6,699,564,451,374.5,349],[14,1901,1901,608],[115,169,548,652.5,750,990.5,1350,1350,1084.5,845,546.5,317,167],[200,1181,1181,643,400,200],[200,1181,1181,993,750,200],[200,1181,1181,803,576,200],[200,1181,1181,1038,426,200],[137,725,725,389,146,137],[137,725,725,482,137],[93,137,725,776,548,321],[126,137,725,738,738,126],[14,210,586,916.5,1144,1379.5,1468,1383,1146,929,582,210,14],[200,1336,1336,1208,1079,630,456,200],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1310,753,510,163],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1083,840,303,163],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1136,908,681,453,163],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1207,1078,629,455,163],[112,160.5,299,517.5,803,1089.5,1307,1445.5,1495,1446.5,1108,909,496,160],[291,402,1274,1385,1385,1274,402,291],[115,120,252,1092.5,1310,1448.5,1498,1474,1342,806,521.5,303,163],[178,213.5,330,505,749,989,1169,1285.5,1321,1321,753,510,178],[178,213.5,330,505,749,989,1169,1285.5,1321,1321,1073,830,178],[178,213.5,330,505,749,989,1169,1285.5,1321,1321,856,629,178],[178,213.5,330,505,749,989,1169,1285.5,1321,1321,1056,444,178],[6,532,730,1254,935,692],[200,398,1044,1139,1174,1127,997,398,200],[185,675,873.1,1029.5,1131.1,1165,1066,1037.4,951.5,819.9,654,470.5,321,221,185],[104,130.3,209,325.5,465,1053,1053,1020,559,316,203],[104,130.3,209,325.5,465,1053,1053,934,691,203],[104,130.3,209,325.5,465,1053,1053,961,733,506,278,203],[104,130.3,209,325.5,465,1053,1053,1038,909,460,286,207],[104,130.3,209,325.5,465,1053,1053,926,314,203],[104,130.3,209,325.5,465,1053,1053,956,930.6,854.5,741.6,606,471,358,281.5,256],[104,130.4,209.5,326.1,465,1433,1648.5,1833,1855,1855,1823.6,1729.5,1581.1,1387,564,360,202],[105,145,353,456,551,788.5,857.1,1011,1011,841.5,653,430.1,255.5,142.6],[106,145,262,448.5,696,904,1098,1120,1120,1089.4,997.5,580,337,143.4],[106,145,262,448.5,696,904,1098,1120,1120,1089.4,960,717,255.5,143.4],[106,145,262,448.5,696,904,1098,1120,1120,1089.4,986,758,531,303,143.4],[106,145,262,448.5,696,904,1098,1120,1120,1089.4,951,339,143.4],[-21,187,375,401,222],[160,187,375,582,339],[-11,187,375,572,394,167],[5,187,375,557,557,5],[106,140.6,244.5,405.6,612,828.3,995,1101.5,1137,1004,938,263],[185,1119,1119,1075,946,497,323,244,185],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,997,553,310,140.9],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,933,690,245.5,140.9],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,963,735,508,280,140.9],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1038,909,460,286,207],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,928,729,316,140.9],[210,719,957,1466,1466,957,719,210],[93,203,833.3,997,1102,1137,1132,1021,409.4,245.5,140.9,106],[177,201.5,275,392.5,549,1111,1111,585,342,177],[177,201.5,275,392.5,549,1111,1111,945,702,177],[177,201.5,275,392.5,549,1111,1111,757,530,177],[177,201.5,275,392.5,549,1111,1111,955,343,177],[61,298,499,1151,928,685],[185,373,1019,1129,1168,1139.9,1055.5,920.6,373,185],[230,376,658,585,346],[530,579,724,773],[256,588,716,1048,1048,765,539,256],[7,26,1374,832],[346,585,585,346],[0,49,443,1424,1424,443],[0,49,443,1582,1582,443],[0,49,380,968,968,380],[0,49,354.5,493,711.5,997,1283.5,1501,1639.5,1689,1640.5,1501,1284.5,997],[0,49,815,1013,1537,289],[0,49,291,1751,1751,1701,1654.1,1513.5,1296.6,1021],[-53,187,375,615,615,379,183,-53],[26,1374,832,568],[200,728,983.5,1168,1281,1323,1196,1159,1040,885,641,200],[200,398,1162,1162,200],[26,1414,852,588],[200,1181,1181,200],[126,1288,1288,1266,160,126],[200,1339,1339,200],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1310,1093.5,806,521.5,303,163],[137,725,725,137],[205,1397,1366,205],[26,1378,822,582],[200,1526,1526,200],[200,1336,1336,200],[114,1215,1215,114],[115,163.5,302,520.5,806,1092.5,1310,1448.5,1498,1449.5,1310,1093.5,806,521.5,303,163],[200,1339,1339,200],[200,398,1043,1139.5,1174,1127.5,996,831,604,200],[118,1280,1280,1234,138,118],[0,532,730,1262,1262,0],[6,532,730,1254,225],[105,149.5,273,740,937,1404,1527.5,1572,1528.5,1410,937,740,267,148],[68,1335,1336,80],[179,219.5,338,793,990,1446,1563.5,1604,1604,179],[108,1568,1568,1518,1471.1,1330.5,1113.6,838,562.4,345.5,204.9,158,108],[126,137,725,738,738,126],[6,532,730,1254,939,740,327],[108,137.4,225.5,363.6,543,1091,1091,743,500,148.5],[109,152.5,265,417,578,796,1006,1006,961,721,478,191.5,144],[185,931,1119,1119,1095.3,802,559,185],[160,187,375,403],[177,207.8,300,448,646,846,994,1085.5,1116,1116,1043,760,534,251,177],[108,137.4,225.5,363.6,543,1091,1091,604,416.5,258,148.5],[185,373,1030.5,1131.4,1165,1084,1050,959,825.5,661,462.1,311.5,216.6,185],[61,506,694,1151,265],[106,140.6,244.5,408.6,624,837.1,1000.5,1104.4,1139,1049,239],[109,152.5,265,417,578,796,1006,1006,961,789,609,449,304,191.5,144],[108,135.8,219,646,825,937,982,942,198],[185,931,1119,1119,1095.3,1024,907.5,748,185],[137,159.5,219,382,639,896,1059,1118,1141,1118,1058,895.5,639,382.5,220,159.5],[187,375,375,187],[193,1192,1122,1085,1027,193],[61,1151,522,311],[185,373,1125,1125,185],[61,510,699,1151,265],[104,138.5,239,704,884,995.5,1041,957,133],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,997,833.3,622,409.4,245.5,140.9],[185,1120,1120,185],[185,373,1033.5,1137.4,1172,1140,1044,887.3,673,477.5,322,220.5,185],[105,146.5,261,685,862,971,1018,986,839,675,441.9,260.5,143.9],[106,140.5,244,407.8,623,832.9,996.5,1101.9,1295,1295,625,412,247,141.3],[10,414,602,1006,1006,10],[177,207.8,300,448,646,846,994,1085.5,1116,1116,177],[104,151,283,715,902,1342.5,1471.1,1514,1470.4,1339.5,1132.6,861,784.5,714,355,163],[48,1160,1149,59],[176,223.5,748,935,1459,1507,1507,176],[113,136.5,211,343.5,538,1128,1321.5,1455,1529.5,1553,1496,1295,371,170],[5,187,375,557,557,5],[177,207.8,300,448,646,846,994,1085.5,1116,1116,953,341,177],[106,140.9,245.5,409.4,622,833.3,997,1102,1137,1102,743,500,140.9],[177,207.8,300,448,646,846,994,1085.5,1116,1116,768,525,177],[113,136.5,211,343.5,538,1128,1321.5,1455,1529.5,1553,1496,955,712,170],[149,179.4,270.5,409.6,584,798.5,985,1106,1145,1130.5,1074,909.5,670,473.5,292],[50,1438,876,612],[144,344,1332,1532,1532,144],[187,1369,1369,1330,197,187],[220,1456,1456,220],[-102,63,843,678],[253,492,492,253],[134,755,857,1737,1570,134],[161,189.3,274,406.5,578,1435,1620.9,1764.5,1856.4,1887,1858.8,1774,1641.5,1470,613,430.3,286,192.3],[138,241.5,348,515.3,641,719,1168,1168,1063,954,786.3,661,583,138],[243,400,1070,1214,1320,1432,1431,1274,604,462.4,355.5,243],[245,566,719,1431,1431,1109,956,245],[254,1408,1408,254],[268,1422,1422,268]],this.OUTLINE_Y=[[],[1489,0,0,1489],[1556,977,977,1556,1556],[421,0,0,421,932,1067,1489,1489,1067,556],[85,-361,-361,238.1,380,1231,1576,1576,1185,1071.5,935,283],[1075,880.5,743,0,-29,-1.8,80,217.8,413,607.5,745,1489,1517,1489.8,1408,1270.3],[409,230.9,90.5,-.6,-31,0,909,1333.4,1432.5,1498.1,1520,1490,1412,1301.5,1174],[1556,977,977,1556],[572,286.3,31,-412,-412,1556,1556,1113,857.8],[-412,-412,31,286.3,572,857.8,1113,1556,1556],[886,776,630,630,777,887,1299,1409,1556,1556,1410,1300],[572,27,27,572,732,1277,1277,732],[-370,-370,285,285],[561,561,742,742],[0,0,285,285],[-304,-304,1556,1556],[743,400,159,16.5,-31,15.9,156.5,397.4,745,1084.9,1326.5,1470.9,1519,1471.6,1329.5,1088.1],[0,0,152,1494,1494,1286],[0,0,171,1110,1279.4,1409.5,1492.4,1520,1491,1427,209],[63,-1.5,-31,2.5,106,254,441,1161,1320,1436,1500,1520,1490.5,1426,272],[419,0,0,419,579,1489,1489,649],[56,-5.5,-31,6.5,114,274,473,1489,1489,267],[654,324,104,3,-31,4.9,112.5,276.9,483,1494,1512,1517,1453.5,1277,1005],[1314,0,0,1266,1489,1489],[411,233.5,91,-2.8,-34,-2,94,238.3,415,1144,1294.5,1416,1496.3,1523,1495,1411,1285,1131],[1005,-6,-23.5,-29,33,209,480,834,1171.5,1385,1485.5,1519,1483.3,1376,1211.8],[0,0,1117,1117],[-370,-370,285,1117,1117],[590,77,1227,714],[362,362,942,942],[77,590,714,1227],[1245,0,0,964.5,1139,1293.4,1414.5,1492.9,1519,1497.5,1449],[647,291,15,-162.5,-226,-218.5,-190,157,394,663,1013.5,1283,1457,1519,1452,1268,991.5],[0,0,1489,1489],[0,0,28,122,262,458,1155,1316.5,1427,1477,1489,1489],[743,402.5,161,18.5,-27,-13.5,19,63,108,1385,1487,1516,1465,1317,1072],[0,0,28,119,375,743,1118,1371,1457.5,1489,1489],[0,0,1489,1489],[0,0,717,1313,1489,1489],[746,405.5,163,19,-29,12.5,110,749,1382,1485.5,1516,1464.4,1309.5,1065.4],[0,0,1489,1489],[0,0,1489,1489],[8,-12.5,-21,5.5,85,213.5,387,1489,1489,193],[0,0,1489,1489],[0,0,176,1489,1489],[0,0,1489,1489],[0,0,1489,1489],[744,415,172,21,-31,20,172,414.5,744,1073,1318,1467.5,1520,1468,1318,1070.5],[0,0,709,855.5,1039,1254,1396,1466.5,1489,1489],[744,415,172,21,-297.5,-369.1,-393,-386.5,-365,-183,744,1073,1318,1467.5,1520,1468,1318,1070.5],[0,0,1280.5,1409,1471.5,1489,1489],[92,3,-27,9,109,253,425,1412,1486,1516,1486.1,1396.5,1260.1,1090,340],[1313,0,0,1313,1489,1489],[598,313,115,6,-31,4,115,315.5,598,1489,1489],[1489,0,0,1489,1489],[1489,0,0,1489,1489],[0,0,1489,1489],[1489,0,0,1489,1489],[0,0,176,1489,1489,184],[-392,-392,1556,1556],[1556,-304,-304,1556],[-392,-392,1556,1556],[682,682,684,1489,1489],[-300,-300,-180,-180],[1676,1302,1302,1676],[324,182.8,69,-6,-31,0,758,939,1058,1124.5,1144,1126,1093],[0,-31,8.5,127,315,567,812.8,996,1110,1556,1556],[557,300,118,10.5,-25,0,70,1050,1116,1143,1104,987,801.5],[550,306.8,123,7.5,-31,0,1556,1556,992,803],[552,306.6,124.5,11.6,-26,1,68,539,641,856.3,1016,1115,1148,1107.8,987,797.8],[959,0,0,959,1374,1546,1560,1566,1539.4,1459.5,1117],[569,-375,-410.5,-423,-389.8,-290,-119.3,127,1117,1148,1108.5,998,817.5],[0,0,725,906,1039,1556,1556],[1304,0,0,1304,1499,1499],[-395,-415,-423,-398,-323,-199,-27,1304,1499,1499,1117,-216],[0,0,1117,1556,1556],[0,0,1556,1556],[0,0,725,902.9,1036.5,1120.1,1148,1148,1117],[0,0,725,906,1039,1120.8,1148,1117],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,989.5,1108.4,1148,1108.4,989.5,802.4],[-412,-412,133,323.5,572,813.4,995.5,1109.9,1148,1117],[555,314.1,131.5,16.4,-412,-412,1117,1148,1108,995,809.5],[0,0,912,1105,1114.5,1117,1117],[67,2.5,-27,-2.5,71,182.8,322,1060,1119.5,1144,1116.5,1042,933,803,278],[959,189.8,70,1,-22,-13,10,1117,1438,1438,1117],[392,209.1,76.5,-4.1,-31,0,1117,1117],[1117,0,0,1117,1117],[1117,0,0,1117,1117],[0,0,1117,1117],[1117,-412,-412,1117,1117],[0,0,159,1117,1117,139],[504,-170.9,-292.5,-367.1,-392,-392,1556,1556,1531.1,1456.5,1334.9,660],[-392,-392,1556,1556],[-392,-392,-367.1,-292.5,-170.9,504,660,1334.9,1456.5,1531.1,1556,1556],[395,395,396,440,561,732,927,927,926,880.5,761,589.5],[],[0,0,1489,1489],[557,333.5,163,-361,-361,74,1046,1475,1475,948.5,775.9],[0,0,171,1467,1501,1518,1485.9,1389.5,1243.1,751,207],[258,145,147,257,1067,1176,1176,1066],[1489,426,0,0,426,1489,1489],[-392,-392,1556,1556],[533,-327,-371.5,-385,-358,-275,-156,-10,601,1462,1505,1519,1490,1411,1293.5,1147],[1304,1304,1499,1499],[655,323.1,43.5,-146.6,-210,-146.6,43.5,323.1,655,986.9,1266.5,1456.6,1520,1456.6,1266.5,986.9],[833,616,531,554,1192,1332.4,1435.5,1498.9,1520,1504,1475],[608,162,191,1113,1142,697],[602,57,57,762,762],[561,561,742,742],[655,323.1,43.5,-146.6,-210,-146.6,43.5,323.1,655,986.9,1266.5,1456.6,1520,1456.6,1266.5,986.9],[1788,1668,1668,1788],[1116,960.4,831.5,744.9,716,745,832,961,1116,1271,1400,1487,1516,1487,1400,1271],[179,179,917,1462,1462,917],[566,566,711,1237,1350.4,1440.5,1519,1501.5,1458,722],[585,542,527,543.5,595,685.5,817,1278,1374.5,1452,1520,1502.5,1458,764],[1302,1302,1676,1676],[-412,-412,0,1117,1117],[1050,866,-363,-363,1489,1489,1460,1373,1234.3],[511,511,794,794],[-397,-416,-423,-337,-232,-89,-25,20,20,-237],[1256,566,566,688,1493,1493,1368],[1025,820.1,663.5,564.1,531,563.4,660.5,816.4,1025,1233.8,1390,1487.5,1520,1486.8,1387,1230],[191,162,608,697,1142,1113],[1246,0,0,220,353,944,1489,1493,1493,1363],[1246,0,0,139,664,865,1489,1493,1493,1363],[598,0,0,220,353,944,1489,1517,1500,1456,773],[350,195.6,74.5,-3.9,-30,-10,40,244,1489,1489,523],[0,0,1675,2049,2049],[0,0,2049,2049,1675],[0,0,1670,2049,2049,1670],[0,0,1992,1992,1987,1910,1682],[0,0,1872,1872,1872],[0,0,1712,1843.5,1952,2024.8,2049,2024.8,1952,1843.5,1712],[0,0,1489,1489],[743,402.5,-397,-416,-423,-337,108,1385,1487,1516,1465,1317,1072],[0,0,1489,2049,2049,1489],[0,0,1489,2049,2049,1489],[0,0,1489,2049,2049,1489],[0,0,1489,1872,1872,1489],[0,0,1489,2049,2049,1489],[0,0,2049,2049,1489],[1670,0,0,1670,2049,2049],[1677,0,0,1677,1872,1872],[740,0,0,28,119,375,743,1118,1371,1457.5,1489,1489,883],[0,0,1489,1992,1992,1987,1910,1489],[744,415,172,21,-31,20,172,414.5,744,1073,1318,2049,2049,1070.5],[744,415,172,21,-31,20,172,414.5,744,1073,2049,2049,1318,1070.5],[744,415,172,21,-31,20,172,414.5,744,1073,1670,2049,2049,1670,1070.5],[744,415,172,21,-31,20,172,414.5,744,1073,1992,1992,1987,1910,1070.5],[744,415,172,21,-31,20,172,414.5,744,1073,1872,1872,1872,1070.5],[216,105,105,216,1088,1199,1199,1088],[744,-146,-146,20,172,414.5,744,1611,1611,1520,1468,1318,1070.5],[598,313,115,6,-31,4,115,315.5,598,1489,2049,2049,1489],[598,313,115,6,-31,4,115,315.5,598,1489,2049,2049,1489],[598,313,115,6,-31,4,115,315.5,598,1489,2049,2049,1489],[598,313,115,6,-31,4,115,315.5,598,1489,1872,1872,1489],[1489,0,0,1489,2049,2049],[0,0,469,610.5,787,992,1130,1489,1489],[0,-24,12.4,121.5,284.1,481,1241,1376,1479,1544.3,1566,1536.5,1449,1295.5,1080],[324,182.8,69,-6,-31,0,758,939,1676,1676,1093],[324,182.8,69,-6,-31,0,758,1676,1676,1093],[324,182.8,69,-6,-31,0,758,1297,1676,1676,1297,1093],[324,182.8,69,-6,-31,0,758,1619,1619,1614,1537,1309],[324,182.8,69,-6,-31,0,758,1499,1499,1093],[324,182.8,69,-6,-31,0,758,1630,1761.8,1871,1944.5,1969,1944.5,1871,1761.8,1630],[317,178.8,68,-4.8,-29,-26,3.5,68,559,641,861.3,1020,1116,1148,1146,1127,1093],[557,300,-397,-416,-423,-337,-232,70,1050,1116,1143,1104,987,801.5],[552,306.6,124.5,11.6,-26,1,68,539,641,856.3,1016,1676,1676,797.8],[552,306.6,124.5,11.6,-26,1,68,539,641,856.3,1676,1676,987,797.8],[552,306.6,124.5,11.6,-26,1,68,539,641,856.3,1297,1676,1676,1297,797.8],[552,306.6,124.5,11.6,-26,1,68,539,641,856.3,1499,1499,797.8],[1676,0,0,1302,1676],[1302,0,0,1676,1676],[1297,0,0,1297,1676,1676],[1304,0,0,1304,1499,1499],[484,266.5,104,2.8,-31,12,141,351,637,1469,1566,1556],[0,0,725,1619,1619,1614,1537,1309,1117],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,989.5,1676,1676,802.4],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,1676,1676,989.5,802.4],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,1297,1676,1676,1297,802.4],[558,313.8,127,8.5,-31,8.5,127,313.8,558,1619,1619,1614,1537,1309],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,1499,1499,1499,802.4],[572,7,7,572,732,1297,1297,732],[-148,-148,8.5,127,313.8,558,1241,1241,1108.4,989.5,802.4,558],[392,209.1,76.5,-4.1,-31,0,1117,1676,1676,1117],[392,209.1,76.5,-4.1,-31,0,1117,1676,1676,1117],[392,209.1,76.5,-4.1,-31,0,1117,1676,1676,1117],[392,209.1,76.5,-4.1,-31,0,1117,1499,1499,1117],[1117,-412,-412,1117,1676,1676],[-412,-412,133,323.5,572,813.4,995.5,1109.9,1556,1556],[-370,-370,285,1117,1117],[1676,1292,1292,1676],[1304,1292,1292,1304,1499,1676,1676,1499],[1489,0,0,1489],[832,832,1117,1117],[1489,1105,0,0,1489,1489],[1489,1105,0,0,1489,1489],[1489,1105,0,0,1489,1489],[1489,1105,415,172,21,-31,20,172,414.5,744,1073,1318,1467.5,1520],[1489,1105,0,0,1489,1489],[1489,1105,0,0,174,894,1144.8,1345,1476.3,1520],[1304,0,0,1304,1499,1676,1676,1499],[0,0,1489,1489],[0,0,28,122,262,458,1155,1316.5,1427,1477,1489,1489],[0,0,1313,1489,1489],[0,0,1489,1489],[0,0,1489,1489],[0,0,176,1489,1489,184],[0,0,1489,1489],[744,415,172,21,-31,20,172,414.5,744,1073,1318,1467.5,1520,1468,1318,1070.5],[0,0,1489,1489],[0,0,1489,1489],[0,0,1489,1489],[0,0,1489,1489],[0,0,1489,1489],[0,0,1489,1489],[744,415,172,21,-31,20,172,414.5,744,1073,1318,1467.5,1520,1468,1318,1070.5],[0,0,1489,1489],[0,0,709,855.5,1039,1254,1396,1466.5,1489,1489],[0,0,176,1489,1489,184],[1313,0,0,1313,1489,1489],[1489,0,0,1489,1489],[755,507,325,-16,-16,325,506.5,755,994,1171,1505,1505,1171,993],[0,0,1489,1489],[910,647,471,0,0,471,645.5,910,1489,1489],[0,0,174,894,1144.8,1345,1476.3,1520,1476.3,1345,1144.8,894,174],[1677,0,0,1677,1872,1872],[1489,0,0,1489,1872,1872,1872],[550,306.8,123,7.5,-31,0,1117,1676,1676,803],[306,148.5,46,-10,-26,-5,64,270,1083,1676,1676,986.5,839],[0,-412,-412,725,906,1676,1676,1117],[1676,0,0,1676],[407,213.6,77.5,-3.1,-30,-2.6,79.5,216.1,407,1117,1499,1676,1676,1499,1117],[550,306.8,123,7.5,-31,0,1117,1148,1108,992,803],[-412,-412,110,259.5,444,1195,1355,1467,1534.5,1556,1524.3,1429,1277.8,1078],[1117,-412,-412,1117,1117],[534,299.6,120.5,6.9,-31,7.8,124,308.3,551,1556,1556],[306,148.5,46,-10,-26,-5,64,270,1083,1127.5,1144,1128,1079,986.5,839],[463,262.3,118,-412,-412,-264.5,-96,1556,1556],[0,-412,-412,725,906,1039,1120.8,1148,1117],[768,451.5,241,37.5,-31,37.5,241,451.5,768,1073,1288,1487,1556,1487,1288,1073.5],[0,0,1117,1117],[0,0,1117,1118,1119,1117],[0,0,1556,1556],[-412,-412,0,1117,1117],[1117,0,0,1117,1117],[412,248.5,113,-412,-412,-265,-96,1556,1556],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,989.5,1108.4,1148,1108.4,989.5,802.4],[0,0,1117,1117],[-412,-412,148.5,340.9,577,821.5,1001,1111.3,1148,1115,1020,861.5,646],[549,299,129,-412,-412,-268,-96,1079,1124.5,1143,1102.5,981,792],[558,313.8,127,8.5,-31,7.5,123,308.8,952,1117,1148,1108.6,990.5,803.6],[952,0,0,952,1117,1117],[407,213.6,77.5,-3.1,-30,-2.6,79.5,216.1,407,1117,1117],[546,314,142,-412,-412,159,342.3,576,816.6,996.5,1108.6,1146,1145.5,1143,1117,842],[-412,-412,1117,1117],[446,248.5,-412,-412,248,446,1117,1117],[503,310.5,139,16.5,-30,-30,14.5,139,310.5,503,811.5,1117,1117,811.5],[1304,0,0,1304,1499,1499],[407,213.6,77.5,-3.1,-30,-2.6,79.5,216.1,407,1117,1499,1499,1117],[558,313.8,127,8.5,-31,8.5,127,313.8,558,802.4,1676,1676,802.4],[407,213.6,77.5,-3.1,-30,-2.6,79.5,216.1,407,1117,1676,1676,1117],[503,310.5,139,16.5,-30,-30,14.5,139,310.5,503,811.5,1676,1676,811.5],[424,240.1,94.5,-.4,-32,17,190,493,837,1097,1286,1464.5,1519,1496.5,1430],[0,0,1489,1489],[1315,-193,-193,1315,1489,1489],[-189,-189,-13,1489,1489,2],[572,572,732,732],[0,0,1489,1489],[511,511,794,794],[842,-151,-151,1788,1788,981],[642,447.6,292.5,190.9,157,157,190.4,290.5,450.4,663,857.4,1012.5,1114.1,1148,1148,1114.5,1014,854],[-402,-417.5,-423,-395.5,-313,-179.8,1367,1545,1560.5,1566,1538.5,1456,1321.8,-224],[202,202,209,233.4,306.5,588,1104,1104,1097,1072.5,999,719],[362,27,27,362,942,1277,1277,942],[0,0,1393,910],[0,0,910,1393]],this.KERN_C1=["'","'","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-","-",".",".","A","A","A","A","A","A","A","A","A","A","A","A","B","B","B","B","C","D","D","D","D","D","D","D","F","F","F","F","F","F","F","F","F","F","F","F","F","I","J","J","J","J","K","K","K","K","K","K","K","K","K","K","K","K","L","L","L","L","L","L","L","L","L","L","L","L","L","L","O","O","O","O","O","O","P","P","P","P","P","P","P","P","P","P","Q","Q","R","R","R","R","R","R","R","R","R","R","S","S","S","S","S","S","S","S","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","T","U","U","U","U","V","V","V","V","V","V","V","V","V","V","V","V","V","V","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","X","X","X","X","X","X","X","X","X","X","X","X","X","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Y","Z","Z","Z","Z","Z","Z","Z","Z","Z","Z","Z","Z","Z","Z","a","a","a","b","b","b","c","c","e","f","f","f","f","f","f","f","f","f","f","f","f","h","h","h","k","k","k","k","m","m","m","n","n","n","o","o","o","o","o","p","p","p","r","r","r","r","r","t","t","v","v","v","v","v","v","v","v","w","w","w","w","w","x","x","x","x","x","x","x","x","y","y","y","y","y","y","y","y","y","y","y","y","y","z","z","z","z","z","z","z","z","z","","","","","","","","","","","","",""],this.KERN_C2=["","A","","","z","y","x","w","v","a","Z","Y","X","W","V","T","S","J","I","A","-",",","y","w","v","u","t","Y","W","V","U","T","S","-","T",".","-",",","-","Z","Y","X","W","T",".",",","","","","o","e","a","T","A","?",";",":",".",",","-","","A",".",",","","","","y","w","v","u","o","e","a","O","-","","","y","v","Y","W","V","T","O","J","G","C","-","'","Z","Y","X","T",".",",","","","","o","e","a","Y","A",".",",",".",",","","","y","u","o","e","a","Y","T","-","","y","w","v","S","A",".",",","","","","","","z","y","w","v","u","s","r","o","g","e","c","a","T","S","O","G","C","A","?",";",":",".","-",",","","A",".",",","","","","y","u","o","e","a","A",";",":",".","-",",","","","","y","u","r","o","e","a","A",";",":",".","-",",","","","","","y","u","o","e","a","O","G","C","-","","","","","v","u","s","r","q","p","o","n","m","g","e","d","a","O","A",";",":",".","-",",","","","","","y","w","o","e","a","Z","O","G","C","-","y","w","v","y",".",",","T","-","T","}","y","]","\\","?",".","-",",","*",")","'",'"',"y","w","v","","o","e","-","y","w","v","y","w","v","y","x","v",".",",","y",".",",","","a",".","-",",","y","-","","","o","e","a",".","-",",","","a",".","-",",","","","o","g","e","d","c","-","","","","q","o","g","e","d","c","a",".","-",",","","","q","o","g","e","d","c","-","-","-","Z","Y","X","T",".",",","y","x","v",".",","],this.KERN_K=[100,100,20,50,40,40,50,20,40,20,30,140,80,50,50,150,20,100,30,50,160,130,50,30,50,10,20,80,50,60,10,120,10,50,60,20,-10,20,50,20,20,10,20,50,50,50,50,100,110,50,50,100,-30,100,-60,60,60,300,300,30,10,10,20,20,70,60,20,80,70,80,50,70,70,60,20,110,20,20,110,110,160,100,110,170,20,-100,20,20,160,120,20,20,10,50,30,30,50,50,70,50,50,50,-20,50,300,300,30,30,50,50,55,20,50,50,40,20,60,100,20,30,20,30,22,20,20,20,220,240,50,130,40,170,200,200,200,200,180,200,220,210,220,220,240,70,12,50,40,40,120,-60,200,200,290,150,290,20,10,20,20,100,100,70,65,60,100,100,100,60,80,80,290,50,290,100,100,60,65,60,60,100,100,100,50,80,80,220,50,290,60,50,10,10,80,30,60,60,50,10,10,10,80,130,140,20,80,100,110,110,100,130,100,130,100,100,130,130,120,140,20,80,200,200,290,140,290,60,50,20,20,65,40,60,60,50,10,20,20,20,60,16,10,16,5,20,30,60,20,140,-100,10,-100,-100,-110,120,50,130,-50,-100,-60,-60,20,10,20,20,20,20,100,20,10,20,20,10,20,15,20,15,20,30,5,20,30,40,36,290,20,290,10,40,18,40,18,18,40,180,40,180,20,20,70,20,70,24,20,24,10,24,10,20,50,18,40,18,10,18,10,18,10,18,40,190,40,190,12,10,10,12,10,12,10,10,20,50,20,20,20,10,50,30,30,15,20,15,20,30],this.pathCache=[],this.pathMissing=null,this.ctxReference=null;for(let t=this.GLYPH_DATA.length-1;t>=0;t--)this.pathCache[t]=null}getKerning(t,e){const n=this.KERN_K.length;for(let i=0;i<n;i++)if(this.KERN_C1[i]==t&&this.KERN_C2[i]==e)return-this.KERN_K[i];return 0}static measureText(t,e){return this.main.measureText(t,e)}measureText(t,e){let n=jt.main,i=e/n.UNITS_PER_EM,s=0;for(let e=0;e<t.length;e++){let i=t.charAt(e),l=this.getIndex(i);l<0?s+=n.MISSING_HORZ:(s+=n.HORIZ_ADV_X[l],e<t.length-1&&(s+=n.getKerning(i,t.charAt(e+1))))}return[s*i,n.ASCENT*i*n.ASCENT_FUDGE,-n.DESCENT*i]}static measureWidths(t,e){return this.main.measureWidths(t,e)}measureWidths(t,e){let n=jt.main,i=e/n.UNITS_PER_EM,s=[0],l=0;for(let e=0;e<t.length;e++){let r=t.charAt(e),o=this.getIndex(r);o<0?(l+=n.MISSING_HORZ,s.push(l*i)):(l+=n.HORIZ_ADV_X[o],e<t.length-1&&(l+=n.getKerning(r,t.charAt(e+1))),s.push(l*i))}return s}getIndex(t){return this.UNICODE.indexOf(t)}getRawGlyph(t){return this.GLYPH_DATA[t]}getGlyphPath(t){let e=this.pathCache[t];return null!=e||(e=new Path2D(this.GLYPH_DATA[t]),this.pathCache[t]=e),e}getMissingPath(){return this.pathMissing||(this.pathMissing=new Path2D(this.MISSING_DATA)),this.pathMissing}getOutlineX(t){return this.OUTLINE_X[t].slice(0)}getOutlineY(t){return this.OUTLINE_Y[t].slice(0)}initNativeFont(t){if(null!=t||!this.ctxReference)if(null==t){let t=new OffscreenCanvas(256,256);this.ctxReference=t.getContext("2d")}else this.ctxReference=t}static measureTextNative(t,e,n,i={}){return this.main.measureTextNative(t,e,n,i)}measureTextNative(t,e,n,i={}){if(!this.ctxReference)throw"Calling measureTextNative without having called initNativeFont first";this.ctxReference.save();let s="";i.bold&&(s+="bold "),i.italic&&(s+="italic "),this.ctxReference.font=s+n+"px "+e;let l=this.ctxReference.measureText(t);this.ctxReference.restore();const r=this.ASCENT_FUDGE*this.ASCENT/this.UNITS_PER_EM;return[l.width,n*r,n*(-this.DESCENT/this.ASCENT)*r]}}jt.main=new jt,function(t){t[t.Normal=1]="Normal",t[t.Inclined=2]="Inclined",t[t.Declined=3]="Declined",t[t.Unknown=4]="Unknown",t[t.Dotted=5]="Dotted",t[t.DotDir=6]="DotDir",t[t.IncDouble=7]="IncDouble",t[t.IncTriple=8]="IncTriple",t[t.IncQuadruple=9]="IncQuadruple"}(Xt||(Xt={}));class Ht{static guestimateSize(t,e,n,i){let s=t.boundary(),l=s.minX(),r=s.minY(),o=s.maxX(),a=s.maxY(),h=e.data.fontSize*this.FONT_CORRECT;for(let e=1;e<=t.numAtoms;e++)if(t.atomExplicit(e)){let n=0;for(let i of t.atomElement(e))"|{}^".includes(i)||n++;let i=t.atomHydrogens(e)>0?1:0;const s=.35*h*(n+i),u=.75*h*(1+.2*i),m=t.atomX(e),c=t.atomY(e);l=Math.min(l,m-s),o=Math.max(o,m+s),r=Math.min(r,c-u),a=Math.max(a,c+u)}let u=Math.max(1,o-l)*e.data.pointScale,m=Math.max(1,a-r)*e.data.pointScale;return n>0&&u>n&&(m*=n/u,u=n),i>0&&m>i&&(u*=i/m,m=i),[u,m]}constructor(t,e,n,i=new zt){this.mol=t,this.measure=e,this.policy=n,this.effects=i,this.points=[],this.lines=[],this.rings=[],this.paths=[],this.space=[],this.unsplitLines=null,this.wantArtifacts=!0,this.wantCrossings=!0,this.artifacts=null,this.bondOrder=[],this.atomCharge=[],this.atomUnpaired=[],this.artifactCharge=new Map,this.artifactUnpaired=new Map,this.artifactFract=new Map}getMolecule(){return this.mol}getMeasure(){return this.measure}getPolicy(){return this.policy}getEffects(){return this.effects}getScale(){return this.scale}setWantArtifacts(t){this.wantArtifacts=t}getArtifacts(){return this.artifacts}setArtifacts(t){this.artifacts=t}setWantCrossings(t){this.wantCrossings=t}arrange(){const{mol:e,measure:n,policy:i,effects:s}=this;this.scale=n.scale(),this.bondSepPix=i.data.bondSep*n.scale(),this.lineSizePix=i.data.lineSize*n.scale(),this.fontSizePix=i.data.fontSize*n.scale()*Ht.FONT_CORRECT,this.ymul=n.yIsUp()?-1:1;let l=null;if(this.wantArtifacts&&null==this.artifacts){this.artifacts=new tt(e),l=t.booleanArray(!1,e.numAtoms);for(let t of this.artifacts.getResPaths())for(let e of t.atoms)l[e-1]=!0;for(let t of this.artifacts.getResRings())for(let e of t.atoms)l[e-1]=!0;for(let t of this.artifacts.getArenes()){l[t.centre-1]=!0;for(let e of t.atoms)l[e-1]=!0}}this.setupBondOrders();for(let t=1;t<=e.numAtoms;t++){if(e.atomElement(t).length>2&&0==e.atomHydrogens(t)){this.points.push(null),this.space.push(null);continue}let n={anum:t,text:e.atomExplicit(t)||St.atomIsWeirdLinear(e,t)?e.atomElement(t):null,fsz:this.fontSizePix,col:this.policy.data.atomCols[e.atomicNumber(t)],oval:new f(this.measure.angToX(e.atomX(t)),this.measure.angToY(e.atomY(t)),0,0)},i=this.effects.colAtom[t];if(i&&(n.col=i),l&&l[t-1]&&"C"==e.atomElement(t)&&(n.text=null),null!=n.text){let t=this.measure.measureText(n.text,n.fsz);const e=1.1;n.oval.rw=.5*t[0]*e,n.oval.rh=.5*t[1]*e}this.points.push(n),this.space.push(this.computeSpacePoint(n))}for(let t=1;t<=e.numAtoms;t++)null==this.points[t-1]&&this.processLabel(t);let r=t.booleanArray(!1,e.numBonds);for(let i=1;i<=e.numBonds;i++){let s=e.bondFrom(i),l=e.bondTo(i),o=e.bondType(i),a=this.bondOrder[i-1];if(a<0)continue;let h=this.effects.colBond[i];h||(h=this.policy.data.foreground),r[i-1]=2==a&&(o==qt.BONDTYPE_NORMAL||o==qt.BONDTYPE_UNKNOWN);let u=this.points[s-1],m=this.points[l-1],c=u.oval.cx,d=u.oval.cy,C=m.oval.cx,g=m.oval.cy;if(Math.abs(C-c)<=1&&Math.abs(g-d)<=1){r[i-1]=!1;continue}if(r[i-1])continue;let A=(1==a&&o==qt.BONDTYPE_NORMAL?.25:.5)*n.scale(),b=this.shrinkBond(c,d,C,g,this.backOffAtom(s,c,d,C,g,A)),y=this.shrinkBond(C,g,c,d,this.backOffAtom(l,C,g,c,d,A));this.ensureMinimumBondLength(b,y,c,d,C,g,A);let E=this.lineSizePix,x=0,M=mt.queryBondOrders(e,i);if(t.notBlank(M)){t.sort(M),-1==M[0]&&(M.splice(0,1),M.push(-1));let e=t.equals(M,[0,1,2,3,-1])?"?":M.map((t=>-1==t?"A":t.toString())).join(""),n=this.orthogonalDelta(b[0],b[1],y[0],y[1],1.3*this.bondSepPix),r=-.5;for(let t=0;t<2;t++,r++){let t=b[0]+r*n[0],e=b[1]+r*n[1],o=y[0]+r*n[0],a=y[1]+r*n[1],u={bnum:i,bfr:s,bto:l,type:Xt.Dotted,line:new p(t,e,o,a),size:.5*E,head:x,col:16777215&h|2147483648};this.lines.push(u),this.space.push(this.computeSpaceLine(u))}let o=Math.atan2(y[1]-b[1],y[0]-b[0])*L;(o<-90||o>90)&&(o+=180);let a={anum:0,text:e,fsz:.35*this.fontSizePix,col:h,oval:new f(.5*(b[0]+y[0]),.5*(b[1]+y[1]),0,0),rotation:o};this.points.push(a),this.space.push(this.computeSpacePoint(a));continue}let v=Xt.Normal;if(1==a&&o==qt.BONDTYPE_INCLINED?(v=Xt.Inclined,x=.15*n.scale()):1==a&&o==qt.BONDTYPE_DECLINED?(v=Xt.Declined,x=.15*n.scale()):o==qt.BONDTYPE_UNKNOWN?(v=Xt.Unknown,x=.2*n.scale()):0==a?v=o==qt.BONDTYPE_INCLINED||o==qt.BONDTYPE_DECLINED?Xt.DotDir:Xt.Dotted:2!=a&&3!=a&&4!=a||o!=qt.BONDTYPE_INCLINED&&o!=qt.BONDTYPE_DECLINED||(v=2==a?Xt.IncDouble:3==a?Xt.IncTriple:Xt.IncQuadruple,x=(2==a?.2:.25)*n.scale()),0==a){let t=y[0]-b[0],n=y[1]-b[1],i=1/N(t,n),r=.5*t*i*this.bondSepPix,o=.5*n*i*this.bondSepPix;e.atomAdjCount(s)>1&&(b[0]+=r,b[1]+=o),e.atomAdjCount(l)>1&&(y[0]-=r,y[1]-=o)}if(1!=a&&o==qt.BONDTYPE_DECLINED&&([b,y]=[y,b]),a>1&&(o==qt.BONDTYPE_NORMAL||o==qt.BONDTYPE_UNKNOWN)){let t=this.orthogonalDelta(b[0],b[1],y[0],y[1],this.bondSepPix),e=1,n=1;for(let n=0,i=-.5*(a-1);n<a;n++,i++){let n=b[0]+i*t[0],l=b[1]+i*t[1],r=y[0]+i*t[0],o=y[1]+i*t[1];e=Math.min(e,this.backOffAtom(s,n,l,r,o,A))}b=this.shrinkBond(b[0],b[1],y[0],y[1],e);for(let e=0,i=-.5*(a-1);e<a;e++,i++){let e=b[0]+i*t[0],s=b[1]+i*t[1],r=y[0]+i*t[0],o=y[1]+i*t[1];n=Math.min(n,this.backOffAtom(l,r,o,e,s,A))}y=this.shrinkBond(y[0],y[1],b[0],b[1],n);for(let e=0,n=-.5*(a-1);e<a;e++,n++){let e=b[0]+n*t[0],r=b[1]+n*t[1],o=y[0]+n*t[0],a=y[1]+n*t[1],u={bnum:i,bfr:s,bto:l,type:v,line:new p(e,r,o,a),size:E,head:x,col:h};this.lines.push(u),this.space.push(this.computeSpaceLine(u))}}else{let t={bnum:i,bfr:s,bto:l,type:v,line:new p(b[0],b[1],y[0],y[1]),size:E,head:x,col:h};this.lines.push(t),this.space.push(this.computeSpaceLine(t))}}let o=this.orderedRingList();for(let t=0;t<o.length;t++)for(let n=0;n<o[t].length;n++){let i=e.findBond(o[t][n],o[t][n<o[t].length-1?n+1:0]);r[i-1]&&(this.processDoubleBond(i,o[t]),r[i-1]=!1)}for(let t=1;t<=e.numBonds;t++)r[t-1]&&this.processDoubleBond(t,this.priorityDoubleSubstit(t));let a=t.numberArray(0,e.numAtoms);for(let t=1;t<=e.numAtoms;t++)a[t-1]=null==this.points[t-1].text?0:e.atomHydrogens(t);for(let t=0;t<e.numAtoms;t++)a[t]>0&&this.placeHydrogen(t,a[t],!0)&&(a[t]=0);for(let t=0;t<e.numAtoms;t++)a[t]>0&&this.placeHydrogen(t,a[t],!1);for(let t=1;t<=e.numAtoms;t++)if(e.atomIsotope(t)!=qt.ISOTOPE_NATURAL){let n=e.atomIsotope(t).toString(),s=i.data.atomCols[e.atomicNumber(t)];this.placeAdjunct(t,n,.6*this.fontSizePix,s,150*_)}for(let t=1;t<=e.numAtoms;t++){let n="",s=this.atomCharge[t-1];-1==s?n="-":1==s?n="+":s<-1?n=Math.abs(s)+"-":s>1&&(n=s+"+");for(let e=this.atomUnpaired[t-1];e>0;e--)n+=".";if(0==n.length)continue;let l=i.data.atomCols[e.atomicNumber(t)];this.placeAdjunct(t,n,1==n.length?.8*this.fontSizePix:.6*this.fontSizePix,l,30*_)}for(let t=0;t<s.atomDecoText.length;t++){let e=s.atomDecoText[t];e&&this.annotateAtom(t+1,e,s.atomDecoCol[t],s.atomDecoSize[t]*this.scale*Ht.FONT_CORRECT)}for(let t=0;t<s.bondDecoText.length;t++){let e=s.bondDecoText[t];e&&this.annotateBond(t+1,e,s.bondDecoCol[t],s.bondDecoSize[t]*this.scale*Ht.FONT_CORRECT)}for(let t=0;t<Math.min(s.atomCircleSz.length,e.numAtoms);t++)if(s.atomCircleSz[t]>0){let e=s.atomCircleSz[t]*this.scale,n=this.points[t],i=new d(n.oval.cx-e,n.oval.cy-e,2*e,2*e),l={anum:0,bnum:0,box:i,px:[i.minX(),i.maxX(),i.maxX(),i.minX()],py:[i.minY(),i.minY(),i.maxY(),i.maxY()]};this.space.push(l)}if(null!=this.artifacts){for(let t of this.artifacts.getResPaths())this.createCurvedPath(t.atoms,this.artifactFract.get(t),0),this.delocalisedAnnotation(t.atoms,this.artifactCharge.get(t),this.artifactUnpaired.get(t));for(let t of this.artifacts.getResRings())this.createCircularRing(t.atoms),this.delocalisedAnnotation(t.atoms,this.artifactCharge.get(t),this.artifactUnpaired.get(t));for(let t of this.artifacts.getArenes()){let n=t.atoms.length>2;if(n)for(let i=0;i<t.atoms.length;i++){let s=i<t.atoms.length-1?i+1:0;if(0==e.findBond(t.atoms[i],t.atoms[s])){n=!1;break}}let i=2==t.atoms.length;this.createBondCentroid(t.centre,t.atoms),i||(n?this.createCircularRing(t.atoms):this.createCurvedPath(t.atoms,!1,t.centre)),this.delocalisedAnnotation(t.atoms,this.artifactCharge.get(t),this.artifactUnpaired.get(t))}}if(this.wantCrossings){let t=new Ut(e);t.calculateCrossings();for(let e of t.crossings)1==e.higher?this.resolveLineCrossings(e.bond1,e.bond2):2==e.higher&&this.resolveLineCrossings(e.bond2,e.bond1)}let h=new ut(e);for(let t of h.getIDList())this.processPolymerUnit(h.getUnit(t),h.getUnits())}numPoints(){return this.points.length}getPoint(t){return this.points[t]}getPoints(){return this.points}numLines(){return this.lines.length}getLine(t){return this.lines[t]}getLines(){return this.lines}getUnsplitLines(){return this.unsplitLines}numRings(){return this.rings.length}getRing(t){return this.rings[t]}getRings(){return this.rings}numPaths(){return this.paths.length}getPath(t){return this.paths[t]}getPaths(){return this.paths}numSpace(){return this.space.length}getSpace(t){return this.space[t]}getSpaces(){return this.space}offsetEverything(e,n){var i;for(let t of this.points)t.oval.offsetBy(e,n);for(let t of[...this.lines,...null!==(i=this.unsplitLines)&&void 0!==i?i:[]])t.line.offsetBy(e,n);for(let t of this.rings)t.cx+=e,t.cy+=n;for(let i of this.paths)t.addTo(i.px,e),t.addTo(i.py,n);for(let i of this.space)i.box.offsetBy(e,n),t.addTo(i.px,e),t.addTo(i.py,n)}offsetOrigin(){let t=this.determineBoundary();0==t[0]&&0==t[1]||this.offsetEverything(-t[0],-t[1])}scaleEverything(e){var n;if(1!=e){this.scale*=e;for(let t of this.points)t.oval.scaleBy(e),t.fsz*=e;for(let t of[...this.lines,...null!==(n=this.unsplitLines)&&void 0!==n?n:[]])t.line.scaleBy(e),t.size*=e,t.head*=e;for(let t of this.rings)t.cx*=e,t.cy*=e,t.rw*=e,t.rh*=e,t.size*=e;for(let n of this.paths)t.mulBy(n.px,e),t.mulBy(n.py,e),n.size*=e;for(let n of this.space)n.box.scaleBy(e),t.mulBy(n.px,e),t.mulBy(n.py,e)}}determineBoundary(e){if(null==e&&(e=0),0==this.space.length)return[0,0,2*e,2*e];let n=t.numberArray(0,4),i=this.space[0];n[0]=i.box.x,n[1]=i.box.y,n[2]=i.box.x+i.box.w,n[3]=i.box.y+i.box.h;for(let t=this.space.length-1;t>0;t--)i=this.space[t],n[0]=Math.min(n[0],i.box.x),n[1]=Math.min(n[1],i.box.y),n[2]=Math.max(n[2],i.box.x+i.box.w),n[3]=Math.max(n[3],i.box.y+i.box.h);return n}determineBoundaryBox(){let[t,e,n,i]=this.determineBoundary();return new d(t,e,n-t,i-e)}squeezeInto(e,n,i,s,l){null!=l&&l>0&&(e+=l,n+=l,i-=2*l,s-=2*l);let r=this.determineBoundary(0),o=r[2]-r[0],a=r[3]-r[1];if(o>i||a>s){let e=1;o>i&&(e=i/o),a>s&&(e=Math.min(e,s/a)),this.scaleEverything(e),t.mulBy(r,e)}this.offsetEverything(e-r[0]+.5*(i-r[2]+r[0]),n-r[1]+.5*(s-r[3]+r[1]))}limitBounds(t,e){let n=this.determineBoundary(0);if(n[0]==n[2]&&n[1]==n[3])return;let i=Math.min(1,Math.min(t/(n[2]-n[0]),e/(n[3]-n[1])));this.offsetEverything(-n[0],-n[1]),this.scaleEverything(i)}monochromate(t){for(let e of this.points)e.col=t;for(let e of this.lines)e.col=t}spatialCongestion(t,e,n){null==n&&(n=.001);let i=0;for(let s=0;s<this.points.length;s++){let l=this.points[s];if(null==l)continue;let r=l.oval.cx-t,o=l.oval.cy-e;i+=1/(r*r+o*o+n)}return i}clone(){let t=new Ht(this.mol,this.measure,this.policy,this.effects);t.scale=this.scale,t.bondSepPix=this.bondSepPix,t.lineSizePix=this.lineSizePix,t.fontSizePix=this.fontSizePix,t.ymul=this.ymul;for(let e of this.points)t.points.push(H(e));for(let e of this.lines)t.lines.push(H(e));for(let e of this.space)t.space.push(H(e));return t}setupBondOrders(){const t=this.mol;for(let e=0;e<t.numBonds;e++)this.bondOrder[e]=t.bondOrder(e+1);for(let e=0;e<t.numAtoms;e++)this.atomCharge[e]=t.atomCharge(e+1),this.atomUnpaired[e]=t.atomUnpaired(e+1);let e=(e,n)=>{let i=0,s=0;for(let t of n)i+=this.atomCharge[t-1],s+=this.atomUnpaired[t-1],this.atomCharge[t-1]=this.atomUnpaired[t-1]=0;this.artifactCharge.set(e,i),this.artifactUnpaired.set(e,s);for(let e of n)for(let i of t.atomAdjList(e))if(!n.includes(i)){let n=t.findBond(e,i);this.bondOrder[n-1]>=0&&(this.bondOrder[n-1]=1)}};if(null!=this.artifacts){for(let n of this.artifacts.getResPaths()){let i=0,s=0,l=0;for(let e=0;e<n.atoms.length;e++){i+=t.atomCharge(n.atoms[e]),s+=t.atomUnpaired(n.atoms[e]);let r=t.findBond(n.atoms[e],n.atoms[e<n.atoms.length-1?e+1:0]);r>0&&(l+=t.bondOrder(r))}let r=(2*l-i+s)/n.atoms.length<1;this.artifactFract.set(n,r);for(let e=0;e<n.atoms.length-1;e++){let i=t.findBond(n.atoms[e],n.atoms[e+1]);i>0&&(this.bondOrder[i-1]=r?-1:1)}e(n,n.atoms)}for(let n of this.artifacts.getResRings()){for(let e=0;e<n.atoms.length;e++){let i=t.findBond(n.atoms[e],n.atoms[e<n.atoms.length-1?e+1:0]);i>0&&(this.bondOrder[i-1]=1)}e(n,n.atoms)}for(let n of this.artifacts.getArenes()){let i=2==n.atoms.length;for(let e=0;e<n.atoms.length;e++){if(!i){let i=t.findBond(n.atoms[e],n.atoms[e<n.atoms.length-1?e+1:0]);i>0&&(this.bondOrder[i-1]=1)}let s=t.findBond(n.centre,n.atoms[e]);s>0&&(this.bondOrder[s-1]=-1)}e(n,n.atoms)}}}placeAdjunct(e,n,i,s,l){let r=this.measure.measureText(n,i),o=this.points[e-1],a=o.oval.cx,h=o.oval.cy,u=.55*r[0],m=.55*r[1];if(".."==n){let t=this.mol.atomAdjBonds(e).filter((t=>0==this.mol.bondOrder(t)));if(1==t.length){let n=this.getPoint(this.mol.bondOther(t[0],e)-1),l=n.oval.cx-a,r=n.oval.cy-h,o=1/N(l,r),c=.15*i,d=r*o*2.5*c,p=-l*o*2.5*c,C=1.2*(u+m)*o;return[l,r]=[l*C,r*C],this.points.push({anum:0,text:".",fsz:i,col:s,oval:new f(a+l+d,h+r+p,c,c)}),void this.points.push({anum:0,text:".",fsz:i,col:s,oval:new f(a+l-d,h+r-p,c,c)})}}let c=0,p=0,C=0,g=t.numberArray(0,4),A=t.numberArray(0,4),b=10,y=!1;for(let t=.5*(o.oval.rw+o.oval.rh);!y&&t<1.5*this.measure.scale();t+=.1*this.measure.scale()){const e=5*_;for(let n=0;!y&&n<Math.PI-1e-4;n+=e)for(let i=-1;i<=1;i+=2){let s=n*i+(i>0?e:0),r=l+s,o=t*Math.cos(r),d=t*Math.sin(r)*-this.ymul,f=a+o-u,E=a+o+u,x=h+d-m,M=h+d+m;g[0]=f,A[0]=x,g[1]=E,A[1]=x,g[2]=E,A[2]=M,g[3]=f,A[3]=M;let v=this.countPolyViolations(g,A,null,!1),T=10*v+Math.abs(s)+10*t,N=0==v&&Math.abs(s)<(b+1)*_;if((0==c||N||T<c)&&(c=T,p=o,C=d),N){y=!0;break}}b+=5}o={anum:0,text:n,fsz:i,col:s,oval:new f(a+p,h+C,u,m)},this.points.push(o);let E={anum:0,bnum:0,box:new d(o.oval.cx-u,o.oval.cy-m,2*u,2*m),px:[o.oval.cx-u,o.oval.cx+u,o.oval.cx+u,o.oval.cx-u],py:[o.oval.cy-m,o.oval.cy-m,o.oval.cy+m,o.oval.cy+m]};this.space.push(E)}processLabel(e){let n=this.mol.atomX(e),i=this.mol.atomY(e),s=0,l=0,r=this.mol.atomAdjList(e);for(let t=0;t<r.length;t++){let e=Math.atan2(this.mol.atomY(r[t])-i,this.mol.atomX(r[t])-n)*L;e>=-15&&e<=15?l+=3:e>=-85&&e<=85?l++:e>85&&e<95||e<-85&&e>-95||(e>165||e<-165?s+=3:s++)}let o=this.mol.atomElement(e),a=o.indexOf("|"),h=o.indexOf("{"),u=0;0==s&&0==l&&a<0&&h<0||(u=s<l?-1:l<s?1:St.congestionPoint(this.mol,n-1,i)<.5*St.congestionPoint(this.mol,n+1,i)?-1:1);let m=null,c=null,d=null,p=0;if(a<0&&h<0)0==u?m=[o]:u<0?(m=[o.substring(0,o.length-1),o.substring(o.length-1)],p=1):m=[o.substring(0,1),o.substring(1)];else{let e=[],n=[],i=[],s=o.split("|");u<0&&(s=t.reverse(s));let l="";for(let t=0;t<s.length;t++){let r=u>=0&&0==t||u<0&&t==s.length-1;u<0&&0==p&&t==s.length-1&&(p=e.length);let o=0;l="";for(let a=0;a<s[t].length;a++){let h=s[t].charAt(a);"{"==h||"}"==h?(l.length>0&&(e.push(l.toString()),n.push(o),i.push(r)),l="",o="{"==h?-1:0):"^"==h&&-1==o&&0==l.length?o=1:l+=h}l.length>0&&(e.push(l.toString()),n.push(o),i.push(r))}for(m=e,c=n,d=i;p<m.length-1&&0!=c[p];)p++}let C=t.numberArray(0,m.length),g=0;for(let t=0;t<m.length;t++)C[t]=this.measure.measureText(m[t],this.fontSizePix)[0],null!=c&&0!=c[t]&&(C[t]*=.6),g+=C[t];let A=this.measure.angToX(n),b=this.measure.angToY(i);for(let t=0;t<p;t++)A-=C[t];A-=.5*C[p];for(let t=0;t<m.length;t++){let n={anum:t==p||null!=d&&d[t]?e:0,text:m[t],fsz:this.fontSizePix,col:this.policy.data.atomCols[this.mol.atomicNumber(e)],oval:new f(A+.5*C[t],b,.5*C[t]*1.1,.5*this.fontSizePix*1.1)};null!=c&&0!=c[t]&&(n.fsz*=.6,c[t]<0?n.oval.cy+=.7*n.fsz*(this.measure.yIsUp()?-1:1):n.oval.cy-=.3*n.fsz*(this.measure.yIsUp()?-1:1)),t==p?(this.points[e-1]=n,this.space[e-1]=this.computeSpacePoint(n)):(this.points.push(n),this.space.push(this.computeSpacePoint(n))),A+=C[t]}}backOffAtom(t,e,n,i,s,l){if(e==i&&n==s)return 1;let r=e-i,o=n-s,a=N(r,o),u=1/a;const m=.1*this.measure.scale();let c=e+2*m*r*u,d=n+2*m*o*u,f=a,p=!1;for(let l of this.space)if(l.anum==t){const t=l.px.length;if(0==t)continue;for(let r=0;r<t;r++){let o=r<t-1?r+1:0,a=l.px[r],u=l.py[r],m=l.px[o],C=l.py[o];if(!h.doLineSegsIntersect(c,d,i,s,a,u,m,C))continue;let g=h.lineIntersect(e,n,i,s,a,u,m,C);p=!0,f=Math.min(f,N(g[0]-i,g[1]-s))}}return p?(f=Math.max(l,f-m),f/a):1}backOffAtomDelta(t,e,n,i,s,l){let r=this.backOffAtom(t,e,n,i,s,l);if(r>=1)return null;r=1-r;let o=(i-e)*r,a=(s-n)*r;return[q(o,a),o,a]}shrinkBond(t,e,n,i,s){return 1==s?[t,e]:[n+s*(t-n),i+s*(e-i)]}ensureMinimumBondLength(t,e,n,i,s,l,r){let o=e[0]-t[0],a=e[1]-t[1],h=q(o,a);if(h>=O((r=Math.min(r,N(s-n,l-i)))-1e-4))return;let u=Math.sqrt(h),m=N(t[0]-n,t[1]-i),c=N(s-e[0],l-e[1]),d=1-r/u,f=1/(m+c),p=m*d*f,C=c*d*f;t[0]-=o*p,t[1]-=a*p,e[0]+=o*C,e[1]+=a*C}orderedRingList(){let e=[],n=[6,5,7,4,3];for(let t=0;t<n.length;t++){let i=this.mol.findRingsOfSize(n[t]);for(let t=0;t<i.length;t++)e.push(i[t])}let i=e.length,s=t.numberArray(0,this.mol.numAtoms);for(let t=0;t<i;t++){let n=e[t];for(let t=0;t<n.length;t++)s[n[t]-1]++}let l=t.numberArray(0,i);for(let t=0;t<i;t++){let n=e[t];for(let e=0;e<n.length;e++)l[t]+=s[n[e]-1]}let r=t.idxSort(l),o=t.numberArray(0,i),a=0;for(let t=0;t<i;t++){let n=e[r[t]];for(let e=0;e<n.length;e++){let i=this.mol.findBond(n[e],n[e+1<n.length?e+1:0]);2==this.mol.bondOrder(i)&&o[t]++}a=Math.max(a,o[t])}let h=[];for(let t=a;t>=0;t--)for(let n=0;n<i;n++)o[n]==t&&h.push(e[r[n]]);return h}orthogonalDelta(t,e,n,i,s){let l=e-i,r=n-t,o=q(l,r),a=o>0?s/Math.sqrt(o):1;return[l*a,r*a]}processDoubleBond(t,e){let n=this.mol.bondFrom(t),i=this.mol.bondTo(t),s=this.mol.atomAdjList(n),l=this.mol.atomAdjList(i),r=this.points[n-1],o=this.points[i-1],a=r.oval.cx,h=r.oval.cy,u=o.oval.cx,m=o.oval.cy,c=this.orthogonalDelta(a,h,u,m,this.bondSepPix);const d=.5*this.measure.scale();let f=u-a,C=m-h,g=Math.atan2(C,f),A=0,b=0,y=0,E=0,x=0,M=0,v=0,T=0,N=!1;for(let t=0;t<s.length;t++)if(s[t]!=i){let i=this.mol.bondOrder(this.mol.findBond(n,s[t]));if(0==i)continue;if(i>1){N=!0;break}let l=!1;for(let n=0;n<(null==e?0:e.length);n++)e[n]==s[t]&&(l=!0);let r=z(Math.atan2(this.points[s[t]-1].oval.cy-h,this.points[s[t]-1].oval.cx-a),g);if(Math.abs(r)*L>175){N=!0;break}r>0?(l&&A++,x=s[t]):(l&&b++,M=s[t])}for(let t=0;t<l.length;t++)if(l[t]!=n){let n=this.mol.bondOrder(this.mol.findBond(i,l[t]));if(0==n)continue;if(n>1){N=!0;break}let s=!1;for(let n=0;n<(null==e?0:e.length);n++)e[n]==l[t]&&(s=!0);let r=z(Math.atan2(this.points[l[t]-1].oval.cy-m,this.points[l[t]-1].oval.cx-u),g);if(Math.abs(r)*L>175){N=!0;break}r>0?(s&&y++,v=l[t]):(s&&E++,T=l[t])}let q=0;N||A>1||b>1||y>1||E>1||A>0&&b>0||y>0&&E>0||(A>0||y>0?q=1:(b>0||E>0)&&(q=-1));let S=this.lineSizePix,w=a,O=h,D=u,R=m,B=0,I=0,k=0,_=0;0==q?(w=a+.5*c[0],O=h+.5*c[1],D=u+.5*c[0],R=m+.5*c[1],B=a-.5*c[0],I=h-.5*c[1],k=u-.5*c[0],_=m-.5*c[1]):q>0?(B=a+c[0],I=h+c[1],k=u+c[0],_=m+c[1],s.length>1&&null==this.points[n-1].text&&(B+=c[1],I-=c[0]),l.length>1&&null==this.points[i-1].text&&(k-=c[1],_+=c[0])):q<0&&(B=a-c[0],I=h-c[1],k=u-c[0],_=m-c[1],s.length>1&&null==this.points[n-1].text&&(B+=c[1],I-=c[0]),l.length>1&&null==this.points[i-1].text&&(k-=c[1],_+=c[0])),0!=q&&(this.mol.atomElement(n).length<=2&&1==this.mol.atomAdjCount(n)&&null!=this.points[n-1].text&&this.bumpAtomPosition(n,.5*c[0]*q,.5*c[1]*q),this.mol.atomElement(i).length<=2&&1==this.mol.atomAdjCount(i)&&null!=this.points[i-1].text&&this.bumpAtomPosition(i,.5*c[0]*q,.5*c[1]*q));let P=this.backOffAtomDelta(n,w,O,D,R,d),F=this.backOffAtomDelta(n,B,I,k,_,d);if(null!=P||null!=F){let t=(null==P?0:P[0])>(null==F?0:F[0])?P:F;w+=t[1],O+=t[2],B+=t[1],I+=t[2]}let X=this.backOffAtomDelta(i,D,R,w,O,d),U=this.backOffAtomDelta(i,k,_,B,I,d);if(null!=X||null!=U){let t=(null==X?0:X[0])>(null==U?0:U[0])?X:U;D+=t[1],R+=t[2],k+=t[1],_+=t[2]}if(0==q&&!N){let e=null;null!=this.points[n-1].text||this.mol.bondInRing(t)||(e=this.adjustBondPosition(x,n,w,O,D,R),null!=e&&(w=e[0],O=e[1]),e=this.adjustBondPosition(M,n,B,I,k,_),null!=e&&(B=e[0],I=e[1])),null!=this.points[i-1].text||this.mol.bondInRing(t)||(e=this.adjustBondPosition(v,i,D,R,w,O),null!=e&&(D=e[0],R=e[1]),e=this.adjustBondPosition(T,i,k,_,B,I),null!=e&&(k=e[0],_=e[1]))}let Y=this.mol.bondType(t)==qt.BONDTYPE_UNKNOWN?Xt.Unknown:Xt.Normal,j=Y==Xt.Unknown?.1*this.scale:0,H=this.effects.colBond[t];H||(H=this.policy.data.foreground);let W={bnum:t,bfr:n,bto:i,type:Y,line:new p(w,O,D,R),size:S,head:j,col:H},V={bnum:t,bfr:n,bto:i,type:Y,line:new p(B,I,k,_),size:S,head:j,col:H};this.lines.push(W),this.lines.push(V),this.space.push(this.computeSpaceLine(W)),this.space.push(this.computeSpaceLine(V))}placeHydrogen(e,n,i){let s=jt.main;const l=.6,r=s.getIndex("H");let o=this.points[e],a=o.fsz*s.INV_UNITS_PER_EM,h=n>=2?n.toString():"",m=s.getOutlineX(r),c=s.getOutlineY(r),p=s.HORIZ_ADV_X[r],C=p;for(let e=0;e<h.length;e++){let n=h.charAt(e),i=s.getIndex(n);if(0==e)C+=s.getKerning("H",n);else{let t=h.charAt(e-1);C+=s.getKerning(t,n)*l}let r=s.getOutlineX(i),o=s.getOutlineY(i);t.addTo(r,C/l),t.addTo(o,-.4*s.ASCENT*1.3),t.mulBy(r,l),t.mulBy(o,l),m=m.concat(r),c=c.concat(o),C+=s.HORIZ_ADV_X[i]*l}if(h.length>0){let t=new u(m,c,0);m=t.hullX,c=t.hullY}let g=-.5*p,A=.5*s.ASCENT*s.ASCENT_FUDGE;for(let t=0;t<m.length;t++)m[t]=o.oval.cx+(g+m[t])*a,c[t]=o.oval.cy+(A-c[t])*a*this.ymul;let b=0,y=0,E=this.measure.measureText(o.text,o.fsz);if(i){let e=[0,1,2,3],n=[1,0,2,3],i=[2,3,0,1],s=[3,2,0,1],l=e,r=this.mol.atomAdjList(o.anum);if(0==r.length){let t=["O","S","F","Cl","Br","I"];l=0==this.mol.atomCharge(o.anum)&&0==this.mol.atomUnpaired(o.anum)&&t.indexOf(this.mol.atomElement(o.anum))>=0?n:e}else{let t=!0,e=!0,a=!0,h=!0;const u=this.mol.atomX(o.anum),m=this.mol.atomY(o.anum);for(let n=0;n<r.length;n++){const i=this.mol.atomX(r[n]),s=this.mol.atomY(r[n]);i>u+.01&&(t=!1),i<u-.01&&(e=!1),s<m-.01&&(a=!1),s>m+.01&&(h=!1)}t||(e?l=n:a?l=s:h&&(l=i))}for(let e=0;e<4;e++){let n=0,i=0;0==l[e]?n=.5*E[0]+.5*p*a:1==l[e]?n=-.5*E[0]-(C-.5*p)*a:2==l[e]?i=(1.1*E[1]+.5*E[2])*-this.ymul:3==l[e]&&(i=(1.1*E[1]+.5*E[2])*this.ymul),t.addTo(m,n),t.addTo(c,i);let s=this.countPolyViolations(m,c,null,!0);if(t.addTo(m,-n),t.addTo(c,-i),0==s){b=n,y=i;break}}if(0==b&&0==y)return!1}else{const e=t.min(c),n=t.max(m),i=t.min(c),s=t.max(c),l=.5*(e+n),r=.5*(i+s),a=1+this.measure.scale()*this.policy.data.fontSize*Ht.FONT_CORRECT*.1/Math.max(n-l,s-r),h=m.length;let u=m.slice(0),d=c.slice(0);for(let t=0;t<h;t++)u[t]=(u[t]-l)*a+l,d[t]=(d[t]-r)*a+r;let f=0,p=0,C=0;for(let e=.5*(o.oval.rw+o.oval.rh);e<1.5*this.measure.scale();e+=.1*this.measure.scale()){let n=!1;for(let i=0;i<2*Math.PI;i+=5*_){let s=e*Math.cos(i),l=e*Math.sin(i);t.addTo(u,s),t.addTo(d,l);let r=this.countPolyViolations(u,d,null,!1);t.addTo(u,-s),t.addTo(d,-l),0==r&&(n=!0);let a=10*r+this.spatialCongestion(o.oval.cx+s,o.oval.cy+l,.5)+2*e;(0==f||a<f)&&(f=a,p=e,C=i,b=s,y=l)}if(n)break}}let x=this.measure.measureText("H",o.fsz);const M=1.1;let v={anum:0,text:"H",fsz:o.fsz,col:o.col,oval:new f(o.oval.cx+b,o.oval.cy+y,.5*x[0]*M,.5*x[1]*M)};if(this.points.push(v),h.length>0){const t=l*o.fsz;x=this.measure.measureText(h,t);let e={anum:0,text:h,fsz:t,col:o.col,oval:new f(v.oval.cx+.5*p*o.fsz*s.INV_UNITS_PER_EM+.5*x[0],v.oval.cy+.4*o.fsz,.5*x[0]*M,.5*x[1]*M)};this.points.push(e)}t.addTo(m,b),t.addTo(c,y);let T=t.min(m),N=t.min(c),q={anum:0,bnum:0,box:new d(T,N,t.max(m)-T,t.max(c)-N),px:m,py:c};return this.space.push(q),!0}computeSpacePoint(e){let n={anum:e.anum,bnum:0,box:new d,px:[],py:[]};const i=jt.main;let s=[],l=[],r=0,o=0;if(null!=e.text)for(let n=0;n<e.text.length;n++){let a=e.text.charAt(n),h=i.getIndex(a);if(h>=0){if(0==r)s=i.getOutlineX(h),l=i.getOutlineY(h),o=1;else{let e=i.getOutlineX(h),n=i.getOutlineY(h);e.length>0&&(t.addTo(e,r),s=s.concat(e),l=l.concat(n),o++)}r+=i.HORIZ_ADV_X[h]}else r+=i.MISSING_HORZ;if(n<e.text.length-1){let t=e.text.charAt(n+1);r+=i.getKerning(a,t)}}if(s.length>0){if(o>1){let t=new u(s,l,0);s=t.hullX,l=t.hullY}let a=-.5*r,h=.5*i.ASCENT*i.ASCENT_FUDGE,m=e.fsz*i.INV_UNITS_PER_EM;for(let t=0;t<s.length;t++)s[t]=e.oval.cx+(a+s[t])*m,l[t]=e.oval.cy+(h-l[t])*m*this.ymul;n.px=s,n.py=l;let c=t.min(s),f=t.min(l);n.box=new d(c,f,t.max(s)-c,t.max(l)-f)}else n.box=d.fromOval(e.oval),n.box.w>0&&n.box.h>0&&(n.px=[n.box.minX(),n.box.maxX(),n.box.maxX(),n.box.minX()],n.py=[n.box.minY(),n.box.minY(),n.box.maxY(),n.box.maxY()]);return n}computeSpaceLine(e){let n={anum:0,bnum:e.bnum,box:new d,px:[],py:[]};if(e.type==Xt.Normal||e.type==Xt.Dotted||e.type==Xt.DotDir)n.px=[e.line.x1,e.line.x2],n.py=[e.line.y1,e.line.y2];else{const t=e.line.x2-e.line.x1,i=e.line.y2-e.line.y1,s=e.head/Math.sqrt(t*t+i*i),l=s*i,r=-s*t;e.type==Xt.Unknown?(n.px=[e.line.x1+l,e.line.x1-l,e.line.x2-l,e.line.x2+l],n.py=[e.line.y1+r,e.line.y1-r,e.line.y2-r,e.line.y2+r]):(n.px=[e.line.x1,e.line.x2-l,e.line.x2+l],n.py=[e.line.y1,e.line.y2-r,e.line.y2+r])}return n.box.x=t.min(n.px)-e.size,n.box.y=t.min(n.py)-e.size,n.box.w=t.max(n.px)-n.box.x+e.size,n.box.h=t.max(n.py)-n.box.y+e.size,n}bumpAtomPosition(e,n,i){let s=this.points[e-1];s.oval.cx+=n,s.oval.cy+=i;for(let s=this.space.length-1;s>=0;s--){let l=this.space[s-1];null!=l&&l.anum==e&&(l.box.x+=n,l.box.y+=i,t.addTo(l.px,n),t.addTo(l.py,i))}}spaceSubset(t,e,n,i){let s=[];for(let l of this.space)h.rectsIntersect(t,e,n,i,l.box.x,l.box.y,l.box.w,l.box.h)&&s.push(l);return s}countPolyViolations(e,n,i,s){null==i&&(i=this.space);let l=0;const r=e.length,o=i.length;let a=new d,u=new d;for(let t=0;t<r;t++){let m=t<r-1?t+1:0;a.x=Math.min(e[t],e[m])-1,a.y=Math.min(n[t],n[m])-1,a.w=Math.max(e[t],e[m])-a.x+2,a.h=Math.max(n[t],n[m])-a.y+2;for(let r=0;r<o;r++){let o=i[r];if(null==o.px)continue;if(u.x=o.box.x-1,u.y=o.box.y-1,u.w=o.box.w+1,u.h=o.box.h+1,!a.intersects(u))continue;let c=o.px.length;for(let i=0;i<c;i++){let r=i<c-1?i+1:0;if(u.x=Math.min(o.px[i],o.px[r])-1,u.y=Math.min(o.py[i],o.py[r])-1,u.w=Math.max(o.px[i],o.px[r])-u.x+2,u.h=Math.max(o.py[i],o.py[r])-u.y+2,a.intersects(u)){if(h.doLineSegsIntersect(e[t],n[t],e[m],n[m],o.px[i],o.py[i],o.px[r],o.py[r])){if(s)return 1;l++;break}if(1==c)break}}}}a.x=t.min(e),a.y=t.min(n),a.w=t.max(e)-a.x,a.h=t.max(n)-a.y;for(let t=o-1;t>=0;t--){let o=i[t];if(u.x=o.box.x,u.y=o.box.y,u.w=o.box.w,u.h=o.box.h,a.intersects(u)){for(let t=o.px.length-1;t>=0;t--)if(h.pointInPolygon(o.px[t],o.py[t],e,n)){if(s)return 1;l++;break}for(let t=0;t<r;t++)if(h.pointInPolygon(e[t],n[t],o.px,o.py)){if(s)return 1;l++;break}}}return l}adjustBondPosition(t,e,n,i,s,l){if(0==t||0==e)return null;for(let r=0;r<this.lines.length;r++){let o=this.lines[r];if(1!=this.mol.bondOrder(o.bnum)||this.mol.bondType(o.bnum)!=qt.BONDTYPE_NORMAL)continue;let a=!1;if(this.mol.bondFrom(o.bnum)==t&&this.mol.bondTo(o.bnum)==e);else{if(this.mol.bondFrom(o.bnum)!=e||this.mol.bondTo(o.bnum)!=t)continue;a=!0}let u=z(Math.atan2(o.line.y2-o.line.y1,o.line.x2-o.line.x1),Math.atan2(l-i,s-n))*L;if(u>-5&&u<5||u>175||u<-175)continue;let m=h.lineIntersect(o.line.x1,o.line.y1,o.line.x2,o.line.y2,n,i,s,l);return 0==this.mol.atomRingBlock(e)&&(a?(o.line.x1=m[0],o.line.y1=m[1]):(o.line.x2=m[0],o.line.y2=m[1])),m}return null}priorityDoubleSubstit(t){let e=this.mol.bondFrom(t),n=this.mol.bondTo(t),i=this.mol.atomAdjList(e),s=this.mol.atomAdjList(n),l=this.points[e-1],r=this.points[n-1],o=l.oval.cx,a=l.oval.cy,h=r.oval.cx,u=r.oval.cy,m=h-o,c=u-a,d=Math.atan2(c,m),f=0,p=0,C=0,g=0;for(let t=0;t<i.length;t++)if(i[t]!=n)if(z(Math.atan2(this.points[i[t]-1].oval.cy-a,this.points[i[t]-1].oval.cx-o),d)>0){if(0!=f)return null;f=i[t]}else{if(0!=p)return null;p=i[t]}for(let t=0;t<s.length;t++)if(s[t]!=e)if(z(Math.atan2(this.points[s[t]-1].oval.cy-u,this.points[s[t]-1].oval.cx-h),d)>0){if(0!=C)return null;C=s[t]}else{if(0!=g)return null;g=s[t]}let A=(f>0?1:0)+(p>0?1:0),b=(C>0?1:0)+(g>0?1:0);if(1==A&&0==b)return[f>0?f:p];if(0==A&&1==b)return[C>0?C:g];if(1==A&&1==b){if(f>0&&C>0)return[f,C];if(p>0&&g>0)return[p,g];let t=this.orthogonalDelta(o,a,h,u,this.bondSepPix);return this.spatialCongestion(.5*(o+h)+t[0],.5*(a+u)+t[1])<this.spatialCongestion(.5*(o+h)-t[0],.5*(a+u)-t[1])?[f>0?f:C]:[p>0?p:g]}return 2==A&&1==b?0==C?[p,g]:[f,C]:1==A&&2==b?0==f?[p,g]:[f,C]:null}annotateAtom(t,e,n,i){let[s,l]=this.measure.measureText(e,i),r=this.points[t-1],o=r.oval.cx,a=r.oval.cy,h=.6*s,u=.6*l,m=[];for(let e of this.mol.atomAdjList(t)){let t=this.points[e-1].oval.cx-o,n=this.points[e-1].oval.cy-a;m.push(Math.atan2(n,t))}let c=.5*(r.oval.rw+r.oval.rh),p=.1*this.scale,C=I/36,g=Number.POSITIVE_INFINITY,A=0,b=0,y=[0,0,0,0],E=[0,0,0,0],x=h+c+8*p,M=u+c+8*p,v=this.spaceSubset(o-x,a-M,2*x,2*M);for(let t=0;t<8;t++){let e=c+t*p;for(let t=0;t<36;t++){let n=C*t,i=e*Math.cos(n),s=e*Math.sin(n),l=o+i-h,r=o+i+h,c=a+s-u,d=a+s+u;y[0]=l,E[0]=c,y[1]=r,E[1]=c,y[2]=r,E[2]=d,y[3]=l,E[3]=d;let f=1e3*this.countPolyViolations(y,E,v,!1);for(let t of m)f-=Math.abs(z(n,t));f<g&&(g=f,A=i,b=s)}if(g<500)break}let T=o+A,N=a+b,q={anum:0,text:e,fsz:i,col:n,oval:new f(T,N,h,u)};this.points.push(q);let S={anum:0,bnum:0,box:new d(T-h,N-u,2*h,2*u),px:[T-h,T+h,T+h,T-h],py:[N-u,N-u,N+u,N+u]};this.space.push(S)}annotateBond(t,e,n,i){let[s,l]=this.measure.measureText(e,i),r=this.mol.bondFrom(t),o=this.mol.bondTo(t),a=this.points[r-1],h=this.points[o-1],u=.5*(a.oval.cx+h.oval.cx),m=.5*(a.oval.cy+h.oval.cy),c=.6*s,p=.6*l,C=Math.atan2(h.oval.cy-a.oval.cy,h.oval.cx-a.oval.cx),g=[C,C+Math.PI];for(let t of this.mol.atomAdjList(r))if(t!=o){let e=this.points[t-1].oval.cx-this.points[r-1].oval.cx,n=this.points[t-1].oval.cy-this.points[r-1].oval.cy;g.push(Math.atan2(n,e))}for(let t of this.mol.atomAdjList(o))if(t!=r){let e=this.points[t-1].oval.cx-this.points[o-1].oval.cx,n=this.points[t-1].oval.cy-this.points[o-1].oval.cy;g.push(Math.atan2(n,e))}let A=.2*this.scale*this.bondOrder[t-1],b=.1*this.scale,y=I/36,E=Number.POSITIVE_INFINITY,x=0,M=0,v=[0,0,0,0],T=[0,0,0,0],N=c+A+8*b,q=p+A+8*b,S=this.spaceSubset(u-N,m-q,2*N,2*q);for(let t=0;t<8;t++){let e=A+t*b;for(let t=0;t<36;t++){let n=y*t,i=e*Math.cos(n),s=e*Math.sin(n),l=u+i-c,r=u+i+c,o=m+s-p,a=m+s+p;v[0]=l,T[0]=o,v[1]=r,T[1]=o,v[2]=r,T[2]=a,v[3]=l,T[3]=a;let h=1e3*this.countPolyViolations(v,T,S,!1);for(let t of g)h-=Math.abs(z(n,t));h<E&&(E=h,x=i,M=s)}if(E<500)break}let w=u+x,O=m+M,D={anum:0,text:e,fsz:i,col:n,oval:new f(w,O,c,p)};this.points.push(D);let R={anum:0,bnum:0,box:new d(w-c,O-p,2*c,2*p),px:[w-c,w+c,w+c,w-c],py:[O-p,O-p,O+p,O+p]};this.space.push(R)}boxOverlaps(t,e,n,i,s,l){let r=t,o=e,a=t+n,u=e+i;for(let t=0;t<this.points.length;t++){if(null!=s&&!s[t])continue;let e=this.points[t],n=e.oval.cx-e.oval.rw,i=e.oval.cy-e.oval.rh,l=e.oval.cx+e.oval.rw,h=e.oval.cy+e.oval.rh;if(!(a<n||r>l||u<i||o>h))return!0}for(let t=0;t<this.lines.length;t++){if(null!=l&&!l[t])continue;let e=this.lines[t],n=e.line.x1,i=e.line.y1,s=e.line.x2,m=e.line.y2;if(!(a<Math.min(n,s)||r>Math.max(n,s)||u<Math.min(i,m)||o>Math.max(i,m))){if(n>=r&&n<=a&&i>=o&&i<=u)return!0;if(s>=r&&s<=a&&m>=o&&m<=u)return!0;if(h.doLineSegsIntersect(n,i,s,m,r,o,a,o))return!0;if(h.doLineSegsIntersect(n,i,s,m,r,u,a,u))return!0;if(h.doLineSegsIntersect(n,i,s,m,r,o,r,u))return!0;if(h.doLineSegsIntersect(n,i,s,m,a,o,a,u))return!0}}return!1}resolveLineCrossings(t,e){const n=[Xt.Normal,Xt.Dotted,Xt.DotDir],i=()=>{this.unsplitLines||(this.unsplitLines=this.lines.map((t=>Object.assign(Object.assign({},t),{line:t.line.clone()}))))};for(let s=10;s>0;s--){let s=!1,l=this.lines.filter((e=>e.bnum==t&&n.includes(e.type))),r=this.lines.filter((t=>t.bnum==e&&n.includes(t.type)));for(let t of l)for(let e of r){if(t.bfr==e.bfr||t.bfr==e.bto||t.bto==e.bfr||t.bto==e.bto)continue;if(e.type==Xt.DotDir&&(e.type=Xt.Dotted),!h.doLineSegsIntersect(t.line.x1,t.line.y1,t.line.x2,t.line.y2,e.line.x1,e.line.y1,e.line.x2,e.line.y2))continue;let[n,l]=h.lineIntersect(t.line.x1,t.line.y1,t.line.x2,t.line.y2,e.line.x1,e.line.y1,e.line.x2,e.line.y2),r=e.line.x2-e.line.x1,o=e.line.y2-e.line.y1,a=Math.abs(r)>Math.abs(o)?(n-e.line.x1)/r:(l-e.line.y1)/o,u=N(r,o),m=e.size/u*(e.type==Xt.Normal?2:4);if(a>m&&a<1-m){i();let t={bnum:e.bnum,bfr:e.bfr,bto:e.bto,type:e.type,line:e.line.clone(),size:e.size,head:e.head,col:e.col};this.lines.push(t),e.line.x2=e.line.x1+r*(a-m),e.line.y2=e.line.y1+o*(a-m),t.line.x1=t.line.x1+r*(a+m),t.line.y1=t.line.y1+o*(a+m),s=!0}else a>m?(i(),e.line.x2=e.line.x1+r*(a-m),e.line.y2=e.line.y1+o*(a-m),s=!0):a<1-m&&(i(),e.line.x1=e.line.x1+r*(a+m),e.line.y1=e.line.y1+o*(a+m),s=!0)}if(!s)break}}createCircularRing(e){let n=new Array(e.length),i=new Array(e.length);for(let t=0;t<e.length;t++){let s=this.points[e[t]-1];n[t]=s.oval.cx,i[t]=s.oval.cy}let s=t.sum(n)/e.length,l=t.sum(i)/e.length,r=[],o=[],a=!0,u=Number.NaN;const m=.7;for(let t of e){let n=this.points[t-1],i=n.oval.cx-s,h=n.oval.cy-l,c=i-n.oval.rw,d=i+n.oval.rw,f=h-n.oval.rh,p=h+n.oval.rh;r.push(c),o.push(h),r.push(c),o.push(f),r.push(c),o.push(p),r.push(i),o.push(f),r.push(i),o.push(p),r.push(d),o.push(h),r.push(d),o.push(f),r.push(d),o.push(p);let C=N(i,h),g=Math.atan2(h,i);r.push(m*C*Math.cos(g)),o.push(m*C*Math.sin(g));for(let i of this.mol.atomAdjList(t))if(e.indexOf(i)>=0){let t=this.points[i-1],e=.5*(n.oval.cx+t.oval.cx)-s,a=.5*(n.oval.cy+t.oval.cy)-l,h=N(e,a),u=Math.atan2(a,e);r.push(m*h*Math.cos(u)),o.push(m*h*Math.sin(u))}a&&(Number.isFinite(u)?Math.abs(u-C)>1&&(a=!1):u=C)}let c={atoms:e,cx:s,cy:l,rw:0,rh:0,theta:0,size:0};if(a)c.rw=c.rh=h.fitCircle(r,o);else{let t=0;for(let r=0;r<e.length;r++)t+=N(n[r]-s,i[r]-l);let r=t/e.length*(1-m);var d=new Yt(n,i,r);d.calculate(),c.cx=d.cx,c.cy=d.cy,c.rw=d.rw,c.rh=d.rh,c.theta=d.theta}c.size=this.lineSizePix,this.rings.push(c)}createCurvedPath(e,n,i){const s=e.length;let l=[],r=[],o=[];for(let t=0;t<s;t++){let n=this.points[e[t]-1];l.push(n.oval.cx),r.push(n.oval.cy),o.push(null!=n.text)}let a=[],h=[];const u=.25*qt.IDEALBOND*this.scale;for(let t=0;t<s-1;t++){let e=l[t+1]-l[t],n=r[t+1]-r[t],i=u*D(N(e,n));a.push(n*i),h.push(-e*i)}let m=t.numberArray(0,s),c=t.numberArray(0,s),d=t.numberArray(0,s),f=t.numberArray(0,s);const p=o[0]?1.2:.7;if(n){const t=-h[0],e=a[0];m[0]=l[0]+t*p,c[0]=r[0]+e*p,d[0]=l[0]+t*p,f[0]=r[0]+e*p}else m[0]=l[0]+a[0]*p,c[0]=r[0]+h[0]*p,d[0]=l[0]-a[0]*p,f[0]=r[0]-h[0]*p;let C=0,g=0;for(let t=1;t<s-1;t++){const n=o[t]?1.2:.7,s=n;m[t]=l[t]+n*(a[t-1]+a[t]),c[t]=r[t]+n*(h[t-1]+h[t]),d[t]=l[t]-s*(a[t-1]+a[t]),f[t]=r[t]-s*(h[t-1]+h[t]);for(let n of this.mol.atomAdjList(e[t]))if(e.indexOf(n)<0&&n!=i){let e=this.points[n-1],i=e.oval.cx-l[t],s=e.oval.cy-r[t];i*(m[t]-l[t])+s*(c[t]-l[t])>s*(d[t]-l[t])+s*(f[t]-l[t])?C++:g++}}let A=s-1,b=o[A]?1.2:.7;if(n){let t=-h[A-1],e=a[A-1];m[A]=l[A]-t*b,c[A]=r[A]-e*b,d[A]=l[A]-t*b,f[A]=r[A]-e*b}else m[A]=l[A]+a[A-1]*b,c[A]=r[A]+h[A-1]*b,d[A]=l[A]-a[A-1]*b,f[A]=r[A]-h[A-1]*b;let y=0,E=0;for(let t=0;t<s-1;t++)y+=N(m[t+1]-m[t],c[t+1]-c[t]),E+=N(d[t+1]-d[t],f[t+1]-f[t]);y*=C+1,E*=g+1;let x=y<E?m:d,M=y<E?c:f,v={atoms:e,px:null,py:null,ctrl:null,size:this.lineSizePix};this.splineInterpolate(v,x,M),this.paths.push(v)}createBondCentroid(t,e){let n=this.points[t-1],i=n.oval.cx,s=n.oval.cy,l=0,r=0;for(let t of e)n=this.points[t-1],l+=n.oval.cx,r+=n.oval.cy;l/=e.length,r/=e.length,e.length<=2&&(l-=.1*(l-i),r-=.1*(r-s));const o=.25*this.measure.scale();let a=this.shrinkBond(i,s,l,r,this.backOffAtom(t,i,s,l,r,o));this.ensureMinimumBondLength(a,[l,r],i,s,l,r,o);let h={bnum:0,bfr:t,bto:0,type:Xt.Normal,line:new p(a[0],a[1],l,r),size:this.lineSizePix,head:0,col:this.policy.data.foreground};this.lines.push(h),this.space.push(this.computeSpaceLine(h))}splineInterpolate(e,n,i){const s=n.length,l=.25;for(let r=0;r<s;r++)if(0==r){let s=n[r+1]-n[r],o=i[r+1]-i[r],a=n[r]+l*s,h=i[r]+l*o;e.px=t.append(e.px,n[r]),e.py=t.append(e.py,i[r]),e.ctrl=t.append(e.ctrl,!1),e.px=t.append(e.px,a),e.py=t.append(e.py,h),e.ctrl=t.append(e.ctrl,!0)}else if(r==s-1){let s=n[r]-n[r-1],o=i[r]-i[r-1],a=n[r]-l*s,h=i[r]-l*o;e.px=t.append(e.px,a),e.py=t.append(e.py,h),e.ctrl=t.append(e.ctrl,!0),e.px=t.append(e.px,n[r]),e.py=t.append(e.py,i[r]),e.ctrl=t.append(e.ctrl,!1)}else{let s=n[r+1]-n[r-1],o=i[r+1]-i[r-1],a=D(N(s,o));s*=a,o*=a;let h=l*N(n[r]-n[r-1],i[r]-i[r-1]),u=l*N(n[r+1]-n[r],i[r+1]-i[r]),m=n[r]-s*h,c=i[r]-o*h,d=n[r]+s*u,f=i[r]+o*u;e.px=t.append(e.px,m),e.py=t.append(e.py,c),e.ctrl=t.append(e.ctrl,!0),e.px=t.append(e.px,n[r]),e.py=t.append(e.py,i[r]),e.ctrl=t.append(e.ctrl,!1),e.px=t.append(e.px,d),e.py=t.append(e.py,f),e.ctrl=t.append(e.ctrl,!0)}}delocalisedAnnotation(t,e,n){const i=this.mol;let s="";if(-1==e?s="-":1==e?s="+":e<-1?s=Math.abs(e)+"-":e>1&&(s=e+"+"),n>0)for(let t=0;t<n;t++)s+=".";if(0==s.length)return;const l=t.length;let r=0,o=0;for(let e of t)r+=i.atomX(e),o+=i.atomY(e);r/=l,o/=l;let a=St.congestionPoint(i,r,o);for(let e=1;e<l-1;e++){let n=.5*(i.atomX(t[e-1])+i.atomX(t[e+1])),s=.5*(i.atomY(t[e-1])+i.atomY(t[e+1])),l=St.congestionPoint(i,n,s);l<a&&(a=l,r=n,o=s)}let h=.8*this.fontSizePix,u=this.measure.measureText(s,h),m=.55*u[0],c=.55*u[1],p={anum:0,text:s,fsz:h,col:this.policy.data.foreground,oval:new f(this.measure.angToX(r),this.measure.angToY(o),m,c)};this.points.push(p);let C={anum:0,bnum:0,box:new d(p.oval.cx-m,p.oval.cy-c,2*m,2*c),px:[p.oval.cx-m,p.oval.cx+m,p.oval.cx+m,p.oval.cx-m],py:[p.oval.cy-c,p.oval.cy-c,p.oval.cy+c,p.oval.cy+c]};this.space.push(C)}processPolymerUnit(e,n){if(4==t.len(e.bondConn))return void this.processPolymerUnitPair(e);let i=[];const{mol:s,measure:l}=this;for(let t=1;t<=s.numBonds;t++){let l=s.bondFrom(t),r=s.bondTo(t),o=e.atoms.indexOf(l)>=0,a=e.atoms.indexOf(r)>=0,h=null;if(o&&!a)h={a1:l,a2:r};else{if(!a||o)continue;h={a1:r,a2:l}}h.x1=s.atomX(h.a1),h.y1=s.atomY(h.a1),h.x2=s.atomX(h.a2),h.y2=s.atomY(h.a2),h.shared=!1;for(let t of n)if(e!==t&&t.atoms.includes(h.a2)){h.shared=!0;break}let u=n.filter((t=>t===e||t.atoms.includes(h.a1)&&!t.atoms.includes(h.a2)));if(u.length>1){u.sort(((t,e)=>t.atoms.length-e.atoms.length));for(let t=0;t<u.length;t++)u[t]===e&&(h.nestOrder=t);h.nestCount=u.length}i.push(h)}let r=0,o=e.atoms.map((t=>s.atomX(t))),a=e.atoms.map((t=>s.atomY(t))),h=t.min(o),u=t.min(a),m=t.max(o),c=t.max(a);for(let t=1;t<i.length;t++){let e=i[r],n=i[t],s=e.x2-h-e.y2+u;n.x2-h-n.y2+u>s&&(r=t)}let d=!1,C=!1;if(2==i.length){let t=i[0==r?1:0],e=i[r],n=Math.atan2(t.y2-t.y1,t.x2-t.x1),s=Math.atan2(e.y2-e.y1,e.x2-e.x1);d=(n>145*_||n<-145*_)&&s<35*_&&s>-35*_}else if(0==i.length){let t=.5*(u+c);i.push({x1:h,y1:t,x2:h-1,y2:t}),i.push({x1:m,y1:t,x2:m+1,y2:t}),r=1,C=!0}let g=(C?.5*(c-u+1):d?1:.5)*this.scale,A=.2*this.scale;const b={bnum:0,bfr:0,bto:0,type:Xt.Normal,size:this.lineSizePix,head:0,col:this.policy.data.foreground},y={anum:0,fsz:.7*this.fontSizePix,bold:!1,col:this.policy.data.foreground};for(let t=0;t<i.length;t++){let n=i[t],s=l.angToX(n.x1),o=l.angToY(n.y1),a=l.angToX(n.x2),h=l.angToY(n.y2);if(n.shared&&(a-=.1*(a-s),h-=.1*(h-o)),n.nestCount>1){let t=a-s,e=h-o,i=(n.nestOrder+1)/n.nestCount;a=s+t*i,h=o+e*i}let u=.5*(s+a),m=.5*(o+h);d&&(s=a=u,o=h=m,t==r?(s--,a++):(s++,a--));let c=D(N(a-s,h-o)),C=(a-s)*c,E=(h-o)*c,x=E,M=-C,v=u-g*x,T=m-g*M,q=u+g*x,S=m+g*M,w=v-A*C,O=T-A*E,R=q-A*C,B=S-A*E,I=Object.assign(Object.assign({},b),{line:new p(w,O,v,T)}),k=Object.assign(Object.assign({},b),{line:new p(v,T,q,S)}),_=Object.assign(Object.assign({},b),{line:new p(q,S,R,B)});if(this.lines.push(I),this.lines.push(k),this.lines.push(_),this.space.push(this.computeSpaceLine(I)),this.space.push(this.computeSpaceLine(k)),this.space.push(this.computeSpaceLine(_)),t==r){let t,i;n.shared?[t,i]=[v-.5*this.scale*x,T-.5*this.scale*M]:[t,i]=[v+2*A*C,T+2*A*E];let s=Object.assign(Object.assign({},y),{text:"n",oval:new f(t,i,0,0)});if(this.points.push(s),this.space.push(this.computeSpacePoint(s)),null!=e.connect){let s="?";e.connect==rt.HeadToTail?s="ht":e.connect==rt.HeadToHead?s="hh":e.connect==rt.Random&&(s="eu"),n.shared?[t,i]=[q+.5*this.scale*x,S+.5*this.scale*M]:[t,i]=[q+2.5*A*C,S+2.5*A*E];let l=Object.assign(Object.assign({},y),{text:s,oval:new f(t,i,0,0)});this.points.push(l),this.space.push(this.computeSpacePoint(l))}}}}processPolymerUnitPair(e){const{mol:n,measure:i}=this;let s=[],l=[];for(let t of e.bondConn){let e=n.bondFrom(t),r=n.bondTo(t);s.push(i.angToX(.5*(n.atomX(e)+n.atomX(r)))),l.push(i.angToY(.5*(n.atomY(e)+n.atomY(r))))}let r=.25*t.sum(s),o=.25*t.sum(l),a=.5*this.scale,h=[],u=[];for(let[t,e]of[[0,1],[2,3]]){let n=s[e]-s[t],i=l[e]-l[t],m=a*D(N(n,i)+.001);[n,i]=[n*m,i*m],s[t]-=2*n,l[t]-=2*i,s[e]+=2*n,l[e]+=2*i;let c=i,d=-n,f=q(.5*(s[t]+s[e])+c-r,.5*(l[t]+l[e])+d-o);q(.5*(s[t]+s[e])-c-r,.5*(l[t]+l[e])-d-o)<f&&([c,d]=[-c,-d]),h.push(c,c),u.push(d,d)}const m={bnum:0,bfr:0,bto:0,type:Xt.Normal,size:this.lineSizePix,head:0,col:this.policy.data.foreground},c={anum:0,fsz:.7*this.fontSizePix,bold:!1,col:this.policy.data.foreground};let d=(t,e,n,i)=>{let s=Object.assign(Object.assign({},m),{line:new p(t,e,n,i)});this.lines.push(s),this.space.push(this.computeSpaceLine(s))},C=(t,e,n)=>{let i=Object.assign(Object.assign({},c),{text:n,oval:new f(t,e,0,0)});this.points.push(i),this.space.push(this.computeSpacePoint(i))};d(s[0],l[0],s[1],l[1]),d(s[0],l[0],s[0]+h[0],l[0]+u[0]),d(s[1],l[1],s[1]+h[1],l[1]+u[1]),d(s[2],l[2],s[3],l[3]),d(s[2],l[2],s[2]+h[2],l[2]+u[2]),d(s[3],l[3],s[3]+h[3],l[3]+u[3]);let g=t.min(s),A=t.min(l),b=[];for(let t=0;t<4;t++)b.push(s[t]-g+l[t]-A);let y=t.idxMax(b);C(s[y]-h[y],l[y]-u[y],"n");let E=y+(y%2==1?-1:1),x=(E+2)%4;C(s[x]-.5*h[x],l[x]-.5*u[x],"*"),C(s[E]-.5*h[E],l[E]-.5*u[E],"*")}}Ht.FONT_CORRECT=1.5;let Wt=null;const Vt={units:"http://purl.obolibrary.org/obo/UO_0000000 units\n- http://purl.obolibrary.org/obo/UO_0000051 concentration units\n- - http://www.bioassayontology.org/bao#BAO_0000102 -log10[mol/L]\n- - http://purl.obolibrary.org/obo/UO_0000175 grams per litre (g/L)\n- - http://www.bioassayontology.org/bao#BAO_0000101 log10[mol/L]\n- - http://purl.obolibrary.org/obo/UO_0000275 micrograms per litre (ug/L)\n- - http://purl.obolibrary.org/obo/UO_0000064 micromoles per litre (umol/L)\n- - http://purl.obolibrary.org/obo/UO_0000273 milligrams per litre (mg/L)\n- - http://purl.obolibrary.org/obo/UO_0000063 millimoles per litre (mmol/L)\n- - http://purl.obolibrary.org/obo/UO_0000062 moles per litre (mol/L)\n- - http://purl.obolibrary.org/obo/UO_0000065 nanomoles per litre (nmol/L)\n- - http://purl.obolibrary.org/obo/UO_0000066 picomoles per litre (pmol/L)\n- http://purl.obolibrary.org/obo/UO_0000186 dimensionless unit\n- - http://www.bioassayontology.org/bao#BAO_0080023 binary (true/false)\n- - http://purl.obolibrary.org/obo/UO_0000187 percent"};class Gt{static get main(){return Wt}static getOntologyKeys(){return Object.keys(Vt)}static getOntologyData(t){return Vt[t]}constructor(){this.roots=[],this.mapTerms=new Map,this.alreadyLoaded=new Set}static init(){if(!Wt){Wt=new Gt;for(let t of this.getOntologyKeys())Wt.loadFromString(t,this.getOntologyData(t))}}getRoots(){return this.roots}hasTerm(t){return this.mapTerms.has(t)}getBranch(t){return this.mapTerms.get(t)}getBranchList(e){if("string"==typeof e){let t=this.mapTerms.get(e);if(!t)throw`Unknown branch URI: ${e}`;if(t.length>1)throw`Ambiguous branch URI occurs more than once: ${e}`;e=t[0]}let n=[],i=e=>{n.push(e);for(let n of t.safeArray(e.children))i(n)};return i(e),n}loadFromString(t,e){this.alreadyLoaded.has(t)||(this.alreadyLoaded.add(t),this.loadContent(e))}loadContent(t){let e=[],n=0;for(let i of t.split(/\n/)){if(n++,i=i.trim(),!i||i.startsWith("#"))continue;let t=i.indexOf("http");if(t<0)throw`Line ${n} invalid, no URI term: ${i}`;let s=0;for(let e=0;e<t;e++)"-"==i.charAt(e)&&s++;let l=i.substring(t);if(t=l.indexOf(" "),t<0)throw`Line ${n} invalid, no label: ${i}`;let r=l.substring(t+1);l=l.substring(0,t);let o=null;if(0==s&&(o=this.roots.find((t=>t.uri==l))),!o){if(o={uri:l,label:r,parent:null,children:[],depth:s},0==s)this.roots.push(o);else{for(let t=e.length-1;t>=0;t--)if(e[t].depth==s-1){o.parent=e[t],e[t].children.push(o);break}if(!o.parent)throw`Line ${n} invalid hierarchy, no parent found`}let t=this.mapTerms.get(l);t?t.push(o):this.mapTerms.set(l,[o])}e.push(o)}}debugString(t){let e=[],n=t=>{e.push("* ".repeat(t.depth)+`<${t.uri}> "${t.label}"`);for(let e of t.children)n(e)};return n(t),e.join("\n")}}var Qt,Kt,$t,Zt,Jt;!function(t){t[t.Strong=0]="Strong",t[t.Medium=1]="Medium",t[t.Weak=2]="Weak"}(Qt||(Qt={}));class te{constructor(t,e,n,i){this.packSize=t,this.boxes=e,this.hspace=n,this.vspace=i,this.layout=null,this.wantRatio=t.w/t.h}pack(){let e=[],n=this.boxes.length;for(let i=0;i<n;i++){let s={idxStart:i,springs:t.anyArray(Qt.Weak,n)};s.hash=s.idxStart+"/"+s.springs,this.processCandidate(s),e.push(s)}e=e.sort(((t,e)=>t.score-e.score)).slice(0,100);for(let t=100;t>0;t--){let t=new Set;for(let n of e)t.add(n.hash);let i=e.slice(0);for(let s of e)for(let e=0;e<n;e++)if(e!=s.idxStart)for(let n of[Qt.Strong,Qt.Medium,Qt.Weak])if(s.springs[e]!=n){let l={idxStart:s.idxStart,springs:s.springs.slice(0)};if(l.springs[e]=n,l.hash=l.idxStart+"/"+l.springs,t.has(l.hash))continue;this.processCandidate(l),i.push(l)}i=i.sort(((t,e)=>t.score-e.score)).slice(0,100);let s=!0;for(let t=0;t<e.length&&t<i.length;t++)if(e[t].hash!=i[t].hash){s=!1;break}if(!s)break;e=i}let i=e[0];this.outline=i.outline,this.layout=i.layout;let s=t.min(this.layout.map((t=>t.y)));for(let t of this.layout)t.y-=s;return!0}processCandidate(e){let n=this.boxes.length;e.layout=this.boxes.map((t=>new d(0,0,t.w,t.h)));let i=t.booleanArray(!1,n);i[e.idxStart]=!0;let s=(t,s)=>{let l=e.layout[t],r=null;for(let s=t+1;s<n;s++)if(i[s]){let t=e.layout[s],n=[];if(t.minX()>0&&n.push({y:t.midY()-this.vspace,x1:0,x2:t.minX()-this.hspace}),n.push({y:t.minY()-this.vspace,x1:Math.max(0,t.minX()-this.hspace),x2:t.maxX()+this.hspace}),n.push({y:t.minY()-this.vspace+.5*l.h,x1:t.maxX()+this.hspace,x2:Number.POSITIVE_INFINITY}),null==r)r=n;else for(let t of n)this.mergeSegmentAbove(r,t)}let o=0,a=Number.NEGATIVE_INFINITY;for(let t=0;t<r.length;t++){let e=r[t].x1,n=Number.POSITIVE_INFINITY;for(let i=t;i<r.length&&(n=Math.min(n,r[i].y),!(l.w<r[i].x2-e));i++);if(n>a&&([o,a]=[e,n]),s==Qt.Strong)break;if(s==Qt.Medium&&e>.5*this.packSize.w)break}l.x=o,l.y=a-l.h,i[t]=!0},l=(t,n)=>{let s=e.layout[t],l=null;for(let n=t-1;n>=0;n--)if(i[n]){let t=e.layout[n],i=[];if(t.minX()>0&&i.push({y:t.midY()+this.vspace,x1:0,x2:t.minX()-this.hspace}),i.push({y:t.maxY()+this.vspace,x1:Math.max(0,t.minX()-this.hspace),x2:t.maxX()+this.hspace}),i.push({y:t.maxY()+this.vspace-.5*s.h,x1:t.maxX()+this.hspace,x2:Number.POSITIVE_INFINITY}),null==l)l=i;else for(let t of i)this.mergeSegmentBelow(l,t)}let r=0,o=Number.POSITIVE_INFINITY;for(let t=0;t<l.length;t++){let e=l[t].x1,i=Number.NEGATIVE_INFINITY;for(let n=t;n<l.length&&(i=Math.max(i,l[n].y),!(s.w<l[n].x2-e));n++);if(i<o&&([r,o]=[e,i]),n==Qt.Strong)break;if(n==Qt.Medium&&e>.5*this.packSize.w)break}s.x=r,s.y=o,i[t]=!0};for(let t=1;t<n;t++){let i=e.idxStart-t,r=e.idxStart+t;i>=0&&s(i,e.springs[i]),r<n&&l(r,e.springs[r])}let r=t.max(e.layout.map((t=>t.maxX()))),o=t.min(e.layout.map((t=>t.minY()))),a=t.max(e.layout.map((t=>t.maxY())));e.outline=new c(r-0,a-o);let h=e.outline.w/e.outline.h;e.score=Math.abs(h-this.wantRatio)*(e.outline.w+e.outline.h),e.score+=t.sum(e.layout.map((t=>t.x)));for(let t=0;t<e.layout.length-1;t++)e.score+=Math.max(0,e.layout[t].minY()-e.layout[t].maxY())}mergeSegmentAbove(t,e){for(let n of t){if(e.x1>=n.x1&&e.x1<=n.x2&&e.x2>=n.x1&&e.x2<=n.x2){if(e.y>n.y)return;t.push({y:n.y,x1:e.x2,x2:n.x2}),n.x2=e.x1;break}e.x1>=n.x1&&e.x1<=n.x2&&(e.y<n.y?n.x2=e.x1:e.x1=n.x2),e.x2>=n.x1&&e.x2<=n.x2&&(e.y<n.y?n.x1=e.x2:e.x2=n.x1)}for(let e=t.length-1;e>=0;e--)t[e].x1>=t[e].x2&&t.splice(e,1);e.x1<e.x2&&(t.push(e),t.sort(((t,e)=>t.x1-e.x1)))}mergeSegmentBelow(t,e){for(let n of t){if(e.x1>=n.x1&&e.x1<=n.x2&&e.x2>=n.x1&&e.x2<=n.x2){if(e.y<n.y)return;t.push({y:n.y,x1:e.x2,x2:n.x2}),n.x2=e.x1;break}e.x1>=n.x1&&e.x1<=n.x2&&(e.y>n.y?n.x2=e.x1:e.x1=n.x2),e.x2>=n.x1&&e.x2<=n.x2&&(e.y>n.y?n.x1=e.x2:e.x2=n.x1)}for(let e=t.length-1;e>=0;e--)t[e].x1>=t[e].x2&&t.splice(e,1);e.x1<e.x2&&(t.push(e),t.sort(((t,e)=>t.x1-e.x1)))}}!function(t){t[t.Name=0]="Name",t[t.Quantity=1]="Quantity",t[t.Identifier=2]="Identifier",t[t.Meta=3]="Meta"}(Kt||(Kt={}));class ee{constructor(t,e,n){this.mixture=t,this.measure=e,this.policy=n,this.norm=null,this.width=0,this.height=0,this.components=[],this.minBoxSize=null,this.showCollapsors=!1,this.collapsedBranches=[],this.packBranches=null,this.includeIdentifiers=!0,this.scale=n.data.pointScale,this.nameFontSize=.5*this.scale,this.limitStructW=this.limitStructH=10*this.scale,this.hardwrapName=12*this.scale,this.softwrapName=8*this.scale}arrange(){this.createComponents(),this.layoutSubComponents(0),this.contractComponents();let t=null;for(let e of this.components)t=t?t.union(e.boundary):e.boundary;for(let e of this.components)if(e.boundary.x-=t.x,e.boundary.y-=t.y,e.molLayout){let t=e.boundary,n=e.molBox;e.molLayout.squeezeInto(t.x+n.x,t.y+n.y,n.w,n.h)}this.width=t.w,this.height=t.h}scaleComponents(t){if(1!=t){this.scale*=t,this.width*=t,this.height*=t;for(let e of this.components){if(e.boundary.scaleBy(t),e.outline.scaleBy(t),e.molBox&&(e.molBox.scaleBy(t),e.molLayout)){let t=e.boundary.x+e.molBox.x,n=e.boundary.y+e.molBox.y;e.molLayout.squeezeInto(t,n,e.molBox.w,e.molBox.h)}e.nameBox&&e.nameBox.scaleBy(t),e.collapseBox&&e.collapseBox.scaleBy(t),e.fontSize*=t}}}findComponent(e){for(let n=0;n<this.components.length;n++)if(t.equals(this.components[n].origin,e))return n;return-1}static formatQuantity(t){let e=t=>{if(null==t)return"";if(t>1e4)return Math.round(t).toString();let e=t.toPrecision(6);if(e.indexOf("e")>=0||e.indexOf(".")<0)return e;for(;;){if(!e.endsWith("0")){if(e.endsWith(".")){e=e.substring(0,e.length-1);break}break}e=e.substring(0,e.length-1)}return e};if(t.ratio)return 2==t.ratio.length?e(t.ratio[0])+"/"+e(t.ratio[1]):null;if(null==t.quantity)return null;let n="";if(t.relation&&"="!=t.relation){let e=t.relation;">="==e?e="":"<="==e&&(e=""),n+=e}if(t.quantity instanceof Array){if(0==t.quantity.length)return;n+=e(t.quantity[0]),t.quantity.length>=2&&(n+=" - "+e(t.quantity[1]))}else n+=e(t.quantity),t.error&&(n+="  "+e(t.error));return t.units&&(t.units.startsWith("%")||(n+=" "),n+=t.units),n}formatNormQuantity(t){if(!this.norm)return;let e=this.norm.findNote(t);if(!e||!e.concQuantity)return;let n={quantity:e.concQuantity,error:e.concError,units:e.concUnits,relation:e.concRelation};return ee.formatQuantity(n)}createComponents(){let e=(n,i,s)=>{let l={origin:n,content:i,parentIdx:s},r=this.components.push(l)-1;l.isCollapsed=!1;for(let e of this.collapsedBranches)t.equals(e,l.origin)&&(l.isCollapsed=!0);if(i.contents&&!l.isCollapsed)for(let s=0;s<i.contents.length;s++){let l=t.append(n,s);e(l,i.contents[s],r)}};e([],this.mixture.mixfile,-1);let n=.25*this.scale;for(let[e,i]of this.components.entries()){let e=i.content;if(e.molfile&&(i.mol=vt.readUnknown(e.molfile)),i.mol){i.molLayout=new Ht(i.mol,this.measure,this.policy),i.molLayout.arrange(),i.molLayout.squeezeInto(0,0,this.limitStructW,this.limitStructH);let t=i.molLayout.determineBoundary();i.molBox=new d(n,n,Math.ceil(t[2]-t[0]),Math.ceil(t[3]-t[1]))}else i.molBox=d.zero();i.nameLines=[],e.name&&this.wrapSplitName(i.nameLines,e.name,0,Kt.Name);let s=ee.formatQuantity(e);if(s&&i.nameLines.push({text:s,col:0,source:Kt.Quantity}),s=this.formatNormQuantity(i.origin),s&&i.nameLines.push({text:`(${s})`,col:8421504,source:Kt.Quantity}),this.includeIdentifiers&&e.identifiers)for(let t in e.identifiers){let n=t+" ",s=e.identifiers[t];if(s instanceof Array)for(let t=0;t<s.length;t++)n+=(0==t?"":", ")+s[t];else n+=s;i.nameLines.push({text:this.truncateEllipsis(n),col:4325502,source:Kt.Identifier})}if(e.metadata)for(let n of e.metadata){let e=e=>{if("number"==typeof e)return y(e,4);if(!Gt.main)return e;let n=Gt.main.getBranch(e);return t.notBlank(n)?n[0].label:e},s=[];s=Array.isArray(n)?n.map((t=>e(t))):[e(n)],i.nameLines.push({text:s.join(" "),col:11144,source:Kt.Meta})}i.nameBox=new d(n,n),i.fontSize=this.nameFontSize;for(let t=0;t<i.nameLines.length;t++){let e=this.measure.measureText(i.nameLines[t].text,i.fontSize);i.nameBox.w=Math.max(i.nameBox.w,e[0]),i.nameBox.h+=e[1]+(t>0?2*e[2]:0)}if(i.outline=d.zero(),i.outline.w=Math.max(i.molBox.w,i.nameBox.w)+2*n,i.outline.h=i.molBox.h+i.nameBox.h+2*n,i.molBox.notEmpty()&&i.nameBox.notEmpty()&&(i.outline.h+=n,i.nameBox.y+=i.molBox.h+n,i.molBox.w=i.nameBox.w=Math.max(i.molBox.w,i.nameBox.w)),this.minBoxSize){let t=this.minBoxSize,e=t.w-i.outline.w,n=t.h-i.outline.h;e>0&&(i.outline.w+=e,i.molBox.w+=e),n>0&&(i.outline.h+=n,i.molBox.h+=n,i.nameBox.y+=n)}if(i.boundary=i.outline.clone(),(this.showCollapsors||i.isCollapsed)&&t.notBlank(i.content.contents)){let t=.05*this.scale,e=.3*this.scale;i.collapseBox=new d(i.boundary.maxX()+t,i.boundary.midY()-.5*e,e,e),i.boundary.w+=t+e}}}layoutSubComponents(t){let e=[t],n=[],i=[],s=0,l=0;for(let r=t+1;r<this.components.length;r++){if(this.components[r].parentIdx!=t)continue;let o=this.layoutSubComponents(r);if(0==o.length)continue;let a=null;for(let t of o){e.push(t);let n=this.components[t].boundary;a=a?a.union(n):n}n.push(o),i.push(a),s=Math.max(s,a.w),l+=a.h}if(0==n.length)return e;let r=1*this.scale,o=.5*this.scale;l+=o*(n.length-1);let a=this.components[t].boundary,h=a.maxX()+r;if(this.packBranches&&n.length>2&&l>this.packBranches.h){let t=this.packBranches.clone();for(let e of i)t.h=Math.max(t.h,e.h);let s=new te(t,i,o,o);if(s.pack()){let t=a.midY()-.5*s.outline.h;for(let e=0;e<n.length;e++){let l=s.layout[e],r=h-i[e].x+l.x,o=t-i[e].y+l.y;for(let t of n[e])this.components[t].boundary.x+=r,this.components[t].boundary.y+=o}return e}}let u=a.midY()-.5*l;for(let t=0;t<n.length;t++){let e=h-i[t].x,s=u-i[t].y;for(let i of n[t])this.components[i].boundary.x+=e,this.components[i].boundary.y+=s;u+=i[t].h+o}return e}contractComponents(){let e=[];for(let t=0;t<this.components.length;t++){e.push([]);for(let n=this.components[t].parentIdx;n>=0;n=this.components[n].parentIdx)e[n].push(t)}let n=1*this.scale,i=.25*this.scale;for(;;){let s=!1;for(let l=1;l<e.length;l++){let r=this.components[l].parentIdx,o=this.components[r].boundary.maxX()+n,a=this.components[l].boundary.minX()-o;if(a<1)continue;let h=[l,...e[l]],u=t.identity0(e.length).filter((t=>!h.includes(t)));for(let t of h){let e=this.components[t].boundary.withGrow(i,i);for(let t of u){let n=this.components[t].boundary;n.minX()>e.maxX()||e.minY()>n.maxY()||e.maxY()<n.minY()||(a=Math.min(a,e.minX()-n.maxX()))}}if(a>1){for(let t of h)this.components[t].boundary.x-=a;s=!0}}if(!s)break}}wrapSplitName(e,n,i,s){if(!n)return;let l=jt.measureWidths(n,this.nameFontSize);if(t.last(l)<=this.softwrapName)return void e.push({text:n,col:i,source:s});let r=0;for(;l[r]<this.softwrapName;r++);for(;l[r]<this.hardwrapName;r++){let t=n.charAt(r);if(" ,;-/".includes(t)){r++;break}}e.push({text:n.substring(0,r).trim(),col:i,source:s}),this.wrapSplitName(e,n.substring(r).trim(),i,s)}truncateEllipsis(e){let n=jt.measureWidths(e,this.nameFontSize);if(t.last(n)<=this.hardwrapName)return e;let i=jt.measureText("...",this.nameFontSize)[0],s=1;for(;s<e.length&&!(n[s]+i>this.hardwrapName);s++);return e.substring(0,s)+"..."}}function ne(t){var e;let n=t.toFixed(4),i=null!==(e=/^(.*\.\d*?[1-9]+)0+$/.exec(n))&&void 0!==e?e:/^(.*)\.0+$/.exec(n);return i&&(n=i[1]),n}!function(t){t[t.Centre=0]="Centre",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Baseline=0]="Baseline",t[t.Middle=4]="Middle",t[t.Top=8]="Top",t[t.Bottom=16]="Bottom"}($t||($t={})),function(t){t[t.Line=1]="Line",t[t.Rect=2]="Rect",t[t.Oval=3]="Oval",t[t.Path=4]="Path",t[t.Text=5]="Text",t[t.TextNative=6]="TextNative"}(Zt||(Zt={}));class ie{constructor(t){this.prettyPrint=t,this.lines=[],this.depth=0}spool(t){(null==t?void 0:t.length)>0&&this.lines.push(t)}start(t){this.prettyPrint&&this.depth>0&&this.lines.push("  ".repeat(this.depth)),this.spool(t)}stop(t){this.spool(t),this.prettyPrint&&this.lines.push("\n")}whole(t){this.prettyPrint&&this.depth>0&&this.lines.push("  ".repeat(this.depth)),this.spool(t),this.prettyPrint&&this.lines.push("\n")}attr(t,e){"number"==typeof e&&(e=ne(e)),this.spool(` ${t}="${e}"`)}inc(){this.depth++}dec(){this.depth--}toString(){return this.lines.join("")}}class se{constructor(e){this.types=[],this.prims=[],this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.scale=1,this.density=1,this.charMissing=!1,this.lowX=null,this.lowY=null,this.highX=null,this.highY=null;const n=jt.main;if(this.charMask=t.booleanArray(!1,n.UNICODE.length),null!=e){null!=e.size&&(this.width=e.size[0],this.height=e.size[1]),null!=e.types&&(this.types=e.types),null!=e.prims&&(this.prims=e.prims);for(let t of this.prims)if(t.primClass==Zt.Text){let{txt:e}=t;for(let t=0;t<e.length;t++){let i=n.getIndex(e.charAt(t));i>=0?this.charMask[i]=!0:this.charMissing=!0}}}}drawLine(t,e,n,i,s,l){null==l&&(l=1);let r=this.findOrCreateType({primClass:Zt.Line,thickness:l,colour:s});const o=.5*l;this.updateBounds(Math.min(t,n)-o,Math.min(e,i)-o),this.updateBounds(Math.max(t,n)+o,Math.max(e,i)+o),this.prims.push({primClass:Zt.Line,typeidx:r,x1:t,y1:e,x2:n,y2:i})}drawRect(t,e,n,i,s,l,r){null==s&&(s=se.NOCOLOUR),null==r&&(r=se.NOCOLOUR),null==l&&(l=1);let o=this.findOrCreateType({primClass:Zt.Rect,edgeCol:s,fillCol:r,thickness:l});const a=.5*l;this.updateBounds(t-a,e-a),this.updateBounds(t+n+a,e+i+a),this.prims.push({primClass:Zt.Rect,typeidx:o,x:t,y:e,w:n,h:i})}drawOval(t,e,n,i,s,l,r){null==s&&(s=se.NOCOLOUR),null==r&&(r=se.NOCOLOUR),null==l&&(l=1);const o=.5*l;this.updateBounds(t-n-o,e-i-o),this.updateBounds(t+n+o,e+i+o);let a=this.findOrCreateType({primClass:Zt.Oval,edgeCol:s,fillCol:r,thickness:l});this.prims.push({primClass:Zt.Oval,typeidx:a,cx:t,cy:e,rw:n,rh:i})}drawPath(e,n,i,s,l,r,o,a){null==l&&(l=se.NOCOLOUR),null==o&&(o=se.NOCOLOUR),null==r&&(r=1),null==a&&(a=!1);const h=.5*r;for(let t=0;t<e.length;t++)this.updateBounds(e[t]-h,n[t]-h),0!=h&&this.updateBounds(e[t]+h,n[t]+h);let u=this.findOrCreateType({primClass:Zt.Path,edgeCol:l,fillCol:o,thickness:r,hardEdge:a});this.prims.push({primClass:Zt.Path,typeidx:u,count:e.length,x:t.duplicate(e),y:t.duplicate(n),ctrl:i&&[...i],closed:s})}drawPoly(t,e,n,i,s,l){this.drawPath(t,e,null,!0,n,i,s,l)}drawText(e,n,i,s,l,r,o){null==r&&(r=$t.Left|$t.Baseline),null==o&&(o=0);let a=1,h=0;0!=o&&([a,h]=[Math.cos(o*_),Math.sin(o*_)]);const u=jt.main;for(let t=0;t<i.length;t++){let e=u.getIndex(i.charAt(t));e>=0?this.charMask[e]=!0:this.charMissing=!0}let m=u.measureText(i,s),c=0,d=0,f=0;r&$t.Left||(f=r&$t.Right?-m[0]:-.5*m[0]),0!=f&&(c+=f*a,d+=f*h);let p=0;r&$t.Middle?p=.5*m[1]:r&$t.Top?p=m[1]:r&$t.Bottom&&(p=-m[2]),0!=p&&(c-=p*h,d+=p*a);let C=0,g=0,A=0,b=0,y=0;for(let e=0;e<i.length;e++){let n=i.charAt(e),s=u.getIndex(n);if(s>=0){let l=u.getOutlineX(s),r=u.getOutlineY(s);C=Math.min(C,y+t.min(l)),A=Math.max(A,y+t.max(l)),g=Math.min(g,-t.max(r)),b=Math.max(b,-t.min(r)),y+=u.HORIZ_ADV_X[s],e<i.length-1&&(y+=u.getKerning(n,i.charAt(e+1)))}else y+=u.MISSING_HORZ}const E=s*u.INV_UNITS_PER_EM;if(0==o)this.updateBounds(e+c+C*E,n+d+g*E),this.updateBounds(e+c+A*E,n+d+b*E);else{let t=C*E,i=g*E,s=A*E,l=b*E;this.updateBounds(e+c+t*a-i*h,n+d+t*h+i*a),this.updateBounds(e+c+s*a-i*h,n+d+s*h+i*a),this.updateBounds(e+c+s*a-l*h,n+d+s*h+l*a),this.updateBounds(e+c+t*a-l*h,n+d+t*h+l*a)}let x=this.findOrCreateType({primClass:Zt.Text,size:s,colour:l});this.prims.push({primClass:Zt.Text,typeidx:x,x:e+c,y:n+d,txt:i,direction:o})}drawTextNative(t,e,n,i,s,l,r,o){o||(o={}),null==r&&(r=$t.Left|$t.Baseline);let a=jt.main.measureTextNative(n,i,s,o);r&$t.Left||(r&$t.Right?t-=a[0]:t-=.5*a[0]),r&$t.Middle?e+=.5*a[1]:r&$t.Top?e+=a[1]:r&$t.Bottom&&(e-=a[2]),this.updateBounds(t,e-a[1]),this.updateBounds(t+a[0],e+a[2]);let h=this.findOrCreateType({primClass:Zt.TextNative,family:i,size:s,colour:l,opt:o});this.prims.push({primClass:Zt.TextNative,typeidx:h,x:t,y:e,txt:n})}boundLowX(){return this.lowX}boundLowY(){return this.lowY}boundHighX(){return this.highX}boundHighY(){return this.highY}getBounds(){return new d(this.lowX,this.lowY,this.highX-this.lowX,this.highY-this.lowY)}measure(){this.width=Math.ceil(this.highX-this.lowX),this.height=Math.ceil(this.highY-this.lowY)}normalise(){0==this.lowX&&0==this.lowY||this.transformPrimitives(-this.lowX,-this.lowY,1,1),this.width=Math.ceil(this.highX-this.lowX),this.height=Math.ceil(this.highY-this.lowY)}setSize(t,e){this.width=t,this.height=e}transformIntoBox(t){this.transformPrimitives(-this.lowX,-this.lowY,1,1);let e=Math.ceil(this.highX-this.lowX),n=Math.ceil(this.highY-this.lowY),i=1;if(e>t.w){let s=t.w/e;e=t.w,n*=s,i*=s}if(n>t.h){let s=t.h/n;n=t.h,e*=s,i*=s}let s=.5*(t.w-e),l=.5*(t.h-n);this.transformPrimitives(t.x+s,t.y+l,i,i)}scaleExtent(t,e){let n=this.highX-this.lowX,i=this.highY-this.lowY;if(n<=t&&i<=e)return;let s=Math.min(t/n,e/i);this.transformPrimitives(0,0,s,s)}transformPrimitives(t,e,n,i){if(0==t&&0==e&&1==n&&1==i)return;for(let s of this.prims){const l=s.primClass;if(l==Zt.Line){let l=s;l.x1=t+l.x1*n,l.y1=e+l.y1*i,l.x2=t+l.x2*n,l.y2=e+l.y2*i}else if(l==Zt.Rect){let l=s;l.x=t+l.x*n,l.y=e+l.y*i,l.w=l.w*n,l.h=l.h*i}else if(l==Zt.Oval){let l=s;l.cx=t+l.cx*n,l.cy=e+l.cy*i,l.rw*=n,l.rh*=i}else if(l==Zt.Path){let l=s,r=l.count,o=l.x,a=l.y;for(let s=0;s<r;s++)o[s]=t+o[s]*n,a[s]=e+a[s]*i}else if(l==Zt.Text||l==Zt.TextNative){let l=s;l.x=t+l.x*n,l.y=e+l.y*i}}let s=.5*(n+i);if(1!=s)for(let t of this.types){const e=t.primClass;e==Zt.Line||e==Zt.Rect||e==Zt.Oval||e==Zt.Path?t.thickness*=s:(e==Zt.Text||e==Zt.TextNative)&&(t.size*=s)}this.lowX=t+this.lowX*n,this.lowY=e+this.lowY*i,this.highX=t+this.highX*n,this.highY=e+this.highY*i}renderInto(t){let e=function(t,e,n){let i=g(`<${e}/>`);var s;return n&&i.attr(n),(s=t,null==s?null:s.jquery?g(s[0]):g(s)).append(i),i.el}(t,"canvas",{width:this.width,height:this.height});return this.renderCanvas(e),e}renderCanvas(t,e){let n=t.getContext("2d");e&&n.clearRect(0,0,t.width,t.height);let i=this.width,s=this.height;this.density="devicePixelRatio"in window&&window.devicePixelRatio>1?window.devicePixelRatio:1,t.style.width=i+"px",t.style.height=s+"px",t.width=i*this.density,t.height=s*this.density,this.renderContext(n)}renderContext(t){t.save(),t.scale(this.density,this.density),this.typeObj=[];for(let t=0;t<this.types.length;t++){let e=this.types[t];e.primClass==Zt.Line?this.typeObj[t]=this.setupTypeLine(e):e.primClass==Zt.Rect?this.typeObj[t]=this.setupTypeRect(e):e.primClass==Zt.Oval?this.typeObj[t]=this.setupTypeOval(e):e.primClass==Zt.Path?this.typeObj[t]=this.setupTypePath(e):e.primClass==Zt.Text?this.typeObj[t]=this.setupTypeText(e):e.primClass==Zt.TextNative&&(this.typeObj[t]=this.setupTypeTextNative(e))}for(let e=0;e<this.prims.length;e++){let n=this.prims[e];n.primClass==Zt.Line?this.renderLine(t,n):n.primClass==Zt.Rect?this.renderRect(t,n):n.primClass==Zt.Oval?this.renderOval(t,n):n.primClass==Zt.Path?this.renderPath(t,n):n.primClass==Zt.Text?this.renderText(t,n):n.primClass==Zt.TextNative&&this.renderTextNative(t,n)}t.restore()}createSVG(t=!1,e=!1){let n=new ie(t);return n.start('<svg xmlns="http://www.w3.org/2000/svg"'),e&&n.attr("xmlns:xlink","http://www.w3.org/1999/xlink"),n.attr("width",this.width),n.attr("height",this.height),n.attr("viewBox",`0 0 ${this.width} ${this.height}`),n.stop(">"),n.inc(),this.renderSVG(n,e),n.dec(),n.whole("</svg>"),n.toString()}renderSVG(t,e=!1){this.typeObj=[];const n=jt.main;t.whole("<defs>"),t.inc(),this.charMissing&&(t.start("<path"),t.attr("id","missing"),t.attr("d",n.MISSING_DATA),t.attr("edge","none"),t.stop("/>"));for(let e=0;e<n.UNICODE.length;e++)this.charMask[e]&&(t.start("<path"),t.attr("id","char"+e),t.attr("d",n.GLYPH_DATA[e]),t.attr("edge","none"),t.stop("/>"));t.dec(),t.whole("</defs>");for(let t=0;t<this.types.length;t++){let e=this.types[t];e.primClass==Zt.Line?this.typeObj[t]=this.setupTypeLine(e):e.primClass==Zt.Rect?this.typeObj[t]=this.setupTypeRect(e):e.primClass==Zt.Oval?this.typeObj[t]=this.setupTypeOval(e):e.primClass==Zt.Path?this.typeObj[t]=this.setupTypePath(e):e.primClass==Zt.Text?this.typeObj[t]=this.setupTypeText(e):e.primClass==Zt.TextNative&&(this.typeObj[t]=this.setupTypeTextNative(e))}for(let n=0;n<this.prims.length;){let i=this.prims[n],s=1;if(i.primClass!=Zt.Path&&i.primClass!=Zt.Text&&i.primClass!=Zt.TextNative)for(;n+s<this.prims.length&&this.prims[n+s].primClass==i.primClass&&this.prims[n+s].typeidx==i.typeidx;s++);i.primClass==Zt.Line?1==s?this.svgLine1(t,i):this.svgLineN(t,this.prims.slice(n,n+s)):i.primClass==Zt.Rect?1==s?this.svgRect1(t,i):this.svgRectN(t,this.prims.slice(n,n+s)):i.primClass==Zt.Oval?1==s?this.svgOval1(t,i):this.svgOvalN(t,this.prims.slice(n,n+s)):i.primClass==Zt.Path?this.svgPath(t,i):i.primClass==Zt.Text?this.svgText(t,i,e):i.primClass==Zt.TextNative&&this.svgTextNative(t,i),n+=s}}spool(t){for(let e of this.prims)if(e.primClass==Zt.Line){let{typeidx:n,x1:i,y1:s,x2:l,y2:r}=e,{thickness:o,colour:a}=this.types[n];t.drawLine(i,s,l,r,a,o)}else if(e.primClass==Zt.Rect){let{typeidx:n,x:i,y:s,w:l,h:r}=e,{edgeCol:o,fillCol:a,thickness:h}=this.types[n];t.drawRect(i,s,l,r,o,h,a)}else if(e.primClass==Zt.Oval){let{typeidx:n,cx:i,cy:s,rw:l,rh:r}=e,{edgeCol:o,fillCol:a,thickness:h}=this.types[n];t.drawOval(i,s,l,r,o,h,a)}else if(e.primClass==Zt.Path){let{typeidx:n,count:i,x:s,y:l,ctrl:r,closed:o}=e,{edgeCol:a,fillCol:h,thickness:u,hardEdge:m}=this.types[n];t.drawPath(s,l,r,o,a,u,h,m)}else if(e.primClass==Zt.Text){let{typeidx:n,x:i,y:s,txt:l,direction:r}=e,{size:o,colour:a}=this.types[n];t.drawText(i,s,l,o,a,null,r)}else if(e.primClass==Zt.TextNative){let{typeidx:n,x:i,y:s,txt:l}=e,{family:r,size:o,colour:a}=this.types[n];t.drawTextNative(i,s,l,r,o,a)}}setupTypeLine(t){let e=t.thickness*this.scale,n=t.colour;return{primClass:t.primClass,thickness:e,colour:n}}setupTypeRect(t){let e=t.edgeCol,n=t.fillCol,i=t.thickness*this.scale;return{primClass:t.primClass,edgeCol:e,fillCol:n,thickness:i}}setupTypeOval(t){let e=t.edgeCol,n=t.fillCol,i=t.thickness*this.scale;return{primClass:t.primClass,edgeCol:e,fillCol:n,thickness:i}}setupTypePath(t){let e=t.edgeCol,n=t.fillCol,i=t.thickness*this.scale,s=t.hardEdge;return{primClass:t.primClass,edgeCol:e,fillCol:n,thickness:i,hardEdge:s}}setupTypeText(t){let e=t.size*this.scale,n=t.colour;return{primClass:t.primClass,colour:n,size:e}}setupTypeTextNative(t){let e=t.family,n=t.size*this.scale,i=t.colour,s=t.opt;return{primClass:t.primClass,colour:i,family:e,size:n,opt:s}}renderLine(t,e){let{x1:n,y1:i,x2:s,y2:l}=e,{colour:r,thickness:o}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,s=this.offsetX+this.scale*s,l=this.offsetY+this.scale*l,null!=r&&(t.beginPath(),t.moveTo(n,i),t.lineTo(s,l),t.strokeStyle=v(r),t.lineWidth=o,t.lineCap="round",t.stroke())}renderRect(t,e){let{x:n,y:i,w:s,h:l}=e,{edgeCol:r,fillCol:o,thickness:a}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,s*=this.scale,l*=this.scale,o!=se.NOCOLOUR&&(t.fillStyle=v(o),t.fillRect(n,i,s,l)),r!=se.NOCOLOUR&&(t.strokeStyle=v(r),t.lineWidth=a,t.lineCap="square",t.strokeRect(n,i,s,l))}renderOval(t,e){let{cx:n,cy:i,rw:s,rh:l}=e,{edgeCol:r,fillCol:o,thickness:a}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,s*=this.scale,l*=this.scale,o!=se.NOCOLOUR&&(t.fillStyle=v(o),t.beginPath(),t.ellipse(n,i,s,l,0,0,2*Math.PI,!0),t.fill()),r!=se.NOCOLOUR&&(t.strokeStyle=v(r),t.lineWidth=a,t.beginPath(),t.ellipse(n,i,s,l,0,0,2*Math.PI,!0),t.stroke())}renderPath(t,e){let{count:n,x:i,y:s,ctrl:l,closed:r}=e,{edgeCol:o,fillCol:a,thickness:h,hardEdge:u}=this.typeObj[e.typeidx];i=[...i],s=[...s];for(let t=0;t<n;t++)i[t]=this.offsetX+this.scale*i[t],s[t]=this.offsetY+this.scale*s[t];for(let e=1;e<=2;e++)if(!(1==e&&a==se.NOCOLOUR||2==e&&o==se.NOCOLOUR)){t.beginPath(),t.moveTo(i[0],s[0]);for(let e=1;e<n;e++)l&&l[e]?e<n-1&&!l[e+1]?(t.quadraticCurveTo(i[e],s[e],i[e+1],s[e+1]),e++):e<n-1&&!l[e+2]&&(t.bezierCurveTo(i[e],s[e],i[e+1],s[e+1],i[e+2],s[e+2]),e+=2):t.lineTo(i[e],s[e]);r&&t.closePath(),1==e?(t.fillStyle=v(a),t.fill()):(t.strokeStyle=v(o),t.lineWidth=h,t.lineCap=u?"square":"round",t.lineJoin=u?"miter":"round",t.stroke())}}renderText(t,e){let{x:n,y:i,txt:s,direction:l}=e,{size:r,colour:o}=this.typeObj[e.typeidx],a=v(o);n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i;let h=jt.main,u=r*this.scale/h.UNITS_PER_EM,m=0;for(let e=0;e<s.length;e++){let r=s.charAt(e),o=h.getIndex(r),c=null;if(o<0?(m+=h.MISSING_HORZ,c=h.getMissingPath()):c=h.getGlyphPath(o),c){t.save();let e=0!=l?l*_:0;0==e?t.translate(n+m*u,i):t.translate(n+Math.cos(e)*m*u,i+Math.sin(e)*m*u),t.scale(u,-u),0!=e&&t.rotate(-e),t.fillStyle=a,t.fill(c),t.restore()}m+=h.HORIZ_ADV_X[o],e<s.length-1&&(m+=h.getKerning(r,s.charAt(e+1)))}}renderTextNative(t,e){let{x:n,y:i,txt:s}=e,{size:l,colour:r,family:o,opt:a}=this.typeObj[e.typeidx],h=v(r);n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,t.save();let u="";a.bold&&(u+="bold "),a.italic&&(u+="italic "),t.font=u+l*this.scale+"px "+o,t.fillStyle=h,t.fillText(s,n,i),t.restore()}svgLine1(t,e){let{x1:n,y1:i,x2:s,y2:l}=e,{colour:r,thickness:o}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,s=this.offsetX+this.scale*s,l=this.offsetY+this.scale*l,r!=se.NOCOLOUR&&(t.start("<line"),t.attr("x1",n),t.attr("y1",i),t.attr("x2",s),t.attr("y2",l),this.defineSVGStroke(t,r),t.attr("stroke-width",o),t.attr("stroke-linecap","round"),t.stop("/>"))}svgLineN(t,e){let{colour:n,thickness:i}=this.typeObj[e[0].typeidx];t.start("<g"),this.defineSVGStroke(t,n),t.attr("stroke-width",i),t.attr("stroke-linecap","round"),t.stop(">"),t.inc();for(let n of e){let{x1:e,y1:i,x2:s,y2:l}=n;e=this.offsetX+this.scale*e,i=this.offsetY+this.scale*i,s=this.offsetX+this.scale*s,l=this.offsetY+this.scale*l,t.start("<line"),t.attr("x1",e),t.attr("y1",i),t.attr("x2",s),t.attr("y2",l),t.stop("/>")}t.dec(),t.whole("</g>")}svgRect1(t,e){let{x:n,y:i,w:s,h:l}=e,{edgeCol:r,fillCol:o,thickness:a}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,s*=this.scale,l*=this.scale,t.start("<rect"),t.attr("x",n),t.attr("y",i),t.attr("width",s),t.attr("height",l),this.defineSVGStroke(t,r),r!=se.NOCOLOUR&&(t.attr("stroke-width",a),t.attr("stroke-linecap","square")),this.defineSVGFill(t,o),t.stop("/>")}svgRectN(t,e){let{edgeCol:n,fillCol:i,thickness:s}=this.typeObj[e[0].typeidx];t.start("<g"),this.defineSVGStroke(t,n),n!=se.NOCOLOUR&&(t.attr("stroke-width",s),t.attr("stroke-linecap","square")),this.defineSVGFill(t,i),t.stop(">"),t.inc();for(let n of e){let{x:e,y:i,w:s,h:l}=n;e=this.offsetX+this.scale*e,i=this.offsetY+this.scale*i,s*=this.scale,l*=this.scale,t.start("<rect"),t.attr("x",e),t.attr("y",i),t.attr("width",s),t.attr("height",l),t.stop("/>")}t.dec(),t.whole("</g>")}svgOval1(t,e){let{cx:n,cy:i,rw:s,rh:l}=e,{edgeCol:r,fillCol:o,thickness:a}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i,s*=this.scale,l*=this.scale,t.start("<ellipse"),t.attr("cx",n),t.attr("cy",i),t.attr("rx",s),t.attr("ry",l),this.defineSVGStroke(t,r),r!=se.NOCOLOUR&&t.attr("stroke-width",a),this.defineSVGFill(t,o),t.stop("/>")}svgOvalN(t,e){let{edgeCol:n,fillCol:i,thickness:s}=this.typeObj[e[0].typeidx];t.start("<g"),this.defineSVGStroke(t,n),n!=se.NOCOLOUR&&t.attr("stroke-width",s),this.defineSVGFill(t,i),t.stop(">"),t.inc();for(let n of e){let{cx:e,cy:i,rw:s,rh:l}=n;e=this.offsetX+this.scale*e,i=this.offsetY+this.scale*i,s*=this.scale,l*=this.scale,t.start("<ellipse"),t.attr("cx",e),t.attr("cy",i),t.attr("rx",s),t.attr("ry",l),t.stop("/>")}t.dec(),t.whole("</g>")}svgPath(t,e){let{count:n,x:i,y:s,ctrl:l,closed:r}=e,{edgeCol:o,fillCol:a,thickness:h,hardEdge:u}=this.typeObj[e.typeidx];i=[...i],s=[...s];for(let t=0;t<n;t++)i[t]=this.offsetX+this.scale*i[t],s[t]=this.offsetY+this.scale*s[t];let m="M "+ne(i[0])+" "+ne(s[0]),c=1;for(;c<n;)l&&l[c]?l[c]&&c<n-1&&!l[c+1]?(m+=" Q "+ne(i[c])+" "+ne(s[c])+" "+ne(i[c+1])+" "+ne(s[c+1]),c+=2):l[c]&&c<n-2&&l[c+1]&&!l[c+2]?(m+=" C "+ne(i[c])+" "+ne(s[c])+" "+ne(i[c+1])+" "+ne(s[c+1])+" "+ne(i[c+2])+" "+ne(s[c+2]),c+=3):c++:(m+=" L "+ne(i[c])+" "+ne(s[c]),c++);r&&(m+=" Z"),t.start("<path"),t.attr("d",m),this.defineSVGStroke(t,o),o!=se.NOCOLOUR&&(t.attr("stroke-width",h),t.attr("stroke-linejoin",u?"miter":"round"),t.attr("stroke-linecap",u?"square":"round")),this.defineSVGFill(t,a),t.stop("/>")}svgText(t,e,n=!0){let{x:i,y:s,txt:l,direction:r}=e,{size:o,colour:a}=this.typeObj[e.typeidx];i=this.offsetX+this.scale*i,s=this.offsetY+this.scale*s;let h=jt.main,u=o*this.scale/h.UNITS_PER_EM;0!=r&&(t.start("<g"),t.attr("transform",`rotate(${r},${ne(i)},${ne(s)})`),t.stop(">"),t.inc()),t.start("<g"),t.attr("transform",`translate(${ne(i)},${ne(s)})`),this.defineSVGFill(t,a),t.stop(">"),t.inc(),t.start("<g"),t.attr("transform",`scale(${ne(u)},${ne(-u)})`),t.stop(">"),t.inc();let m=0;for(let e=0;e<l.length;e++){let i=l.charAt(e),s=h.getIndex(i);t.start("<use");let r=s<0?"#missing":"#char"+s;n?t.attr("xlink:href",r):t.attr("href",r),t.attr("x",m),t.stop("/>"),s>=0?(m+=h.HORIZ_ADV_X[s],e<l.length-1&&(m+=h.getKerning(i,l.charAt(e+1)))):m+=h.MISSING_HORZ}t.dec(),t.whole("</g>"),t.dec(),t.whole("</g>"),0!=r&&(t.dec(),t.whole("</g>"))}svgTextNative(t,e){let{x:n,y:i,txt:s}=e,{size:l,colour:r,family:o,opt:a}=this.typeObj[e.typeidx];n=this.offsetX+this.scale*n,i=this.offsetY+this.scale*i;let h=`fill: ${v(r)}; font-family: ${o}; font-size: ${l*this.scale};`;a.bold&&(h+=" font-weight: bold;"),a.italic&&(h+=" font-style: italic;"),t.start("<text"),t.attr("xml:space","preserve"),t.attr("x",n),t.attr("y",i),t.attr("style",h),t.stop(">"+s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")+"</text>")}defineSVGStroke(t,e){if(e==se.NOCOLOUR)return void t.attr("stroke-opacity","0");t.attr("stroke",E(e));let n=x(e);1!=n&&t.attr("stroke-opacity",n)}defineSVGFill(t,e){if(e==se.NOCOLOUR)return void t.attr("fill-opacity","0");t.attr("fill",E(e));let n=x(e);1!=n&&t.attr("fill-opacity",n)}findOrCreateType(t){for(let e=0;e<this.types.length;e++)if(this.types[e].primClass==t.primClass&&Object.keys(t).every((n=>t[n]==this.types[e][n])))return e;return this.types.push(t),this.types.length-1}updateBounds(t,e){if(null==this.lowX)return this.lowX=t,this.lowY=e,this.highX=t,void(this.highY=e);this.lowX=Math.min(this.lowX,t),this.lowY=Math.min(this.lowY,e),this.highX=Math.max(this.highX,t),this.highY=Math.max(this.highY,e)}}se.NOCOLOUR=-1;class le{constructor(t,e){this.layout=t,this.vg=e,this.mnemonics=null,this.mol=t.getMolecule(),this.policy=t.getPolicy(),this.effects=t.getEffects(),this.scale=t.getScale(),this.invScale=1/this.scale}getMolecule(){return this.mol}getMetaVector(){return this.vg}getLayout(){return this.layout}getPolicy(){return this.policy}getEffects(){return this.effects}draw(){var t,e,n,i,s,l,r,o,a,u,m,c,d;this.drawUnderEffects();let{mol:f,layout:p,effects:C,policy:g,vg:A}=this,b=new Set(C.hideBonds);for(let e=1;e<=f.numBonds;e++)if(f.bondType(e)==qt.BONDTYPE_INCLINED&&!b.has(e)){let n=f.bondTo(e);if(p.getPoint(n-1).text)continue;for(let i of f.atomAdjBonds(n))if(i!=e&&f.bondType(i)==qt.BONDTYPE_INCLINED&&f.bondTo(i)==n&&!b.has(i)){let n=p.getLines().find((t=>t.bnum==e)),s=p.getLines().find((t=>t.bnum==i)),l=Math.atan2(n.line.y1-n.line.y2,n.line.x1-n.line.x2),r=Math.atan2(s.line.y1-s.line.y2,s.line.x1-s.line.x2);if(Math.abs(z(l,r))<170*_){this.drawFusedWedge(n,s),null===(t=this.mnemonics)||void 0===t||t.append(Ft.Artifact,"Fused",[n.line.x1,n.line.y1,n.line.x2,n.line.y2,s.line.x1,s.line.y1,s.line.x2,s.line.y2]),b.add(e),b.add(i);break}}}for(let t=0;t<p.numLines();t++){let o=p.getLine(t);b.has(o.bnum)||(o.type==Xt.Normal?(A.drawLine(o.line.x1,o.line.y1,o.line.x2,o.line.y2,o.col,o.size),null===(e=this.mnemonics)||void 0===e||e.append(Ft.Bond,"L",[o.line.x1,o.line.y1,o.line.x2,o.line.y2])):o.type==Xt.Inclined?(this.drawBondInclined(o),null===(n=this.mnemonics)||void 0===n||n.append(Ft.Bond,"I",[o.line.x1,o.line.y1,o.line.x2,o.line.y2])):o.type==Xt.Declined?(this.drawBondDeclined(o),null===(i=this.mnemonics)||void 0===i||i.append(Ft.Bond,"D",[o.line.x1,o.line.y1,o.line.x2,o.line.y2])):o.type==Xt.Unknown?(this.drawBondUnknown(o),null===(s=this.mnemonics)||void 0===s||s.append(Ft.Bond,"U",[o.line.x1,o.line.y1,o.line.x2,o.line.y2])):o.type==Xt.Dotted||o.type==Xt.DotDir?(this.drawBondDotted(o),null===(l=this.mnemonics)||void 0===l||l.append(Ft.Bond,"O",[o.line.x1,o.line.y1,o.line.x2,o.line.y2])):o.type!=Xt.IncDouble&&o.type!=Xt.IncTriple&&o.type!=Xt.IncQuadruple||(this.drawBondIncMulti(o),null===(r=this.mnemonics)||void 0===r||r.append(Ft.Bond,"M",[o.line.x1,o.line.y1,o.line.x2,o.line.y2])))}let y=g.data.foreground;for(let t of p.getRings())if(0!=t.theta){var E=h.createBezierEllipse(t.cx,t.cy,t.rw,t.rh,t.theta);A.drawPath(E.px,E.py,E.ctrl,!0,y,t.size,se.NOCOLOUR,!1),null===(o=this.mnemonics)||void 0===o||o.append(Ft.Artifact,"Ring",[t.cx,t.cy,t.rw,t.rh,t.theta])}else A.drawOval(t.cx,t.cy,t.rw,t.rh,y,t.size,se.NOCOLOUR),null===(a=this.mnemonics)||void 0===a||a.append(Ft.Artifact,"Ring",[t.cx,t.cy,t.rw,t.rh]);for(let t of p.getPaths())A.drawPath(t.px,t.py,t.ctrl,!1,y,t.size,se.NOCOLOUR,!1),null===(u=this.mnemonics)||void 0===u||u.append(Ft.Artifact,"Path",[...t.px,...t.py]);for(let t=0;t<p.numPoints();t++){let e=p.getPoint(t);if(C.hideAtoms.has(e.anum))continue;let n=e.text,i=e.oval.cx,s=e.oval.cy,l=e.oval.rw;if(null==n){null===(m=this.mnemonics)||void 0===m||m.append(Ft.Atom,".",[i,s]);continue}let r=e.fsz,o=e.col;for(;n.endsWith(".");){let t=l/n.length,e=.15*r;A.drawOval(i+l-t,s,e,e,se.NOCOLOUR,0,o),i-=t,l-=t,n=n.substring(0,n.length-1)}for(;n.startsWith("+");){let t=l/n.length,e=i-l+t,a=s,h=.18*r,u=.1*r;A.drawLine(e-h,a,e+h,a,o,u),A.drawLine(e,a-h,e,a+h,o,u),i+=t,l-=t,n=n.substring(1,n.length)}for(;n.startsWith("-");){let t=l/n.length,e=i-l+t,a=s,h=.18*r,u=.1*r;A.drawLine(e-h,a,e+h,a,o,u),i+=t,l-=t,n=n.substring(1,n.length)}n.length>0?(A.drawText(i,s,n,r,o,$t.Centre|$t.Middle,e.rotation||0),null===(c=this.mnemonics)||void 0===c||c.append(Ft.Atom,n,[i,s])):null===(d=this.mnemonics)||void 0===d||d.append(Ft.Atom,".",[i,s])}this.drawOverEffects()}drawUnderEffects(){var t,e,n;let i=this.mol,s=(this.policy,this.effects),l=this.layout,r=this.scale,o=this.vg;for(let e=0,n=Math.min(s.atomFrameDotSz.length,i.numAtoms);e<n;e++){if(s.hideAtoms.has(e+1))continue;let n=s.atomFrameDotSz[e]*r,i=s.atomFrameCol[e],a=l.getPoint(e),h=a.oval.rw+.1*r,u=a.oval.rh+.1*r,m=Math.ceil(2*h/(3*n)),c=Math.ceil(2*u/(3*n)),d=2*h/m,f=2*u/c;for(let t=0;t<=m;t++){let e=a.oval.cx-h+t*d;o.drawOval(e,a.oval.cy-u,n,n,se.NOCOLOUR,0,i),o.drawOval(e,a.oval.cy+u,n,n,se.NOCOLOUR,0,i)}for(let t=1;t<c;t++){let e=a.oval.cy-u+t*f;o.drawOval(a.oval.cx-h,e,n,n,se.NOCOLOUR,0,i),o.drawOval(a.oval.cx+h,e,n,n,se.NOCOLOUR,0,i)}null===(t=this.mnemonics)||void 0===t||t.append(Ft.Effect,"Dot",[a.oval.cx,a.oval.cy,a.oval.rw,a.oval.rh])}for(let t in s.dottedRectOutline){let n=parseInt(t),i=s.dottedRectOutline[t],a=l.getPoint(n-1),h=Math.max(a.oval.rw,.2*r),u=Math.max(a.oval.rh,.2*r),m=.05*r,c=Math.max(1,Math.round(h/(2*m))),d=Math.max(1,Math.round(u/(2*m))),f=2*h/c,p=2*u/d;for(let t=0;t<=c;t++){let e=a.oval.cx-h+t*f;o.drawOval(e,a.oval.cy-u,m,m,se.NOCOLOUR,0,i),o.drawOval(e,a.oval.cy+u,m,m,se.NOCOLOUR,0,i)}for(let t=1;t<d;t++){let e=a.oval.cy-u+t*p;o.drawOval(a.oval.cx-h,e,m,m,se.NOCOLOUR,0,i),o.drawOval(a.oval.cx+h,e,m,m,se.NOCOLOUR,0,i)}null===(e=this.mnemonics)||void 0===e||e.append(Ft.Effect,"Rect",[a.oval.cx,a.oval.cy,a.oval.rw,a.oval.rh])}for(let t in s.dottedBondCross){let e=parseInt(t),i=s.dottedBondCross[t],a=0,h=0,u=0,m=0,c=0;for(let t=0;t<l.numLines();t++){let n=l.getLine(t);n.bnum==e&&(a+=n.line.x1,h+=n.line.y1,u+=n.line.x2,m+=n.line.y2,c+=1)}if(c>1){let t=1/c;[a,h,u,m]=[a*t,h*t,u*t,m*t]}let d=u-a,f=m-h,p=.2*r*D(N(d,f)),C=f*p,g=-d*p,A=.5*(a+u),b=.5*(h+m),y=.05*r;for(let t of[-2,-1,1,2]){let e=A+t*C,n=b+t*g;o.drawOval(e,n,y,y,se.NOCOLOUR,0,i)}null===(n=this.mnemonics)||void 0===n||n.append(Ft.Effect,"Crossing",[a,h,u,m])}}drawOverEffects(){var t,e;let n=this.mol,i=(this.policy,this.effects),s=this.layout,l=this.scale,r=this.vg;for(let e of i.overlapAtoms){let n=s.getPoint(e-1),i=.2*l;r.drawLine(n.oval.cx-i,n.oval.cy-i,n.oval.cx+i,n.oval.cy+i,16711680,1),r.drawLine(n.oval.cx+i,n.oval.cy-i,n.oval.cx-i,n.oval.cy+i,16711680,1),null===(t=this.mnemonics)||void 0===t||t.append(Ft.Effect,"Overlap",[n.oval.cx,n.oval.cy,n.oval.rw,n.oval.rh])}for(let t=0,o=Math.min(i.atomCircleSz.length,n.numAtoms);t<o;t++)if(i.atomCircleSz[t]>0){let n=i.atomCircleSz[t]*l,o=i.atomCircleCol[t],a=s.getPoint(t);r.drawOval(a.oval.cx,a.oval.cy,n,n,se.NOCOLOUR,0,o),null===(e=this.mnemonics)||void 0===e||e.append(Ft.Effect,"Circle",[a.oval.cx,a.oval.cy,a.oval.rw,a.oval.rh])}}drawBondInclined(t){let e=t.line.x1,n=t.line.y1,i=t.line.x2,s=t.line.y2,l=i-e,r=s-n,o=t.col,a=(t.size,t.head/Math.sqrt(l*l+r*r)),u=a*r,m=-a*l,c=[e,i-u,i+u],d=[n,s-m,s+m];if(null==this.layout.getPoint(t.bto-1).text&&2==this.mol.atomAdjCount(t.bto)){let l=null;for(let e=0;e<this.layout.numLines();e++){let n=this.layout.getLine(e);if(n.type==Xt.Normal&&(n.bfr==t.bto||n.bto==t.bto)){if(null!=l){l=null;break}l=n}}if(null!=l){let r=Math.atan2(n-s,e-i),o=Math.atan2(l.line.y1-l.line.y2,l.line.x1-l.line.x2);t.bto==l.bfr&&(o+=Math.PI);let a=Math.abs(z(r,o));if(a>105*_&&a<135*_){let t=h.lineIntersect(c[0],d[0],c[1],d[1],l.line.x1,l.line.y1,l.line.x2,l.line.y2),e=h.lineIntersect(c[0],d[0],c[2],d[2],l.line.x1,l.line.y1,l.line.x2,l.line.y2);c[1]=t[0],d[1]=t[1],c[2]=e[0],d[2]=e[1];let n=c[1]-c[0],i=d[1]-d[0],s=.5*l.size/N(n,i);c[1]+=n*s,d[1]+=i*s;let r=c[2]-c[0],o=d[2]-d[0];l.size,N(r,o),c[2]+=r*s,d[2]+=o*s}}}if(null==this.layout.getPoint(t.bto-1).text&&3==this.mol.atomAdjCount(t.bto)){let l=null,r=null;for(let e=0;e<this.layout.numLines();e++){let n=this.layout.getLine(e);if(n.type==Xt.Normal&&(n.bfr==t.bto||n.bto==t.bto))if(null==l)l=n;else{if(null!=r){l=r=null;break}r=n}}if(null!=l&&null!=r){let o=Math.atan2(n-s,e-i),a=Math.atan2(l.line.y1-l.line.y2,l.line.x1-l.line.x2),u=Math.atan2(r.line.y1-r.line.y2,r.line.x1-r.line.x2);t.bto==l.bfr&&(a+=Math.PI),t.bto==r.bfr&&(u+=Math.PI);let m=z(o,a),f=Math.abs(m),p=z(o,u),C=Math.abs(p),g=Math.abs(z(a,u));if(f>105*_&&f<135*_||C>105*_&&C<135*_||g>105*_&&g<135*_){m<0&&([l,r]=[r,l]);let t=h.lineIntersect(c[0],d[0],c[1],d[1],l.line.x1,l.line.y1,l.line.x2,l.line.y2),o=h.lineIntersect(c[0],d[0],c[2],d[2],r.line.x1,r.line.y1,r.line.x2,r.line.y2);c=[e,t[0],i,o[0]],d=[n,t[1],s,o[1]]}}}this.vg.drawPoly(c,d,se.NOCOLOUR,0,o,!0)}drawFusedWedge(t,e){const n=(t,e)=>{let n=t.line.x1,i=t.line.y1,s=t.line.x2,l=t.line.y2,r=s-n,o=l-i,a=t.head/Math.sqrt(r*r+o*o),h=a*o,u=-a*r,m=s-h,c=l-u,d=s+h,f=l+u;return q(m-e.line.x1,c-e.line.y1)>q(d-e.line.x1,f-e.line.y1)?{outerX:m,outerY:c,innerX:d,innerY:f}:{outerX:d,outerY:f,innerX:m,innerY:c}};let i=n(t,e),s=n(e,t),[l,r]=h.lineIntersect(t.line.x1,t.line.y1,i.innerX,i.innerY,e.line.x1,e.line.y1,s.innerX,s.innerY),o=[t.line.x1,i.outerX,s.outerX,e.line.x1,l],a=[t.line.y1,i.outerY,s.outerY,e.line.y1,r];this.vg.drawPoly(o,a,se.NOCOLOUR,0,t.col,!0)}drawBondDeclined(t){let e=t.line.x1,n=t.line.y1,i=t.line.x2-e,s=t.line.y2-n,l=t.col,r=t.size,o=t.head,a=Math.sqrt(i*i+s*s),h=Math.ceil(2.5*a*this.invScale),u=o/a,m=u*s,c=-u*i,d=1/(h+1),f=1==this.mol.atomAdjCount(t.bto)&&null==this.layout.getPoint(t.bto-1).text?1:1-.15*this.scale/a;for(let t=0;t<=h+1;t++){let o=e+t*i*d*f,a=n+t*s*d*f,h=m*t*d,u=c*t*d;this.vg.drawLine(o-h,a-u,o+h,a+u,l,r)}}drawBondUnknown(e){let n=e.line.x1,i=e.line.y1,s=e.line.x2-n,l=e.line.y2-i,r=e.col,o=e.size,a=e.head,h=Math.sqrt(s*s+l*l),u=Math.ceil(3.5*h*this.invScale),m=a/h,c=m*l,d=-m*s,f=1+3*(u+1),p=t.numberArray(0,f),C=t.numberArray(0,f),g=t.booleanArray(!1,f);p[0]=n,C[0]=i,g[0]=!1;for(let t=0,e=1;t<=u;t++,e+=3){let r=n+t*s/(u+1),o=i+t*l/(u+1),a=n+(t+1)*s/(u+1),h=i+(t+1)*l/(u+1),m=(r+a)/2,f=(o+h)/2,A=t%2==0?1:-1;p[e]=r,p[e+1]=m+A*c,p[e+2]=a,C[e]=o,C[e+1]=f+A*d,C[e+2]=h,g[e]=!0,g[e+1]=!0,g[e+2]=!1}this.vg.drawPath(p,C,g,!1,r,o,se.NOCOLOUR,!1)}drawBondDotted(t){let e=t.line.x1,n=t.line.y1,i=t.line.x2,s=t.line.y2,l=i-e,r=s-n,o=t.col,a=t.size,h=a,u=N(l,r);if(u<.01)return;let m=.5*a/u;e+=m*l,n+=m*r,i-=m*l,s-=m*r,l=i-e,r=s-n;let c=Math.ceil(.2*u/h),d=1/(c+1);for(let i=0;i<=c+1;i++){let s=h;t.type==Xt.DotDir&&(s*=i*(1/(c+2))-.5+1);let a=e+i*l*d,u=n+i*r*d;this.vg.drawOval(a,u,s,s,se.NOCOLOUR,0,o)}}drawBondIncMulti(t){let e=t.line.x1,n=t.line.y1,i=t.line.x2,s=t.line.y2,l=i-e,r=s-n,o=t.col,a=(t.size,t.head/Math.sqrt(l*l+r*r)),h=a*r,u=-a*l;this.vg.drawPoly([e,i-h,i+h],[n,s-u,s+u],o,.05*this.scale,se.NOCOLOUR,!0),t.type==Xt.IncDouble?this.vg.drawLine(e,n,i,s,o,.03*this.scale):(this.vg.drawLine(e,n,i+.33*h,s+.33*u,o,.03*this.scale),this.vg.drawLine(e,n,i-.33*h,s-.33*u,o,.03*this.scale))}}class re{constructor(t,e){this.layout=t,this.vg=e,this.hoverIndex=-1,this.activeIndex=-1,this.selectedIndex=-1,this.callbackDrawNameLine=null,this.measure=t.measure,this.policy=t.policy,this.scale=t.scale,this.invScale=1/this.scale}draw(){for(let t of this.layout.components)t.parentIdx>=0&&this.drawConnection(this.layout.components[t.parentIdx],t);for(let t=0;t<this.layout.components.length;t++)this.drawComponent(t)}drawConnection(t,e){let n=t.boundary.maxX(),i=e.boundary.minX(),s=t.boundary.midY(),l=e.boundary.midY(),r=n+.25*this.scale,o=s<l-1?-4:s>l+1?4:0,a=[n,r-4,r,r,r,r,r+4,i],h=[s,s,s,s-o,l+o,l,l,l],u=.1*this.scale;this.vg.drawPath(a,h,[!1,!1,!0,!1,!1,!0,!1,!1],!1,0,u,se.NOCOLOUR,!1)}drawComponent(t){let e=this.layout.components[t],n=e.outline.clone();n.offsetBy(e.boundary.x,e.boundary.y);let i=16316664;if(t==this.activeIndex?i=8558308:t==this.selectedIndex?i=11123711:t==this.hoverIndex&&(i=14737632),this.vg.drawRect(n.x,n.y,n.w,n.h,8421504,1,i),e.molLayout&&new le(e.molLayout,this.vg).draw(),e.nameLines.length>0){let t=n.x,i=t+e.nameBox.midX(),s=n.y+e.nameBox.y;for(let l of e.nameLines){let r=this.measure.measureText(l.text,e.fontSize),o=r[1]+2*r[2];this.callbackDrawNameLine&&this.callbackDrawNameLine(e,l,this.vg,new d(t,s,n.w,o))||this.vg.drawText(i,s,l.text,e.fontSize,l.col,$t.Centre|$t.Top),s+=o}}if(e.collapseBox){let t=e.collapseBox.clone();t.offsetBy(e.boundary.x,e.boundary.y),this.vg.drawRect(t.x,t.y,t.w,t.h,8421504,1,16316664);let n=t.midX(),i=t.midY(),s=.4*Math.min(t.w,t.h),l=.2*s;this.vg.drawLine(n-s,i,n+s,i,0,l),e.isCollapsed&&this.vg.drawLine(n,i-s,n,i+s,0,l)}}}!function(t){t.pc="http://purl.obolibrary.org/obo/UO_0000187",t.pcWV="http://purl.obolibrary.org/obo/UO_0000164",t.pcWW="http://purl.obolibrary.org/obo/UO_0000163",t.pcVV="http://purl.obolibrary.org/obo/UO_0000205",t.pcMM="http://purl.obolibrary.org/obo/UO_0000076",t.ratio="http://purl.obolibrary.org/obo/UO_0000190",t.mol_L="http://purl.obolibrary.org/obo/UO_0000062",t.mmol_L="http://purl.obolibrary.org/obo/UO_0000063",t.umol_L="http://purl.obolibrary.org/obo/UO_0000064",t.nmol_L="http://purl.obolibrary.org/obo/UO_0000065",t.pmol_L="http://purl.obolibrary.org/obo/UO_0000066",t.g_L="http://purl.obolibrary.org/obo/UO_0000175",t.mg_L="http://purl.obolibrary.org/obo/UO_0000273",t.ug_L="http://purl.obolibrary.org/obo/UO_0000275",t.mg_mL="http://purl.obolibrary.org/obo/UO_0000176",t.mol_kg="http://purl.obolibrary.org/obo/UO_0000068",t.kg="http://purl.obolibrary.org/obo/UO_0000009",t.g="http://purl.obolibrary.org/obo/UO_0000021",t.mg="http://purl.obolibrary.org/obo/UO_0000022",t.ug="http://purl.obolibrary.org/obo/UO_0000023",t.ng="http://purl.obolibrary.org/obo/UO_0000024",t.L="http://purl.obolibrary.org/obo/UO_0000099",t.mL="http://purl.obolibrary.org/obo/UO_0000098",t.uL="http://purl.obolibrary.org/obo/UO_0000101",t.nL="http://purl.obolibrary.org/obo/UO_0000102",t.mol="http://purl.obolibrary.org/obo/UO_0000013",t.mmol="http://purl.obolibrary.org/obo/UO_0000040",t.umol="http://purl.obolibrary.org/obo/UO_0000039",t.nmol="http://purl.obolibrary.org/obo/UO_0000041",t.ppm="placeholder1",t.ppb="placeholder2"}(Jt||(Jt={}));const oe=[[Jt.pc,"%"],[Jt.pcWV,"w/v%"],[Jt.pcWW,"w/w%"],[Jt.pcVV,"v/v%"],[Jt.pcMM,"mol/mol%"],[Jt.ratio,"ratio"],[Jt.mol_L,"mol/L","M"],[Jt.mmol_L,"mmol/L","mM"],[Jt.umol_L,"mol/L","umol/L","uM"],[Jt.nmol_L,"nmol/L","nM"],[Jt.pmol_L,"pmol/L","pM"],[Jt.g_L,"g/L"],[Jt.mg_L,"mg/L"],[Jt.ug_L,"g/L","ug/L"],[Jt.mg_mL,"mg/mL"],[Jt.mol_kg,"mol/kg"],[Jt.kg,"kg"],[Jt.g,"g"],[Jt.mg,"mg"],[Jt.ug,"g","ug"],[Jt.ng,"ng"],[Jt.L,"L"],[Jt.mL,"mL"],[Jt.uL,"L","uL"],[Jt.nL,"nL"],[Jt.mol,"mol"],[Jt.mmol,"mmol"],[Jt.umol,"mol","umol"],[Jt.nmol,"nmol"],[Jt.ppm,"ppm"],[Jt.ppb,"ppb"]],ae=[[Jt.pc,"pp",1],[Jt.pcWV,"wv",.01],[Jt.pcWW,"wf",.01],[Jt.pcVV,"vf",.01],[Jt.pcMM,"mf",.01],[Jt.ratio,"rt",1],[Jt.mol_L,"mr",1],[Jt.mmol_L,"mr",.001],[Jt.umol_L,"mr",1e-6],[Jt.nmol_L,"mr",1e-9],[Jt.pmol_L,"mr",1e-12],[Jt.g_L,"wv",.001],[Jt.mg_L,"wv",1e-6],[Jt.ug_L,"wv",1e-9],[Jt.mg_mL,"wv",.001],[Jt.mol_kg,"mb",1],[Jt.ppm,"pp",1e-6],[Jt.ppb,"pp",1e-9]];class he{static setup(){for(let t of oe){let e=t[0],n=t[1];this.STANDARD_LIST.push(e),this.COMMON_NAMES.push(n),this.URI_TO_NAME[e]=n;for(let n=1;n<=t.length;n++)this.NAME_TO_URI[t[n]]=e}for(let t of ae){let e=t[0],n=t[1],i=t[2];this.URI_TO_MINCHI[e]=[n,i]}this.setup=()=>{}}static standardList(){return this.setup(),this.STANDARD_LIST}static commonNames(){return this.setup(),this.COMMON_NAMES}static uriToName(t){return this.setup(),this.URI_TO_NAME[t]}static nameToURI(t){return this.setup(),this.NAME_TO_URI[t]}static convertToMInChI(e,n){let[i,s]=this.URI_TO_MINCHI[e]||[null,null];return i?[i,t.mul(n,s)]:[null,null]}}var ue,me;he.STANDARD_LIST=[],he.COMMON_NAMES=[],he.URI_TO_NAME={},he.NAME_TO_URI={},he.URI_TO_MINCHI={},function(t){t[t.O0=0]="O0",t[t.O01=1]="O01",t[t.O1=2]="O1",t[t.O12=3]="O12",t[t.O2=4]="O2",t[t.O23=5]="O23",t[t.O3=6]="O3",t[t.O3X=7]="O3X"}(ue||(ue={})),function(t){t[t.N1X=-3]="N1X",t[t.N1=-2]="N1",t[t.N01=-1]="N01",t[t.Z0=0]="Z0",t[t.P01=1]="P01",t[t.P1=2]="P1",t[t.P1X=3]="P1X"}(me||(me={}));class ce{constructor(t){this.mol=t,this.paths=[],t&&this.calculate()}clone(){let t=new ce(null);return t.mol=this.mol,t.maskBlock=this.maskBlock,t.paths=this.paths.slice(0),t}getBondOrders(){const t=this.mol;let e=[];for(let n=1;n<=t.numBonds;n++)e.push(t.bondOrder(n));for(let t of this.paths){let n=t.numer/t.denom;for(let t=1;t<=5;t++)R(n,t)&&(n=t);for(let i of t.bonds)e[i-1]=n}return e}getBondClasses(){const t=this.mol;let e=[];for(let n=1;n<=t.numBonds;n++){let i=t.bondOrder(n);e.push(0==i?0:1==i?2:2==i?4:3==i?6:7)}for(let t of this.paths){let n=t.numer/t.denom,i=R(n,0)?0:R(n,1)?2:R(n,2)?4:R(n,3)?6:n<1?1:n<2?3:n<3?5:7;for(let n of t.bonds)e[n-1]=i}return e}getChargeClasses(){const t=this.mol;let e=[];for(let n=1;n<=t.numAtoms;n++){let i=t.atomCharge(n);e.push(0==i?0:-1==i?-2:1==i?2:i<-1?-3:3)}for(let n of this.paths){let i=0;for(let e of n.atoms)i+=t.atomCharge(e);i/=n.atoms.length;let s=R(i,0)?0:R(i,-1)?-2:R(i,1)?2:i>-1&&i<0?-1:i>0&&i<1?1:i<-1?-3:3;for(let t of n.atoms)e[t-1]=s}return e}getAggregateCharges(){const t=this.mol;let e=[];for(let n=1;n<=t.numAtoms;n++)e[n-1]=t.atomCharge(n);for(let t of this.paths){let n=0;for(let i of t.atoms)n+=e[i-1];for(let i of t.atoms)e[i-1]=n}return e}toString(){let t="blocking="+JSON.stringify(this.maskBlock)+"; paths="+this.paths.length;for(let e of this.paths)t+=" ["+e.numer+"/"+e.denom+";a="+JSON.stringify(e.atoms)+";b="+JSON.stringify(e.bonds)+"]";return t}calculate(){const e=this.mol,n=e.numAtoms,i=e.numBonds;let l=t.booleanArray(!1,n),r=t.booleanArray(!1,n),o=t.booleanArray(!1,n),a=t.numberArray(0,n);for(let t=0;t<n;t++)a[t]=e.atomHydrogens(t+1);for(let t=1;t<=i;t++){let n=e.bondOrder(t),i=e.bondFrom(t),h=e.bondTo(t);if(1!=n&&(l[i-1]=!0,l[h-1]=!0),n>=2)r[i-1]=!0,r[h-1]=!0;else{let t=s.ELEMENT_BLOCKS[e.atomicNumber(i)],n=s.ELEMENT_BLOCKS[e.atomicNumber(h)];(t>=3||n>=3)&&(o[i-1]=!0,o[h-1]=!0)}a[i-1]+=n,a[h-1]+=n,e.bondTransient(t).indexOf(nt.BondAromatic)>=0&&(r[i-1]=!0,r[h-1]=!0)}let h=t.booleanArray(!1,n);for(let t=1;t<=n;t++)if(!r[t-1]){let n=0;for(let i of e.atomAdjList(t))(r[i-1]||o[i-1])&&n++;n>=2&&(h[t-1]=!0)}for(let t=0;t<n;t++)h[t]&&(r[t]=!0);this.maskBlock=t.booleanArray(!1,n);let u=t.booleanArray(!1,n);const m=[s.ELEMENT_H,s.ELEMENT_B,s.ELEMENT_C,s.ELEMENT_N,s.ELEMENT_O,s.ELEMENT_F,s.ELEMENT_Al,s.ELEMENT_Si,s.ELEMENT_P,s.ELEMENT_S,s.ELEMENT_Cl,s.ELEMENT_Ga,s.ELEMENT_Ge,s.ELEMENT_As,s.ELEMENT_Se,s.ELEMENT_Br,s.ELEMENT_In,s.ELEMENT_Sn,s.ELEMENT_Sb,s.ELEMENT_Te,s.ELEMENT_I,s.ELEMENT_Tl,s.ELEMENT_Pb,s.ELEMENT_Bi,s.ELEMENT_Po,s.ELEMENT_At],c=[s.ELEMENT_B,s.ELEMENT_Al,s.ELEMENT_Si,s.ELEMENT_Ga,s.ELEMENT_Ge,s.ELEMENT_In,s.ELEMENT_Sn,s.ELEMENT_Tl,s.ELEMENT_Pb],d=[s.ELEMENT_N,s.ELEMENT_O,s.ELEMENT_F,s.ELEMENT_P,s.ELEMENT_S,s.ELEMENT_Cl,s.ELEMENT_As,s.ELEMENT_Se,s.ELEMENT_Br,s.ELEMENT_Sb,s.ELEMENT_Te,s.ELEMENT_I,s.ELEMENT_Bi,s.ELEMENT_Po,s.ELEMENT_At];t:for(let t=0;t<n;t++){const n=t+1;if(l[t]||r[t])continue;if(0!=e.atomCharge(n)||0!=e.atomUnpaired(n))continue;const i=e.atomicNumber(n);if(0!=i){if(!(m.indexOf(i)<0)&&a[t]==s.ELEMENT_BONDING[i]){if(c.indexOf(i)>=0)for(let t of e.atomAdjList(n))if(d.indexOf(e.atomicNumber(t))>=0)continue t;if(d.indexOf(i)>=0)for(let t of e.atomAdjList(n))if(c.indexOf(e.atomicNumber(t))>=0)continue t;if(u[t]=!0,i==s.ELEMENT_C){let i=!1;for(let t of e.atomAdjList(n))m.indexOf(e.atomicNumber(t))<0&&(i=!0);i||(this.maskBlock[t]=!0)}else i==s.ELEMENT_H&&(this.maskBlock[t]=!0)}}else this.maskBlock[t]=!0}t:for(let t=0;t<n;t++)if(u[t]&&!this.maskBlock[t]){for(let n of e.atomAdjList(t+1))if(!u[n-1])continue t;this.maskBlock[t]=!0}let f=Q.fromMolecule(e);for(let t=0;t<n;t++)this.maskBlock[t]&&f.isolateNode(t);for(let l of f.calculateComponentGroups()){if(1==l.length)continue;let r=t.idxMask(l,n);t.addTo(l,1);let o={atoms:l,bonds:[],numer:0,denom:0};for(let t=1;t<=i;t++)r[e.bondFrom(t)-1]&&r[e.bondTo(t)-1]&&o.bonds.push(t);let a=0,h=0;for(let t of o.atoms){let n=e.atomHydrogens(t);for(let i of e.atomAdjList(t))r[i-1]||n++;let i=e.atomicNumber(t);a+=s.ELEMENT_VALENCE[i]-e.atomCharge(t)-n,h+=s.ELEMENT_SHELL[i]-s.ELEMENT_VALENCE[i]-n}let u=Math.min(a,h);o.numer=u,o.denom=2*o.bonds.length,this.paths.push(o)}}}class de{constructor(e){this.meta=e,this.mol=e.mol,this.priority=t.numberArray(0,this.mol.numAtoms),this.chiralTetra=t.numberArray(de.STEREO_NONE,this.mol.numAtoms),this.cistransBond=t.numberArray(de.STEREO_NONE,this.mol.numBonds),this.squarePlanar=t.numberArray(de.STEREO_NONE,this.mol.numAtoms)}calculate(){this.isH=t.booleanArray(!1,this.mol.numAtoms);for(let t=this.mol.numAtoms;t>=1;t--)this.isH[t-1]="H"==this.mol.atomElement(t);this.buildPriority(),this.buildTetraChirality(),this.buildBondCisTrans(),this.buildPlanarCisTrans(),this.buildOctaChirality()}atomPriority(t){return this.priority[t-1]}atomTetraChirality(t){return this.chiralTetra[t-1]}bondSideStereo(t){return this.cistransBond[t-1]}atomPlanarStereo(t){return this.squarePlanar[t-1]}getPriorities(){return this.priority.slice(0)}getAtomTetraChiral(){return this.chiralTetra.slice(0)}getBondSideStereo(){return this.cistransBond.slice(0)}static create(t){let e=new de(t);return e.calculate(),e}static rubricTetrahedral(e,n){if(e.atomAdjCount(n)<3||e.atomAdjCount(n)+e.atomHydrogens(n)!=4)return null;let i=e.atomAdjBonds(n),s=!1;for(let t=0;t<i.length;t++){let l=e.bondType(i[t]);if(l==qt.BONDTYPE_UNKNOWN)return null;e.bondFrom(i[t])==n&&(l!=qt.BONDTYPE_INCLINED&&l!=qt.BONDTYPE_DECLINED||(s=!0))}if(!s&&!e.is3D())return null;let l=e.atomAdjList(n),r=[0,0,0,0],o=[0,0,0,0],a=[0,0,0,0],h=0,u=0;for(let t=0;t<i.length;t++){const s=e.bondFrom(i[t]),f=e.bondType(i[t]);if(r[t]=e.atomX(l[t])-e.atomX(n),o[t]=e.atomY(l[t])-e.atomY(n),e.is3D()?a[t]=e.atomZ(l[t])-e.atomZ(n):s==n&&(f==qt.BONDTYPE_INCLINED?(a[t]=1,u++):f==qt.BONDTYPE_DECLINED&&(a[t]=-1,u++)),m=r[t],c=o[t],d=a[t],Math.hypot(m,c,d)<1e-4&&(h++,h>1))return null}var m,c,d;if(3==i.length)if(l.push(0),e.is3D()||1!=u){r[3]=-(r[0]+r[1]+r[2]),o[3]=-(o[0]+o[1]+o[2]),a[3]=-(a[0]+a[1]+a[2]);let t=S(r[3],o[3],a[3]);if(t<1e-4)return null;let e=1/Math.sqrt(t);r[3]*=e,o[3]*=e,a[3]*=e}else{let t=Math.atan2(o[0],r[0]),e=Math.atan2(o[1],r[1]),n=Math.atan2(o[2],r[2]),i=1,s=2;F(e,t)>F(n,t)&&(s=1,i=2),r[0]=1.5,o[0]=0,r[1]=-.75,o[i]=1.3,r[2]=-.75,o[s]=-1.3}let f=0,p=0;for(let t=1;t<=6;t++){let e=0,n=0;1==t?(e=1,n=2):2==t?(e=2,n=3):3==t?(e=3,n=1):4==t?(e=2,n=1):5==t?(e=3,n=2):6==t&&(e=1,n=3);let i=o[e]*a[n]-o[n]*a[e]-r[0],s=a[e]*r[n]-a[n]*r[e]-o[0],l=r[e]*o[n]-r[n]*o[e]-a[0];t<=3?f+=i*i+s*s+l*l:p+=i*i+s*s+l*l}return p>f&&t.swap(l,2,3),l}static rubricSquarePlanar(e,n){if(4!=e.atomAdjCount(n))return null;if(!e.is3D()){let t=0,i=0;for(let s of e.atomAdjBonds(n)){let n=e.bondType(s);n==qt.BONDTYPE_INCLINED?t++:n==qt.BONDTYPE_DECLINED&&i++}if(2==t&&2==i);else if(2==t&&0==i);else if(0!=t||2!=i)return null}let i=e.atomAdjList(n),s=Dt.atomVec3(e,n),l=t.sub(Dt.atomVec3(e,i[0]),s),r=t.sub(Dt.atomVec3(e,i[1]),s),o=t.sub(Dt.atomVec3(e,i[2]),s),a=t.sub(Dt.atomVec3(e,i[3]),s);for(let t of[l,r,o,a]){let e=S(t[0],t[1],t[2]);if(e<1e-4)continue;let n=1/Math.sqrt(e);t[0]*=n,t[1]*=n,t[2]*=n}let u=h.dist2(l,r),m=h.dist2(l,o),c=h.dist2(l,a);u>m&&u>=c?(t.swap(i,1,2),[r,o]=[o,r]):c>m&&(t.swap(i,3,2),[o,a]=[a,o]);const d=(e.is3D()?80:45)*_,f=(e.is3D()?100:135)*_,p=h.acuteAngle(l,r);if(p<d||p>f)return null;const C=h.acuteAngle(r,o);if(C<d||C>f)return null;const g=h.acuteAngle(o,a);if(g<d||g>f)return null;const A=h.acuteAngle(a,l);return A<d||A>f?null:i}static rubricBipyrimidal(e,n){const i=e.atomAdjCount(n);if(4!=i&&5!=i)return null;let s=0,l=0,r=e.atomAdjList(n),o=e.atomAdjBonds(n);if(!e.is3D()){for(let t=0;t<r.length;t++)if(e.bondType(o[t])==qt.BONDTYPE_INCLINED){if(s>0)return null;s=r[t]}else if(e.bondType(o[t])==qt.BONDTYPE_DECLINED){if(l>0)return null;l=r[t]}if(0==s||0==l)return null;let t=Math.atan2(e.atomY(s)-e.atomY(n),e.atomX(s)-e.atomX(n)),i=Math.atan2(e.atomY(l)-e.atomY(n),e.atomX(l)-e.atomX(n));if(Math.abs(z(t,i))>160*_)return null}let a=Dt.atomVec3(e,n),u=[[],[],[],[],[]];for(let n=0;n<i;n++){u[n]=t.sub(Dt.atomVec3(e,r[n]),a);const i=h.magnitude(u[n]);if(i<.1)return null;t.mulBy(u[n],1/i),r[n]==s?u[n][2]+=1:r[n]==l&&(u[n][2]-=1)}let m=0,c=0;const d=175*_;for(let t=0;t<i-1;t++)if(r[t]!=s&&r[t]!=l)for(let e=t+1;e<i;e++)if(r[e]!=s&&r[e]!=l&&h.acuteAngle(u[t],u[e])>d){if(0!=m)return null;m=r[t],c=r[e]}if(e.is3D())for(let t of r)t!=m&&t!=c&&(0==s?s=t:0==l&&(l=t));if(!m||!c)return null;let f=null,p=u[r.indexOf(s)],C=u[r.indexOf(l)],g=u[r.indexOf(m)],A=u[r.indexOf(c)],b=0;if(5==i){for(let t=0;t<i;t++)if(r[t]!=s&&r[t]!=l&&r[t]!=m&&r[t]!=c){b=r[t],f=u[t];break}}else{f=[0,0,0],f=t.sub(f,p),f=t.sub(f,C);const e=h.magnitude(f);if(e<.1)return null;t.mulBy(f,1/e)}let y=t.sub(A,g),E=h.crossProduct(y,f);return h.dist2(E,p)<h.dist2(E,C)?[b,s,l,m,c]:[b,s,l,c,m]}static rubricOctahedral(e,n){const i=e.atomAdjCount(n);if(5!=i&&6!=i)return null;let s=e.atomAdjList(n),l=e.atomAdjBonds(n);if(5==i&&(s.push(0),l.push(0)),!e.is3D()){let t=0;for(let n of l)if(n>0){const i=e.bondType(n);i!=qt.BONDTYPE_INCLINED&&i!=qt.BONDTYPE_DECLINED||t++}if(5==i&&t<1||6==i&&t<2)return null}let r=Dt.atomVec3(e,n),o=[[],[],[],[],[],[]];for(let a=0;a<i;a++){o[a]=Dt.atomVec3(e,s[a]),t.subFromArray(o[a],r);let i=h.magnitude(o[a]);if(i<.1)return null;t.mulBy(o[a],1/i);let u=e.bondType(l[a]);u==qt.BONDTYPE_INCLINED?e.bondFrom(l[a])==n?o[a][2]+=1:o[a][2]-=1:u==qt.BONDTYPE_DECLINED&&(e.bondFrom(l[a])==n?o[a][2]-=1:o[a][2]+=1)}if(5==i){o[5]=[0,0,0];for(let e=0;e<5;e++)t.subFromArray(o[5],o[e]);let e=h.magnitude(o[5]);if(e<.1)return null;t.mulBy(o[5],1/e)}let a=[-1,-1,-1,-1,0,1],u=h.acuteAngle(o[0],o[1]);for(let t=0;t<5;t++)for(let e=0==t?2:t+1;e<6;e++){let n=h.acuteAngle(o[t],o[e]);n>u&&(a[4]=t,a[5]=e,u=n)}let m=t.sub(o[a[5]],o[a[4]]),c=Number.POSITIVE_INFINITY;for(let t=0;t<6;t++)if(t!=a[4]&&t!=a[5]){let e=Math.abs(90*_-h.acuteAngle(o[t],m));e<c&&(a[0]=t,c=e)}for(let t=1;t<=2;t++){let e=h.crossProduct(m,o[a[t-1]]),n=Number.POSITIVE_INFINITY;for(let i=0;i<6;i++){if(i==a[4]||i==a[5]||i==a[0]||i==a[1])continue;let s=h.acuteAngle(o[i],e);s<n&&(a[t]=i,n=s)}}for(let t=0;t<6;t++)if(a.indexOf(t)<0){a[3]=t;break}let d=[0,0,0,0,0,0];for(let t=0;t<6;t++)d[t]=a[t]<0?0:s[a[t]];return d}static rubricBondSides(e,n){const i=e.bondFrom(n),s=e.bondTo(n),l=e.atomAdjCount(i),r=e.atomAdjCount(s);if(l<2||l>3||r<2||r>3)return null;let o=e.atomAdjList(i),a=e.atomAdjList(s),u=0,m=0,c=0,d=0;for(let t=0;t<o.length;t++)o[t]!=s&&(0==u?u=o[t]:m=o[t]);for(let t=0;t<a.length;t++)a[t]!=i&&(0==c?c=a[t]:d=a[t]);if(u>0&&m>0&&"H"==e.atomElement(u)){let t=u;u=m,m=t}if(c>0&&d>0&&"H"==e.atomElement(c)){let t=c;c=d,d=t}let f=Dt.atomVec3(e,i),p=Dt.atomVec3(e,s),C=t.sub(p,f),g=t.sub(Dt.atomVec3(e,u),f),A=t.sub(Dt.atomVec3(e,c),p);const b=.1*.1;let y=h.crossProduct(g,C);if(h.magnitude2(y)<b)return null;let E=h.crossProduct(A,C);if(h.magnitude2(E)<b)return null;let x=t.neg(y),M=h.dist2(y,E)<h.dist2(x,E),v=M,T=M,N=M,q=null,S=null,w=null,O=null,D=null;if(m>0)if(q=t.sub(Dt.atomVec3(e,m),f),h.magnitude2(q)<b){if("H"!=e.atomElement(m))return null}else{if(w=h.crossProduct(q,C),h.magnitude2(w)<b)return null;D=t.neg(w),v=h.dist2(w,E)>h.dist2(D,E)}if(d>0)if(S=t.sub(Dt.atomVec3(e,d),p),h.magnitude2(S)<b){if("H"!=e.atomElement(d))return null}else{if(O=h.crossProduct(S,C),h.magnitude2(O)<b)return null;T=h.dist2(y,O)>h.dist2(x,O)}return null!=w&&null!=O&&(N=h.dist2(w,O)<h.dist2(D,O)),M&&v&&T&&N?[u,m,c,d]:M||v||T||N?null:[u,m,d,c]}buildTetraChirality(){const n=this.mol,i=n.numAtoms,s=n.numBonds;let l=t.booleanArray(!1,i);for(let t=1;t<=s;t++)n.bondType(t)!=qt.BONDTYPE_INCLINED&&n.bondType(t)!=qt.BONDTYPE_DECLINED||(l[n.bondFrom(t)-1]=!0);t:for(let s=1;s<=i;s++){this.chiralTetra[s-1]=de.STEREO_NONE;let i=n.atomAdjList(s);if(4!=i.length&&(3!=i.length||1!=n.atomHydrogens(s)))continue;if(3==i.length&&(this.isH[i[0]-1]||this.isH[i[1]-1]||this.isH[i[2]-1]))continue;for(let t=0;t<i.length-1;t++)for(let e=t+1;e<i.length;e++)if(this.priority[i[t]-1]==this.priority[i[e]-1])continue t;if(!l[s-1]&&!n.is3D()){this.chiralTetra[s-1]=de.STEREO_UNKNOWN;continue}let r=de.rubricTetrahedral(n,s);if(null==r)continue;let o=[0==r[0]?0:this.priority[r[0]-1],0==r[1]?0:this.priority[r[1]-1],0==r[2]?0:this.priority[r[2]-1],0==r[3]?0:this.priority[r[3]-1]];o=t.idxSort(o);let a=e.parityIdentity(o);this.chiralTetra[s-1]=1&a?de.STEREO_NEG:de.STEREO_POS}}buildBondCisTrans(){const e=this.mol,n=(e.numAtoms,e.numBonds);let i=t.booleanArray(!1,n);for(let t=3;t<=7;t++)for(let n of e.findRingsOfSize(t))for(let t=0;t<n.length;t++)i[e.findBond(n[t],n[t<n.length-1?t+1:0])-1]=!0;t:for(let t=1;t<=n;t++){if(this.cistransBond[t-1]=de.STEREO_NONE,2!=e.bondOrder(t)||this.meta.isBondAromatic(t)||i[t-1])continue;let n=e.bondFrom(t),s=e.bondTo(t),l=e.atomAdjList(n),r=e.atomAdjList(s);if(l.length<=1||r.length<=1||l.length>3||r.length>3)continue;if(2==l.length&&(this.isH[l[0]-1]||this.isH[l[1]-1]))continue;if(2==r.length&&(this.isH[r[0]-1]||this.isH[r[1]-1]))continue;for(let t=0;t<l.length-1;t++)if(l[t]!=n)for(let e=t+1;e<l.length;e++)if(l[e]!=n&&this.priority[l[t]-1]==this.priority[l[e]-1])continue t;for(let t=0;t<r.length-1;t++)if(r[t]!=s)for(let e=t+1;e<r.length;e++)if(r[e]!=s&&this.priority[r[t]-1]==this.priority[r[e]-1])continue t;if(e.bondType(t)==qt.BONDTYPE_UNKNOWN){this.cistransBond[t-1]=de.STEREO_UNKNOWN;continue}let o=de.rubricBondSides(e,t);if(null==o)continue;let a=0==o[0]?0:this.priority[o[0]-1],h=0==o[1]?0:this.priority[o[1]-1],u=0==o[2]?0:this.priority[o[2]-1],m=0==o[3]?0:this.priority[o[3]-1];this.cistransBond[t-1]=a<h==u<m?de.STEREO_POS:de.STEREO_NEG}}buildPlanarCisTrans(){const t=this.mol,n=t.numAtoms;t.numBonds;t:for(let i=1;i<=n;i++){if(this.squarePlanar[i-1]=de.STEREO_NONE,4!=t.atomAdjCount(i))continue;if(s.ELEMENT_BLOCKS[t.atomicNumber(i)]<3)continue;let n=t.atomAdjList(i);for(let t=0;t<n.length;t++){let e=0;for(let i=0;i<n.length;i++)this.priority[n[t]-1]==this.priority[n[i]-1]&&e++;if(e>=3)continue t}let l=de.rubricSquarePlanar(t,i);if(null==l)continue;let r=[0==l[0]?0:this.priority[l[0]-1],0==l[1]?0:this.priority[l[1]-1],0==l[2]?0:this.priority[l[2]-1],0==l[3]?0:this.priority[l[3]-1]],o=e.parityOrder(r);this.squarePlanar[i-1]=1&o?de.STEREO_NEG:de.STEREO_POS}}buildOctaChirality(){}buildPriority(){const e=this.mol,n=e.numAtoms,i=e.numBonds;let s=[];for(let i=0;i<n;i++)s.push(t.numberArray(-1,e.atomHydrogens(i+1)));for(let t=1;t<=i;t++){let n=e.bondFrom(t)-1,i=e.bondTo(t)-1,l=e.bondOrder(t);if(this.meta.isBondAromatic(t)&&(l=2),n!=i)for(let t=0;t<l;t++)s[n].push(i),s[i].push(n)}this.priority=t.numberArray(0,n);let l=!1;for(let t=0;t<n;t++)this.priority[t]=e.atomicNumber(t+1),1==this.priority[t]&&(l=!0);let r=[];for(let t=0;t<n;t++)r.push([]);for(;;){for(let e=0;e<n;e++){let n=s[e],i=[];for(let t=0;t<n.length;t++)i.push(n[t]<0?1:this.priority[n[t]]);t.sort(i),r[e]=i}let e=this.sortAndGroup(this.priority),i=l?0:1,o=!1;for(let t=0;t<e.length;t++){let n=e[t];for(let t=0;t<n.length-1;){const e=n[t],i=n[t+1];let s=0,l=Math.max(r[e].length,r[i].length);for(let t=0;t<l;t++){let n=t<r[e].length?r[e][t]:0,l=t<r[i].length?r[i][t]:0;if(n<l){s=-1;break}if(n>l){s=1;break}}s>0?(n[t]=i,n[t+1]=e,t>0&&t--):t++}for(let t=0;t<n.length;t++){if(0==t)i++;else if(r[n[t]].length!=r[n[t-1]].length)i++,o=!0;else for(let e=0;e<r[n[t]].length;e++)if(r[n[t]][e]!=r[n[t-1]][e]){i++,o=!0;break}this.priority[n[t]]=i}}if(!o)break}}sortAndGroup(e){let n=new Set;for(let t of e)n.add(t);let i=Array.from(n);t.sort(i);let s=[];for(let t=0;t<i.length;t++)s.push([]);for(let t=0;t<e.length;t++)s[i.indexOf(e[t])].push(t);return s}}de.STEREO_NONE=0,de.STEREO_POS=1,de.STEREO_NEG=2,de.STEREO_UNKNOWN=3,de.STEREO_BROKEN=4,de.RUBRIC_EQUIV_TETRA=[[0,1,2,3],[0,2,3,1],[0,3,1,2],[1,0,3,2],[1,2,0,3],[1,3,2,0],[2,0,1,3],[2,1,3,0],[2,3,0,1],[3,0,2,1],[3,1,0,2],[3,2,1,0]],de.RUBRIC_EQUIV_SIDES=[[0,1,2,3],[1,0,3,2],[2,3,0,1],[3,2,1,0]],de.RUBRIC_EQUIV_SQUARE=[[0,1,2,3],[0,3,2,1],[1,2,3,0],[1,0,3,2],[2,1,0,3],[2,3,0,1],[3,2,1,0],[3,0,1,2]],de.RUBRIC_EQUIV_BIPY=[[0,1,2,3,4],[1,2,0,3,4],[2,0,1,3,4],[0,2,1,4,3],[1,0,2,4,3],[2,1,0,4,3]],de.RUBRIC_EQUIV_OCTA=[[0,1,2,3,4,5],[0,3,2,1,5,4],[0,4,2,5,3,1],[0,5,2,4,1,3],[1,0,3,2,5,4],[1,2,3,0,4,5],[1,4,3,5,0,2],[1,5,3,4,2,0],[2,1,0,3,5,4],[2,3,0,1,4,5],[2,4,0,5,1,3],[2,5,0,4,3,1],[3,0,1,2,4,5],[3,2,1,0,5,4],[3,4,1,5,2,0],[3,5,1,4,0,2],[4,0,5,2,1,3],[4,1,5,3,2,0],[4,2,5,0,3,1],[4,3,5,1,0,2],[5,0,4,2,3,1],[5,1,4,3,0,2],[5,2,4,0,1,3],[5,3,4,1,2,0]];class fe{constructor(t){this.mol=t,this.atomArom=null,this.bondArom=null,this.rubricTetra=null,this.rubricSquare=null,this.rubricBipy=null,this.rubricOcta=null,this.rubricSides=null,this.hash=null,this.heavyHash=null,this.uniqueElements=null,this.dots=null,this.piAtom=null}calculateStrictAromaticity(){let e=this.mol;this.atomArom=t.booleanArray(!1,e.numAtoms),this.bondArom=t.booleanArray(!1,e.numBonds);let n=e.findRingsOfSize(6);const i=n.length;if(0==i)return;this.ensurePiAtoms();let s=t.booleanArray(!1,i);for(let t=0;t<i;t++)for(let i=0;i<n[t].length;i++){let l=n[t][i];if(!this.piAtom[l-1]){s[t]=!0;break}let r=e.findBond(l,n[t][i==n[t].length-1?0:i+1]),o=e.bondOrder(r);if(1!=o&&2!=o){s[t]=!0;break}}for(;;){let t=!1;for(let l=0;l<i;l++)if(!s[l]){let i=!0,r=!0;for(let t=0;t<n[l].length;t++){let s=e.findBond(n[l][t],n[l][t==n[l].length-1?0:t+1]);if(this.bondArom[s-1])continue;let o=e.bondOrder(s);i=i&&o==2-(1&t),r=r&&o==1+(1&t)}if(!i&&!r)continue;for(let t=0;t<n[l].length;t++){let i=e.findBond(n[l][t],n[l][t==n[l].length-1?0:t+1]);this.bondArom[i-1]=!0}s[l]=!0,t=!0}if(!t)break}for(let t=0;t<this.bondArom.length;t++)this.bondArom[t]&&(this.atomArom[e.bondFrom(t+1)-1]=!0,this.atomArom[e.bondTo(t+1)-1]=!0)}calculateRelaxedAromaticity(){let e=this.mol;this.atomArom=t.booleanArray(!1,e.numAtoms),this.bondArom=t.booleanArray(!1,e.numBonds),this.ensurePiAtoms();const n=e.numAtoms,i=e.numBonds;let l=t.numberArray(0,n),r=t.booleanArray(!1,n);for(let t=1;t<=n;t++){let n=e.atomicNumber(t);l[t-1]=(2==s.ELEMENT_BLOCKS[n]?s.ELEMENT_VALENCE[n]:0)-e.atomCharge(t)-e.atomHydrogens(t)-e.atomUnpaired(t)}for(let t=1;t<=i;t++){const n=e.bondFrom(t),i=e.bondTo(t),s=e.bondOrder(t);if(l[n-1]-=s,l[i-1]-=s,2==s){const t=e.atomRingBlock(n),s=e.atomRingBlock(i);t>0&&t!=s&&(r[n-1]=!0),s>0&&s!=t&&(r[i-1]=!0)}}let o=[];for(let t=3;t<=7;t++)for(let n of e.findRingsOfSize(t)){let i=!0;for(let s=0;s<t;s++){const o=n[s];if(!this.piAtom[o-1]&&l[o-1]<2&&!r[o-1]){i=!1;break}let a=e.findBond(o,n[s<t-1?s+1:0]),h=e.bondOrder(a);if(1!=h&&2!=h){i=!1;break}}i&&o.push(n)}for(;o.length>0;){let n=!1;for(let i=0;i<o.length;i++){let s=o[i],r=[0];for(let n=0;n<s.length;n++){const i=s[n],o=e.findBond(i,s[n<s.length-1?n+1:0]),a=e.findBond(i,s[n>0?n-1:s.length-1]);if(this.bondArom[o-1])for(let e=r.length-1;e>=0;e--){const n=r[e]+2;r.indexOf(n)<0&&(r=t.append(r,n))}else(2==e.bondOrder(o)||l[i-1]>=2&&1==e.bondOrder(o)&&1==e.bondOrder(a))&&t.addTo(r,2)}let a=!1;for(let t of r){if(2==t&&3==s.length){a=!0;break}if(6==t){a=!0;break}}if(a){for(let t=0;t<s.length;t++){let n=s[t],i=e.findBond(n,s[t<s.length-1?t+1:0]);this.atomArom[n-1]=!0,this.bondArom[i-1]=!0}o.splice(i,1),i--,n=!0}}if(!n)break}}calculateStereoRubric(){const t=this.mol,e=t.numAtoms,n=t.numBonds;this.rubricTetra=new Array(e),this.rubricSquare=new Array(e),this.rubricBipy=new Array(e),this.rubricOcta=new Array(e),this.rubricSides=new Array(n);for(let n=1;n<=e;n++){let e=s.ELEMENT_BLOCKS[t.atomicNumber(n)],i=t.atomAdjCount(n),l=t.atomHydrogens(n),r=0,o=0;for(let e of t.atomAdjBonds(n))t.bondType(e)==qt.BONDTYPE_INCLINED&&t.bondFrom(e)==n?r++:t.bondType(e)==qt.BONDTYPE_DECLINED&&t.bondFrom(e)==n&&o++;(2==e&&(3==i&&1==l||4==i&&0==l)||e>=3&&4==i&&1==r&&1==o)&&(this.rubricTetra[n-1]=de.rubricTetrahedral(t,n)),e>=3&&4==i&&0==l&&(this.rubricSquare[n-1]=de.rubricSquarePlanar(t,n)),e>=3&&(4==i||5==i)&&0==l&&(this.rubricBipy[n-1]=de.rubricBipyrimidal(t,n)),(e>=3&&(5==i||6==i)&&0==l||2==e&&6==i&&0==l)&&(this.rubricOcta[n-1]=de.rubricOctahedral(t,n))}for(let e=1;e<=t.numBonds;e++){if(2!=t.bondOrder(e)||t.bondType(e)==qt.BONDTYPE_UNKNOWN||this.isBondAromatic(e))continue;let n=t.bondFrom(e),i=t.bondTo(e),l=s.ELEMENT_BLOCKS[t.atomicNumber(n)],r=s.ELEMENT_BLOCKS[t.atomicNumber(i)],o=t.atomAdjCount(n),a=t.atomHydrogens(n),h=t.atomAdjCount(i),u=t.atomHydrogens(i);2==l&&2==r&&o+a==3&&a<=1&&h+u==3&&u<=1&&(this.rubricSides[e-1]=de.rubricBondSides(t,e))}}removeHydrogens(){let e=this.mol,n=e.numAtoms,i=e.numBonds,s=t.booleanArray(!0,n),l=t.booleanArray(!0,i);for(let t=1;t<=n;t++)Dt.boringHydrogen(e,t)&&(s[t-1]=!1,l[e.atomAdjBonds(t)[0]-1]=!1);if(!t.allTrue(s)&&(e=Dt.subgraphMask(e,s),this.atomArom&&(this.atomArom=t.maskGet(this.atomArom,s)),this.bondArom&&(this.bondArom=t.maskGet(this.bondArom,l)),this.rubricTetra||this.rubricSquare||this.rubricBipy||this.rubricOcta||this.rubricSides)){this.rubricTetra&&(this.rubricTetra=t.maskGet(this.rubricTetra,s)),this.rubricSquare&&(this.rubricSquare=t.maskGet(this.rubricSquare,s)),this.rubricBipy&&(this.rubricBipy=t.maskGet(this.rubricBipy,s)),this.rubricOcta&&(this.rubricOcta=t.maskGet(this.rubricOcta,s)),this.rubricSides&&(this.rubricSides=t.maskGet(this.rubricSides,l));let e=t.prepend(t.add(t.maskMap(s),1),0);for(let n=0;n<t.len(this.rubricTetra);n++)this.rubricTetra[n]&&(this.rubricTetra[n]=t.idxGet(e,this.rubricTetra[n]));for(let n=0;n<t.len(this.rubricSquare);n++)this.rubricSquare[n]&&(this.rubricSquare[n]=t.idxGet(e,this.rubricSquare[n]));for(let n=0;n<t.len(this.rubricBipy);n++)this.rubricBipy[n]&&(this.rubricBipy[n]=t.idxGet(e,this.rubricBipy[n]));for(let n=0;n<t.len(this.rubricOcta);n++)this.rubricOcta[n]&&(this.rubricOcta[n]=t.idxGet(e,this.rubricOcta[n]));for(let n=0;n<t.len(this.rubricSides);n++)this.rubricSides[n]&&(this.rubricSides[n]=t.idxGet(e,this.rubricSides[n]))}}calculateSkeletonHash(){if(null==fe.skeletonHash)throw"Skeleton hash not available.";this.hash=fe.skeletonHash(this.mol)}calculateHeavyHash(){let t=!1;for(let e=1;e<=this.mol.numAtoms;e++)if("H"==this.mol.atomElement(e)){t=!0;break}if(!t)return void(this.heavyHash=this.getSkeletonHash());let e=this.mol.clone();for(let t=e.numAtoms;t>=1;t--)"H"==e.atomElement(t)&&e.deleteAtomAndBonds(t);this.heavyHash=fe.skeletonHash(e)}isAtomAromatic(t){return null!=this.atomArom&&this.atomArom[t-1]}isBondAromatic(t){return null!=this.bondArom&&this.bondArom[t-1]}bondOrderArom(t){return null!=this.bondArom&&this.bondArom[t-1]?-1:this.mol.bondOrder(t)}getAtomAromaticity(){return null==this.atomArom?null:this.atomArom.slice(0)}getBondAromaticity(){return null==this.bondArom?null:this.bondArom.slice(0)}getSkeletonHash(){return null==this.hash&&this.calculateSkeletonHash(),this.hash}getHeavyHash(){return null==this.heavyHash&&this.calculateHeavyHash(),this.heavyHash}getDotPath(){return null==this.dots&&(this.dots=new ce(this.mol)),this.dots}getUniqueElements(){if(null==this.uniqueElements){this.uniqueElements=[];for(let t=1;t<=this.mol.numAtoms;t++){let e=this.mol.atomElement(t);this.uniqueElements.indexOf(e)<0&&this.uniqueElements.push(e)}}return this.uniqueElements}equivalentTo(t,e=1e3){if(null==fe.isomorphMatch)throw"Isomorph search unavailable.";if(this.mol.numAtoms!=t.mol.numAtoms||this.mol.numBonds!=t.mol.numBonds)return!1;if(null==this.hash&&this.calculateSkeletonHash(),null==t.hash&&t.calculateSkeletonHash(),this.hash!=t.hash)return!1;if(0==this.mol.compareTo(t.mol))return!0;let n=this.getUniqueElements(),i=t.getUniqueElements();for(let t=0;t<n.length;t++)if(!i.includes(n[t]))return!1;return fe.isomorphMatch(this,t,e)}static createRubric(t){if(null==t)return null;let e=new fe(t);return e.calculateStereoRubric(),e}static createStrict(t){if(null==t)return null;let e=new fe(t);return e.calculateStrictAromaticity(),e}static createStrictRubric(t){if(null==t)return null;let e=new fe(t);return e.calculateStrictAromaticity(),e.calculateStereoRubric(),e}static createRelaxed(t){if(null==t)return null;let e=new fe(t);return e.calculateRelaxedAromaticity(),e}static createRelaxedRubric(t){if(null==t)return null;let e=new fe(t);return e.calculateRelaxedAromaticity(),e.calculateStereoRubric(),e}ensurePiAtoms(){if(null==this.piAtom){this.piAtom=t.booleanArray(!1,this.mol.numAtoms);for(let t=1;t<=this.mol.numBonds;t++)2==this.mol.bondOrder(t)&&(this.piAtom[this.mol.bondFrom(t)-1]=!0,this.piAtom[this.mol.bondTo(t)-1]=!0)}}}fe.skeletonHash=null,fe.isomorphMatch=null;let pe=[];const Ce=4294967295;function ge(){return Ce}function Ae(t,e){return pe[255&(t^e)]^t>>>8}function be(t){return t^Ce}class ye{constructor(t,e){this.meta=t,this.kind=e,this.hookApplyNewFP=null,this.hookConsiderNewFP=null,this.identity=[],this.resolvedChiral=[],this.atomGroup=[],this.fplist=[],this.amask=[],this.atomAdj=[],this.bondAdj=[],function(){if(!(pe.length>0))for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;pe.push(e)}}()}calculate(){let e=this.meta.mol,n=e.numAtoms;this.identity=t.numberArray(0,n),this.resolvedChiral=t.booleanArray(!1,n);for(let t=0;t<n;t++)this.atomGroup.push([]);this.amask=t.booleanArray(!1,n);for(let t=0;t<n;t++)this.amask[t]=e.atomicNumber(t+1)>=2&&!Dt.hasAbbrev(e,t+1),this.atomAdj.push([]),this.bondAdj.push([]);for(let t=0;t<n;t++)if(this.amask[t]){this.atomAdj[t]=e.atomAdjList(t+1),this.bondAdj[t]=e.atomAdjBonds(t+1);for(let e=this.atomAdj[t].length-1;e>=0;e--)this.amask[this.atomAdj[t][e]-1]||(this.atomAdj[t].splice(e,1),this.bondAdj[t].splice(e,1))}for(let t=0;t<n;t++)this.amask[t]&&(this.identity[t]=this.initialIdentityECFP(t+1),this.atomGroup[t]=[t+1],this.applyNewFP({hashCode:this.identity[t],iteration:0,atoms:this.atomGroup[t],centralAtom:t+1}));let i=this.kind;for(let e=1;e<=i;e++){let i=t.numberArray(0,n);for(let t=0;t<n;t++)this.amask[t]&&(i[t]=this.circularIterate(e,t+1));this.identity=i;for(let t=0;t<n;t++)this.amask[t]&&(this.atomGroup[t]=this.growAtoms(this.atomGroup[t]),this.considerNewFP({hashCode:this.identity[t],iteration:e,atoms:this.atomGroup[t],centralAtom:t+1}))}}static create(t,e){t instanceof qt&&(t=fe.createStrictRubric(t));let n=new ye(t,e);return n.calculate(),n}getMolecule(){return this.meta.mol}get numFP(){return this.fplist.length}getFP(t){return this.fplist[t]}getFingerprints(){return this.fplist.slice(0)}getUniqueHashes(){let e=new Set;for(let t of this.fplist)e.add(t.hashCode);return t.sorted(Array.from(e))}getFoldedHashes(e){let n=e-1,i=new Set;for(let t of this.fplist)i.add(t.hashCode&n);return t.sorted(Array.from(i))}static tanimoto(t,e){let n=0,i=0,s=t.length,l=e.length;if(0==s&&0==l)return 0;let r=0,o=0;for(;r<s||o<l;){if(r==s){i+=l-o;break}if(o==l){i+=s-r;break}let a=t[r],h=e[o];a==h?(n+=1,r+=1,o+=1):a<h?r+=1:o+=1,i+=1}return n/i}initialIdentityECFP(t){const e=this.meta.mol;let n=e.atomAdjList(t),i=0,l=e.atomHydrogens(t);for(let t of n)"H"==e.atomElement(t)?l++:i++;let r=e.atomicNumber(t),o=Math.max(0,s.ELEMENT_BONDING[r]-l),a=e.atomCharge(t),h=e.atomRingBlock(t)>0?1:0,u=ge();return u=Ae(u,i<<4|o),u=Ae(u,r),u=Ae(u,a+128),u=Ae(u,l<<4|h),be(u)}circularIterate(n,i){let s=this.atomAdj[i-1],l=this.bondAdj[i-1],r=t.numberArray(0,2+2*s.length);r[0]=n,r[1]=this.identity[i-1];for(let t=0;t<s.length;t++)r[2*t+2]=this.meta.isBondAromatic(l[t])?15:this.meta.mol.bondOrder(l[t]),r[2*t+3]=this.identity[s[t]-1];let o=0;for(;o<s.length-1;){let e=2+2*o;r[e]>r[e+2]||r[e]==r[e+2]&&r[e+1]>r[e+3]?(t.swap(r,e,e+2),t.swap(r,e+1,e+3),o>0&&o--):o++}let a=ge();for(let t=0;t<r.length;t+=2){a=Ae(a,r[t]);let e=r[t+1];a=Ae(a,e>>24),a=Ae(a,e>>16&255),a=Ae(a,e>>8&255),a=Ae(a,255&e)}if(!this.resolvedChiral[i-1]&&t.len(this.meta.rubricTetra)>0&&null!=this.meta.rubricTetra[i-1]){let t=this.meta.rubricTetra[i-1],n=[0==t[0]?0:this.identity[t[0]-1],0==t[1]?0:this.identity[t[1]-1],0==t[2]?0:this.identity[t[2]-1],0==t[3]?0:this.identity[t[3]-1]];n[0]!=n[1]&&n[0]!=n[2]&&n[0]!=n[3]&&n[1]!=n[2]&&n[1]!=n[3]&&n[2]!=n[3]&&(a=Ae(a,e.parityOrder(n)+1),this.resolvedChiral[i-1]=!0)}return be(a)}growAtoms(e){let n=t.booleanArray(!1,this.meta.mol.numAtoms);for(let t=0;t<e.length;t++){n[e[t]-1]=!0;for(let i of this.atomAdj[e[t]-1])n[i-1]=!0}return t.add(t.maskIdx(n),1)}applyNewFP(t){this.hookConsiderNewFP&&this.hookConsiderNewFP(t),this.hookApplyNewFP&&this.hookApplyNewFP(t),this.fplist.push(t)}considerNewFP(e){this.hookConsiderNewFP&&this.hookConsiderNewFP(e);let n=-1,i=null;for(let s=0;s<this.fplist.length;s++){let l=this.fplist[s];if(t.equals(l.atoms,e.atoms)){i=l,n=s;break}}n<0?this.fplist.push(e):i.iteration<e.iteration||i.hashCode<e.hashCode||(this.fplist[n]=e,this.hookApplyNewFP&&this.hookApplyNewFP(e))}}ye.CLASS_ECFP0=0,ye.CLASS_ECFP2=1,ye.CLASS_ECFP4=2,ye.CLASS_ECFP6=3;class Ee{static readXML(t){let e;if(e=C.customParser?(new C.customParser).parseFromString(t,"application/xml"):(new DOMParser).parseFromString(t,"application/xml"),null==e)return null;let n=e.documentElement;if(null==n)return null;let i=new it,s=Y(n,"Summary");if(null==s)return null;i.title=T(Y(s,"Title")),i.description=T(Y(s,"Description"));let l=Y(n,"Extension");if(null!=l){let t=j(l,"Ext");for(let e=0;e<t.length;e++){let n=t[e];i.appendExtension(n.getAttribute("name"),n.getAttribute("type"),T(n))}}let r=Y(n,"Header"),o=parseInt(r.getAttribute("ncols")),a=j(r,"Column");if(a.length!=o)return null;for(let t=0;t<o;t++){let e=a[t];if(parseInt(e.getAttribute("id"))!=t+1)return null;i.appendColumn(e.getAttribute("name"),e.getAttribute("type"),T(e))}let h=0;for(let t of j(Y(n,"Content"),"Row")){if(parseInt(t.getAttribute("id"))!=h+1)return null;i.appendRow();for(let e of j(t,"Cell")){let t=parseInt(e.getAttribute("id"))-1,n=i.colType(t),s=T(e);""==s||("molecule"==n?i.setObject(h,t,s):"string"==n?i.setString(h,t,s):"real"==n?i.setReal(h,t,parseFloat(s)):"integer"==n?i.setInteger(h,t,parseInt(s)):"boolean"==n?i.setBoolean(h,t,"true"==s||"false"!=s&&null):"extend"==n&&i.setExtend(h,t,s)),e=e.nextElementSibling,t++}t=t.nextElementSibling,h++}return i}static readJSON(t){if(!t.colData||!t.rowData)throw"Not a JSON-formatted datasheet.";return new it(W(t))}static writeXML(t){let e;e=C.customParser?(new C.customParser).parseFromString("<DataSheet/>","application/xml"):(new DOMParser).parseFromString("<DataSheet/>","application/xml");let n=e.createElement("Summary");e.documentElement.appendChild(n);let i=e.createElement("Title"),s=e.createElement("Description");n.appendChild(i),i.appendChild(e.createTextNode(t.title)),n.appendChild(s),s.appendChild(e.createCDATASection(t.description));let l=e.createElement("Extension");e.documentElement.appendChild(l);for(let n=0;n<t.numExtensions;n++){let i=e.createElement("Ext");l.appendChild(i),i.setAttribute("name",t.getExtName(n)),i.setAttribute("type",t.getExtType(n)),i.appendChild(e.createCDATASection(t.getExtData(n)))}let r=e.createElement("Header");e.documentElement.appendChild(r),r.setAttribute("nrows",t.numRows.toString()),r.setAttribute("ncols",t.numCols.toString());for(let n=0;n<t.numCols;n++){let i=e.createElement("Column");r.appendChild(i),i.setAttribute("id",(n+1).toString()),i.setAttribute("name",t.colName(n)),i.setAttribute("type",t.colType(n)),i.appendChild(e.createTextNode(t.colDescr(n)))}let o=e.createElement("Content");e.documentElement.appendChild(o);for(let n=0;n<t.numRows;n++){let i=e.createElement("Row");i.setAttribute("id",(n+1).toString()),o.appendChild(i);for(let s=0;s<t.numCols;s++){let l=e.createElement("Cell");l.setAttribute("id",(s+1).toString()),i.appendChild(l);let r=t.colType(s),o=null;if(t.isNull(n,s));else if("molecule"==r){let i=t.getObject(n,s);i instanceof qt&&(i=vt.writeNative(i)),o=e.createCDATASection(i)}else"string"==r?o=e.createCDATASection(t.getString(n,s)):"real"==r?o=e.createTextNode(t.getReal(n,s).toString()):"integer"==r?o=e.createTextNode(t.getInteger(n,s).toString()):"boolean"==r?o=e.createTextNode(t.getBoolean(n,s).toString()):"extend"==r&&(o=e.createCDATASection(t.getExtend(n,s)));null!=o&&l.appendChild(o)}}return C.customSerial?(new C.customSerial).serializeToString(e.documentElement):(new XMLSerializer).serializeToString(e.documentElement)}static writeJSON(t){let e=t.data,n=t.numRows,i=t.numCols,s=new Array(n);for(let t=0;t<n;t++)s[t]=new Array(i);for(let l=0;l<i;l++){let i="molecule"==t.colType(l);for(let t=0;t<n;t++){let n=e.rowData[t][l];null!=n&&i&&(n=n.toString()),s[t][l]=n}}return{title:e.title,description:e.description,colData:W(e.colData),rowData:s,extData:W(e.extData)}}}const xe={rings:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n <Summary>\n  <Title>Small Rings</Title>\n  <Description><![CDATA[]]></Description>\n </Summary>\n <Header nrows="24" ncols="3">\n  <Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n  <Column name="Name" type="string" id="2">Template Name</Column>\n  <Column name="Abbrev" type="string" id="3">Abbreviation Code</Column>\n </Header>\n <Content>\n  <Row id="1">\n   <Cell id="1"><![CDATA[SketchEl!(3,3)\nC=1.7500,-6.1500;0,0,i2\nC=2.5000,-7.4490;0,0,i2\nC=1.0000,-7.4490;0,0,i2\n1-2=1,0\n1-3=1,0\n3-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclopropane]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="2">\n   <Cell id="1"><![CDATA[SketchEl!(4,4)\nC=3.6500,-0.9500;0,0,i2\nC=3.6500,-2.4500;0,0,i2\nC=5.1500,-2.4500;0,0,i2\nC=5.1500,-0.9500;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n1-4=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclobutane]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="3">\n   <Cell id="1"><![CDATA[SketchEl!(5,5)\nC=0.7500,2.3100;0,0,i2\nC=-0.4600,1.4300;0,0,i2\nC=0.0000,0.0000;0,0,i2\nC=1.9600,1.4300;0,0,i2\nC=1.5000,0.0000;0,0,i2\n3-2=1,0\n2-1=1,0\n1-4=1,0\n4-5=1,0\n5-3=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclopentane]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="4">\n   <Cell id="1"><![CDATA[SketchEl!(5,5)\nC=4.3700,-7.8550;0,0,i2\nC=3.6200,-10.1650;0,0,i1\nC=3.1600,-8.7350;0,0,i1\nC=5.5800,-8.7350;0,0,i1\nC=5.1200,-10.1650;0,0,i1\n2-3=2,0\n3-1=1,0\n1-4=1,0\n4-5=2,0\n5-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclopentadiene]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="5">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=3.9490,-2.3000;0,0,i2\nC=2.6500,-3.0500;0,0,i2\nC=2.6500,-4.5500;0,0,i2\nC=3.9490,-5.3000;0,0,i2\nC=5.2481,-4.5500;0,0,i2\nC=5.2481,-3.0500;0,0,i2\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-1=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclohexane1]]></Cell>\n   <Cell id="3"><![CDATA[Cy]]></Cell>\n  </Row>\n  <Row id="6">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=1.5000,-3.6500;0,0,i2\nC=2.7990,-3.2500;0,0,i2\nC=2.2500,-2.3510;0,0,i2\nC=4.0981,-4.0000;0,0,i2\nC=3.5490,-3.1010;0,0,i2\nC=4.8481,-2.3510;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n6-5=1,0\n4-6=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclohexane2]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="7">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=-0.2500,-2.1490;0,0,i2\nC=0.6000,-1.2500;0,0,i2\nC=2.1500,-1.2500;0,0,i2\nC=3.0000,-2.1490;0,0,i2\nC=2.2500,-0.4990;0,0,i2\nC=0.4500,-0.4990;0,0,i2\n1-2=1,0\n3-2=1,0\n3-4=1,0\n4-5=1,0\n1-6=1,0\n6-5=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclohexane3]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="8">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=6.1000,0.2500;0,0,i1\nC=4.8010,-0.5000;0,0,i1\nC=7.3990,-0.5000;0,0,i1\nC=4.8010,-2.0000;0,0,i1\nC=6.1000,-2.7500;0,0,i1\nC=7.3990,-2.0000;0,0,i1\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[benzene]]></Cell>\n   <Cell id="3"><![CDATA[Ph]]></Cell>\n  </Row>\n  <Row id="9">\n   <Cell id="1"><![CDATA[SketchEl!(7,7)\nC=0.7400,3.2800;0,0,i2\nC=0.0000,0.0000;0,0,i2\nC=-0.9400,1.1700;0,0,i2\nC=-0.6100,2.6300;0,0,i2\nC=2.0900,2.6300;0,0,i2\nC=2.4200,1.1700;0,0,i2\nC=1.4800,0.0000;0,0,i2\n3-2=1,0\n3-4=1,0\n4-1=1,0\n5-1=1,0\n5-6=1,0\n6-7=1,0\n7-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cycloheptane]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="10">\n   <Cell id="1"><![CDATA[SketchEl!(8,8)\nC=0.0000,3.6200;0,0,i2\nC=0.0000,0.0000;0,0,i2\nC=-1.0600,1.0600;0,0,i2\nC=-1.0600,2.5600;0,0,i2\nC=1.5000,3.6200;0,0,i2\nC=2.5600,2.5600;0,0,i2\nC=2.5600,1.0600;0,0,i2\nC=1.5000,0.0000;0,0,i2\n2-3=1,0\n3-4=1,0\n4-1=1,0\n1-5=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n8-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cyclooctane]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="11">\n   <Cell id="1"><![CDATA[SketchEl!(9,10)\nC=1.2510,-1.4500;0,0,i1\nC=-0.0481,-2.2000;0,0,i1\nC=2.5500,-2.2000;0,0,i0\nC=-0.0481,-3.7000;0,0,i1\nC=1.2510,-4.4500;0,0,i1\nC=2.5500,-3.7000;0,0,i0\nC=3.9713,-1.7306;0,0,i2\nC=4.8537,-2.9389;0,0,i2\nC=3.9779,-4.1593;0,0,i2\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n3-7=1,0\n7-8=1,0\n8-9=1,0\n9-6=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[dihydroindene]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="12">\n   <Cell id="1"><![CDATA[SketchEl!(10,11)\nC=2.5990,-2.5500;0,0,i1\nC=1.3000,-3.3000;0,0,i1\nC=1.3000,-4.8000;0,0,i1\nC=2.5990,-5.5500;0,0,i1\nC=3.8981,-4.8000;0,0,i0\nC=3.8981,-3.3000;0,0,i0\nC=5.1971,-2.5500;0,0,i1\nC=5.1971,-5.5500;0,0,i1\nC=6.4962,-4.8000;0,0,i1\nC=6.4962,-3.3000;0,0,i1\n2-3=2,0\n2-1=1,0\n3-4=1,0\n4-5=2,0\n5-6=1,0\n6-1=2,0\n7-6=1,0\n5-8=1,0\n8-9=2,0\n9-10=1,0\n10-7=2,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[napthalene]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="13">\n   <Cell id="1"><![CDATA[SketchEl!(13,15)\nC=-0.1824,-4.7254;0,0,i1\nC=-1.2065,-5.8214;0,0,i1\nC=1.2788,-5.0643;0,0,i0\nC=-0.7693,-7.2563;0,0,i1\nC=0.6919,-7.5952;0,0,i1\nC=1.7160,-6.4992;0,0,i0\nC=2.5017,-4.2011;0,0,i2\nC=3.6979,-5.0997;0,0,i0\nC=3.2158,-6.5224;0,0,i0\nC=5.1689,-4.8063;0,0,i1\nC=6.1585,-5.9336;0,0,i1\nC=4.2061,-7.6477;0,0,i1\nC=5.6772,-7.3542;0,0,i1\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n3-7=1,0\n7-8=1,0\n8-9=1,0\n9-6=1,0\n10-11=1,0\n10-8=2,0\n9-12=2,0\n12-13=1,0\n13-11=2,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[fluoroscene]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="14">\n   <Cell id="1"><![CDATA[SketchEl!(14,16)\nC=2.5990,-2.5500;0,0,i1\nC=1.3000,-3.3000;0,0,i1\nC=1.3000,-4.8000;0,0,i1\nC=2.5990,-5.5500;0,0,i1\nC=3.8981,-4.8000;0,0,i0\nC=3.8981,-3.3000;0,0,i0\nC=5.1971,-2.5500;0,0,i1\nC=5.1971,-5.5500;0,0,i1\nC=6.4962,-4.8000;0,0,i0\nC=6.4962,-3.3000;0,0,i0\nC=7.7952,-2.5500;0,0,i1\nC=7.7952,-5.5500;0,0,i1\nC=9.0943,-4.8000;0,0,i1\nC=9.0943,-3.3000;0,0,i1\n2-3=1,0\n2-1=2,0\n3-4=2,0\n4-5=1,0\n5-6=2,0\n6-1=1,0\n7-6=1,0\n5-8=1,0\n8-9=2,0\n9-10=1,0\n10-7=2,0\n10-11=1,0\n9-12=1,0\n12-13=2,0\n13-14=1,0\n14-11=2,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[anthracene]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="15">\n   <Cell id="1"><![CDATA[SketchEl!(14,16)\nC=5.4911,-0.2789;0,0,i1\nC=4.7411,-1.5780;0,0,i1\nC=6.9910,-0.2789;0,0,i1\nC=5.4910,-2.8770;0,0,i1\nC=6.9911,-2.8770;0,0,i0\nC=7.7411,-1.5780;0,0,i0\nC=9.2410,-1.5780;0,0,i0\nC=7.7410,-4.1760;0,0,i1\nC=9.2411,-4.1761;0,0,i1\nC=9.9911,-2.8770;0,0,i0\nC=9.9910,-0.2789;0,0,i1\nC=11.4911,-2.8770;0,0,i1\nC=12.2411,-1.5780;0,0,i1\nC=11.4911,-0.2790;0,0,i1\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n7-6=1,0\n5-8=1,0\n8-9=2,0\n9-10=1,0\n10-7=2,0\n7-11=1,0\n10-12=1,0\n12-13=2,0\n13-14=1,0\n14-11=2,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[phenanthrene]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="16">\n   <Cell id="1"><![CDATA[SketchEl!(5,5)\nN=3.3300,-1.7050;0,0,i1\nC=2.5800,-4.0150;0,0,i2\nC=2.1200,-2.5850;0,0,i2\nC=4.5400,-2.5850;0,0,i2\nC=4.0800,-4.0150;0,0,i2\n2-3=1,0\n3-1=1,0\n1-4=1,0\n4-5=1,0\n5-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[pyrrolidine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="17">\n   <Cell id="1"><![CDATA[SketchEl!(5,5)\nC=1.3200,-2.2350;0,0,i2\nC=1.7800,-3.6650;0,0,i2\nO=2.5300,-1.3550;0,0,i0\nC=3.7400,-2.2350;0,0,i2\nC=3.2800,-3.6650;0,0,i2\n2-1=1,0\n1-3=1,0\n3-4=1,0\n4-5=1,0\n5-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[tetrahydrofuran]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="18">\n   <Cell id="1"><![CDATA[SketchEl!(5,5)\nC=1.3200,-2.2350;0,0,i1\nC=1.7800,-3.6650;0,0,i1\nO=2.5300,-1.3550;0,0,i0\nC=3.7400,-2.2350;0,0,i1\nC=3.2800,-3.6650;0,0,i1\n2-1=2,0\n1-3=1,0\n3-4=1,0\n4-5=2,0\n5-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[furan]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="19">\n   <Cell id="1"><![CDATA[SketchEl!(5,5)\nC=1.3200,-2.2350;0,0,i1\nC=1.7800,-3.6650;0,0,i1\nS=2.5300,-1.3550;0,0,i0\nC=3.7400,-2.2350;0,0,i1\nC=3.2800,-3.6650;0,0,i1\n2-1=2,0\n1-3=1,0\n3-4=1,0\n4-5=2,0\n5-2=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[thiofuran]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="20">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=1.6000,-3.0000;0,0,i1\nN=2.8990,-2.2500;0,0,i0\nC=4.1981,-3.0000;0,0,i1\nC=1.6000,-4.5000;0,0,i1\nC=2.8990,-5.2500;0,0,i1\nC=4.1981,-4.5000;0,0,i1\n2-1=1,0\n2-3=2,0\n1-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[pyridine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="21">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=0.7019,-2.1000;0,0,i2\nC=0.7019,-3.6000;0,0,i2\nO=2.0009,-1.3500;0,0,i0\nO=2.0009,-4.3500;0,0,i0\nC=3.3000,-3.6000;0,0,i2\nC=3.3000,-2.1000;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n4-5=1,0\n5-6=1,0\n6-3=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[dioxane]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="22">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=2.1519,-2.1000;0,0,i2\nC=2.1519,-3.6000;0,0,i2\nO=3.4509,-1.3500;0,0,i0\nN=3.4509,-4.3500;0,0,i1\nC=4.7500,-3.6000;0,0,i2\nC=4.7500,-2.1000;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n4-5=1,0\n5-6=1,0\n6-3=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[morpholine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="23">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nN=2.6490,-2.3000;0,0,i1\nC=1.3500,-3.0500;0,0,i2\nC=1.3500,-4.5500;0,0,i2\nC=2.6490,-5.3000;0,0,i2\nC=3.9481,-4.5500;0,0,i2\nC=3.9481,-3.0500;0,0,i2\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-1=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[piperidine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="24">\n   <Cell id="1"><![CDATA[SketchEl!(6,6)\nC=1.3500,-3.0500;0,0,i2\nC=1.3500,-4.5500;0,0,i2\nO=2.6490,-2.3000;0,0,i0\nC=2.6490,-5.3000;0,0,i2\nC=3.9481,-4.5500;0,0,i2\nC=3.9481,-3.0500;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n4-5=1,0\n5-6=1,0\n6-3=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[pyran]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n </Content>\n</DataSheet>\n',termgrp:'<DataSheet><Summary><Title>Terminal Groups</Title><Description><![CDATA[]]></Description></Summary><Extension/><Header nrows="11" ncols="3"><Column id="1" name="Molecule" type="molecule">Molecular structure</Column><Column id="2" name="Name" type="string">Template name</Column><Column id="3" name="Abbrev" type="string">Optional abbreviation</Column></Header><Content><Row id="1"><Cell id="1"><![CDATA[SketchEl!(3,2)\nX=-0.6500,-1.4000;0,0,i0\nC=0.6490,-0.6500;0,0,i2\nC=1.9481,-1.4000;0,0,i3\n1-2=1,0\n2-3=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[ethyl]]></Cell><Cell id="3"><![CDATA[Et]]></Cell></Row><Row id="2"><Cell id="1"><![CDATA[SketchEl!(4,3)\nC=-5.1000,3.4000;0,0,i2\nC=-3.8010,4.1500;0,0,i2\nC=-2.5019,3.4000;0,0,i3\nX=-6.3990,4.1500;0,0,i0\n1-2=1,0\n2-3=1,0\n1-4=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[n-propyl]]></Cell><Cell id="3"><![CDATA[Pr]]></Cell></Row><Row id="3"><Cell id="1"><![CDATA[SketchEl!(4,3)\nC=-4.9450,2.0214;0,0,i1\nC=-4.1950,3.3204;0,0,i3\nC=-4.1950,0.7224;0,0,i3\nX=-6.4450,2.0214;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[i-propyl]]></Cell><Cell id="3"><![CDATA[{^i}Pr]]></Cell></Row><Row id="4"><Cell id="1"><![CDATA[SketchEl!(5,4)\nC=-4.6500,2.9000;0,0,i2\nC=-3.3510,3.6500;0,0,i2\nC=-2.0519,2.9000;0,0,i2\nC=-0.7529,3.6500;0,0,i3\nX=-5.9490,3.6500;0,0,i0\n1-2=1,0\n2-3=1,0\n3-4=1,0\n1-5=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[n-butyl]]></Cell><Cell id="3"><![CDATA[Bu]]></Cell></Row><Row id="5"><Cell id="1"><![CDATA[SketchEl!(5,4)\nC=-3.2000,0.9000;0,0,i0\nC=-3.2000,2.4000;0,0,i3\nC=-3.2000,-0.6000;0,0,i3\nC=-1.7000,0.9000;0,0,i3\nX=-4.7000,0.9000;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[t-butyl]]></Cell><Cell id="3"><![CDATA[{^t}Bu]]></Cell></Row><Row id="6"><Cell id="1"><![CDATA[SketchEl!(3,2)\nX=-7.4188,-4.7944;0,0,i0\nO=-6.1198,-4.0444;0,0,i0\nC=-4.8207,-4.7944;0,0,i3\n1-2=1,0\n2-3=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[methoxy]]></Cell><Cell id="3"><![CDATA[O|Me]]></Cell></Row><Row id="7"><Cell id="1"><![CDATA[SketchEl!(4,3)\nX=-7.4188,-4.7944;0,0,i0\nO=-6.1198,-4.0444;0,0,i0\nC=-4.8207,-4.7944;0,0,i2\nC=-3.5217,-4.0444;0,0,i3\n1-2=1,0\n2-3=1,0\n3-4=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[ethoxy]]></Cell><Cell id="3"><![CDATA[O|Et]]></Cell></Row><Row id="8"><Cell id="1"><![CDATA[SketchEl!(7,7)\nX=-6.5500,1.6000;0,0,i0\nC=-5.0500,1.6000;0,0,i0\nC=-4.3000,2.8990;0,0,i1\nC=-2.8000,2.8990;0,0,i1\nC=-4.3000,0.3010;0,0,i1\nC=-2.8000,0.3010;0,0,i1\nC=-2.0500,1.6000;0,0,i1\n1-2=1,0\n3-2=1,0\n3-4=2,0\n2-5=2,0\n5-6=1,0\n6-7=2,0\n7-4=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[phenyl]]></Cell><Cell id="3"><![CDATA[Ph]]></Cell></Row><Row id="9"><Cell id="1"><![CDATA[SketchEl!(7,7)\nX=-6.5500,1.6000;0,0,i0\nC=-5.0500,1.6000;0,0,i1\nC=-4.3000,2.8990;0,0,i2\nC=-2.8000,2.8990;0,0,i2\nC=-4.3000,0.3010;0,0,i2\nC=-2.8000,0.3010;0,0,i2\nC=-2.0500,1.6000;0,0,i2\n1-2=1,0\n3-2=1,0\n3-4=1,0\n2-5=1,0\n5-6=1,0\n6-7=1,0\n7-4=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[cyclopentyl]]></Cell><Cell id="3"><![CDATA[Cy]]></Cell></Row><Row id="10"><Cell id="1"><![CDATA[SketchEl!(8,8)\nX=0.0500,2.9500;0,0,i0\nC=1.3490,3.7000;0,0,i2\nC=2.6481,2.9500;0,0,i0\nC=2.6481,1.4500;0,0,i1\nC=3.9471,3.7000;0,0,i1\nC=3.9471,0.7000;0,0,i1\nC=5.2461,1.4500;0,0,i1\nC=5.2461,2.9500;0,0,i1\n1-2=1,0\n2-3=1,0\n3-4=1,0\n3-5=2,0\n4-6=2,0\n6-7=1,0\n7-8=2,0\n8-5=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[benzyl]]></Cell><Cell id="3"><![CDATA[Bz]]></Cell></Row><Row id="11"><Cell id="1"><![CDATA[SketchEl!(10,10)\nX=-1.6000,1.6571;0,0,i0\nC=-0.1000,1.6571;0,0,i0\nC=0.6500,0.3581;0,0,i0\nC=0.6500,2.9561;0,0,i0\nC=2.1500,0.3581;0,0,i1\nC=2.9000,1.6571;0,0,i0\nC=2.1500,2.9561;0,0,i1\nC=-0.1000,4.2551;0,0,i3\nC=4.4000,1.6571;0,0,i3\nC=-0.1000,-0.9409;0,0,i3\n1-2=1,0\n2-3=1,0\n2-4=2,0\n3-5=2,0\n5-6=1,0\n6-7=2,0\n7-4=1,0\n4-8=1,0\n6-9=1,0\n3-10=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[mesityl]]></Cell><Cell id="3"><![CDATA[Mes]]></Cell></Row></Content></DataSheet>',funcgrp:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Functional Groups</Title>\n<Description><![CDATA[]]></Description>\n</Summary>\n<Header nrows="18" ncols="3">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Optional abbreviation</Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(4,3)\nN=-6.6000,4.4000;1,0,i0\nO=-5.8500,5.6990;0,0,i0\nO=-5.8500,3.1010;-1,0,i0\nX=-8.1000,4.4000;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[nitro]]></Cell>\n<Cell id="3"><![CDATA[N|O{2}]]></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(4,3)\nC=-7.8000,3.2500;0,0,i0\nO=-7.0500,4.5490;0,0,i0\nO=-7.0500,1.9510;0,0,i1\nX=-9.3000,3.2500;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[carboxyl]]></Cell>\n<Cell id="3"><![CDATA[C|O{2}|H]]></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(5,4)\nC=-7.8000,3.2500;0,0,i0\nO=-7.0500,4.5490;0,0,i0\nO=-7.0500,1.9510;0,0,i0\nX=-9.3000,3.2500;0,0,i0\nC=-5.5500,1.9510;0,0,i3\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[methyl carboxylate]]></Cell>\n<Cell id="3"><![CDATA[C|O{2}|Me]]></Cell>\n</Row>\n<Row id="4">\n<Cell id="1"><![CDATA[SketchEl!(6,5)\nC=-7.8000,3.2500;0,0,i0\nO=-7.0500,4.5490;0,0,i0\nO=-7.0500,1.9510;0,0,i0\nX=-9.3000,3.2500;0,0,i0\nC=-5.5500,1.9510;0,0,i2\nC=-4.8000,0.6520;0,0,i3\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n5-6=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[ethyl carboxylate]]></Cell>\n<Cell id="3"><![CDATA[C|O{2}|Et]]></Cell>\n</Row>\n<Row id="5">\n<Cell id="1"><![CDATA[SketchEl!(4,3)\nC=-7.8000,3.2500;0,0,i0\nO=-7.0500,4.5490;0,0,i0\nN=-7.0500,1.9510;0,0,i2\nX=-9.3000,3.2500;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[amide]]></Cell>\n<Cell id="3"><![CDATA[C|O|NH{2}]]></Cell>\n</Row>\n<Row id="6">\n<Cell id="1"><![CDATA[SketchEl!(4,3)\nC=-7.8000,3.2500;0,0,i0\nO=-7.0500,4.5490;0,0,i0\nC=-7.0500,1.9510;0,0,i3\nX=-9.3000,3.2500;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[acetyl]]></Cell>\n<Cell id="3"><![CDATA[Ac]]></Cell>\n</Row>\n<Row id="7">\n<Cell id="1"><![CDATA[SketchEl!(5,4)\nO=-8.0010,2.5000;0,0,i0\nC=-6.7019,3.2500;0,0,i0\nX=-9.3000,3.2500;0,0,i0\nC=-5.4029,2.5000;0,0,i3\nO=-6.7019,4.7500;0,0,i0\n1-2=1,0\n1-3=1,0\n2-4=1,0\n2-5=2,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[acetoxy]]></Cell>\n<Cell id="3"><![CDATA[O|Ac]]></Cell>\n</Row>\n<Row id="8">\n<Cell id="1"><![CDATA[SketchEl!(3,2)\nX=-5.9500,5.0500;0,0,i0\nC=-4.4500,5.0500;0,0,i0\nN=-2.9500,5.0500;0,0,i0\n1-2=1,0\n2-3=3,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyano]]></Cell>\n<Cell id="3"><![CDATA[C|N]]></Cell>\n</Row>\n<Row id="9">\n<Cell id="1"><![CDATA[SketchEl!(5,4)\nC=0.0000,0.0000;0,0,i0\nF=0.0000,1.5000;0,0,i0\nF=-0.0000,-1.5000;0,0,i0\nF=1.5000,-0.0000;0,0,i0\nX=-1.5000,0.0000;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[trifluoromethyl]]></Cell>\n<Cell id="3"><![CDATA[C|F{3}]]></Cell>\n</Row>\n<Row id="10">\n<Cell id="1"><![CDATA[SketchEl!(6,5)\nO=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nF=3.0000,0.0000;0,0,i0\nF=1.5000,-1.5000;0,0,i0\nF=1.5000,1.5000;0,0,i0\nX=-0.7500,1.2990;0,0,i0\n1-2=1,0\n2-3=1,0\n2-4=1,0\n2-5=1,0\n1-6=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[trifluoromethoxy]]></Cell>\n<Cell id="3"><![CDATA[O|CF{3}]]></Cell>\n</Row>\n<Row id="11">\n<Cell id="1"><![CDATA[SketchEl!(5,4)\nP=-1.2500,0.8500;0,0,i0\nO=-1.2500,2.3500;0,0,i0\nO=-1.2500,-0.6500;0,0,i1\nO=0.2500,0.8500;0,0,i1\nX=-2.7500,0.8500;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[phosphoric]]></Cell>\n<Cell id="3"><![CDATA[P|O{3}|H{2}]]></Cell>\n</Row>\n<Row id="12">\n<Cell id="1"><![CDATA[SketchEl!(6,5)\nO=-2.7500,0.8500;0,0,i0\nP=-1.2500,0.8500;0,0,i0\nO=-1.2500,2.3500;0,0,i0\nO=-1.2500,-0.6500;0,0,i1\nO=0.2500,0.8500;0,0,i1\nX=-3.5000,2.1490;0,0,i0\n2-3=2,0\n2-4=1,0\n2-5=1,0\n2-1=1,0\n1-6=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[phosphoric]]></Cell>\n<Cell id="3"><![CDATA[P|O{4}|H{2}]]></Cell>\n</Row>\n<Row id="13">\n<Cell id="1"><![CDATA[SketchEl!(4,3)\nS=-1.2500,0.8500;0,0,i0\nO=-1.2500,2.3500;0,0,i0\nO=-1.2500,-0.6500;0,0,i0\nX=-2.7500,0.8500;0,0,i0\n1-2=2,0\n1-3=2,0\n1-4=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[sulphonyl]]></Cell>\n<Cell id="3"><![CDATA[S|O{2}|H]]></Cell>\n</Row>\n<Row id="14">\n<Cell id="1"><![CDATA[SketchEl!(5,4)\nS=-1.2500,0.8500;0,0,i0\nO=-1.2500,2.3500;0,0,i0\nO=-1.2500,-0.6500;0,0,i0\nO=0.2500,0.8500;0,0,i1\nX=-2.7500,0.8500;0,0,i0\n1-2=2,0\n1-3=2,0\n1-4=1,0\n1-5=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[sulphonic]]></Cell>\n<Cell id="3"><![CDATA[S|O{3}|H]]></Cell>\n</Row>\n<Row id="15">\n<Cell id="1"><![CDATA[SketchEl!(6,5)\nO=-2.7500,0.8500;0,0,i0\nS=-1.2500,0.8500;0,0,i0\nO=-1.2500,2.3500;0,0,i0\nO=-1.2500,-0.6500;0,0,i0\nO=0.2500,0.8500;0,0,i1\nX=-3.5000,2.1490;0,0,i0\n2-3=2,0\n2-4=2,0\n2-5=1,0\n2-1=1,0\n1-6=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[sulphonic]]></Cell>\n<Cell id="3"><![CDATA[S|O{4}|H]]></Cell>\n</Row>\n<Row id="16">\n<Cell id="1"><![CDATA[SketchEl!(5,4)\nX=0.0000,0.0000;0,0,i0\nSi=1.5000,0.0000;0,0,i0\nC=3.0000,0.0000;0,0,i3\nC=1.5000,-1.5000;0,0,i3\nC=1.5000,1.5000;0,0,i3\n1-2=1,0\n2-3=1,0\n2-4=1,0\n2-5=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[trimethylsilane]]></Cell>\n<Cell id="3"><![CDATA[TMS]]></Cell>\n</Row>\n<Row id="17">\n<Cell id="1"><![CDATA[SketchEl!(12,22)\nC=5.6600,-2.2950;0,0,i1\nC=4.6100,-3.9050;0,0,i1\nC=4.1500,-2.6750;0,0,i1\nC=7.1700,-2.6750;0,0,i1\nC=6.7100,-3.9050;0,0,i1\nC=5.6300,-0.5870;0,0,i1\nC=4.5800,0.7230;0,0,i1\nC=4.1200,-0.2070;0,0,i0\nC=7.1400,-0.2070;0,0,i1\nC=6.6800,0.7230;0,0,i1\nFe=5.6700,-1.6610;0,0,i0\nX=2.6200,-0.2137;0,0,i0\n2-3=2,0\n3-1=1,0\n1-4=1,0\n4-5=2,0\n5-2=1,0\n7-8=2,0\n8-6=1,0\n6-9=1,0\n9-10=2,0\n10-7=1,0\n11-6=1,0\n11-1=1,0\n3-11=0,0\n4-11=0,0\n2-11=0,0\n5-11=0,0\n8-11=0,0\n9-11=0,0\n10-11=0,0\n7-11=0,0\n9-9=1,0\n8-12=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[ferrocenyl]]></Cell>\n<Cell id="3"><![CDATA[Fc]]></Cell>\n</Row>\n<Row id="18">\n<Cell id="1"><![CDATA[SketchEl!(11,15)\nX=-1.8965,0.7175;0,0,i0\nFe=0.1000,0.7175;0,0,i0\nC=0.3931,1.7515;0,0,i1\nC=1.7233,2.7758;0,0,i1\nC=1.9501,1.7633;0,0,i1\nC=-0.9841,2.4781;0,0,i1\nC=-0.3171,3.2728;0,0,i1\nC=0.1000,-0.7825;0,0,e0\nO=0.1000,-2.2825;0,0,i0\nC=1.5289,-0.1075;0,0,e0\nO=2.8280,-0.8575;0,0,i0\n1-2=1,0\n4-5=2,0\n5-3=1,0\n3-6=1,0\n6-7=2,0\n7-4=1,0\n2-3=1,0\n5-2=0,0\n6-2=0,0\n7-2=0,0\n4-2=0,0\n2-8=0,0\n8-9=2,0\n2-10=0,0\n10-11=2,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[bis(carbonyl)cyclopentadienyl iron]]></Cell>\n<Cell id="3"><![CDATA[Fp]]></Cell>\n</Row>\n</Content>\n</DataSheet>\n',protgrp:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Functional Groups</Title>\n<Description><![CDATA[]]></Description>\n</Summary>\n<Header nrows="11" ncols="3">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Optional abbreviation</Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(8,7)\nX=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nO=2.2500,1.2990;0,0,i0\nO=2.2500,-1.2990;0,0,i0\nC=3.7500,1.2990;0,0,i0\nC=5.2500,1.2990;0,0,i3\nC=3.7500,2.7990;0,0,i3\nC=3.7500,-0.2010;0,0,i3\n1-2=1,0\n2-3=1,0\n2-4=2,0\n3-5=1,0\n5-6=1,0\n5-7=1,0\n5-8=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[Boc]]></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(11,11)\nS=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nX=-1.5000,-0.0000;0,0,i0\nO=-0.0000,1.5000;0,0,i0\nO=0.0000,-1.5000;0,0,i0\nC=2.2500,-1.2990;0,0,i1\nC=3.7500,-1.2990;0,0,i1\nC=4.5000,-0.0000;0,0,i0\nC=3.7500,1.2990;0,0,i1\nC=2.2500,1.2990;0,0,i1\nC=6.0000,-0.0000;0,0,i3\n1-2=1,0\n1-3=1,0\n1-4=2,0\n1-5=2,0\n2-6=2,0\n6-7=1,0\n7-8=2,0\n8-9=1,0\n9-10=2,0\n10-2=1,0\n8-11=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[Tos]]></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(8,7)\nS=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nX=-1.5000,-0.0000;0,0,i0\nO=-0.0000,1.5000;0,0,i0\nO=0.0000,-1.5000;0,0,i0\nF=3.0000,-0.0000;0,0,i0\nF=1.5000,1.5000;0,0,i0\nF=1.5000,-1.5000;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=2,0\n1-5=2,0\n2-6=1,0\n2-7=1,0\n2-8=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[Tf]]></Cell>\n</Row>\n<Row id="4">\n<Cell id="1"><![CDATA[SketchEl!(8,7)\nSi=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nX=-1.5000,-0.0000;0,0,i0\nPh=-0.0000,1.5000;0,0,i0,aSketchEl!(7\\002C7)\\000A*\\003D-6.5500\\002C1.6000\\003B0\\002C0\\002Ci0\\000AC\\003D-5.0500\\002C1.6000\\003B0\\002C0\\002Ci0\\000AC\\003D-4.3000\\002C2.8990\\003B0\\002C0\\002Ci1\\000AC\\003D-2.8000\\002C2.8990\\003B0\\002C0\\002Ci1\\000AC\\003D-4.3000\\002C0.3010\\003B0\\002C0\\002Ci1\\000AC\\003D-2.8000\\002C0.3010\\003B0\\002C0\\002Ci1\\000AC\\003D-2.0500\\002C1.6000\\003B0\\002C0\\002Ci1\\000A1-2\\003D1\\002C0\\000A3-2\\003D1\\002C0\\000A3-4\\003D2\\002C0\\000A2-5\\003D2\\002C0\\000A5-6\\003D1\\002C0\\000A6-7\\003D2\\002C0\\000A7-4\\003D1\\002C0\\000A!End\\000A\nPh=0.0000,-1.5000;0,0,i0,aSketchEl!(7\\002C7)\\000A*\\003D-6.5500\\002C1.6000\\003B0\\002C0\\002Ci0\\000AC\\003D-5.0500\\002C1.6000\\003B0\\002C0\\002Ci0\\000AC\\003D-4.3000\\002C2.8990\\003B0\\002C0\\002Ci1\\000AC\\003D-2.8000\\002C2.8990\\003B0\\002C0\\002Ci1\\000AC\\003D-4.3000\\002C0.3010\\003B0\\002C0\\002Ci1\\000AC\\003D-2.8000\\002C0.3010\\003B0\\002C0\\002Ci1\\000AC\\003D-2.0500\\002C1.6000\\003B0\\002C0\\002Ci1\\000A1-2\\003D1\\002C0\\000A3-2\\003D1\\002C0\\000A3-4\\003D2\\002C0\\000A2-5\\003D2\\002C0\\000A5-6\\003D1\\002C0\\000A6-7\\003D2\\002C0\\000A7-4\\003D1\\002C0\\000A!End\\000A\nC=3.0000,-0.0000;0,0,i3\nC=1.5000,1.5000;0,0,i3\nC=1.5000,-1.5000;0,0,i3\n1-2=1,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n2-6=1,0\n2-7=1,0\n2-8=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[TBDPS]]></Cell>\n</Row>\n<Row id="5">\n<Cell id="1"><![CDATA[SketchEl!(8,7)\nSi=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nX=-1.5000,-0.0000;0,0,i0\nC=-0.0000,1.5000;0,0,i3\nC=0.0000,-1.5000;0,0,i3\nC=3.0000,-0.0000;0,0,i3\nC=1.5000,1.5000;0,0,i3\nC=1.5000,-1.5000;0,0,i3\n1-2=1,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n2-6=1,0\n2-7=1,0\n2-8=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[TBDMS]]></Cell>\n</Row>\n<Row id="6">\n<Cell id="1"><![CDATA[SketchEl!(5,5)\nX=1.0000,0.0000;0,0,i0\nO=1.8817,-1.2135;0,0,i0\nC=3.3083,-0.7500;0,0,i2\nC=3.3083,0.7500;0,0,i2\nO=1.8817,1.2135;0,0,i0\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-1=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="7">\n<Cell id="1"><![CDATA[SketchEl!(6,6)\nX=0.0000,0.0000;0,0,i0\nO=0.7500,-1.2990;0,0,i0\nC=2.2500,-1.2990;0,0,i2\nC=3.0000,0.0000;0,0,i2\nC=2.2500,1.2990;0,0,i2\nO=0.7500,1.2990;0,0,i0\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-1=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[1,3-dioxane]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="8">\n<Cell id="1"><![CDATA[SketchEl!(6,6)\nX=0.0000,0.0000;0,0,i0\nS=0.7500,-1.2990;0,0,i0\nC=2.2500,-1.2990;0,0,i2\nC=3.0000,0.0000;0,0,i2\nC=2.2500,1.2990;0,0,i2\nS=0.7500,1.2990;0,0,i0\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-1=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[1,3-dithiane]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="9">\n<Cell id="1"><![CDATA[SketchEl!(7,6)\nX=0.0000,0.0000;0,0,i0\nC=1.5000,0.0000;0,0,i0\nO=2.2500,1.2990;0,0,i0\nC=2.2500,-1.2990;0,0,i0\nC=3.0000,-2.5981;0,0,i3\nC=3.5490,-0.5490;0,0,i3\nC=0.9510,-2.0490;0,0,i3\n1-2=1,0\n2-3=2,0\n2-4=1,0\n4-5=1,0\n4-6=1,0\n4-7=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[Piv]]></Cell>\n</Row>\n<Row id="10">\n<Cell id="1"><![CDATA[SketchEl!(11,11)\nC=8.5563,4.7294;0,0,i1\nC=9.8554,3.9794;0,0,i1\nC=9.8554,2.4794;0,0,i1\nC=8.5563,1.7294;0,0,i1\nC=7.2573,2.4794;0,0,i1\nC=7.2573,3.9794;0,0,i0\nC=5.9582,4.7294;0,0,i2\nO=4.6592,3.9794;0,0,i0\nC=3.3602,4.7294;0,0,i0\nX=2.0611,3.9794;0,0,i0\nO=3.3602,6.2294;0,0,i0\n1-2=2,0\n2-3=1,0\n3-4=2,0\n4-5=1,0\n5-6=2,0\n6-1=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n9-11=2,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[Cbz]]></Cell>\n</Row>\n<Row id="11">\n<Cell id="1"><![CDATA[SketchEl!(18,20)\nC=7.2573,3.9794;0,0,i1\nC=5.9582,4.7294;0,0,i2\nO=4.6592,3.9794;0,0,i0\nC=3.3602,4.7294;0,0,i0\nX=2.0611,3.9794;0,0,i0\nO=3.3602,6.2294;0,0,i0\nC=7.4141,2.4876;0,0,i0\nC=8.8814,2.1758;0,0,i0\nC=9.6313,3.4748;0,0,i0\nC=8.6276,4.5895;0,0,i0\nC=11.0985,3.7867;0,0,i1\nC=11.5620,5.2133;0,0,i1\nC=10.5583,6.3280;0,0,i1\nC=9.0911,6.0161;0,0,i1\nC=6.4105,1.3729;0,0,i1\nC=6.8740,-0.0537;0,0,i1\nC=8.3412,-0.3655;0,0,i1\nC=9.3449,0.7492;0,0,i1\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n4-6=2,0\n1-7=1,0\n7-8=2,0\n8-9=1,0\n9-10=2,0\n10-1=1,0\n9-11=1,0\n11-12=2,0\n12-13=1,0\n13-14=2,0\n14-10=1,0\n7-15=1,0\n15-16=2,0\n16-17=1,0\n17-18=2,0\n18-8=1,0\n!End\n]]></Cell>\n<Cell id="2"></Cell>\n<Cell id="3"><![CDATA[FMOC]]></Cell>\n</Row>\n</Content>\n</DataSheet>\n',nonplrings:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n <Summary>\n  <Title>Non-planar Rings</Title>\n  <Description><![CDATA[]]></Description>\n </Summary>\n <Header nrows="12" ncols="3">\n  <Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n  <Column name="Name" type="string" id="2">Template name</Column>\n  <Column name="Abbrev" type="string" id="3">Abbreviation code</Column>\n </Header>\n <Content>\n  <Row id="1">\n   <Cell id="1"><![CDATA[SketchEl!(6,7)\nC=-6.0428,5.1152;0,0,i1\nC=-5.8360,7.2412;0,0,i2\nC=-4.9821,6.1759;0,0,i1\nC=-3.5332,5.7877;0,0,i2\nC=-4.3230,4.4890;0,0,i2\nC=-7.3398,5.1300;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n1-5=1,0\n5-4=1,0\n1-6=1,0\n3-6=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[5-bridge-1]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="2">\n   <Cell id="1"><![CDATA[SketchEl!(7,8)\nC=-6.1000,5.0000;0,0,i2\nC=-4.8010,5.7500;0,0,i1\nC=-6.1000,3.5000;0,0,i2\nC=-4.8010,4.2500;0,0,i1\nC=-3.5019,5.0000;0,0,i2\nC=-3.5019,3.5000;0,0,i2\nC=-4.0510,6.8490;0,0,i2\n1-2=1,0\n1-3=1,0\n3-4=1,0\n2-5=1,0\n4-6=1,0\n6-5=1,0\n4-7=1,0\n2-7=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[6-bridge-1]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="3">\n   <Cell id="1"><![CDATA[SketchEl!(8,9)\nC=-6.1000,5.0000;0,0,i2\nC=-4.8010,5.7500;0,0,i1\nC=-6.1000,3.5000;0,0,i2\nC=-4.8010,4.2500;0,0,i1\nC=-3.5019,5.0000;0,0,i2\nC=-3.5019,3.5000;0,0,i2\nC=-4.5010,6.7990;0,0,i2\nC=-3.8510,5.7490;0,0,i2\n1-2=1,0\n1-3=1,0\n3-4=1,0\n2-5=1,0\n4-6=1,0\n6-5=1,0\n2-7=1,0\n4-8=1,0\n7-8=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[6-bridge-2]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="4">\n   <Cell id="1"><![CDATA[SketchEl!(8,9)\nC=-6.1177,3.0660;0,0,i2\nC=-5.3677,4.3650;0,0,i1\nC=-5.3677,1.7670;0,0,i2\nC=-4.6177,3.0660;0,0,i1\nC=-3.4177,4.2651;0,0,i2\nC=-3.6177,3.0660;0,0,i2\nC=-5.2677,5.6918;0,0,i2\nC=-2.3186,2.3160;0,0,i2\n1-2=1,0\n1-3=1,0\n3-4=1,0\n2-5=1,0\n4-6=1,0\n4-7=1,0\n2-7=1,0\n6-8=1,0\n8-5=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[7-bridge-1]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="5">\n   <Cell id="1"><![CDATA[SketchEl!(9,10)\nC=-6.1177,3.0660;0,0,i2\nC=-5.3677,4.3650;0,0,i1\nC=-5.3677,1.7670;0,0,i2\nC=-4.6177,3.0660;0,0,i1\nC=-3.4177,4.2651;0,0,i2\nC=-3.6177,3.0660;0,0,i2\nC=-5.6177,5.8418;0,0,i2\nC=-2.3186,2.3160;0,0,i2\nC=-4.9000,5.5000;0,0,i2\n1-2=1,0\n1-3=1,0\n3-4=1,0\n2-5=1,0\n4-6=1,0\n2-7=1,0\n6-8=1,0\n8-5=1,0\n4-9=1,0\n7-9=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[7-bridge-2]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="6">\n   <Cell id="1"><![CDATA[SketchEl!(9,10)\nC=-2.7481,2.7510;0,0,i2\nC=-1.4491,3.1510;0,0,i2\nC=-1.9981,4.0500;0,0,i2\nC=-0.1500,2.4010;0,0,i1\nC=-0.6991,3.3000;0,0,i1\nC=0.6000,4.0500;0,0,i2\nC=-0.4491,1.1500;0,0,i2\nC=0.3078,0.9726;0,0,i2\nC=-1.1922,-0.1265;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n6-5=1,0\n4-6=1,0\n5-7=1,0\n4-8=1,0\n8-9=1,0\n7-9=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[6-bridge-3]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="7">\n   <Cell id="1"><![CDATA[SketchEl!(10,11)\nC=-2.8297,-3.0097;0,0,i2\nC=-2.5266,-1.6847;0,0,i2\nC=-3.5797,-1.7107;0,0,i2\nC=-1.2275,-0.9347;0,0,i1\nC=-2.2806,-0.9607;0,0,i1\nC=-2.2806,0.5394;0,0,i2\nC=-0.2937,-1.8192;0,0,i2\nC=0.4384,-1.1524;0,0,i2\nC=0.4402,-3.1010;0,0,i2\nC=1.1902,-1.8019;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n6-5=1,0\n4-6=1,0\n5-7=1,0\n4-8=1,0\n7-9=1,0\n9-10=1,0\n10-8=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[7-bridge-3]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="8">\n   <Cell id="1"><![CDATA[SketchEl!(10,11)\nC=-5.9491,0.8000;0,0,i2\nC=-7.2481,0.0500;0,0,i2\nC=-7.2481,-1.4500;0,0,i2\nC=-5.9491,-2.2000;0,0,i2\nC=-4.6500,-1.4500;0,0,i1\nC=-4.6500,0.0500;0,0,i1\nC=-3.2287,0.5194;0,0,i2\nC=-2.3463,-0.6889;0,0,i2\nC=-3.2221,-1.9093;0,0,i2\nC=-3.9000,1.3490;0,0,i2\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n6-1=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-5=1,0\n6-10=1,0\n5-10=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[9-bridge-1]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="9">\n   <Cell id="1"><![CDATA[SketchEl!(11,12)\nC=-4.9010,5.1000;0,0,i2\nC=-6.2000,4.3500;0,0,i2\nC=-6.2000,2.8500;0,0,i2\nC=-4.9010,2.1000;0,0,i2\nC=-3.6019,2.8500;0,0,i1\nC=-3.6019,4.3500;0,0,i1\nC=-2.3029,5.1000;0,0,i2\nC=-2.3029,2.1000;0,0,i2\nC=-1.0038,2.8500;0,0,i2\nC=-1.0038,4.3500;0,0,i2\nC=-2.8519,5.6490;0,0,i2\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n6-1=1,0\n6-7=1,0\n5-8=1,0\n8-9=1,0\n9-10=1,0\n10-7=1,0\n6-11=1,0\n5-11=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[10-bridge-1]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="10">\n   <Cell id="1"><![CDATA[SketchEl!(12,13)\nC=-5.1991,3.1000;0,0,i2\nC=-6.4981,2.3500;0,0,i2\nC=-6.4981,0.8500;0,0,i2\nC=-5.1991,0.1000;0,0,i2\nC=-3.9000,0.8500;0,0,i1\nC=-3.9000,2.3500;0,0,i1\nC=-2.7265,3.2785;0,0,i2\nC=-2.7252,-0.0840;0,0,i2\nC=-1.2664,2.9421;0,0,i2\nC=-0.6227,1.5908;0,0,i2\nC=-1.2816,0.2423;0,0,i2\nC=-4.6500,3.6490;0,0,i2\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n6-1=1,0\n5-8=1,0\n6-7=1,0\n9-7=1,0\n9-10=1,0\n10-11=1,0\n11-8=1,0\n6-12=1,0\n5-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[11-bridge-1]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="11">\n   <Cell id="1"><![CDATA[SketchEl!(8,12)\nC=-4.3500,3.6500;0,0,i1\nC=-4.3500,2.1500;0,0,i1\nC=-2.8500,2.1500;0,0,i1\nC=-2.8500,3.6500;0,0,i1\nC=-3.5510,4.2000;0,0,i1\nC=-2.0510,4.2000;0,0,i1\nC=-2.0510,2.7000;0,0,i1\nC=-3.5510,2.7000;0,0,i1\n1-2=1,0\n2-3=1,0\n3-4=1,0\n1-4=1,0\n1-5=1,0\n4-6=1,0\n3-7=1,0\n2-8=1,0\n8-5=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cubane]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="12">\n   <Cell id="1"><![CDATA[SketchEl!(10,12)\nC=-5.1000,-1.5490;0,0,i2\nC=-3.8010,-1.1490;0,0,i1\nC=-4.3500,-0.2500;0,0,i1\nC=-2.5019,-1.8990;0,0,i2\nC=-3.0510,-1.0000;0,0,i2\nC=-1.7519,-0.2500;0,0,i1\nC=-4.3500,1.2500;0,0,i2\nC=-3.8010,0.3510;0,0,i2\nC=-1.7519,1.2500;0,0,i2\nC=-3.0510,2.0000;0,0,i1\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n6-5=1,0\n4-6=1,0\n3-7=1,0\n2-8=1,0\n6-9=1,0\n7-10=1,0\n9-10=1,0\n8-10=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[adamantane]]></Cell>\n   <Cell id="3"/>\n  </Row>\n </Content>\n</DataSheet>\n',largerings:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Large Rings</Title>\n<Description><![CDATA[]]></Description>\n</Summary>\n<Header nrows="11" ncols="3">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Abbreviation code</Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(9,9)\nC=2.0428,-18.6516;0,0,i2\nC=1.7880,-17.1633;0,0,i2\nC=2.5387,-15.8790;0,0,i2\nC=3.1939,-19.6177;0,0,i2\nC=4.7060,-19.6177;0,0,i2\nC=5.8535,-18.6576;0,0,i2\nC=6.1088,-17.1863;0,0,i2\nC=3.9528,-15.3740;0,0,i2\nC=5.3645,-15.8923;0,0,i2\n1-2=1,0\n2-3=1,0\n1-4=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n8-3=1,0\n8-9=1,0\n9-7=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-9]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(10,10)\nC=-3.5491,5.1000;0,0,i2\nC=-4.8481,4.3500;0,0,i2\nC=-4.8481,2.8500;0,0,i2\nC=-3.5491,2.1000;0,0,i2\nC=-2.2500,2.8500;0,0,i2\nC=-2.2500,4.3500;0,0,i2\nC=-0.9509,2.1000;0,0,i2\nC=0.3481,2.8500;0,0,i2\nC=0.3481,4.3500;0,0,i2\nC=-0.9509,5.1000;0,0,i2\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n6-1=1,0\n8-9=1,0\n8-7=1,0\n9-10=1,0\n10-6=1,0\n5-7=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-10]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(11,11)\nC=-7.7858,2.5448;0,0,i2\nC=-7.8013,1.1000;0,0,i2\nC=-6.4244,0.8579;0,0,i2\nC=-5.3288,-0.5811;0,0,i2\nC=-4.3565,0.8361;0,0,i2\nC=-2.9104,1.0882;0,0,i2\nC=-2.8964,2.5470;0,0,i2\nC=-4.2864,2.8806;0,0,i2\nC=-4.6033,4.2815;0,0,i2\nC=-6.0450,4.2766;0,0,i2\nC=-6.3710,2.8699;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n11-1=1,0\n4-5=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-11]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="4">\n<Cell id="1"><![CDATA[SketchEl!(12,12)\nC=1.1614,6.9975;0,0,i2\nC=2.4604,6.2475;0,0,i2\nC=-0.1376,6.2475;0,0,i2\nC=-0.1376,4.7475;0,0,i2\nC=-1.4367,3.9975;0,0,i2\nC=-1.4367,2.4975;0,0,i2\nC=-0.1376,1.7475;0,0,i2\nC=1.1614,2.4975;0,0,i2\nC=2.4604,1.7475;0,0,i2\nC=3.7595,2.4975;0,0,i2\nC=3.7595,3.9975;0,0,i2\nC=2.4604,4.7475;0,0,i2\n1-2=1,0\n1-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n11-12=1,0\n12-2=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-12]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="5">\n<Cell id="1"><![CDATA[SketchEl!(12,12)\nC=0.2503,-1.0236;0,0,i2\nC=1.7491,-1.0236;0,0,i2\nC=2.0788,0.4428;0,0,i2\nC=3.5325,0.7862;0,0,i2\nC=3.5274,2.2829;0,0,i2\nC=2.0508,2.6151;0,0,i2\nC=1.7054,4.0671;0,0,i2\nC=0.1996,4.0655;0,0,i2\nC=-0.1373,2.6137;0,0,i2\nC=-1.5850,2.2710;0,0,i2\nC=-1.5640,0.7758;0,0,i2\nC=-0.0938,0.4547;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n11-12=1,0\n12-1=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-12]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="6">\n<Cell id="1"><![CDATA[SketchEl!(13,13)\nC=-9.0085,1.2181;0,0,i2\nC=-8.4085,2.6671;0,0,i2\nC=-6.9085,2.6671;0,0,i2\nC=-6.3085,1.2181;0,0,i2\nC=-4.8595,0.6181;0,0,i2\nC=-4.8595,-0.8819;0,0,i2\nC=-6.3085,-1.4819;0,0,i2\nC=-9.0085,-1.4819;0,0,i2\nC=-10.4575,-0.8819;0,0,i2\nC=-10.4575,0.6181;0,0,i2\nC=-9.0085,-2.9819;0,0,i2\nC=-6.3085,-2.9819;0,0,i2\nC=-7.7095,-3.7319;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n8-9=1,0\n9-10=1,0\n10-1=1,0\n8-11=1,0\n7-12=1,0\n11-13=1,0\n13-12=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-13]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="7">\n<Cell id="1"><![CDATA[SketchEl!(14,14)\nC=6.9101,-5.9857;0,0,i2\nC=7.5101,-4.5367;0,0,i2\nC=9.0101,-4.5367;0,0,i2\nC=9.6101,-5.9857;0,0,i2\nC=9.6101,-8.6857;0,0,i2\nC=9.0101,-10.1347;0,0,i2\nC=7.5101,-10.1347;0,0,i2\nC=6.9101,-8.6857;0,0,i2\nC=5.4101,-5.9857;0,0,i2\nC=5.4101,-8.6857;0,0,i2\nC=11.1101,-8.6857;0,0,i2\nC=11.1101,-5.9857;0,0,i2\nC=11.8601,-7.3867;0,0,i2\nC=4.6601,-7.2847;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n1-9=1,0\n8-10=1,0\n5-11=1,0\n4-12=1,0\n11-13=1,0\n13-12=1,0\n9-14=1,0\n14-10=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-14]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="8">\n<Cell id="1"><![CDATA[SketchEl!(15,15)\nC=22.1615,-1.5864;0,0,i2\nC=23.3877,-0.7311;0,0,i2\nC=20.9592,-0.7218;0,0,i2\nC=22.9828,0.6878;0,0,i2\nC=19.7379,-1.5763;0,0,i2\nC=24.1796,1.5700;0,0,i2\nC=18.5357,-0.7167;0,0,i2\nC=23.7246,3.0381;0,0,i2\nC=18.9534,0.7033;0,0,i2\nC=22.2021,3.0764;0,0,i2\nC=17.7398,1.6155;0,0,i2\nC=21.7384,4.5021;0,0,i2\nC=18.2148,3.0479;0,0,i2\nC=20.2213,4.5021;0,0,i2\nC=19.7018,3.0711;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n4-6=1,0\n5-7=1,0\n6-8=1,0\n7-9=1,0\n8-10=1,0\n9-11=1,0\n10-12=1,0\n11-13=1,0\n12-14=1,0\n13-15=1,0\n14-15=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-15]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="9">\n<Cell id="1"><![CDATA[SketchEl!(16,16)\nC=-2.3295,-6.3508;0,0,i2\nC=-2.3295,-7.8765;0,0,i2\nC=-1.0175,-8.6353;0,0,i2\nC=0.3099,-7.8765;0,0,i2\nC=2.9416,-6.3508;0,0,i2\nC=2.9416,-7.8765;0,0,i2\nC=1.6218,-8.6353;0,0,i2\nC=-1.0150,-4.2041;0,0,i2\nC=0.2910,-3.4545;0,0,i2\nC=1.6173,-4.2041;0,0,i2\nC=-2.3088,-3.4429;0,0,i2\nC=-3.6056,-4.1961;0,0,i2\nC=-3.6212,-5.5973;0,0,i2\nC=2.9184,-3.4366;0,0,i2\nC=4.2222,-4.1763;0,0,i2\nC=4.2483,-5.5976;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n5-6=1,0\n6-7=1,0\n7-4=1,0\n8-9=1,0\n9-10=1,0\n11-12=1,0\n8-11=1,0\n1-13=1,0\n12-13=1,0\n14-15=1,0\n10-14=1,0\n5-16=1,0\n15-16=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-16]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="10">\n<Cell id="1"><![CDATA[SketchEl!(18,18)\nC=14.0401,-6.5516;0,0,i2\nC=14.7839,-7.8398;0,0,i2\nC=13.8355,-9.0080;0,0,i2\nC=14.6732,-10.2249;0,0,i2\nC=13.8569,-11.4861;0,0,i2\nC=12.3571,-11.2554;0,0,i2\nC=11.7609,-12.6417;0,0,i2\nC=10.2552,-12.6811;0,0,i2\nC=9.6255,-11.3345;0,0,i2\nC=8.1419,-11.5631;0,0,i2\nC=7.3964,-10.2751;0,0,i2\nC=8.3448,-9.1199;0,0,i2\nC=7.5032,-7.8976;0,0,i2\nC=8.3106,-6.6466;0,0,i2\nC=9.8063,-6.8716;0,0,i2\nC=10.4049,-5.4658;0,0,i2\nC=11.9207,-5.4290;0,0,i2\nC=12.5403,-6.7723;0,0,i2\n1-2=1,0\n2-3=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n3-4=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n7-8=1,0\n12-13=1,0\n13-14=1,0\n14-15=1,0\n11-12=1,0\n16-17=1,0\n17-18=1,0\n15-16=1,0\n1-18=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-18]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="11">\n<Cell id="1"><![CDATA[SketchEl!(20,20)\nC=23.0039,-8.7037;0,0,i2\nC=21.6788,-9.4637;0,0,i2\nC=21.6617,-10.9743;0,0,i2\nC=22.9767,-11.7478;0,0,i2\nC=24.2738,-14.0464;0,0,i2\nC=22.9667,-13.2731;0,0,i2\nC=28.1300,-11.8325;0,0,i2\nC=28.1300,-13.3322;0,0,i2\nC=26.8927,-14.0616;0,0,i2\nC=28.1261,-8.8196;0,0,i2\nC=29.4195,-9.5784;0,0,i2\nC=29.4306,-11.0859;0,0,i2\nC=26.8898,-15.5611;0,0,i2\nC=25.5812,-16.3118;0,0,i2\nC=24.2488,-15.5459;0,0,i2\nC=25.5520,-7.2815;0,0,i2\nC=26.8533,-6.5619;0,0,i2\nC=28.1325,-7.3250;0,0,i2\nC=24.2475,-6.5288;0,0,i2\nC=22.9549,-7.2639;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n5-6=1,0\n6-4=1,0\n7-8=1,0\n8-9=1,0\n10-11=1,0\n7-12=1,0\n11-12=1,0\n13-14=1,0\n9-13=1,0\n5-15=1,0\n15-14=1,0\n16-17=1,0\n10-18=1,0\n17-18=1,0\n19-20=1,0\n16-19=1,0\n20-1=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclo-20]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n</Content>\n</DataSheet>\n',crownethers:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n <Summary>\n  <Title>Crown Ethers</Title>\n  <Description><![CDATA[]]></Description>\n </Summary>\n <Header nrows="10" ncols="3">\n  <Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n  <Column name="Name" type="string" id="2">Template name</Column>\n  <Column name="Abbrev" type="string" id="3">Abbreviation code</Column>\n </Header>\n <Content>\n  <Row id="1">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nO=-3.3500,6.9000;0,0,i0\nC=-2.7500,8.3490;0,0,i2\nC=-1.2500,8.3490;0,0,i2\nO=-0.6500,6.9000;0,0,i0\nC=0.7990,6.3000;0,0,i2\nC=0.7990,4.8000;0,0,i2\nO=-0.6500,4.2000;0,0,i0\nC=-1.2500,2.7510;0,0,i2\nC=-2.7500,2.7510;0,0,i2\nO=-3.3500,4.2000;0,0,i0\nC=-4.7990,4.8000;0,0,i2\nC=-4.7990,6.3000;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n11-12=1,0\n12-1=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[12-crown-4]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="2">\n   <Cell id="1"><![CDATA[SketchEl!(13,13)\nO=-9.0085,1.2181;0,0,i0\nC=-8.4085,2.6671;0,0,i2\nC=-6.9085,2.6671;0,0,i2\nO=-6.3085,1.2181;0,0,i0\nC=-4.8595,0.6181;0,0,i2\nC=-4.8595,-0.8819;0,0,i2\nO=-6.3085,-1.4819;0,0,i0\nO=-9.0085,-1.4819;0,0,i0\nC=-10.4575,-0.8819;0,0,i2\nC=-10.4575,0.6181;0,0,i2\nC=-9.0085,-2.9819;0,0,i2\nC=-6.3085,-2.9819;0,0,i2\nC=-7.7095,-3.7319;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n8-9=1,0\n9-10=1,0\n10-1=1,0\n8-11=1,0\n7-12=1,0\n11-13=1,0\n13-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[13-crown-4]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="3">\n   <Cell id="1"><![CDATA[SketchEl!(14,14)\nO=6.9101,-5.9857;0,0,i0\nC=7.5101,-4.5367;0,0,i2\nC=9.0101,-4.5367;0,0,i2\nO=9.6101,-5.9857;0,0,i0\nO=9.6101,-8.6857;0,0,i0\nC=9.0101,-10.1347;0,0,i2\nC=7.5101,-10.1347;0,0,i2\nO=6.9101,-8.6857;0,0,i0\nC=5.4101,-5.9857;0,0,i2\nC=5.4101,-8.6857;0,0,i2\nC=11.1101,-8.6857;0,0,i2\nC=11.1101,-5.9857;0,0,i2\nC=11.8601,-7.3867;0,0,i2\nC=4.6601,-7.2847;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n1-9=1,0\n8-10=1,0\n5-11=1,0\n4-12=1,0\n11-13=1,0\n13-12=1,0\n9-14=1,0\n14-10=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[14-crown-4]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="4">\n   <Cell id="1"><![CDATA[SketchEl!(15,15)\nC=22.1615,-1.5864;0,0,i2\nC=23.3877,-0.7311;0,0,i2\nO=20.9592,-0.7218;0,0,i0\nO=22.9828,0.6878;0,0,i0\nC=19.7379,-1.5763;0,0,i2\nC=24.1796,1.5700;0,0,i2\nC=18.5357,-0.7167;0,0,i2\nC=23.7246,3.0381;0,0,i2\nO=18.9534,0.7033;0,0,i0\nO=22.2021,3.0764;0,0,i0\nC=17.7398,1.6155;0,0,i2\nC=21.7384,4.5021;0,0,i2\nC=18.2148,3.0479;0,0,i2\nC=20.2213,4.5021;0,0,i2\nO=19.7018,3.0711;0,0,i0\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n4-6=1,0\n5-7=1,0\n6-8=1,0\n7-9=1,0\n8-10=1,0\n9-11=1,0\n10-12=1,0\n11-13=1,0\n12-14=1,0\n13-15=1,0\n14-15=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[15-crown-5]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="5">\n   <Cell id="1"><![CDATA[SketchEl!(16,16)\nC=-3.2703,-7.3624;0,0,i2\nC=-4.4642,-6.4905;0,0,i2\nO=-3.7283,-8.7862;0,0,i0\nO=-5.6803,-7.3450;0,0,i0\nC=-2.5315,-9.6420;0,0,i2\nC=-6.8842,-6.4872;0,0,i2\nC=-2.8996,-11.0971;0,0,i2\nC=-8.0816,-7.3361;0,0,i2\nO=-4.4208,-11.4135;0,0,i0\nO=-7.6748,-8.7819;0,0,i0\nC=-4.4492,-12.9087;0,0,i2\nC=-8.9100,-9.5864;0,0,i2\nC=-5.8087,-13.6602;0,0,i2\nC=-8.6136,-11.0608;0,0,i2\nC=-7.1438,-12.8902;0,0,i2\nO=-7.1341,-11.4135;0,0,i0\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n4-6=1,0\n5-7=1,0\n6-8=1,0\n7-9=1,0\n8-10=1,0\n9-11=1,0\n10-12=1,0\n11-13=1,0\n12-14=1,0\n13-15=1,0\n14-16=1,0\n15-16=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[16-crown-5]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="6">\n   <Cell id="1"><![CDATA[SketchEl!(17,17)\nC=11.3913,-8.5218;0,0,i2\nO=9.9653,-8.8821;0,0,i0\nC=8.6597,-11.0126;0,0,i2\nO=7.4967,-10.0548;0,0,i0\nC=6.3270,-10.9800;0,0,i2\nC=5.0002,-10.3582;0,0,i2\nO=4.9982,-8.8783;0,0,i0\nC=3.5605,-8.5538;0,0,i2\nC=3.2430,-7.1220;0,0,i2\nC=4.4248,-6.1867;0,0,i2\nO=5.8590,-6.7660;0,0,i0\nC=6.6561,-5.4870;0,0,i2\nC=8.2017,-5.4870;0,0,i2\nO=9.0164,-6.7596;0,0,i0\nC=10.4452,-6.1465;0,0,i2\nC=11.6565,-7.0603;0,0,i2\nC=9.9960,-10.3691;0,0,i2\n5-6=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n6-7=1,0\n11-12=1,0\n12-13=1,0\n13-14=1,0\n10-11=1,0\n15-16=1,0\n14-15=1,0\n16-1=1,0\n2-17=1,0\n17-3=1,0\n1-2=1,0\n3-4=1,0\n4-5=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[17-crown-5]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="7">\n   <Cell id="1"><![CDATA[SketchEl!(18,18)\nC=25.7638,-7.1614;0,0,i2\nC=25.0080,-8.4698;0,0,i2\nO=23.5267,-8.2690;0,0,i0\nC=22.8858,-9.6176;0,0,i2\nC=21.3709,-9.5699;0,0,i2\nO=20.7705,-8.1782;0,0,i0\nC=19.2614,-8.3591;0,0,i2\nC=18.4799,-7.0636;0,0,i2\nO=19.3514,-5.8621;0,0,i0\nC=18.4463,-4.6854;0,0,i2\nC=19.2046,-3.3933;0,0,i2\nO=20.6839,-3.5899;0,0,i0\nC=21.3018,-2.2555;0,0,i2\nC=22.7925,-2.2628;0,0,i2\nO=23.3883,-3.6550;0,0,i0\nC=24.8877,-3.4674;0,0,i2\nC=25.6817,-4.7676;0,0,i2\nO=24.8469,-5.9802;0,0,i0\n1-2=1,0\n2-3=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n3-4=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n7-8=1,0\n12-13=1,0\n13-14=1,0\n14-15=1,0\n11-12=1,0\n16-17=1,0\n17-18=1,0\n15-16=1,0\n1-18=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[18-crown-6]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="8">\n   <Cell id="1"><![CDATA[SketchEl!(20,20)\nC=-3.4089,-21.0677;0,0,i2\nC=-4.1767,-22.3338;0,0,i2\nC=-4.1760,-19.7823;0,0,i2\nO=-5.6753,-22.3687;0,0,i0\nO=-5.6837,-19.8385;0,0,i0\nC=-5.9548,-23.7442;0,0,i2\nC=-5.9813,-18.3858;0,0,i2\nC=-7.3810,-24.2230;0,0,i2\nC=-7.4086,-17.9180;0,0,i2\nO=-8.5195,-23.2256;0,0,i0\nO=-8.5335,-18.9110;0,0,i0\nC=-9.6750,-17.9220;0,0,i2\nC=-11.0728,-23.7403;0,0,i2\nC=-11.1043,-18.4009;0,0,i2\nO=-11.3732,-22.3272;0,0,i0\nO=-11.3858,-19.8551;0,0,i0\nC=-12.8889,-22.3529;0,0,i2\nC=-12.9024,-19.8027;0,0,i2\nC=-13.6729,-21.0850;0,0,i2\nC=-9.6554,-24.2077;0,0,i2\n1-2=1,0\n2-4=1,0\n3-5=1,0\n4-6=1,0\n5-7=1,0\n6-8=1,0\n7-9=1,0\n8-10=1,0\n9-11=1,0\n11-12=1,0\n13-15=1,0\n14-16=1,0\n15-17=1,0\n16-18=1,0\n17-19=1,0\n18-19=1,0\n12-14=1,0\n13-20=1,0\n10-20=1,0\n3-1=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[20-crown-6]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="9">\n   <Cell id="1"><![CDATA[SketchEl!(21,21)\nC=5.3181,-17.4804;0,0,i2\nC=3.8183,-17.4647;0,0,i2\nO=3.1475,-18.8055;0,0,i0\nC=1.6753,-18.4404;0,0,i2\nC=0.7284,-19.5857;0,0,i2\nO=1.3610,-20.9456;0,0,i0\nC=0.1741,-21.8748;0,0,i2\nC=0.5101,-23.3287;0,0,i2\nO=1.9785,-23.6452;0,0,i0\nC=1.9855,-25.1429;0,0,i2\nC=3.3325,-25.7906;0,0,i2\nO=4.5146,-24.8501;0,0,i0\nC=5.6870,-25.8137;0,0,i2\nC=7.0359,-25.1826;0,0,i2\nC=8.3693,-19.6515;0,0,i2\nC=7.4283,-18.4879;0,0,i2\nO=5.9620,-18.8325;0,0,i0\nO=7.0819,-23.6850;0,0,i0\nO=7.7239,-20.9997;0,0,i0\nC=8.5502,-23.3847;0,0,i2\nC=8.9031,-21.9421;0,0,i2\n1-2=1,0\n2-3=1,0\n4-5=1,0\n5-6=1,0\n6-7=1,0\n3-4=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n7-8=1,0\n12-13=1,0\n13-14=1,0\n11-12=1,0\n15-16=1,0\n16-17=1,0\n1-17=1,0\n14-18=1,0\n19-15=1,0\n18-20=1,0\n19-21=1,0\n20-21=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[21-crown-7]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="10">\n   <Cell id="1"><![CDATA[SketchEl!(24,24)\nC=20.7446,-27.4663;0,0,i2\nO=21.4914,-26.1584;0,0,i0\nC=19.2274,-27.4663;0,0,i2\nC=22.9335,-26.6476;0,0,i2\nO=18.5013,-26.1469;0,0,i0\nC=24.0269,-25.6099;0,0,i2\nC=17.0704,-26.6026;0,0,i2\nO=23.6289,-24.1676;0,0,i0\nC=15.9870,-25.5356;0,0,i2\nC=24.9576,-23.4669;0,0,i2\nO=16.4266,-24.0844;0,0,i0\nC=24.9616,-21.9609;0,0,i2\nC=15.1053,-23.3507;0,0,i2\nO=23.6462,-21.2624;0,0,i0\nC=15.1453,-21.8561;0,0,i2\nC=24.0717,-19.8181;0,0,i2\nO=16.4802,-21.1978;0,0,i0\nC=22.9846,-18.8108;0,0,i2\nC=16.0898,-19.7657;0,0,i2\nO=21.5453,-19.2991;0,0,i0\nC=17.1862,-18.7823;0,0,i2\nC=20.8284,-18.0103;0,0,i2\nO=18.5947,-19.2887;0,0,i0\nC=19.3270,-18.0074;0,0,i2\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n4-6=1,0\n5-7=1,0\n6-8=1,0\n7-9=1,0\n8-10=1,0\n9-11=1,0\n10-12=1,0\n11-13=1,0\n12-14=1,0\n13-15=1,0\n14-16=1,0\n15-17=1,0\n16-18=1,0\n17-19=1,0\n18-20=1,0\n19-21=1,0\n20-22=1,0\n21-23=1,0\n22-24=1,0\n23-24=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[24-crown-8]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n </Content>\n</DataSheet>\n',ligmonodent:'<DataSheet><Summary><Title>Monodentate Ligands</Title><Description><![CDATA[]]></Description></Summary><Extension/><Header nrows="10" ncols="3"><Column id="1" name="Molecule" type="molecule">Molecular structure</Column><Column id="2" name="Name" type="string">Template name</Column><Column id="3" name="Abbrev" type="string">Optional abbreviation</Column></Header><Content><Row id="1"><Cell id="1"><![CDATA[SketchEl!(20,22)\nP=0.0000,0.0000;0,0,i0\nC=0.0000,2.0000;0,0,i0\nC=2.0000,-0.0000;0,0,i0\nC=-0.0000,-2.0000;0,0,i0\nC=-1.2990,2.7500;0,0,i1\nC=1.2990,2.7500;0,0,i1\nC=-1.2990,4.2500;0,0,i1\nC=0.0000,5.0000;0,0,i1\nC=1.2990,4.2500;0,0,i1\nC=2.7500,1.2990;0,0,i1\nC=2.7500,-1.2990;0,0,i1\nC=4.2500,1.2990;0,0,i1\nC=5.0000,-0.0000;0,0,i1\nC=4.2500,-1.2990;0,0,i1\nC=1.2990,-2.7500;0,0,i1\nC=-1.2990,-2.7500;0,0,i1\nC=1.2990,-4.2500;0,0,i1\nC=-0.0000,-5.0000;0,0,i1\nC=-1.2990,-4.2500;0,0,i1\nX=-2.0000,0.0000;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=1,0\n2-5=1,0\n2-6=2,0\n5-7=2,0\n7-8=1,0\n8-9=2,0\n9-6=1,0\n3-10=1,0\n3-11=2,0\n10-12=2,0\n12-13=1,0\n13-14=2,0\n14-11=1,0\n4-15=1,0\n4-16=2,0\n15-17=2,0\n17-18=1,0\n18-19=2,0\n19-16=1,0\n1-20=0,0\n!End\n]]></Cell><Cell id="2"><![CDATA[triphenylphosphine]]></Cell><Cell id="3"><![CDATA[P|Ph{3}]]></Cell></Row><Row id="2"><Cell id="1"><![CDATA[SketchEl!(5,4)\nP=0.0000,0.0000;0,0,i0\nC=0.0000,1.5000;0,0,i3\nC=1.5000,-0.0000;0,0,i3\nC=-0.0000,-1.5000;0,0,i3\nX=-1.5000,0.0000;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=1,0\n1-5=0,0\n!End\n]]></Cell><Cell id="2"><![CDATA[trimethylphosphine]]></Cell><Cell id="3"><![CDATA[P|Me{3}]]></Cell></Row><Row id="3"><Cell id="1"><![CDATA[SketchEl!(8,8)\nX=-2.7000,3.9500;0,0,i0\nC=-1.2000,3.9500;0,0,i0\nN=-0.3200,2.7400;0,0,i0\nC=1.1100,3.2000;0,0,i1\nN=-0.3200,5.1600;0,0,i0\nC=1.1100,4.7000;0,0,i1\nC=-0.7853,6.5860;0,0,i3\nC=-0.7853,1.3140;0,0,i3\n1-2=2,0\n4-3=1,0\n3-2=1,0\n2-5=1,0\n5-6=1,0\n6-4=2,0\n5-7=1,0\n3-8=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[imidazolidine]]></Cell><Cell id="3"/></Row><Row id="4"><Cell id="1"><![CDATA[SketchEl!(3,2)\nX=-0.9000,0.3500;0,0,i0\nC=0.6000,0.3500;0,0,e0\nO=2.1000,0.3500;0,0,i0\n1-2=0,0\n2-3=2,0\n!End\n]]></Cell><Cell id="2"><![CDATA[carbonyl]]></Cell><Cell id="3"/></Row><Row id="5"><Cell id="1"><![CDATA[SketchEl!(6,5)\nX=-2.4000,1.9714;0,0,i0\nO=-0.9000,1.9714;0,0,i0\nC=-0.1500,3.2705;0,0,i2\nC=1.3500,3.2705;0,0,i3\nC=-0.1500,0.6724;0,0,i2\nC=1.3500,0.6724;0,0,i3\n1-2=0,0\n2-3=1,0\n3-4=1,0\n2-5=1,0\n5-6=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[diethylether]]></Cell><Cell id="3"><![CDATA[O|Et{2}]]></Cell></Row><Row id="6"><Cell id="1"><![CDATA[SketchEl!(6,6)\nX=-2.4000,1.9714;0,0,i0\nO=-0.9000,1.9714;0,0,i0\nC=-0.0200,0.7614;0,0,i2\nC=1.4100,1.2214;0,0,i2\nC=-0.0200,3.1814;0,0,i2\nC=1.4100,2.7214;0,0,i2\n1-2=0,0\n4-3=1,0\n3-2=1,0\n2-5=1,0\n5-6=1,0\n6-4=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[tetrahydrofuran]]></Cell><Cell id="3"><![CDATA[THF]]></Cell></Row><Row id="7"><Cell id="1"><![CDATA[SketchEl!(7,6)\nX=-1.0000,-0.9143;0,0,i0\nO=0.5000,-0.9143;0,0,i0\nC=2.0000,-0.9143;0,0,i0\nN=2.7500,-2.2133;0,0,i0\nC=4.2500,-2.2133;0,0,i3\nC=2.0000,-3.5124;0,0,i3\nH=2.7500,0.3848;0,0,i0\n1-2=0,0\n2-3=2,0\n3-4=1,0\n4-5=1,0\n4-6=1,0\n3-7=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[dimethylformamide]]></Cell><Cell id="3"><![CDATA[DMF]]></Cell></Row><Row id="8"><Cell id="1"><![CDATA[SketchEl!(5,4)\nX=-1.0000,-0.9143;0,0,i0\nO=0.5000,-0.9143;0,0,i0\nS=2.0000,-0.9143;0,0,i0\nC=2.7500,-2.2133;0,0,i3\nC=2.7500,0.3848;0,0,i3\n1-2=0,0\n2-3=2,0\n3-4=1,0\n3-5=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[dimethylsulfoxide]]></Cell><Cell id="3"><![CDATA[DMSO]]></Cell></Row><Row id="9"><Cell id="1"><![CDATA[SketchEl!(7,7)\nC=6.8500,0.0490;0,0,i1\nC=5.3500,0.0490;0,0,i1\nC=7.6000,-1.2500;0,0,i1\nN=4.6000,-1.2500;0,0,i0\nC=5.3500,-2.5490;0,0,i1\nC=6.8500,-2.5490;0,0,i1\nX=3.1000,-1.2500;0,0,i0\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n4-7=0,0\n!End\n]]></Cell><Cell id="2"><![CDATA[pyridine]]></Cell><Cell id="3"><![CDATA[Py]]></Cell></Row><Row id="10"><Cell id="1"><![CDATA[SketchEl!(22,24)\nX=0.0000,-0.1997;0,0,i0\nC=0.0000,1.9965;0,2,i0\nN=1.2135,2.8782;0,0,i0\nC=0.7500,4.3048;0,0,i1\nC=-0.7500,4.3048;0,0,i1\nN=-1.2135,2.8782;0,0,i0\nC=-2.7135,2.8782;0,0,i0\nC=2.7135,2.8782;0,0,i0\nC=-3.4635,4.1772;0,0,i0\nC=-4.9635,4.1772;0,0,i1\nC=-5.7135,2.8782;0,0,i1\nC=-4.9635,1.5791;0,0,i1\nC=-3.4635,1.5791;0,0,i0\nC=3.4635,1.5791;0,0,i0\nC=4.9635,1.5791;0,0,i1\nC=5.7135,2.8782;0,0,i1\nC=4.9635,4.1772;0,0,i1\nC=3.4635,4.1772;0,0,i0\n{^i}Pr=-2.7135,0.2801;0,0,i0,aSketchEl!(4\\002C3)\\000A*\\003D-6.4450\\002C2.0214\\003B0\\002C0\\002Ci0\\000AC\\003D-4.1950\\002C3.3204\\003B0\\002C0\\002Ci3\\000AC\\003D-4.1950\\002C0.7224\\003B0\\002C0\\002Ci3\\000AC\\003D-4.9450\\002C2.0214\\003B0\\002C0\\002Ci1\\000A4-2\\003D1\\002C0\\000A4-3\\003D1\\002C0\\000A4-1\\003D1\\002C0\\000A!End\\000A\n{^i}Pr=2.7135,0.2801;0,0,i0,aSketchEl!(4\\002C3)\\000A*\\003D-6.4450\\002C2.0214\\003B0\\002C0\\002Ci0\\000AC\\003D-4.1950\\002C3.3204\\003B0\\002C0\\002Ci3\\000AC\\003D-4.1950\\002C0.7224\\003B0\\002C0\\002Ci3\\000AC\\003D-4.9450\\002C2.0214\\003B0\\002C0\\002Ci1\\000A4-2\\003D1\\002C0\\000A4-3\\003D1\\002C0\\000A4-1\\003D1\\002C0\\000A!End\\000A\n{^i}Pr=2.7135,5.4763;0,0,i0,aSketchEl!(4\\002C3)\\000A*\\003D-6.4450\\002C2.0214\\003B0\\002C0\\002Ci0\\000AC\\003D-4.1950\\002C3.3204\\003B0\\002C0\\002Ci3\\000AC\\003D-4.1950\\002C0.7224\\003B0\\002C0\\002Ci3\\000AC\\003D-4.9450\\002C2.0214\\003B0\\002C0\\002Ci1\\000A4-2\\003D1\\002C0\\000A4-3\\003D1\\002C0\\000A4-1\\003D1\\002C0\\000A!End\\000A\n{^i}Pr=-2.7135,5.4763;0,0,i0,aSketchEl!(4\\002C3)\\000A*\\003D-6.4450\\002C2.0214\\003B0\\002C0\\002Ci0\\000AC\\003D-4.1950\\002C3.3204\\003B0\\002C0\\002Ci3\\000AC\\003D-4.1950\\002C0.7224\\003B0\\002C0\\002Ci3\\000AC\\003D-4.9450\\002C2.0214\\003B0\\002C0\\002Ci1\\000A4-2\\003D1\\002C0\\000A4-3\\003D1\\002C0\\000A4-1\\003D1\\002C0\\000A!End\\000A\n1-2=0,0\n2-3=1,0\n3-4=1,0\n4-5=2,0\n5-6=1,0\n6-2=1,0\n6-7=1,0\n3-8=1,0\n7-9=2,0\n9-10=1,0\n10-11=2,0\n11-12=1,0\n12-13=2,0\n13-7=1,0\n8-14=2,0\n14-15=1,0\n15-16=2,0\n16-17=1,0\n17-18=2,0\n18-8=1,0\n13-19=1,0\n14-20=1,0\n18-21=1,0\n9-22=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[IPr]]></Cell><Cell id="3"/></Row></Content></DataSheet>',ligbident:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Bidentate Ligands</Title>\n<Description><![CDATA[]]></Description>\n</Summary>\n<Header nrows="11" ncols="3">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Optional abbreviation</Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(13,15)\nC=2.7915,1.5000;0,0,i1\nC=4.0905,0.7500;0,0,i1\nC=1.4925,0.7500;0,0,i1\nC=4.0905,-0.7500;0,0,i1\nC=2.7915,-1.5000;0,0,i0\nN=1.4925,-0.7500;0,0,i0\nC=2.7915,-3.0000;0,0,i0\nC=4.0905,-3.7500;0,0,i1\nN=1.4925,-3.7500;0,0,i0\nC=4.0905,-5.2500;0,0,i1\nC=2.7915,-6.0000;0,0,i1\nC=1.4925,-5.2500;0,0,i1\nX=-1.1000,-2.2500;0,0,i0\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n5-7=1,0\n7-8=1,0\n7-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n13-9=0,0\n13-6=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[bipyridine]]></Cell>\n<Cell id="3"><![CDATA[bipy]]></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(13,15)\nC=2.7915,1.5000;0,0,i1\nC=4.0905,0.7500;0,0,i1\nC=1.4925,0.7500;0,0,i1\nC=4.0905,-0.7500;0,0,i1\nC=2.7915,-1.5000;0,0,i0\nN=1.4925,-0.7500;0,0,i0\nC=2.7915,-3.0000;0,0,i0\nC=4.0905,-3.7500;0,0,i1\nC=1.4925,-3.7500;0,0,i0\nC=4.0905,-5.2500;0,0,i1\nC=2.7915,-6.0000;0,0,i1\nC=1.4925,-5.2500;0,0,i1\nX=-1.1000,-2.2500;0,0,i0\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n5-7=1,0\n7-8=1,0\n7-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n13-9=1,0\n13-6=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[phenylpyridine]]></Cell>\n<Cell id="3"><![CDATA[phpy]]></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(8,8)\nX=-0.8000,3.2500;0,0,i0\nO=-0.0500,1.9510;0,0,i0,xRESPATH:1:1\nC=1.4500,1.9510;0,0,i0,xRESPATH:1:2\nC=2.2000,3.2499;0,0,i1,xRESPATH:1:3\nC=1.4500,4.5491;0,0,i0,xRESPATH:1:4\nO=-0.0500,4.5491;0,0,i0,xRESPATH:1:5\nC=2.2001,5.8481;0,0,i3\nC=2.1999,0.6519;0,0,i3\n2-3=2,0\n2-1=0,0\n3-4=1,0\n4-5=2,0\n5-6=1,0\n6-1=1,0\n5-7=1,0\n3-8=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[acetylacetonate]]></Cell>\n<Cell id="3"><![CDATA[acac]]></Cell>\n</Row>\n<Row id="4">\n<Cell id="1"><![CDATA[SketchEl!(5,5)\nX=-3.2985,-1.8750;0,0,i0\nC=0.4506,-1.8500;0,0,i3\nC=-1.0494,-1.8500;0,0,i0,xRESPATH:1:2\nO=-1.7995,-3.1491;0,0,i0,xRESPATH:1:1\nO=-1.7994,-0.5509;0,0,i0,xRESPATH:1:3\n2-3=1,0\n3-4=2,0\n3-5=1,0\n5-1=1,0\n4-1=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[acetate]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="5">\n<Cell id="1"><![CDATA[SketchEl!(15,18)\nC=2.7915,1.5000;0,0,i1\nC=4.0905,0.7500;0,0,i1\nC=1.4925,0.7500;0,0,i1\nC=4.0905,-0.7500;0,0,i0\nC=2.7915,-1.5000;0,0,i0\nN=1.4925,-0.7500;0,0,i0\nC=2.7915,-3.0000;0,0,i0\nC=4.0905,-3.7500;0,0,i0\nN=1.4925,-3.7500;0,0,i0\nC=4.0905,-5.2500;0,0,i1\nC=2.7915,-6.0000;0,0,i1\nC=1.4925,-5.2500;0,0,i1\nX=-1.1000,-2.2500;0,0,i0\nC=5.3896,-3.0000;0,0,i1\nC=5.3896,-1.5000;0,0,i1\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n5-7=1,0\n7-8=1,0\n7-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n13-9=0,0\n13-6=0,0\n8-14=1,0\n14-15=2,0\n15-4=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[phenanthroline]]></Cell>\n<Cell id="3"><![CDATA[phen]]></Cell>\n</Row>\n<Row id="6">\n<Cell id="1"><![CDATA[SketchEl!(5,5)\nX=-1.6500,0.6500;0,0,i0\nN=0.1300,-0.5600;0,0,i2\nC=1.5600,-0.1000;0,0,i2\nN=0.1300,1.8600;0,0,i2\nC=1.5600,1.4000;0,0,i2\n3-2=1,0\n2-1=0,0\n1-4=0,0\n4-5=1,0\n5-3=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[ethylenediamine]]></Cell>\n<Cell id="3"><![CDATA[en]]></Cell>\n</Row>\n<Row id="7">\n<Cell id="1"><![CDATA[SketchEl!(12,14)\nC=4.1514,2.1507;0,0,i1\nC=2.8524,2.9007;0,0,i1\nC=1.5534,2.1507;0,0,i1\nN=1.5534,0.6507;0,0,i0\nC=2.8524,-0.0993;0,0,i0\nC=4.1515,0.6507;0,0,i0\nC=5.4505,-0.0993;0,0,i1\nC=2.8524,-1.5993;0,0,i0\nC=4.1515,-2.3494;0,0,i1\nC=5.4505,-1.5994;0,0,i1\nO=1.5534,-2.3493;0,0,i0\nX=-0.1457,-0.9064;0,0,i0\n2-3=2,0\n2-1=1,0\n3-4=1,0\n4-5=2,0\n5-6=1,0\n6-1=2,0\n7-6=1,0\n5-8=1,0\n8-9=2,0\n9-10=1,0\n10-7=2,0\n8-11=1,0\n11-12=1,0\n12-4=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[oxyquinoline]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="8">\n<Cell id="1"><![CDATA[SketchEl!(29,33)\nX=-0.3660,-0.1210;0,0,i0\nP=1.8140,1.0890;0,0,i0\nC=3.2440,0.6290;0,0,i2\nP=1.8140,-1.3310;0,0,i0\nC=3.2440,-0.8710;0,0,i2\nC=1.0487,2.5150;0,0,i0\nC=2.8725,2.1519;0,0,i0\nC=1.0487,-2.7570;0,0,i0\nC=2.8725,-2.3939;0,0,i0\nC=4.3221,1.7667;0,0,i1\nC=2.4812,3.5999;0,0,i1\nC=5.3806,2.8295;0,0,i1\nC=4.9894,4.2776;0,0,i1\nC=3.5397,4.6628;0,0,i1\nC=1.8387,3.7901;0,0,i1\nC=-0.4505,2.5616;0,0,i1\nC=1.1294,5.1118;0,0,i1\nC=-0.3699,5.1584;0,0,i1\nC=-1.1598,3.8833;0,0,i1\nC=-0.4505,-2.8036;0,0,i1\nC=1.8387,-4.0321;0,0,i1\nC=-1.1598,-4.1253;0,0,i1\nC=-0.3699,-5.4004;0,0,i1\nC=1.1294,-5.3538;0,0,i1\nC=2.4812,-3.8419;0,0,i1\nC=4.3221,-2.0087;0,0,i1\nC=3.5397,-4.9048;0,0,i1\nC=4.9893,-4.5196;0,0,i1\nC=5.3806,-3.0716;0,0,i1\n3-2=1,0\n2-1=0,0\n1-4=0,0\n4-5=1,0\n5-3=1,0\n2-6=1,0\n2-7=1,0\n4-8=1,0\n4-9=1,0\n7-10=1,0\n7-11=2,0\n10-12=2,0\n12-13=1,0\n13-14=2,0\n14-11=1,0\n6-15=1,0\n6-16=2,0\n15-17=2,0\n17-18=1,0\n18-19=2,0\n19-16=1,0\n8-20=1,0\n8-21=2,0\n20-22=2,0\n22-23=1,0\n23-24=2,0\n24-21=1,0\n9-25=1,0\n9-26=2,0\n25-27=2,0\n27-28=1,0\n28-29=2,0\n29-26=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[ethylene bis(diphenylphosphine)]]></Cell>\n<Cell id="3"><![CDATA[dppe]]></Cell>\n</Row>\n<Row id="9">\n<Cell id="1"><![CDATA[SketchEl!(28,32)\nX=-0.3660,-0.1210;0,0,i0\nP=1.8140,1.0890;0,0,i0\nP=1.8140,-1.3310;0,0,i0\nC=1.0487,2.5150;0,0,i0\nC=2.8725,2.1519;0,0,i0\nC=1.0487,-2.7570;0,0,i0\nC=2.8725,-2.3939;0,0,i0\nC=4.3221,1.7667;0,0,i1\nC=2.4812,3.5999;0,0,i1\nC=5.3806,2.8295;0,0,i1\nC=4.9894,4.2776;0,0,i1\nC=3.5397,4.6628;0,0,i1\nC=1.8387,3.7901;0,0,i1\nC=-0.4505,2.5616;0,0,i1\nC=1.1294,5.1118;0,0,i1\nC=-0.3699,5.1584;0,0,i1\nC=-1.1598,3.8833;0,0,i1\nC=-0.4505,-2.8036;0,0,i1\nC=1.8387,-4.0321;0,0,i1\nC=-1.1598,-4.1253;0,0,i1\nC=-0.3699,-5.4004;0,0,i1\nC=1.1294,-5.3538;0,0,i1\nC=2.4812,-3.8419;0,0,i1\nC=4.3221,-2.0087;0,0,i1\nC=3.5397,-4.9048;0,0,i1\nC=4.9893,-4.5196;0,0,i1\nC=5.3806,-3.0716;0,0,i1\nC=3.5430,-0.1210;0,0,i2\n2-1=0,0\n1-3=0,0\n2-4=1,0\n2-5=1,0\n3-6=1,0\n3-7=1,0\n5-8=1,0\n5-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n4-13=1,0\n4-14=2,0\n13-15=2,0\n15-16=1,0\n16-17=2,0\n17-14=1,0\n6-18=1,0\n6-19=2,0\n18-20=2,0\n20-21=1,0\n21-22=2,0\n22-19=1,0\n7-23=1,0\n7-24=2,0\n23-25=2,0\n25-26=1,0\n26-27=2,0\n27-24=1,0\n2-28=1,0\n3-28=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[methylene bis(diphenylphonsphine)]]></Cell>\n<Cell id="3"><![CDATA[dppm]]></Cell>\n</Row>\n<Row id="10">\n<Cell id="1"><![CDATA[SketchEl!(9,10)\nX=-3.3500,-0.0500;0,0,i0\nO=-1.6700,-1.2600;0,0,i0\nC=-0.2400,-0.8000;0,0,i0\nO=-1.6700,1.1600;0,0,i0\nC=-0.2400,0.7000;0,0,i0\nC=1.0590,1.4499;0,0,i1\nC=1.0590,-1.5500;0,0,i1\nC=2.3581,-0.8000;0,0,i1\nC=2.3581,0.6999;0,0,i1\n3-2=1,0\n2-1=1,0\n1-4=1,0\n4-5=1,0\n5-3=1,0\n5-6=2,0\n3-7=2,0\n7-8=1,0\n8-9=2,0\n9-6=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[catecholate]]></Cell>\n<Cell id="3"><![CDATA[cat]]></Cell>\n</Row>\n<Row id="11">\n<Cell id="1"><![CDATA[SketchEl!(9,8)\nX=-2.9010,4.6990;0,0,i0\nO=-1.4010,4.6990;0,0,i0\nC=0.0990,4.6990;0,0,i1\nC=0.8490,5.9981;0,0,i3\nC=0.8490,3.4000;0,0,i2\nC=0.0990,2.1010;0,0,i1\nO=-1.4010,2.1010;0,0,i0\nC=0.8490,0.8019;0,0,i3\nX=-2.9010,2.1009;0,0,i0\n1-2=1,0\n2-3=1,0\n3-4=1,0\n3-5=1,0\n5-6=1,0\n6-7=1,0\n6-8=1,0\n7-9=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[bridging acac]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n</Content>\n</DataSheet>\n',ligtrident:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Tridentate Ligands</Title>\n<Description><![CDATA[]]></Description>\n</Summary>\n<Header nrows="3" ncols="3">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Optional abbreviation</Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(19,23)\nC=2.9998,2.0011;0,0,i1\nC=4.4998,2.0011;0,0,i1\nC=2.2498,0.7021;0,0,i1\nC=5.2498,0.7021;0,0,i1\nC=4.4998,-0.5969;0,0,i0\nN=2.9998,-0.5969;0,0,i0\nC=5.2498,-1.8960;0,0,i0\nC=6.7498,-1.8960;0,0,i1\nN=4.4998,-3.1950;0,0,i0\nC=7.4998,-3.1950;0,0,i1\nC=6.7498,-4.4940;0,0,i1\nC=5.2498,-4.4940;0,0,i0\nC=4.4999,-5.7930;0,0,i0\nN=2.9999,-5.7930;0,0,i0\nC=5.2499,-7.0921;0,0,i1\nC=2.2498,-7.0921;0,0,i1\nC=2.9998,-8.3911;0,0,i1\nC=4.4998,-8.3912;0,0,i1\nX=1.4998,-3.1950;0,0,i0\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n5-7=1,0\n7-8=1,0\n7-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n12-13=1,0\n13-14=1,0\n13-15=2,0\n14-16=2,0\n16-17=1,0\n17-18=2,0\n18-15=1,0\n6-19=0,0\n9-19=0,0\n14-19=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[terpyridine]]></Cell>\n<Cell id="3"><![CDATA[terpy]]></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(4,5)\nX=-7.0728,1.0229;0,0,i0,xARENE:1:1\nC=-5.3624,2.3410;0,0,i2,xARENE:1:2\nC=-4.5676,1.0688;0,0,i1,xARENE:1:3\nC=-5.2718,-0.2556;0,0,i2,xARENE:1:4\n2-3=2,0\n3-4=1,0\n1-4=1,0\n1-3=0,0\n1-2=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[allyl]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(8,9)\nC=3.6861,-1.8600;0,0,i2\nN=2.1861,-1.8600;0,0,i2\nC=4.4361,-3.1590;0,0,i2\nN=3.6861,-4.4580;0,0,i1\nC=4.4361,-5.7571;0,0,i2\nC=3.6861,-7.0561;0,0,i2\nN=2.1862,-7.0561;0,0,i2\nX=0.6861,-4.4580;0,0,i0\n1-2=1,0\n1-3=1,0\n3-4=1,0\n5-4=1,0\n5-6=1,0\n6-7=1,0\n2-8=0,0\n4-8=0,0\n7-8=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[diethylaminetriamine]]></Cell>\n<Cell id="3"><![CDATA[dien]]></Cell>\n</Row>\n</Content>\n</DataSheet>\n',ligmultident:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Multidentate Ligands</Title>\n<Description><![CDATA[]]></Description>\n</Summary>\n<Header nrows="5" ncols="3">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Optional abbreviation</Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(9,12)\nX=3.7990,0.0000;0,0,i0,xARENE:2:1,xARENE:1:1\nC=5.6500,-0.1000;0,0,i1,xARENE:2:2\nC=5.1000,-2.3000;0,0,i1,xARENE:1:3\nC=5.6500,2.4000;0,0,i1,xARENE:2:3\nC=5.1000,0.2000;0,0,i1,xARENE:1:2\nC=7.0319,1.5176;0,0,i2\nC=7.5819,3.0176;0,0,i2\nC=7.5819,-1.0824;0,0,i2\nC=7.0319,-2.5824;0,0,i2\n2-4=2,0\n3-5=2,0\n5-6=1,0\n4-7=1,0\n2-8=1,0\n3-9=1,0\n6-7=1,0\n9-8=1,0\n1-3=0,0\n1-5=0,0\n1-4=0,0\n1-2=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclooctadiene]]></Cell>\n<Cell id="3"><![CDATA[COD]]></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(8,12)\nX=3.7990,0.0000;0,0,i0,xARENE:2:1,xARENE:1:1\nC=5.8000,0.0500;0,0,i1\nC=7.1000,1.2500;0,0,i1\nC=4.7000,1.7651;0,0,i1,xARENE:1:2\nC=6.3000,2.4651;0,0,i1,xARENE:1:3\nC=5.5500,-2.0000;0,0,i1,xARENE:2:2\nC=6.8500,-0.8000;0,0,i1,xARENE:2:3\nC=8.5000,0.6500;0,0,i2\n2-4=1,0\n3-5=1,0\n2-6=1,0\n3-7=1,0\n6-7=2,0\n2-8=1,0\n8-3=1,0\n4-5=2,0\n1-4=0,0\n1-5=0,0\n1-6=0,0\n1-7=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[norbornadiene]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(6,10)\nC=0.2150,2.1200;0,0,i1,xARENE:1:2\nC=-1.0950,3.1700;0,0,i1,xARENE:1:4\nC=-0.1650,3.6300;0,0,i1,xARENE:1:3\nC=-0.1650,0.6100;0,0,i1,xARENE:1:6\nC=-1.0950,1.0700;0,0,i1,xARENE:1:5\nX=-2.2110,2.0800;0,0,i0,xARENE:1:1\n2-3=2,0\n3-1=1,0\n1-4=1,0\n4-5=2,0\n5-2=1,0\n6-1=1,0\n3-6=0,0\n4-6=0,0\n5-6=0,0\n2-6=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cyclopentadienyl]]></Cell>\n<Cell id="3"><![CDATA[Cp]]></Cell>\n</Row>\n<Row id="4">\n<Cell id="1"><![CDATA[SketchEl!(7,12)\nC=0.7490,6.7000;0,0,i1,xARENE:1:2\nC=0.2000,5.9500;0,0,i1,xARENE:1:3\nC=1.2981,6.0500;0,0,i1,xARENE:1:7\nC=0.2000,4.4500;0,0,i1,xARENE:1:4\nC=0.7490,3.7000;0,0,i1,xARENE:1:5\nC=1.2981,4.3500;0,0,i1,xARENE:1:6\nX=-1.3490,5.2000;0,0,i0,xARENE:1:1\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n2-7=0,0\n4-7=0,0\n7-1=0,0\n7-5=0,0\n7-6=0,0\n7-3=0,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[arene]]></Cell>\n<Cell id="3"></Cell>\n</Row>\n<Row id="5">\n<Cell id="1"><![CDATA[SketchEl!(11,15)\nX=0.0000,0.0000;0,0,i0,xARENE:1:1\nC=2.9263,-0.0154;0,0,i0,xARENE:1:2\nC=1.5927,-1.0352;0,0,i0,xARENE:1:4\nC=2.5119,-1.5163;0,0,i0,xARENE:1:3\nC=2.5809,1.5029;0,0,i0,xARENE:1:6\nC=1.6407,1.0642;0,0,i0,xARENE:1:5\nC=3.7728,-0.0348;0,0,i3\nC=2.8692,2.9749;0,0,i3\nC=0.9137,2.3762;0,0,i3\nC=0.8354,-2.3300;0,0,i3\nC=2.7329,-3.0000;0,0,i3\n3-4=2,0\n4-2=1,0\n2-5=1,0\n5-6=2,0\n6-3=1,0\n1-2=1,0\n4-1=0,0\n5-1=0,0\n6-1=0,0\n3-1=0,0\n2-7=1,0\n5-8=1,0\n6-9=1,0\n3-10=1,0\n4-11=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[pentamethylcyclopentadienyl]]></Cell>\n<Cell id="3"><![CDATA[Cp*]]></Cell>\n</Row>\n</Content>\n</DataSheet>\n',cagecmplx:'<DataSheet><Summary><Title>Cage Complexes</Title><Description><![CDATA[]]></Description></Summary><Extension/><Header nrows="8" ncols="3"><Column id="1" name="Molecule" type="molecule">Molecular structure</Column><Column id="2" name="Name" type="string">Template name</Column><Column id="3" name="Abbrev" type="string">Optional abbreviation</Column></Header><Content><Row id="1"><Cell id="1"><![CDATA[SketchEl!(21,25)\nM=-0.6000,2.4500;0,0,i0\nN=-1.3500,3.7490;0,0,i0\nO=0.1500,1.1510;0,0,i0\nO=0.9000,2.4500;0,0,i0\nO=-2.1000,2.4500;0,0,i0\nO=-1.3500,1.1510;0,0,i0\nN=0.1500,3.7490;0,0,i0\nC=-0.9618,5.1979;0,0,i2\nC=-0.2382,5.1979;0,0,i2\nC=-2.7989,4.1373;0,0,i2\nC=-3.3990,3.2000;0,0,i0\nC=2.1990,3.2000;0,0,i0\nC=1.5989,4.1373;0,0,i2\nC=-3.0821,2.1510;0,0,i0\nC=1.8821,2.1510;0,0,i0\nC=1.4938,3.5999;0,0,i2\nC=-2.6938,3.5999;0,0,i2\nO=3.2679,1.5769;0,0,i0\nO=3.6975,3.2689;0,0,i0\nO=-4.4679,1.5769;0,0,i0\nO=-4.8975,3.2689;0,0,i0\n1-2=0,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n1-6=1,0\n1-7=0,0\n2-8=1,0\n7-9=1,0\n8-9=1,0\n2-10=1,0\n5-11=1,0\n4-12=1,0\n7-13=1,0\n12-13=1,0\n11-10=1,0\n6-14=1,0\n3-15=1,0\n15-16=1,0\n14-17=1,0\n17-2=1,0\n16-7=1,0\n15-18=2,0\n12-19=2,0\n14-20=2,0\n11-21=2,0\n!End\n]]></Cell><Cell id="2"><![CDATA[EDTA]]></Cell><Cell id="3"/></Row><Row id="2"><Cell id="1"><![CDATA[SketchEl!(25,32)\nM=-0.3000,1.2000;0,0,i0\nN=-1.7142,2.6142;0,0,i0\nN=1.1142,2.6142;0,0,i0\nN=1.1142,-0.2142;0,0,i0\nN=-1.7142,-0.2142;0,0,i0\nC=-3.1921,0.0191;0,0,i0\nC=-3.8780,-1.3173;0,0,i1\nC=-1.4809,-1.6921;0,0,i0\nC=-2.8173,-2.3780;0,0,i1\nC=-1.4809,4.0921;0,0,i0\nC=-2.8173,4.7780;0,0,i1\nC=-3.1921,2.3809;0,0,i0\nC=-3.8780,3.7173;0,0,i1\nC=2.5921,2.3809;0,0,i0\nC=3.2780,3.7173;0,0,i1\nC=0.8809,4.0921;0,0,i0\nC=2.2173,4.7780;0,0,i1\nC=0.8809,-1.6921;0,0,i0\nC=2.2173,-2.3780;0,0,i1\nC=2.5921,0.0191;0,0,i0\nC=3.2780,-1.3173;0,0,i1\nC=-3.8714,1.2000;0,0,i1\nC=-0.3000,4.7714;0,0,i1\nC=3.2714,1.2000;0,0,i1\nC=-0.3000,-2.3714;0,0,i1\n1-2=1,0\n1-3=0,0\n1-4=1,0\n1-5=0,0\n7-6=1,0\n6-5=1,0\n5-8=2,0\n8-9=1,0\n9-7=2,0\n11-10=2,0\n10-2=1,0\n2-12=1,0\n12-13=2,0\n13-11=1,0\n15-14=1,0\n14-3=2,0\n3-16=1,0\n16-17=1,0\n17-15=2,0\n19-18=1,0\n18-4=1,0\n4-20=1,0\n20-21=1,0\n21-19=2,0\n6-22=2,0\n10-23=1,0\n14-24=1,0\n18-25=2,0\n22-12=1,0\n23-16=2,0\n24-20=2,0\n25-8=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[porphyrin]]></Cell><Cell id="3"/></Row><Row id="3"><Cell id="1"><![CDATA[SketchEl!(25,32)\nM=1.5000,0.0000;0,0,i0\nN=2.9117,1.4117;0,0,i0\nN=0.0882,-1.4117;0,0,i0\nN=2.9117,-1.4117;0,0,i0\nN=0.0882,1.4117;0,0,i0\nC=-2.0755,-2.5147;0,0,i1\nC=-1.3895,-1.1783;0,0,i0\nC=0.3215,-2.8895;0,0,i0\nC=-1.0148,-3.5754;0,0,i1\nC=5.0755,2.5147;0,0,i1\nC=4.3895,1.1783;0,0,i0\nC=2.6784,2.8895;0,0,i0\nC=4.0148,3.5754;0,0,i1\nC=-1.0148,3.5754;0,0,i1\nC=0.3216,2.8895;0,0,i0\nC=-1.3895,1.1783;0,0,i0\nC=-2.0754,2.5148;0,0,i1\nC=4.0148,-3.5754;0,0,i1\nC=2.6783,-2.8895;0,0,i0\nC=4.3895,-1.1783;0,0,i0\nC=5.0754,-2.5148;0,0,i1\nN=-1.9510,-0.0731;0,0,i0\nN=1.4268,3.4510;0,0,i0\nN=4.9510,0.0731;0,0,i0\nN=1.5731,-3.4510;0,0,i0\n1-2=0,0\n1-3=0,0\n1-4=0,0\n1-5=0,0\n6-7=1,0\n7-3=2,0\n3-8=1,0\n8-9=1,0\n9-6=2,0\n10-11=1,0\n11-2=2,0\n2-12=1,0\n12-13=1,0\n13-10=2,0\n14-15=1,0\n15-5=2,0\n5-16=1,0\n16-17=1,0\n17-14=2,0\n18-19=1,0\n19-4=2,0\n4-20=1,0\n20-21=1,0\n21-18=2,0\n7-22=1,0\n15-23=1,0\n11-24=1,0\n19-25=1,0\n8-25=2,0\n16-22=2,0\n12-23=2,0\n20-24=2,0\n!End\n]]></Cell><Cell id="2"><![CDATA[porphyrinoid]]></Cell><Cell id="3"/></Row><Row id="4"><Cell id="1"><![CDATA[SketchEl!(11,20)\nM=12.1738,-1.7111;0,0,i0,xARENE:1:1,xARENE:2:1\nC=13.1284,-0.5301;0,0,i1,xARENE:1:2\nC=11.2193,-0.5301;0,0,i1,xARENE:1:3\nC=11.2193,-2.8920;0,0,i1,xARENE:2:2\nC=13.1284,-2.8920;0,0,i1,xARENE:2:3\nC=10.8390,-3.7589;0,0,i1,xARENE:2:6\nC=12.1738,-4.1749;0,0,i1,xARENE:2:5\nC=13.5087,-3.7589;0,0,i1,xARENE:2:4\nC=13.5087,0.3368;0,0,i1,xARENE:1:6\nC=12.1738,0.7528;0,0,i1,xARENE:1:5\nC=10.8390,0.3368;0,0,i1,xARENE:1:4\n2-3=1,0\n4-5=1,0\n4-6=2,0\n6-7=1,0\n7-8=1,0\n8-5=2,0\n2-9=2,0\n9-10=1,0\n10-11=1,0\n11-3=2,0\n10-1=1,0\n7-1=1,0\n8-1=0,0\n5-1=0,0\n4-1=0,0\n6-1=0,0\n3-1=0,0\n2-1=0,0\n9-1=0,0\n11-1=0,0\n!End\n]]></Cell><Cell id="2"><![CDATA[metallocene]]></Cell><Cell id="3"/></Row><Row id="5"><Cell id="1"><![CDATA[SketchEl!(37,45)\nM=1.5000,0.0000;0,0,i0\nC=5.3914,3.7500;0,0,i1\nC=6.6904,3.0000;0,0,i1\nC=4.0924,3.0000;0,0,i1\nC=6.6904,1.5000;0,0,i1\nC=5.3914,0.7500;0,0,i0\nN=4.0924,1.5000;0,0,i0\nC=5.3914,-0.7500;0,0,i0\nC=6.6904,-1.5000;0,0,i1\nN=4.0924,-1.5000;0,0,i0\nC=6.6904,-3.0000;0,0,i1\nC=5.3914,-3.7500;0,0,i1\nC=4.0924,-3.0000;0,0,i1\nC=-3.6940,1.4927;0,0,i1\nC=-3.6946,2.9927;0,0,i1\nC=-2.3946,0.7433;0,0,i1\nC=-2.3959,3.7433;0,0,i1\nC=-1.0966,2.9939;0,0,i0\nN=-1.0959,1.4939;0,0,i0\nC=0.2020,3.7445;0,0,i0\nC=0.2013,5.2445;0,0,i1\nN=1.5014,2.9951;0,0,i0\nC=1.5000,5.9951;0,0,i1\nC=2.7994,5.2457;0,0,i1\nC=2.8001,3.7457;0,0,i1\nC=2.8030,-5.2448;0,0,i1\nC=1.5041,-5.9951;0,0,i1\nC=2.8026,-3.7448;0,0,i1\nC=0.2049,-5.2453;0,0,i1\nC=0.2046,-3.7454;0,0,i0\nN=1.5034,-2.9951;0,0,i0\nC=-1.0945,-2.9957;0,0,i0\nC=-2.3934,-3.7459;0,0,i1\nN=-1.0949,-1.4957;0,0,i0\nC=-3.6926,-2.9962;0,0,i1\nC=-3.6930,-1.4963;0,0,i1\nC=-2.3941,-0.7460;0,0,i1\n2-3=1,0\n2-4=2,0\n3-5=2,0\n5-6=1,0\n6-7=2,0\n7-4=1,0\n6-8=1,0\n8-9=1,0\n8-10=2,0\n9-11=2,0\n11-12=1,0\n12-13=2,0\n13-10=1,0\n1-10=0,0\n1-7=0,0\n14-15=1,0\n14-16=2,0\n15-17=2,0\n17-18=1,0\n18-19=2,0\n19-16=1,0\n18-20=1,0\n20-21=1,0\n20-22=2,0\n21-23=2,0\n23-24=1,0\n24-25=2,0\n25-22=1,0\n1-22=0,0\n1-19=0,0\n26-27=1,0\n26-28=2,0\n27-29=2,0\n29-30=1,0\n30-31=2,0\n31-28=1,0\n30-32=1,0\n32-33=1,0\n32-34=2,0\n33-35=2,0\n35-36=1,0\n36-37=2,0\n37-34=1,0\n1-34=0,0\n1-31=0,0\n!End\n]]></Cell><Cell id="2"><![CDATA[tris-bipy]]></Cell><Cell id="3"/></Row><Row id="6"><Cell id="1"><![CDATA[SketchEl!(15,18)\nN=0.0000,0.0000;0,0,i1\nC=-1.5000,0.0000;0,0,i2\nC=-2.2500,-1.2990;0,0,i2\nC=-1.5000,-2.5981;0,0,i2\nN=-0.0000,-2.5981;0,0,i1\nC=0.7500,1.2990;0,0,i2\nC=2.2500,1.2990;0,0,i2\nN=3.0000,-0.0000;0,0,i1\nC=4.5000,-0.0000;0,0,i2\nC=5.2500,-1.2990;0,0,i2\nC=4.5000,-2.5981;0,0,i2\nN=3.0000,-2.5981;0,0,i1\nC=0.7500,-3.8971;0,0,i2\nC=2.2500,-3.8971;0,0,i2\nM=1.5000,-1.3000;0,0,i0\n1-2=1,0\n2-3=1,0\n3-4=1,0\n4-5=1,0\n1-6=1,0\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n10-11=1,0\n11-12=1,0\n5-13=1,0\n12-14=1,0\n14-13=1,0\n1-15=0,0\n15-12=0,0\n5-15=0,0\n15-8=0,0\n!End\n]]></Cell><Cell id="2"><![CDATA[tren]]></Cell><Cell id="3"/></Row><Row id="7"><Cell id="1"><![CDATA[SketchEl!(11,13)\nM=1.4999,0.0000;0,0,i0\nN=1.4999,1.5000;0,0,i2\nN=1.4999,-1.5000;0,0,i2\nN=0.2009,0.7500;0,0,i2\nN=0.2009,-0.7500;0,0,i0\nC=0.4393,-2.5606;0,0,i2\nC=-1.2479,-0.3617;0,0,i2\nC=-0.1872,-2.1988;0,0,i2\nC=-1.2479,0.3617;0,0,i2\nC=0.0511,1.8882;0,0,i2\nC=-0.7973,0.9790;0,0,i2\n1-2=0,0\n1-3=0,0\n1-4=0,0\n1-5=0,0\n3-6=1,0\n5-7=1,0\n5-8=1,0\n4-9=1,0\n7-9=1,0\n6-8=1,0\n2-10=1,0\n5-11=1,0\n10-11=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[N4]]></Cell><Cell id="3"/></Row><Row id="8"><Cell id="1"><![CDATA[SketchEl!(21,27)\nN=3.2639,-1.3522;0,0,i1\nC=1.8122,-0.7585;0,0,i2\nC=1.8056,0.7411;0,0,i2\nN=3.2521,1.3475;0,0,i1\nN=5.9520,1.3594;0,0,i1\nC=7.4037,0.7657;0,0,i2\nC=7.4103,-0.7339;0,0,i2\nN=5.9639,-1.3403;0,0,i1\nC=3.2705,-2.8521;0,0,i2\nC=5.9705,-2.8402;0,0,i2\nC=5.9454,2.8594;0,0,i2\nC=3.2455,2.8475;0,0,i2\nC=4.6431,3.6036;0,0,i1\nC=4.5728,-3.5963;0,0,i1\nM=4.6052,-0.0128;0,0,i0\nN=4.5994,1.4890;0,0,i1\nN=4.6133,-1.5126;0,0,i1\nC=4.1980,2.5347;0,0,i2\nC=4.2120,-2.5583;0,0,i2\nC=2.8657,-0.6612;0,0,i2\nC=2.8489,0.6376;0,0,i2\n1-2=1,0\n2-3=1,0\n3-4=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n1-9=1,0\n8-10=1,0\n5-11=1,0\n4-12=1,0\n11-13=1,0\n13-12=1,0\n9-14=1,0\n14-10=1,0\n1-15=0,0\n4-15=0,0\n8-15=0,0\n5-15=0,0\n15-16=0,0\n15-17=0,0\n16-18=1,0\n13-18=1,0\n17-19=1,0\n19-14=1,0\n17-20=1,0\n16-21=1,0\n21-20=1,0\n!End\n]]></Cell><Cell id="2"><![CDATA[N6]]></Cell><Cell id="3"/></Row></Content></DataSheet>',aminoacids:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n<Summary>\n<Title>Amino Acids</Title><Description><![CDATA[]]></Description></Summary>\n<Header nrows="20" ncols="4">\n<Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n<Column name="Name" type="string" id="2">Template name</Column>\n<Column name="Abbrev" type="string" id="3">Abbreviation code</Column>\n<Column name="Mnemonic" type="string" id="4"></Column>\n</Header>\n<Content>\n<Row id="1">\n<Cell id="1"><![CDATA[SketchEl!(7,6)\nC=-6.5731,8.0000;0,0,i0\nO=-6.5731,9.5000;0,0,i0\nC=-7.8721,7.2500;0,0,i1\nX=-5.2741,7.2500;0,0,i0\nN=-9.1712,8.0000;0,0,i1\nC=-7.8721,5.7500;0,0,i3\nX=-10.4702,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n5-7=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[alanine]]></Cell>\n<Cell id="3"><![CDATA[Ala]]></Cell>\n<Cell id="4"><![CDATA[A]]></Cell>\n</Row>\n<Row id="2">\n<Cell id="1"><![CDATA[SketchEl!(8,7)\nC=-6.8514,8.0000;0,0,i0\nO=-6.8514,9.5000;0,0,i0\nC=-8.1504,7.2500;0,0,i1\nX=-5.5524,7.2500;0,0,i0\nN=-9.4495,8.0000;0,0,i1\nC=-8.1504,5.7500;0,0,i2\nS=-6.8515,5.0000;0,0,i1\nX=-10.7485,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n5-8=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[cysteine]]></Cell>\n<Cell id="3"><![CDATA[Cys]]></Cell>\n<Cell id="4"><![CDATA[C]]></Cell>\n</Row>\n<Row id="3">\n<Cell id="1"><![CDATA[SketchEl!(10,9)\nC=-7.5010,8.0000;0,0,i0\nO=-7.5010,9.5000;0,0,i0\nC=-8.8000,7.2500;0,0,i1\nX=-6.2020,7.2500;0,0,i0\nN=-10.0991,8.0000;0,0,i1\nC=-8.8000,5.7500;0,0,i2\nC=-7.5010,5.0000;0,0,i0\nO=-7.5009,3.5000;-1,0,i0\nO=-6.2020,5.7499;0,0,i0\nX=-11.3981,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n7-9=2,0\n5-10=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[aspartic acid]]></Cell>\n<Cell id="3"><![CDATA[Asp]]></Cell>\n<Cell id="4"><![CDATA[D]]></Cell>\n</Row>\n<Row id="4">\n<Cell id="1"><![CDATA[SketchEl!(11,10)\nC=-7.3830,8.0000;0,0,i0\nO=-7.3830,9.5000;0,0,i0\nC=-8.6820,7.2500;0,0,i1\nX=-6.0840,7.2500;0,0,i0\nN=-9.9811,8.0000;0,0,i1\nC=-8.6820,5.7500;0,0,i2\nC=-7.3830,5.0000;0,0,i2\nC=-7.3828,3.5000;0,0,i0\nO=-6.0838,2.7500;-1,0,i0\nO=-8.6819,2.7500;0,0,i0\nX=-11.2801,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n8-9=1,0\n8-10=2,0\n5-11=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[glutamic acid]]></Cell>\n<Cell id="3"><![CDATA[Glu]]></Cell>\n<Cell id="4"><![CDATA[E]]></Cell>\n</Row>\n<Row id="5">\n<Cell id="1"><![CDATA[SketchEl!(13,13)\nC=-8.8000,8.0000;0,0,i0\nO=-8.8000,9.5000;0,0,i0\nC=-10.0990,7.2500;0,0,i1\nX=-7.5010,7.2500;0,0,i0\nN=-11.3981,8.0000;0,0,i1\nC=-10.0990,5.7500;0,0,i2\nC=-8.8000,5.0000;0,0,i0\nC=-8.8000,3.5000;0,0,i1\nC=-7.5010,5.7500;0,0,i1\nC=-7.5010,2.7500;0,0,i1\nC=-6.2019,3.5000;0,0,i1\nC=-6.2019,5.0000;0,0,i1\nX=-12.6971,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n7-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n5-13=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[phenylalanine]]></Cell>\n<Cell id="3"><![CDATA[Phe]]></Cell>\n<Cell id="4"><![CDATA[F]]></Cell>\n</Row>\n<Row id="6">\n<Cell id="1"><![CDATA[SketchEl!(6,5)\nC=-6.6349,8.0000;0,0,i0\nO=-6.6349,9.5000;0,0,i0\nC=-7.9339,7.2500;0,0,i2\nX=-5.3359,7.2500;0,0,i0\nN=-9.2330,8.0000;0,0,i1\nX=-10.5320,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n5-6=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[glycine]]></Cell>\n<Cell id="3"><![CDATA[Gly]]></Cell>\n<Cell id="4"><![CDATA[G]]></Cell>\n</Row>\n<Row id="7">\n<Cell id="1"><![CDATA[SketchEl!(12,12)\nC=-8.4232,8.0000;0,0,i0\nO=-8.4232,9.5000;0,0,i0\nC=-9.7222,7.2500;0,0,i1\nX=-7.1242,7.2500;0,0,i0\nN=-11.0213,8.0000;0,0,i1\nC=-9.7222,5.7500;0,0,i2\nC=-8.4232,5.0000;0,0,i0\nC=-6.0475,4.4955;0,0,i1\nN=-6.7961,3.2002;0,0,i1\nC=-8.2664,3.5081;0,0,i1\nN=-7.0492,5.6069;0,0,i0\nX=-12.3203,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n10-9=1,0\n9-8=1,0\n8-11=2,0\n11-7=1,0\n7-10=2,0\n5-12=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[histidine]]></Cell>\n<Cell id="3"><![CDATA[His]]></Cell>\n<Cell id="4"><![CDATA[H]]></Cell>\n</Row>\n<Row id="8">\n<Cell id="1"><![CDATA[SketchEl!(10,9)\nC=-6.7216,8.0000;0,0,i0\nO=-6.7216,9.5000;0,0,i0\nC=-8.0206,7.2500;0,0,i1\nX=-5.4226,7.2500;0,0,i0\nN=-9.3197,8.0000;0,0,i1\nC=-8.0206,5.7500;0,0,i1\nC=-6.7216,5.0000;0,0,i2\nC=-9.3196,5.0000;0,0,i3\nC=-6.7214,3.5000;0,0,i3\nX=-10.6187,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n6-8=1,0\n7-9=1,0\n5-10=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[isoleucine]]></Cell>\n<Cell id="3"><![CDATA[Ile]]></Cell>\n<Cell id="4"><![CDATA[I]]></Cell>\n</Row>\n<Row id="9">\n<Cell id="1"><![CDATA[SketchEl!(11,10)\nC=-7.8553,8.0000;0,0,i0\nO=-7.8553,9.5000;0,0,i0\nC=-9.1543,7.2500;0,0,i1\nX=-6.5563,7.2500;0,0,i0\nN=-10.4534,8.0000;0,0,i1\nC=-9.1543,5.7500;0,0,i2\nC=-7.8553,5.0000;0,0,i2\nC=-7.8552,3.5000;0,0,i2\nC=-6.5561,2.7500;0,0,i2\nN=-6.5561,1.2500;1,0,i3\nX=-11.7524,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n5-11=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[lysine]]></Cell>\n<Cell id="3"><![CDATA[Lys]]></Cell>\n<Cell id="4"><![CDATA[K]]></Cell>\n</Row>\n<Row id="10">\n<Cell id="1"><![CDATA[SketchEl!(10,9)\nC=-7.5010,8.0000;0,0,i0\nO=-7.5010,9.5000;0,0,i0\nC=-8.8000,7.2500;0,0,i1\nX=-6.2020,7.2500;0,0,i0\nN=-10.0991,8.0000;0,0,i1\nC=-8.8000,5.7500;0,0,i2\nC=-7.5010,5.0000;0,0,i1\nC=-7.5008,3.5000;0,0,i3\nC=-6.2019,5.7500;0,0,i3\nX=-11.3981,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n7-9=1,0\n5-10=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[leucine]]></Cell>\n<Cell id="3"><![CDATA[Leu]]></Cell>\n<Cell id="4"><![CDATA[L]]></Cell>\n</Row>\n<Row id="11">\n<Cell id="1"><![CDATA[SketchEl!(10,9)\nC=-7.5010,8.0000;0,0,i0\nO=-7.5010,9.5000;0,0,i0\nC=-8.8000,7.2500;0,0,i1\nX=-6.2020,7.2500;0,0,i0\nN=-10.0991,8.0000;0,0,i1\nC=-8.8000,5.7500;0,0,i2\nC=-7.5010,5.0000;0,0,i2\nS=-7.5008,3.5000;0,0,i0\nC=-6.2018,2.7500;0,0,i3\nX=-11.3981,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n8-9=1,0\n5-10=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[methionine]]></Cell>\n<Cell id="3"><![CDATA[Met]]></Cell>\n<Cell id="4"><![CDATA[M]]></Cell>\n</Row>\n<Row id="12">\n<Cell id="1"><![CDATA[SketchEl!(10,9)\nC=-7.5010,8.0000;0,0,i0\nO=-7.5010,9.5000;0,0,i0\nC=-8.8000,7.2500;0,0,i1\nX=-6.2020,7.2500;0,0,i0\nN=-10.0991,8.0000;0,0,i1\nC=-8.8000,5.7500;0,0,i2\nC=-7.5010,5.0000;0,0,i0\nN=-7.5008,3.5000;0,0,i2\nO=-6.2019,5.7500;0,0,i0\nX=-11.3981,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n7-9=2,0\n5-10=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[asparagine]]></Cell>\n<Cell id="3"><![CDATA[Asn]]></Cell>\n<Cell id="4"><![CDATA[N]]></Cell>\n</Row>\n<Row id="13">\n<Cell id="1"><![CDATA[SketchEl!(9,9)\nC=-5.7561,8.0000;0,0,i0\nO=-5.7561,9.5000;0,0,i0\nC=-7.0551,7.2500;0,0,i1\nX=-4.4571,7.2500;0,0,i0\nC=-7.2122,5.7621;0,0,i2\nC=-8.6806,5.4455;0,0,i2\nN=-8.4222,7.8579;0,0,i0\nC=-9.4306,6.7446;0,0,i2\nX=-8.7323,9.3255;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n6-5=1,0\n3-5=1,2\n3-7=1,0\n7-8=1,0\n8-6=1,0\n7-9=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[proline]]></Cell>\n<Cell id="3"><![CDATA[Pro]]></Cell>\n<Cell id="4"><![CDATA[P]]></Cell>\n</Row>\n<Row id="14">\n<Cell id="1"><![CDATA[SketchEl!(11,10)\nC=-7.3829,8.0000;0,0,i0\nO=-7.3829,9.5000;0,0,i0\nC=-8.6819,7.2500;0,0,i1\nX=-6.0839,7.2500;0,0,i0\nN=-9.9810,8.0000;0,0,i1\nC=-8.6819,5.7500;0,0,i2\nC=-7.3829,5.0000;0,0,i2\nC=-7.3828,3.5000;0,0,i0\nN=-6.0837,2.7500;0,0,i2\nO=-8.6818,2.7500;0,0,i0\nX=-11.2800,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n8-9=1,0\n8-10=2,0\n5-11=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[glutamine]]></Cell>\n<Cell id="3"><![CDATA[Gln]]></Cell>\n<Cell id="4"><![CDATA[Q]]></Cell>\n</Row>\n<Row id="15">\n<Cell id="1"><![CDATA[SketchEl!(13,12)\nC=-11.2850,5.8016;0,0,i0\nO=-11.2850,7.3016;0,0,i0\nC=-12.5840,5.0517;0,0,i1\nX=-9.9860,5.0516;0,0,i0\nN=-13.8830,5.8017;0,0,i1\nC=-12.5840,3.5516;0,0,i2\nC=-11.2849,2.8015;0,0,i2\nC=-11.2849,1.3015;0,0,i2\nN=-9.9859,0.5516;0,0,i1\nC=-9.9859,-0.9483;0,0,i0\nN=-11.2850,-1.6984;1,0,i2\nN=-8.6869,-1.6983;0,0,i2\nX=-15.1821,5.0517;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n8-9=1,0\n9-10=1,0\n10-11=2,0\n10-12=1,0\n5-13=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[arginine]]></Cell>\n<Cell id="3"><![CDATA[Arg]]></Cell>\n<Cell id="4"><![CDATA[R]]></Cell>\n</Row>\n<Row id="16">\n<Cell id="1"><![CDATA[SketchEl!(8,7)\nC=-6.8514,8.0000;0,0,i0\nO=-6.8514,9.5000;0,0,i0\nC=-8.1504,7.2500;0,0,i1\nX=-5.5525,7.2500;0,0,i0\nN=-9.4496,8.0000;0,0,i1\nC=-8.1504,5.7500;0,0,i2\nO=-6.8514,5.0000;0,0,i1\nX=-10.7486,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n5-8=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[serine]]></Cell>\n<Cell id="3"><![CDATA[Ser]]></Cell>\n<Cell id="4"><![CDATA[S]]></Cell>\n</Row>\n<Row id="17">\n<Cell id="1"><![CDATA[SketchEl!(9,8)\nC=-6.4906,8.0000;0,0,i0\nO=-6.4906,9.5000;0,0,i0\nC=-7.7896,7.2500;0,0,i1\nX=-5.1916,7.2500;0,0,i0\nN=-9.0887,8.0000;0,0,i1\nC=-7.7896,5.7500;0,0,i1\nC=-9.0887,5.0000;0,0,i3\nO=-6.4906,5.0000;0,0,i1\nX=-10.3877,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,2\n3-6=1,0\n6-7=1,0\n6-8=1,2\n5-9=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[threonine]]></Cell>\n<Cell id="3"><![CDATA[Thr]]></Cell>\n<Cell id="4"><![CDATA[T]]></Cell>\n</Row>\n<Row id="18">\n<Cell id="1"><![CDATA[SketchEl!(14,14)\nC=-9.3567,8.0000;0,0,i0\nO=-9.3567,9.5000;0,0,i0\nC=-10.6557,7.2500;0,0,i1\nX=-8.0577,7.2500;0,0,i0\nN=-11.9548,8.0000;0,0,i1\nC=-10.6557,5.7500;0,0,i2\nC=-9.3567,5.0000;0,0,i0\nC=-9.3567,3.5000;0,0,i1\nC=-8.0577,5.7500;0,0,i1\nC=-8.0577,2.7500;0,0,i1\nC=-6.7586,3.5000;0,0,i0\nC=-6.7586,5.0000;0,0,i1\nO=-5.4596,2.7500;0,0,i1\nX=-13.2538,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n7-8=1,0\n7-9=2,0\n8-10=2,0\n10-11=1,0\n11-12=2,0\n12-9=1,0\n11-13=1,0\n5-14=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[tyrosine]]></Cell>\n<Cell id="3"><![CDATA[Tyr]]></Cell>\n<Cell id="4"><![CDATA[Y]]></Cell>\n</Row>\n<Row id="19">\n<Cell id="1"><![CDATA[SketchEl!(9,8)\nC=-6.4906,8.0000;0,0,i0\nO=-6.4906,9.5000;0,0,i0\nC=-7.7896,7.2500;0,0,i1\nX=-5.1916,7.2500;0,0,i0\nN=-9.0887,8.0000;0,0,i1\nC=-7.7896,5.7500;0,0,i1\nC=-9.0887,5.0000;0,0,i3\nC=-6.4906,5.0000;0,0,i3\nX=-10.3877,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n6-8=1,0\n5-9=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[valine]]></Cell>\n<Cell id="3"><![CDATA[Val]]></Cell>\n<Cell id="4"><![CDATA[V]]></Cell>\n</Row>\n<Row id="20">\n<Cell id="1"><![CDATA[SketchEl!(16,17)\nC=-9.1949,8.0000;0,0,i0\nO=-9.1949,9.5000;0,0,i0\nC=-10.4939,7.2500;0,0,i1\nX=-7.8959,7.2500;0,0,i0\nN=-11.7930,8.0000;0,0,i1\nC=-10.4939,5.7500;0,0,i2\nC=-9.1949,5.0000;0,0,i0\nC=-9.4755,2.2797;0,0,i1\nC=-8.7255,0.9806;0,0,i1\nC=-8.7255,3.5787;0,0,i0\nC=-7.2255,0.9806;0,0,i1\nC=-6.4755,2.2797;0,0,i1\nC=-7.2255,3.5787;0,0,i0\nC=-7.9866,5.8824;0,0,i1\nN=-6.7662,5.0065;0,0,i1\nX=-13.0920,7.2501;0,0,i0\n1-2=2,0\n1-3=1,0\n1-4=1,0\n3-5=1,0\n3-6=1,2\n6-7=1,0\n8-9=1,0\n8-10=2,0\n9-11=2,0\n11-12=1,0\n12-13=2,0\n13-10=1,0\n10-7=1,0\n7-14=2,0\n14-15=1,0\n15-13=1,0\n5-16=1,0\n!End\n]]></Cell>\n<Cell id="2"><![CDATA[tryptophan]]></Cell>\n<Cell id="3"><![CDATA[Trp]]></Cell>\n<Cell id="4"><![CDATA[W]]></Cell>\n</Row>\n</Content>\n</DataSheet>\n',biomolecules:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n <Summary>\n  <Title>Biomolecules</Title>\n  <Description><![CDATA[]]></Description>\n </Summary>\n <Header nrows="8" ncols="3">\n  <Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n  <Column name="Name" type="string" id="2">Template name</Column>\n  <Column name="Abbrev" type="string" id="3">Abbreviation code</Column>\n </Header>\n <Content>\n  <Row id="1">\n   <Cell id="1"><![CDATA[SketchEl!(11,12)\nN=0.7009,1.8000;0,0,i0\nC=2.0000,2.5500;0,0,i1\nC=-0.5981,2.5500;0,0,i0\nN=2.0000,4.0500;0,0,i0\nC=0.7009,4.8000;0,0,i0\nC=-0.5981,4.0500;0,0,i0\nN=-2.0194,2.0806;0,0,i0\nC=-2.9018,3.2889;0,0,i1\nN=-2.0260,4.5093;0,0,i0\nN=0.7009,6.3000;0,0,i2\nX=-2.4777,0.6523;0,0,i0\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n3-7=1,0\n7-8=1,0\n8-9=2,0\n9-6=1,0\n5-10=1,0\n7-11=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[adenine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="2">\n   <Cell id="1"><![CDATA[SketchEl!(12,13)\nN=0.7009,1.8000;0,0,i0\nC=2.0000,2.5500;0,0,i0\nC=-0.5981,2.5500;0,0,i0\nN=2.0000,4.0500;0,0,i1\nC=0.7009,4.8000;0,0,i0\nC=-0.5981,4.0500;0,0,i0\nN=-2.0194,2.0806;0,0,i0\nC=-2.9018,3.2889;0,0,i1\nN=-2.0260,4.5093;0,0,i0\nO=0.7009,6.3000;0,0,i0\nX=-2.4777,0.6523;0,0,i0\nN=3.2990,1.8000;0,0,i2\n1-2=2,0\n1-3=1,0\n2-4=1,0\n4-5=1,0\n5-6=1,0\n6-3=2,0\n3-7=1,0\n7-8=1,0\n8-9=2,0\n9-6=1,0\n5-10=2,0\n7-11=1,0\n2-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[guanine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="3">\n   <Cell id="1"><![CDATA[SketchEl!(9,9)\nC=-1.7510,2.3500;0,0,i0\nC=-3.0500,1.6000;0,0,i1\nN=-0.4519,1.6000;0,0,i0\nC=-3.0500,0.1000;0,0,i1\nN=-1.7510,-0.6500;0,0,i0\nC=-0.4519,0.1000;0,0,i0\nN=-1.7510,3.8500;0,0,i2\nO=0.8471,-0.6500;0,0,i0\nX=-1.7510,-2.1500;0,0,i0\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=1,0\n6-3=1,0\n1-7=1,0\n6-8=2,0\n5-9=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[cytosine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="4">\n   <Cell id="1"><![CDATA[SketchEl!(9,9)\nC=-1.7510,2.3500;0,0,i0\nC=-3.0500,1.6000;0,0,i1\nN=-0.4519,1.6000;0,0,i1\nC=-3.0500,0.1000;0,0,i1\nN=-1.7510,-0.6500;0,0,i0\nC=-0.4519,0.1000;0,0,i0\nO=-1.7510,3.8500;0,0,i0\nO=0.8471,-0.6500;0,0,i0\nX=-1.7510,-2.1500;0,0,i0\n1-2=1,0\n3-1=1,0\n2-4=2,0\n4-5=1,0\n5-6=1,0\n6-3=1,0\n1-7=2,0\n6-8=2,0\n5-9=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[uracil]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="5">\n   <Cell id="1"><![CDATA[SketchEl!(10,10)\nC=-1.7510,2.3500;0,0,i0\nC=-3.0500,1.6000;0,0,i0\nN=-0.4519,1.6000;0,0,i1\nC=-3.0500,0.1000;0,0,i1\nN=-1.7510,-0.6500;0,0,i0\nC=-0.4519,0.1000;0,0,i0\nO=-1.7510,3.8500;0,0,i0\nO=0.8471,-0.6500;0,0,i0\nX=-1.7510,-2.1500;0,0,i0\nC=-4.3490,2.3500;0,0,i3\n1-2=1,0\n3-1=1,0\n2-4=2,0\n4-5=1,0\n5-6=1,0\n6-3=1,0\n1-7=2,0\n6-8=2,0\n5-9=1,0\n2-10=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[thymine]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="6">\n   <Cell id="1"><![CDATA[SketchEl!(27,29)\nN=4.6026,-2.2500;0,0,i0\nC=5.9018,-1.5000;0,0,i1\nC=3.3036,-1.5000;0,0,i0\nN=5.9018,0.0000;0,0,i0\nC=4.6026,0.7500;0,0,i0\nC=3.3036,0.0000;0,0,i0\nN=1.8824,-1.9694;0,0,i0\nC=1.0000,-0.7610;0,0,i1\nN=1.8756,0.4593;0,0,i0\nN=4.6026,2.2500;0,0,i2\nC=1.4240,-3.3975;0,0,i1\nO=0.0030,-3.8657;0,0,i0\nC=0.0040,-5.3680;0,0,i1\nC=2.3071,-4.6051;0,0,i1\nC=1.4322,-5.8263;0,0,i1\nO=3.8071,-4.5978;0,0,i1\nO=1.9031,-7.2505;0,0,i1\nC=-1.2076,-6.2522;0,0,i2\nO=-2.5790,-5.6451;0,0,i0\nP=-3.7905,-6.5296;0,0,i0\nO=-4.6750,-5.3179;0,0,i0\nO=-2.9062,-7.7412;0,0,i1\nO=-5.0022,-7.4140;0,0,i0\nP=-6.3738,-6.8069;0,0,i0\nO=-5.7668,-5.4352;0,0,i0\nO=-6.9808,-8.1786;0,0,i1\nO=-7.7455,-6.1998;0,0,i1\n1-2=1,0\n1-3=2,0\n2-4=2,0\n4-5=1,0\n5-6=2,0\n6-3=1,0\n3-7=1,0\n7-8=1,0\n8-9=2,0\n9-6=1,0\n5-10=1,0\n11-7=1,1\n13-12=1,0\n12-11=1,0\n11-14=1,0\n14-15=1,0\n15-13=1,0\n14-16=1,2\n15-17=1,2\n13-18=1,1\n18-19=1,0\n20-21=2,0\n20-22=1,0\n20-23=1,0\n20-19=1,0\n24-25=2,0\n24-26=1,0\n24-27=1,0\n24-23=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[ADP]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="7">\n   <Cell id="1"><![CDATA[SketchEl!(18,19)\nC=2.2100,1.1549;0,0,i0\nN=1.0000,0.2749;0,0,i1\nC=1.4600,-1.1549;0,0,i0\nN=3.4200,0.2749;0,0,i1\nC=2.9600,-1.1549;0,0,i0\nC=3.4282,-2.5763;0,0,i1\nS=2.2199,-3.4587;0,0,i0\nC=0.9995,-2.5829;0,0,i2\nO=2.2100,2.6549;0,0,i0\nH=4.4599,-1.1497;0,0,i0\nH=-0.0399,-1.1545;0,0,i0\nC=4.8563,-3.0352;0,0,i2\nC=5.9677,-2.0279;0,0,i2\nC=7.3958,-2.4869;0,0,i2\nC=8.5073,-1.4796;0,0,i2\nC=9.9353,-1.9386;0,0,i0\nO=11.0468,-0.9314;0,0,i0\nO=10.2519,-3.4048;0,0,i1\n3-2=1,0\n2-1=1,0\n1-4=1,0\n4-5=1,0\n5-3=1,0\n5-6=1,0\n6-7=1,0\n7-8=1,0\n8-3=1,0\n1-9=2,0\n5-10=1,1\n3-11=1,1\n6-12=1,2\n12-13=1,0\n13-14=1,0\n14-15=1,0\n16-17=2,0\n16-18=1,0\n16-15=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[biotin]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="8">\n   <Cell id="1"><![CDATA[SketchEl!(24,27)\nC=-7.1991,2.0500;0,0,i1\nC=-8.4981,1.3000;0,0,i1\nC=-8.4981,-0.2000;0,0,i0\nC=-7.1991,-0.9500;0,0,i1\nC=-5.9000,-0.2000;0,0,i0\nC=-5.9000,1.3000;0,0,i0\nC=-4.6009,-0.9500;0,0,i2\nC=-3.3019,-0.2000;0,0,i2\nC=-3.3019,1.3000;0,0,i0\nC=-4.6009,2.0500;0,0,i0\nC=-2.0028,2.0500;0,0,i0\nC=-2.0028,3.5500;0,0,i0\nC=-3.3018,4.3000;0,0,i2\nC=-4.6008,3.5501;0,0,i2\nC=-0.5814,4.0194;0,0,i1\nC=0.3009,2.8111;0,0,i1\nC=-0.5749,1.5907;0,0,i2\nO=-9.7971,-0.9500;0,0,i1\nH=-4.6009,0.5500;0,0,i0\nH=-3.3019,2.8000;0,0,i0\nH=-2.0028,0.5500;0,0,i0\nC=-2.0028,5.0500;0,0,i3\nO=-0.1231,5.4476;0,0,i1\nO=1.8009,2.8174;0,0,i1\n2-3=2,0\n2-1=1,0\n3-4=1,0\n4-5=2,0\n5-6=1,0\n6-1=2,0\n8-9=1,0\n8-7=1,0\n9-10=1,0\n10-6=1,0\n5-7=1,0\n12-13=1,0\n12-11=1,0\n13-14=1,0\n14-10=1,0\n9-11=1,0\n12-15=1,0\n15-16=1,0\n16-17=1,0\n17-11=1,0\n3-18=1,0\n10-19=1,2\n9-20=1,1\n11-21=1,2\n12-22=1,1\n15-23=1,1\n16-24=1,2\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[estrogen]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n </Content>\n</DataSheet>\n',saccharides:'<?xml version="1.0" encoding="UTF-8"?>\n<DataSheet>\n <Summary>\n  <Title>Saccharides</Title>\n  <Description><![CDATA[]]></Description>\n </Summary>\n <Header nrows="7" ncols="3">\n  <Column name="Molecule" type="molecule" id="1">Molecular structure</Column>\n  <Column name="Name" type="string" id="2">Template name</Column>\n  <Column name="Abbrev" type="string" id="3">Abbreviation code</Column>\n </Header>\n <Content>\n  <Row id="1">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nC=1.0000,0.5911;0,0,i1\nC=2.2990,0.1911;0,0,i1\nC=1.7500,-0.7078;0,0,i1\nO=3.5981,0.9411;0,0,i0\nC=3.0490,0.0421;0,0,i1\nC=4.3481,-0.7078;0,0,i1\nO=-0.2797,-0.1912;0,0,i1\nO=0.2727,-0.9682;0,0,i1\nC=1.4079,1.3978;0,0,i2\nO=2.0074,2.7728;0,0,i1\nO=3.4372,-1.4066;0,0,i1\nO=4.5368,-2.1958;0,0,i1\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n6-5=1,0\n4-6=1,0\n1-7=1,0\n3-8=1,0\n2-9=1,0\n9-10=1,0\n5-11=1,0\n6-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[glucose alpha]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="2">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nC=1.0000,0.5910;0,0,i1\nC=2.2990,0.1911;0,0,i1\nC=1.7500,-0.7077;0,0,i1\nO=3.5980,0.9411;0,0,i0\nC=3.0490,0.0421;0,0,i1\nC=4.3481,-0.7077;0,0,i1\nO=-0.2797,-0.1912;0,0,i1\nO=0.2727,-0.9682;0,0,i1\nC=1.4078,1.3977;0,0,i2\nO=2.0074,2.7727;0,0,i1\nO=3.4372,-1.4065;0,0,i1\nO=5.6169,0.0920;0,0,i1\n1-2=1,0\n1-3=1,0\n2-4=1,0\n3-5=1,0\n6-5=1,0\n4-6=1,0\n1-7=1,0\n3-8=1,0\n2-9=1,0\n9-10=1,0\n5-11=1,0\n6-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[glucose beta]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="3">\n   <Cell id="1"><![CDATA[SketchEl!(16,15)\nC=1.5000,0.0000;0,0,i0\nC=1.4999,1.5000;0,0,i1\nC=1.4999,-1.5000;0,0,i0\nO=3.0000,0.0000;0,0,i1\nH=0.0000,0.0000;0,0,i0\nC=1.4999,-3.0000;0,0,i0\nH=2.9999,-1.5000;0,0,i0\nO=-0.0000,-1.4999;0,0,i1\nC=1.4999,-4.5000;0,0,i0\nO=2.9999,-3.0000;0,0,i1\nH=-0.0000,-2.9999;0,0,i0\nC=1.4999,-6.0000;0,0,i2\nO=2.9999,-4.5000;0,0,i1\nH=-0.0000,-4.5000;0,0,i0\nO=2.7990,-6.7500;0,0,i1\nO=0.2009,2.2499;0,0,i0\n1-2=1,0\n1-3=1,0\n1-4=1,0\n1-5=1,0\n3-6=1,0\n3-7=1,0\n3-8=1,0\n6-9=1,0\n6-10=1,0\n6-11=1,0\n9-12=1,0\n9-13=1,0\n9-14=1,0\n12-15=1,0\n2-16=2,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[glucose chain]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="4">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nC=1.3913,1.2718;0,0,i1\nC=0.4839,-0.0000;0,0,i1\nC=1.3913,-1.2718;0,0,i1\nC=3.2063,-1.2718;0,0,i1\nC=4.1139,0.0000;0,0,i1\nO=3.2063,1.2718;0,0,i0\nC=1.3912,2.7718;0,0,i2\nO=4.1139,-1.4998;0,0,i1\nO=3.2128,-2.7718;0,0,i1\nO=1.3717,0.2280;0,0,i1\nO=0.4839,-1.5000;0,0,i1\nO=0.0922,3.5218;0,0,i1\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-1=1,0\n1-7=1,1\n5-8=1,2\n4-9=1,2\n3-10=1,1\n2-11=1,2\n7-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[glucose alpha]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="5">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nC=1.3912,1.2718;0,0,i1\nC=0.4839,-0.0000;0,0,i1\nC=1.3912,-1.2718;0,0,i1\nC=3.2063,-1.2718;0,0,i1\nC=4.1139,0.0000;0,0,i1\nO=3.2063,1.2718;0,0,i0\nC=1.3911,2.7718;0,0,i2\nO=4.1139,1.4997;0,0,i1\nO=3.2128,-2.7718;0,0,i1\nO=1.3717,0.2280;0,0,i1\nO=0.4839,-1.5000;0,0,i1\nO=0.0922,3.5218;0,0,i1\n2-3=1,0\n2-1=1,0\n3-4=1,0\n4-5=1,0\n5-6=1,0\n6-1=1,0\n1-7=1,1\n5-8=1,1\n4-9=1,2\n3-10=1,1\n2-11=1,2\n7-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[glucose beta]]></Cell>\n   <Cell id="3"><![CDATA[]]></Cell>\n  </Row>\n  <Row id="6">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nO=2.2100,1.1549;0,0,i0\nC=1.0000,0.2749;0,0,i0\nC=1.4600,-1.1549;0,0,i1\nC=3.4200,0.2749;0,0,i1\nC=2.9600,-1.1549;0,0,i1\nO=3.8434,-2.3672;0,0,i1\nC=4.8460,0.7402;0,0,i2\nO=5.1561,2.2078;0,0,i1\nC=-0.4260,0.7402;0,0,i2\nO=-1.5419,-0.2621;0,0,i1\nO=0.7658,1.7566;0,0,i1\nO=0.5765,-2.3672;0,0,i1\n3-2=1,0\n2-1=1,0\n1-4=1,0\n4-5=1,0\n5-3=1,0\n5-6=1,1\n4-7=1,2\n7-8=1,0\n2-9=1,2\n9-10=1,0\n2-11=1,1\n3-12=1,2\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[fructose alpha]]></Cell>\n   <Cell id="3"/>\n  </Row>\n  <Row id="7">\n   <Cell id="1"><![CDATA[SketchEl!(12,12)\nO=2.2100,1.1549;0,0,i0\nC=1.0000,0.2749;0,0,i0\nC=1.4600,-1.1549;0,0,i1\nC=3.4200,0.2749;0,0,i1\nC=2.9600,-1.1549;0,0,i1\nO=3.8434,-2.3672;0,0,i1\nC=4.8460,0.7402;0,0,i2\nO=5.1561,2.2078;0,0,i1\nO=-0.4260,0.7402;0,0,i1\nC=0.7658,1.7566;0,0,i2\nO=0.5765,-2.3672;0,0,i1\nO=-0.6344,2.2946;0,0,i1\n3-2=1,0\n2-1=1,0\n1-4=1,0\n4-5=1,0\n5-3=1,0\n5-6=1,1\n4-7=1,2\n7-8=1,0\n2-9=1,2\n2-10=1,1\n3-11=1,2\n10-12=1,0\n!End\n]]></Cell>\n   <Cell id="2"><![CDATA[fructose beta]]></Cell>\n   <Cell id="3"/>\n  </Row>\n </Content>\n</DataSheet>\n'};class Me{constructor(){this.abbrevs=[]}static getTemplateKeys(){return Object.keys(xe)}static getTemplateData(t){return xe[t]}static needsSetup(){return!this.main}static setupData(){return t=this,e=void 0,i=function*(){if(!this.main){this.main=new Me;for(let t of this.getTemplateKeys()){let e=this.getTemplateData(t),n=Ee.readXML(e),i=n.firstColOfType("molecule"),s=n.findColByName("Abbrev","string");if(!(i<0||s<0))for(let t=0;t<n.numRows;t++){let e=n.getMoleculeClone(t,i),l=n.getString(t,s);if(!e||!l)continue;let r=0,o=0;for(let t=1;t<=e.numAtoms;t++)e.atomElement(t)==Dt.TEMPLATE_ATTACHMENT&&(0==o&&(o=t),e.setAtomElement(t,Dt.ABBREV_ATTACHMENT),r++);1==r&&(o>1&&e.swapAtoms(1,o),this.main.submitAbbreviation(l,e))}}}},new((n=void 0)||(n=Promise))((function(s,l){function r(t){try{a(i.next(t))}catch(t){l(t)}}function o(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}getAbbrevs(){return this.abbrevs.slice(0)}submitAbbreviation(t,e,n=!1){let i=e.clone();this.submitFragment(t,i,n)}submitMolecule(t,e=!1){let n=t.clone();for(let t=1;t<=n.numAtoms;t++){let i=Dt.getAbbrev(n,t);i&&this.submitFragment(n.atomElement(t),i,e)}}substituteAbbrevName(e,n){let i=Dt.getAbbrev(e,n);if(!i)return!1;let s=Dt.expandedAbbrevs(i),l=Dt.molecularFormula(s),r=ye.create(fe.createStrictRubric(s),ye.CLASS_ECFP6).getUniqueHashes();for(let s of this.abbrevs)if(s.frag.numAtoms==i.numAtoms){let o=St.sketchEquivalent(i,s.frag);if(!o){let e=Dt.expandedAbbrevs(s.frag);if(l==Dt.molecularFormula(e)){let n=ye.create(fe.createStrictRubric(e),ye.CLASS_ECFP6).getUniqueHashes();t.equals(r,n)&&(o=!0)}}if(o)return e.setAtomElement(n,s.name),!0}return!1}submitFragment(t,e,n){if("?"==t)return;let i=0,s=0,l=e.atomAdjList(1);for(let t of l)i+=e.atomX(t)-e.atomX(1),s+=e.atomY(t)-e.atomY(1);if(l.length>1){let t=1/l.length;i*=t,s*=t}if(N(i,s)>.1*.1){let t=Math.atan2(s,i);Math.abs(t)>2*_&&St.rotateMolecule(e,-t)}let r=-1;for(let e=0;e<this.abbrevs.length;e++)if(this.abbrevs[e].name==t){r=e;break}let[o,a]=this.formatAbbrevLabel(t),h={name:t,frag:e,nameHTML:o,nameSearch:a};r<0?n?this.abbrevs.unshift(h):this.abbrevs.push(h):n&&r>0?(this.abbrevs.splice(r,1),this.abbrevs.unshift(h)):this.abbrevs[r]=h}formatAbbrevLabel(t){let e="",n="",i=(t,i)=>{i&&(e+="<"+i+">"),e+=V(t),n+=t,i&&(e+="</"+i+">")};for(let e of t.split("|")){for(;;){let t=e.match(/^(.*?)\{(.*?)\}(.*)$/);if(!t)break;let n=t[1],s=t[2],l=t[3];i(n,null),s.startsWith("^")?i(s.substring(1),"sup"):i(s,"sub"),e=l}i(e,null)}return[e,n.toLowerCase()]}}Me.main=null;class ve{constructor(t,e,n){this.metalAtom=e,this.ligandAttach=n,this.ligands=[],this.mol=t.clone()}generate(){const{mol:e,metalAtom:n,ligandAttach:i,ligands:s}=this;let l=Q.fromMolecule(e);l.isolateNode(n-1);for(let r of l.calculateComponentGroups()){t.addTo(r,1);let l=!1;for(let t of i)if(r.indexOf(t)>=0){l=!0;break}if(!l)continue;let o={atoms:r,attach:[]};o.atoms=r;let a=!1;for(let t of o.atoms)if(e.findBond(t,n)>0){a=!0;break}for(let t of o.atoms)(e.findBond(t,n)>0||!a&&i.includes(t))&&o.attach.push(t);s.push(o);for(let t of o.attach)0==e.findBond(t,n)&&this.makeLigandBond(t)}if(0==s.length)throw new Error("No ligand atoms");let r=e.atomAdjList(n);for(let e of s)r=t.exclude(r,e.attach);let o=e.atomX(n),a=e.atomY(n),u=new Array(r.length);for(let t=0;t<r.length;t++)u[t]=Math.atan2(e.atomY(r[t])-a,e.atomX(r[t])-o);for(let n of s)if(1==n.attach.length){let t=n.attach[0];n.avgTheta=Math.atan2(e.atomY(t)-a,e.atomX(t)-o),this.orientLigand(n)}else{let i=new Array(n.attach.length);for(let t=0;t<n.attach.length;t++){let s=n.attach[t];i[t]=Math.atan2(e.atomY(s)-a,e.atomX(s)-o)}i=h.sortAngles(i);let s=i[0];for(let t=0;t<i.length;t++)i[t]=F(i[t],s);n.avgTheta=s+t.sum(i)/i.length,this.orientLigand(n)}if(0==r.length)s.sort(((t,e)=>w(t.avgTheta-e.avgTheta))),this.arrangeLigandsFree(s);else if(1==r.length)s.sort(((t,e)=>w(F(t.avgTheta,u[0])-F(e.avgTheta,u[0])))),this.arrangeLigandsRange(s,u[0],I,!0);else{let e=t.idxSort(u);for(let t=0;t<e.length;t++){let n=(t+1)%e.length,i=u[e[t]],l=F(u[e[n]],i),r=[];for(let t of s)F(t.avgTheta,i)<l&&r.push(t);0!=r.length&&(r.sort(((t,e)=>w(F(t.avgTheta,i)-F(e.avgTheta,i)))),this.arrangeLigandsRange(r,i,l,!0))}}return this.resolveClashes(),e}makeLigandBond(t){const{mol:e,metalAtom:n}=this;let i=e.atomCharge(n),s=e.atomCharge(t);if(i>0&&s<0)return e.setAtomCharge(n,i-1),e.setAtomCharge(t,s+1),void e.addBond(n,t,1);if(i<0&&s>0)return e.setAtomCharge(n,i+1),e.setAtomCharge(t,s-1),void e.addBond(n,t,1);let l=0;e.atomHExplicit(t)==qt.HEXPLICIT_UNKNOWN&&e.atomHydrogens(t)>0&&(l=1),e.addBond(n,t,l)}orientLigand(e){const{mol:n,metalAtom:i}=this;let s=n.atomX(i),l=n.atomY(i),r=e.atoms.length,o=e.attach.length,a=new Array(o);for(let t=0;t<o;t++)a[t]=e.atoms.indexOf(e.attach[t]);let u=new Array(r),m=new Array(r),c=Dt.arrayAtomX(n),d=Dt.arrayAtomY(n),f=t.max(c)-t.min(c)+t.max(d)-t.min(d),p=f*Math.cos(e.avgTheta),C=f*Math.sin(e.avgTheta);for(let t=0;t<r;t++)u[t]=n.atomX(e.atoms[t])+p,m[t]=n.atomY(e.atoms[t])+C;let g=t.sum(u)/r,A=t.sum(m)/r,b=[];for(let t=0;t<r;t++){let e=Number.POSITIVE_INFINITY;for(let n of a)e=Math.min(e,q(u[t]-u[n],m[t]-m[n]));b.push(1/(1+Math.sqrt(e)))}let y=Number.POSITIVE_INFINITY,E=null,x=null;for(let t=0;t<360;t+=15){let n=Math.cos(t*_),i=Math.sin(t*_),o=new Array(r),a=new Array(r),h=0;for(let t=0;t<r;t++){let r=u[t]-g,c=m[t]-A;o[t]=g+r*n-c*i,a[t]=A+r*i+c*n;let d=N(o[t]-s,a[t]-l);e.attach.indexOf(e.atoms[t])>=0?h+=d:h-=d*b[t]}h<y&&(y=h,E=o,x=a)}if(u=E,m=x,1==o)p=qt.IDEALBOND*Math.cos(e.avgTheta),C=qt.IDEALBOND*Math.sin(e.avgTheta),t.addTo(u,s+p-u[a[0]]),t.addTo(m,l+C-m[a[0]]);else{let n=new Array(o),i=t.numberArray(0,o),c=t.numberArray(0,o),d=t.numberArray(0,o);for(let t=0;t<o;t++){let e=u[a[t]]-s,r=m[a[t]]-l;n[t]=Math.atan2(r,e),o>2&&(i[t]=N(e,r),c[t]=e/i[t],d[t]=r/i[t])}t.addTo(i,-t.min(i));let f=h.idxSortAngles(n),p=new Array(o),C=new Array(o),g=new Array(o),A=new Array(o),b=45*_/(o-1),y=e.avgTheta-.5*b;for(let t=0;t<o;t++)p[t]=u[a[f[t]]],C[t]=m[a[f[t]]],g[t]=s+qt.IDEALBOND*Math.cos(y)+i[t]*c[t],A[t]=l+qt.IDEALBOND*Math.sin(y)+i[t]*d[t],y+=b/(o-1);let E=h.superimpose(p,C,g,A);for(let t=0;t<r;t++){let[e,n]=h.applyAffine(u[t],m[t],E);u[t]=e,m[t]=n}}for(let t=0;t<r;t++)n.setAtomPos(e.atoms[t],u[t],m[t])}arrangeLigandsFree(e){if(1==e.length)return;let n=t.last(e).avgTheta;n+=.5*F(t.first(e).avgTheta,n),this.arrangeLigandsRange(e,n,I,!1)}arrangeLigandsRange(t,e,n,i){const{mol:s,metalAtom:l}=this;let r=s.atomX(l),o=s.atomY(l),a=t.length,h=new Array(a),u=new Array(a),m=0;for(let e=0;e<a;e++){let[n,i]=this.determineThetaBounds(t[e]);h[e]=n,u[e]=F(i,n),m+=u[e]}let c=(n-m)/(a+(i?1:0)),d=e+(i?c:.5*c);for(let e=0;e<a;e++){let n=d-h[e],i=Math.cos(n),l=Math.sin(n);for(let n of t[e].atoms){let t=s.atomX(n)-r,e=s.atomY(n)-o;s.setAtomPos(n,r+t*i-e*l,o+t*l+e*i)}d+=u[e]+c}}determineThetaBounds(e){const{mol:n,metalAtom:i}=this;let s=[],l=n.atomX(i),r=n.atomY(i);for(let t=0;t<e.attach.length;t++){let i=n.atomX(e.attach[t])-l,o=n.atomY(e.attach[t])-r;s.push(Math.atan2(o,i))}t.sort(s);let o=Number.POSITIVE_INFINITY,a=0,h=0;for(let e=0;e<s.length;e++){let e=0;for(let t=0;t<s.length-1;t++)e+=F(s[t+1],s[t]);e<o&&(o=e,a=t.first(s),h=t.last(s)),s.push(s.shift())}return[a,h]}resolveClashes(){const{mol:e,metalAtom:n,ligands:i}=this,s=e.numAtoms,l=e.numBonds,r=this.ligands.length;let o=t.numberArray(-1,s),a=t.numberArray(-1,l);for(let t=1;t<=s;t++)e.atomConnComp(t)==e.atomConnComp(n)&&(o[t-1]=0);for(let t=0;t<r;t++)for(let e of i[t].atoms)o[e-1]=t+1;for(let t=1;t<=l;t++){let n=o[e.bondFrom(t)-1],i=o[e.bondTo(t)-1];n<0||i<0||n==i&&(a[t-1]=n)}let u=new Array(r),m=new Array(r),c=e.atomX(n),d=e.atomY(n);for(let t=0;t<r;t++){let n=i[t],s=0,l=0;for(let t of n.attach)s+=e.atomX(t)-c,l+=e.atomY(t)-d;s/=n.attach.length,l/=n.attach.length;let r=1/N(s,l);u[t]=.5*s*r,m[t]=.5*l*r}const f=O(.5);for(let n=0;n<12;n++){let n=t.booleanArray(!1,r);t:for(let i=0;i<s-1;i++)if(!(o[i]<0))for(let l=i+1;l<s;l++)if(o[l]>=0&&o[l]!=o[i]&&(q(e.atomX(i+1)-e.atomX(l+1),e.atomY(i+1)-e.atomY(l+1))<f&&(o[i]>0&&(n[o[i]-1]=!0),o[l]>0&&(n[o[l]-1]=!0)),t.allTrue(n)))break t;if(t.anyFalse(n))t:for(let i=0;i<l-1;i++){if(a[i]<0)continue;let s=e.atomX(e.bondFrom(i+1)),r=e.atomY(e.bondFrom(i+1)),o=e.atomX(e.bondTo(i+1)),u=e.atomY(e.bondTo(i+1));for(let m=i+1;m<l;m++)if(a[m]>=0&&a[m]!=a[i]){let l=e.atomX(e.bondFrom(m+1)),c=e.atomY(e.bondFrom(m+1)),d=e.atomX(e.bondTo(m+1)),f=e.atomY(e.bondTo(m+1));if(h.doLineSegsIntersect(s,r,o,u,l,c,d,f)&&(a[i]>0&&(n[a[i]-1]=!0),a[m]>0&&(n[a[m]-1]=!0)),t.allTrue(n))break t}}if(t.allFalse(n))break;for(let t=0;t<r;t++)if(n[t])for(let n of i[t].atoms)e.setAtomPos(n,e.atomX(n)+u[t],e.atomY(n)+m[t])}}}class Te{constructor(){this.attdist=0,this.guided=!1,this.bridged=!1,this.scoreModifier=0,this.chainSelect=0}}class Ne{constructor(t,e,n){this.mol=t,this.templ=e,this.abbrev=n,this.perms=[],this.numAttach=0,this.withGuideOnly=!1,this.guidetempl=null,this.guideidx=[],this.guideadj=[],this.timeLimit=5;let i=new tt(t),s=new tt(e);s.harmoniseNumbering(i),s.rewriteMolecule();let l=new ut(t),r=new ut(e);r.harmoniseNumbering(l),r.rewriteMolecule(),this.huntForGuides()}permuteNone(){let t=this.mol.clone(),e=this.templ.clone();if(t.numAtoms>0){let n=t.boundary(),i=e.boundary(),s=n.maxX()+1-i.minX(),l=.5*(n.minY()+n.maxY())-.5*(i.minY()+i.maxY());St.translateMolecule(e,s,l)}else{let t=e.boundary();St.translateMolecule(e,-t.midX(),-t.midY())}t.boundary();let n=e.boundary(),i=n.midX(),s=n.midY(),l=[0,30,45,60,90,120,135,150,180,210,225,240,270,300,315,330];t:for(let n=0;n<l.length;n++){let r=e.clone();St.rotateMolecule(r,-l[n]*_,i,s);for(let t=0;t<this.perms.length;t++)if(St.sketchEquivalent(r,this.perms[t].display))continue t;let o=new Te;o.mol=t.clone(),o.mol.append(r),o.display=r,o.srcidx=this.sourceIndex(o.mol,t),o.attdist=0,o.guided=!1,this.perms.push(o)}}permuteAtom(t){this.numAttach=1;let e=(new Date).getTime(),n=this.mol.clone(),i=this.templ.clone(),s=[];if(null!=this.guidetempl){let i=St.mirrorImage(this.guidetempl.clone());for(let l=0;l<this.guideidx.length&&!((new Date).getTime()-e>1e3*this.timeLimit);l++)this.composeGuidedOne(s,n,this.guidetempl,t,this.guideidx[l]),this.composeGuidedOne(s,n,i,t,this.guideidx[l])}if(!this.withGuideOnly){let l=i.clone();St.mirrorImage(l);for(let r=1;r<=i.numAtoms&&!((new Date).getTime()-e>1e3*this.timeLimit);r++)this.composeDirectOne(s,n,i,t,r),this.composeDirectOne(s,n,l,t,r),this.composeBridge(s,n,i,t,r),this.composeBridge(s,n,l,t,r)}this.affixRawPermutations(s)}permuteBond(t,e){this.numAttach=2;let n=(new Date).getTime(),i=this.mol.clone(),s=this.templ.clone(),l=[];if(null!=this.guidetempl){let s=St.mirrorImage(this.guidetempl.clone());for(let r=0;r<this.guideidx.length&&!((new Date).getTime()-n>1e3*this.timeLimit);r++){let n=this.guideidx[r],o=this.guidetempl.atomAdjList(n);for(let r=0;r<o.length;r++){let a=o[r];this.composeGuidedTwo(l,i,this.guidetempl,t,e,n,a,!0),this.composeGuidedTwo(l,i,this.guidetempl,e,t,n,a,!0),this.composeGuidedTwo(l,i,s,t,e,n,a,!0),this.composeGuidedTwo(l,i,s,e,t,n,a,!0),this.composeGuidedTwo(l,i,this.guidetempl,t,e,n,a,!1),this.composeGuidedTwo(l,i,this.guidetempl,e,t,n,a,!1),this.composeGuidedTwo(l,i,s,t,e,n,a,!1),this.composeGuidedTwo(l,i,s,e,t,n,a,!1)}}}if(!this.withGuideOnly){let r=s.clone();St.mirrorImage(r);for(let o=1;o<=s.numBonds&&!((new Date).getTime()-n>1e3*this.timeLimit);o++){let n=s.bondFrom(o),a=s.bondTo(o);this.composeDirectTwo(l,i,s,t,e,n,a),this.composeDirectTwo(l,i,r,t,e,n,a),this.composeDirectTwo(l,i,s,t,e,a,n),this.composeDirectTwo(l,i,r,t,e,a,n)}}this.affixRawPermutations(l)}permuteMulti(t){this.numAttach=t.length;let e=(new Date).getTime(),n=this.mol.clone(),i=this.templ.clone(),s=[];if(null!=this.guidetempl){let e=St.mirrorImage(this.guidetempl.clone());this.guideidx.length==t.length&&(this.composeGuidedMulti(s,n,this.guidetempl,t,this.guideidx,!0),this.composeGuidedMulti(s,n,e,t,this.guideidx,!0)),this.guideadj.length==t.length&&(this.composeGuidedMulti(s,n,this.guidetempl,t,this.guideadj,!1),this.composeGuidedMulti(s,n,e,t,this.guideadj,!1))}if(!this.withGuideOnly){let l=i.clone();St.mirrorImage(l);for(let r=1;r<=i.numAtoms&&!((new Date).getTime()-e>1e3*this.timeLimit);r++)this.composeDirectMulti(s,n,i,t,r),this.composeDirectMulti(s,n,l,t,r)}this.affixRawPermutations(s)}huntForGuides(){this.guideidx=[],this.guideadj=[];for(let t=1;t<=this.templ.numAtoms;t++)if("X"==this.templ.atomElement(t)&&this.templ.atomAdjCount(t)>0){this.guideidx.push(t);let e=this.templ.atomAdjList(t);for(let t=0;t<e.length;t++)this.guideadj.indexOf(e[t])<0&&this.guideadj.push(e[t])}if(this.guideidx.length>0){this.guidetempl=this.templ.clone();for(let t=this.guideidx.length-1;t>=0;t--)this.templ.deleteAtomAndBonds(this.guideidx[t])}}composeDirectOne(t,e,n,i,s){let l=Ot.primeDirections(e,i),r=Ot.primeDirections(n,s),o=St.atomBondAngles(e,i),a=St.atomBondAngles(n,s),h=[],u=[],m=[];for(let t=0;t<o.length;t++)for(let e=0;e<r.length;e++)h.push(o[t]),u.push(r[e]),m.push(-51);for(let t=0;t<l.length;t++)for(let e=0;e<a.length;e++)h.push(l[t]),u.push(a[e]),m.push(0);for(let t=0;t<l.length;t++)for(let e=0;e<r.length;e++)h.push(l[t]),u.push(r[e]),m.push(0);let c=Q.fromMolecule(n).calculateBFS(0),d=e.atomX(i),f=e.atomY(i),p=n.atomX(s),C=n.atomY(s);for(let l=0;l<h.length;l++){let r=z(h[l],u[l]),o=n.clone();St.translateMolecule(o,d-p,f-C),St.rotateMolecule(o,r,d,f);let a=e.clone(),g=a.numAtoms;a.append(o);let A=this.sourceIndex(a,e);if(Ot.mergeFragmentsMask(a,this.asMask(A)),a.numAtoms==g)continue;let b=new Te;b.mol=a,b.display=o,b.srcidx=A,b.molidx=[i],b.temidx=[s],b.attdist=c[s-1],b.guided=!1,b.scoreModifier=m[l],this.removeExtraGuides(b,e),t.push(b)}}composeDirectTwo(t,e,n,i,s,l,r){let o=Math.atan2(e.atomY(s)-e.atomY(i),e.atomX(s)-e.atomX(i)),a=Math.atan2(n.atomY(r)-n.atomY(l),n.atomX(r)-n.atomX(l)),h=.5*(e.atomX(i)+e.atomX(s)),u=.5*(e.atomY(i)+e.atomY(s)),m=n.clone();St.translateMolecule(m,h-.5*(n.atomX(l)+n.atomX(r)),u-.5*(n.atomY(l)+n.atomY(r))),St.rotateMolecule(m,o-a,h,u),m.setAtomPos(l,e.atomX(i),e.atomY(i)),m.setAtomPos(r,e.atomX(s),e.atomY(s));let c=e.clone(),d=c.numAtoms;c.append(m);let f=this.sourceIndex(c,e);if(Ot.mergeFragmentsMask(c,this.asMask(f)),c.numAtoms==d)return;let p=Q.fromMolecule(n).calculateBFS(0),C=new Te;C.mol=c,C.display=m,C.srcidx=f,C.molidx=[i,s],C.temidx=[l,r],C.attdist=Math.min(p[l-1],p[r-1]),C.guided=!1,this.removeExtraGuides(C,e),t.push(C)}composeDirectMulti(t,e,n,i,s){let l=n.clone(),r=e.atomX(i[0]),o=e.atomY(i[0]);St.translateMolecule(l,r-l.atomX(s),o-l.atomY(s));let a=e.atomX(i[1])-r,h=e.atomY(i[1])-o,u=Math.atan2(h,a),m=N(a,h),c=Q.fromMolecule(n).calculateBFS(1),d=[];for(let n=1;n<=l.numAtoms;n++)if(s!=n){let a=l.atomX(n)-l.atomX(s),h=l.atomY(n)-l.atomY(s),f=N(a,h);if(Math.abs(f-m)>.1)continue;let p=Math.atan2(h,a);St.rotateMolecule(l,u-p,r,o),d=[s,n];for(let t=2;t<i.length;t++){let n=!1;for(let s=1;s<=l.numAtoms;s++)if(d.indexOf(s)<0&&N(e.atomX(i[t])-l.atomX(s),e.atomY(i[t])-l.atomY(s))<.1*.1){n=!0,d.push(s);break}if(!n)break}if(d.length<i.length)continue;let C=c.length;for(let t=0;t<d.length;t++)C=Math.min(C,c[d[t]-1]);let g=0,A=0;for(let t=0;t<i.length;t++)g+=e.atomX(i[t])-l.atomX(d[t]),A+=e.atomY(i[t])-l.atomY(d[t]);let b=1/i.length;g*=b,A*=b,St.translateMolecule(l,g,A);let y=e.clone(),E=y.numAtoms;y.append(l);let x=this.sourceIndex(y,e);for(let t=0;t<d.length;t++){let e=y.atomX(i[t]),n=y.atomY(i[t]);y.setAtomPos(E+d[t],e,n)}if(Ot.mergeFragmentsMask(y,this.asMask(x)),y.numAtoms==E)continue;let M=new Te;M.mol=y,M.display=l.clone(),M.srcidx=x,M.molidx=i.slice(0),M.temidx=d.slice(0),M.attdist=Math.min(c[s-1],c[n-1]),M.guided=!1,this.removeExtraGuides(M,e),t.push(M)}}composeBridge(t,e,n,i,s){let l=0!=e.atomRingBlock(i)||e.atomAdjCount(i)>=3,r=0!=n.atomRingBlock(s)||n.atomAdjCount(s)>=3;if(!l||!r)return;let o=Ot.primeDirections(e,i),a=Ot.primeDirections(n,s),h=Q.fromMolecule(n).calculateBFS(0);for(let l=0;l<o.length;l++)for(let r=0;r<a.length;r++){let u=e.atomX(i),m=e.atomY(i),c=n.atomX(s),d=n.atomY(s),f=qt.IDEALBOND*Math.cos(o[l]),p=qt.IDEALBOND*Math.sin(o[l]),C=z(o[l],Math.PI+a[r]),g=n.clone();St.translateMolecule(g,u-c+f,m-d+p),St.rotateMolecule(g,C,u+f,m+p);let A=e.clone(),b=A.numAtoms+s,y=A.numAtoms;A.append(g);let E=this.sourceIndex(A,e);if(A.addBond(i,b,1),b=g.addAtom("C",u,m),g.addBond(s,b,1),Ot.mergeFragmentsMask(A,this.asMask(E)),A.numAtoms==y)continue;let x=new Te;x.mol=A,x.display=g,x.srcidx=E,x.molidx=[i],x.temidx=[b],x.attdist=h[s-1],x.bridged=!0,x.guided=!1,this.removeExtraGuides(x,e),t.push(x)}}composeGuidedOne(t,e,n,i,s){if(0==n.atomAdjCount(s))return;let l=Ot.primeDirections(e,i);if(n.atomAdjCount(s)>1&&e.atomAdjCount(i)>0){let t=0,n=0,s=e.atomAdjList(i);for(let l=0;l<s.length;l++)t+=e.atomX(s[l])-e.atomX(i),n+=e.atomY(s[l])-e.atomY(i);let r=Math.atan2(n,t),o=!0;for(let t=0;t<l.length;t++)if(Math.abs(z(r,l[t]))<3*L){o=!1;break}o&&l.push(r)}let r=n.atomX(s),o=n.atomY(s),a=0,h=0,u=n.atomAdjList(s);for(let t=0;t<u.length;t++)a+=n.atomX(u[t])-r,h+=n.atomY(u[t])-o;a/=u.length,h/=u.length;let m=Math.atan2(h,a),c=0;if(1==u.length){let t=e.atomElement(i),s=n.atomElement(u[0]);"C"!=t&&t==s&&(c=1)}for(let a=0;a<l.length;a++){let h=n.clone();if(2==this.guideidx.length)for(let t=1;t<=h.numAtoms;t++)if(t!=s&&"X"==h.atomElement(t)){h.setAtomElement(t,Ne.RESERVED_GUIDESYMBOL);break}St.rotateMolecule(h,l[a]-m,r,o),St.translateMolecule(h,e.atomX(i)-r,e.atomY(i)-o);let u=e.clone(),d=u.numAtoms;u.append(h);let f=this.sourceIndex(u,e);if(Ot.mergeFragmentsMask(u,this.asMask(f)),u.numAtoms==d)continue;let p=0;for(let t=1;t<=u.numAtoms;t++)if(u.atomElement(t)==Ne.RESERVED_GUIDESYMBOL){let e=u.atomAdjList(t);1==e.length&&(p=e[0],p>t&&p--),u.deleteAtomAndBonds(t),f.splice(t-1,1);break}let C=new Te;C.mol=u,C.display=h,C.srcidx=f,C.molidx=[i],C.temidx=[s],C.attdist=0,C.guided=!0,C.scoreModifier=c,C.chainSelect=p,this.removeExtraGuides(C,e),t.push(C)}}composeGuidedTwo(t,e,n,i,s,l,r,o){let a=e.atomX(i),h=e.atomY(i),u=n.atomX(l),m=n.atomY(l),c=n.atomX(r),d=n.atomY(r),f=Math.atan2(e.atomY(s)-h,e.atomX(s)-a),p=Math.atan2(d-m,c-u),C=1==e.atomAdjCount(i),g=e.clone(),A=n.clone();St.rotateMolecule(A,f-p,u,m),o?(St.translateMolecule(A,a-u,h-m),g.setAtomPos(s,A.atomX(r),A.atomY(r))):(St.translateMolecule(A,e.atomX(s)-A.atomX(r),e.atomY(s)-A.atomY(r)),A.setAtomPos(l,a,h));let b=g.numAtoms;g.append(A);let y=this.sourceIndex(g,e);if(Ot.mergeFragmentsMask(g,this.asMask(y)),g.numAtoms==b)return;let E=new Te;E.mol=g,E.display=A,E.srcidx=y,E.molidx=[i,s],E.temidx=[l,r],E.attdist=C?1:0,E.guided=!0,this.removeExtraGuides(E,e),t.push(E)}composeGuidedMulti(e,n,i,s,l,r){let o=0,a=0,h=0,u=0;for(let t=0;t<s.length;t++)o+=n.atomX(s[t]),a+=n.atomY(s[t]);for(let t=0;t<l.length;t++)h+=i.atomX(l[t]),u+=i.atomY(l[t]);o/=s.length,a/=s.length,h/=l.length,u/=l.length;let m=n.numAtoms;for(let c=0;c<s.length;c++)for(let d=0;d<l.length;d++){let f=n.clone(),p=i.clone(),C=Math.atan2(f.atomY(s[c])-a,f.atomX(s[c])-o),g=Math.atan2(p.atomY(l[d])-u,p.atomX(l[d])-h);St.rotateMolecule(p,C-g,h,u),St.translateMolecule(p,o-h,a-u),f.append(p);let A=this.sourceIndex(f,n),b=t.numberArray(0,l.length),y=l.slice(0);t.sort(y);let E=t.booleanArray(!1,m);for(let t=y.length-1;t>=0;t--){let e=y[t]+m,n=0,i=0;for(let t=0;t<s.length;t++)if(!E[s[t]-1]){let l=N(f.atomX(s[t])-f.atomX(e),f.atomY(s[t])-f.atomY(e));(0==n||l<i)&&(n=s[t],i=l)}if(!r){if(N(f.atomX(e)-f.atomX(n),f.atomY(e)-f.atomY(n))>.1*.1){let e=p.addAtom("C",f.atomX(n),f.atomY(n));p.addBond(e,y[t],0)}f.setAtomPos(n,f.atomX(e),f.atomY(e))}b[t]=n,E[n-1]=!0;let l=f.atomAdjList(e);for(let t=0;t<l.length;t++){let i=f.findBond(e,l[t]);f.addBond(n,l[t],f.bondOrder(i),f.bondType(i))}f.deleteAtomAndBonds(e),A.splice(e-1,1),p.setAtomPos(y[t],f.atomX(n),f.atomY(n))}for(let t=f.numAtoms;t>m;t--)if("X"==f.atomElement(t)){f.deleteAtomAndBonds(t),A.splice(t-1,1);for(let e=0;e<y.length;e++)t<y[e]&&y[e]--}for(let t=p.numAtoms;t>=1;t--)"X"==p.atomElement(t)&&p.setAtomElement(t,"C");let x=new Te;x.mol=f,x.display=p,x.srcidx=A,x.molidx=b,x.temidx=y,x.attdist=0,x.guided=!0,this.removeExtraGuides(x,n),e.push(x)}}affixRawPermutations(e){let n=e.length;if(0==n)return;let i=t.booleanArray(!0,n);for(let t=0;t<n-1;t++)if(i[t]){let s=e[t];for(let l=t+1;l<n;l++)if(i[l]){let n=e[l];St.sketchEquivalent(s.mol,n.mol)&&(s.scoreModifier+s.attdist>n.scoreModifier+n.attdist&&(e[t]=n,e[l]=s),i[l]=!1)}}let s=t.numberArray(0,n),l=0;for(let t=0;t<n;t++)i[t]?(s[t]=this.scorePermutation(e[t]),s[t]<1e3&&l++):s[t]=0;if(l>0)for(let t=0;t<n;t++)i[t]&&s[t]>=1e3&&(i[t]=!1);let r=[],o=[];for(let t=0;t<n;t++)i[t]&&(r.push(s[t]),o.push(t));let a=t.idxSort(r);for(let t=0;t<a.length;t++){let n=e[o[a[t]]];n.guided&&this.perms.push(n)}for(let t=0;t<a.length;t++){let n=e[o[a[t]]];n.guided||this.perms.push(n)}}removeExtraGuides(t,e){Dt.removeDuplicateBonds(t.mol);for(let e=t.temidx.length-1;e>=0;e--){let n=t.display.atomElement(t.temidx[e]);"X"!=n&&n!=Ne.RESERVED_GUIDESYMBOL||(t.molidx.splice(e,1),t.temidx.splice(e,1))}for(let n=t.display.numAtoms;n>=1;n--){let i=t.display.atomElement(n);if("X"==i||i==Ne.RESERVED_GUIDESYMBOL)if(St.atomAtPoint(e,t.display.atomX(n),t.display.atomY(n))>0)t.display.setAtomElement(n,"C");else{t.display.deleteAtomAndBonds(n);for(let e=0;e<t.temidx.length;e++)t.temidx[e]>n&&t.temidx[e]--}}}scorePermutation(e){let n=this.mol,i=e.display,s=e.mol,l=.2*e.attdist+e.scoreModifier;l+=St.congestionMolecule(s,.001),l-=s.numAtoms;let r=n.numAtoms,o=i.numAtoms,a=[],h=[],u=[],m=[];for(let t=0;t<r;t++)a.push(n.atomX(t+1)),h.push(n.atomY(t+1));for(let t=0;t<o;t++)u.push(i.atomX(t+1)),m.push(i.atomY(t+1));for(let t=0;t<r;t++)for(let n=0;n<o;n++){if(N(a[t]-u[n],h[t]-m[n])>St.OVERLAP_THRESHOLD_SQ)continue;let i=!1;for(let s=0;s<e.molidx.length;s++)if(e.molidx[s]==t+1&&e.temidx[s]==n+1){i=!0;break}i||(l+=100)}if(!e.guided)for(let t=0;t<e.molidx.length;t++){let s=n.atomElement(e.molidx[t]);if("C"==s||"O"==s||"S"==s||"N"==s||"P"==s)continue;let r=n.atomAdjList(e.molidx[t]),o=i.atomAdjList(e.temidx[t]);if(!(r.length+o.length>=4))for(let s=0;s<r.length;s++)for(let c=0;c<o.length;c++){let d=r[s],f=o[c],p=n.bondOrder(n.findBond(e.molidx[t],d)),C=i.bondOrder(i.findBond(e.temidx[t],f)),g=0;if(1==p&&1==C||1==p&&2==C||2==p&&1==C)g=120;else{if(!(2==p&&2==C||1==p&&3==C||3==p&&1==C))continue;g=180}let A=a[d-1]-a[e.molidx[t]-1],b=h[d-1]-h[e.molidx[t]-1],y=u[f-1]-u[e.temidx[t]-1],E=m[f-1]-m[e.temidx[t]-1],x=Math.abs(z(Math.atan2(b,A),Math.atan2(E,y)))*L;Math.abs(x-g)>5&&(l+=50)}}for(let t=1;t<=s.numAtoms;t++)if("C"==s.atomElement(t)||"N"==s.atomElement(t)){let e=s.atomAdjBonds(t),n=0;for(let t=0;t<e.length;t++){let i=s.bondOrder(e[t]);if(n+=i,0==i){n=0;break}}n>4&&(l+=1e3)}if(e.molidx.length>=2){let s=t.booleanArray(!1,r);for(let t=0;t<e.molidx.length;t++)s[e.molidx[t]-1]=!0;for(let t=1;t<=n.numBonds;t++){let r=n.bondFrom(t),o=n.bondTo(t);if(!s[r-1]||!s[o-1])continue;let a=e.molidx.indexOf(r),h=e.molidx.indexOf(o),u=i.findBond(e.temidx[a],e.temidx[h]);0!=u&&n.bondOrder(t)!=i.bondOrder(u)&&(l+=1)}}return l}sourceIndex(e,n){let i=t.numberArray(0,e.numAtoms);for(let t=n.numAtoms;t>=1;t--)i[t-1]=t;return i}asMask(e){let n=t.booleanArray(!1,e.length);for(let t=0;t<e.length;t++)n[t]=0!=e[t];return n}}var qe,Se;Ne.RESERVED_GUIDESYMBOL="XXX",function(t){t[t.Delete=1]="Delete",t[t.Clear=2]="Clear",t[t.Copy=3]="Copy",t[t.Cut=4]="Cut",t[t.SelectAll=5]="SelectAll",t[t.SelectNone=6]="SelectNone",t[t.SelectPrevComp=7]="SelectPrevComp",t[t.SelectNextComp=8]="SelectNextComp",t[t.SelectSide=9]="SelectSide",t[t.SelectGrow=10]="SelectGrow",t[t.SelectShrink=11]="SelectShrink",t[t.SelectChain=12]="SelectChain",t[t.SelectSmRing=13]="SelectSmRing",t[t.SelectRingBlk=14]="SelectRingBlk",t[t.SelectCurElement=15]="SelectCurElement",t[t.SelectToggle=16]="SelectToggle",t[t.SelectUnCurrent=17]="SelectUnCurrent",t[t.Element=18]="Element",t[t.AtomPos=19]="AtomPos",t[t.Charge=20]="Charge",t[t.Connect=21]="Connect",t[t.Disconnect=22]="Disconnect",t[t.MetalLigate=23]="MetalLigate",t[t.BondOrder=24]="BondOrder",t[t.BondType=25]="BondType",t[t.BondGeom=26]="BondGeom",t[t.BondAtom=27]="BondAtom",t[t.BondSwitch=28]="BondSwitch",t[t.BondRotate=29]="BondRotate",t[t.BondAddTwo=30]="BondAddTwo",t[t.BondInsert=31]="BondInsert",t[t.Join=32]="Join",t[t.Nudge=33]="Nudge",t[t.NudgeLots=34]="NudgeLots",t[t.NudgeFar=35]="NudgeFar",t[t.Flip=36]="Flip",t[t.Scale=37]="Scale",t[t.Rotate=38]="Rotate",t[t.BondDist=39]="BondDist",t[t.AlignAngle=40]="AlignAngle",t[t.AlignRegular=41]="AlignRegular",t[t.AdjustTorsion=42]="AdjustTorsion",t[t.Move=43]="Move",t[t.Ring=44]="Ring",t[t.TemplateFusion=45]="TemplateFusion",t[t.AbbrevTempl=46]="AbbrevTempl",t[t.AbbrevGroup=47]="AbbrevGroup",t[t.AbbrevFormula=48]="AbbrevFormula",t[t.AbbrevClear=49]="AbbrevClear",t[t.AbbrevExpand=50]="AbbrevExpand",t[t.BondArtifactPath=51]="BondArtifactPath",t[t.BondArtifactRing=52]="BondArtifactRing",t[t.BondArtifactArene=53]="BondArtifactArene",t[t.BondArtifactClear=54]="BondArtifactClear",t[t.PolymerBlock=55]="PolymerBlock",t[t.AddHydrogens=56]="AddHydrogens",t[t.RemoveHydrogens=57]="RemoveHydrogens",t[t.QueryClear=58]="QueryClear",t[t.QueryCopy=59]="QueryCopy",t[t.QueryPaste=60]="QueryPaste",t[t.QuerySetAtom=61]="QuerySetAtom",t[t.QuerySetBond=62]="QuerySetBond",t[t.QueryBondAny=63]="QueryBondAny",t[t.SproutDirection=64]="SproutDirection"}(qe||(qe={}));class we{constructor(e,n,i,s){this.input=e,this.activity=n,this.param=i,this.owner=s,this.toClipboard=null,this.output={mol:null,currentAtom:-1,currentBond:-1,selectedMask:null};let l=this.input.mol.numAtoms;for(null==this.input.selectedMask&&(this.input.selectedMask=t.booleanArray(!1,l));this.input.selectedMask.length<l;)this.input.selectedMask.push(!1);if(this.subjectMask=this.input.selectedMask.slice(0),this.subjectLength=t.maskCount(this.subjectMask),this.subjectIndex=[],this.hasSelected=this.subjectLength>0,0==this.subjectLength){if(this.input.currentAtom>0)this.subjectLength=1,this.subjectMask[this.input.currentAtom-1]=!0,this.subjectIndex=[this.input.currentAtom];else if(this.input.currentBond>0){let t=this.input.mol.bondFrom(this.input.currentBond),e=this.input.mol.bondTo(this.input.currentBond),n=Math.min(t,e),i=Math.max(t,e);this.subjectLength=2,this.subjectMask[n-1]=!0,this.subjectMask[i-1]=!0,this.subjectIndex=[n,i]}}else this.subjectIndex=t.maskIdx(this.subjectMask),t.addTo(this.subjectIndex,1)}setOwner(t){this.owner=t}evaluate(){return!0}execute(){var t;let e=this.param;if(this.activity==qe.Delete)this.execDelete();else if(this.activity==qe.Clear)this.execClear();else if(this.activity==qe.Copy)this.execCopy(!1);else if(this.activity==qe.Cut)this.execCopy(!0);else if(this.activity==qe.SelectAll)this.execSelectAll(!0);else if(this.activity==qe.SelectNone)this.execSelectAll(!1);else if(this.activity==qe.SelectPrevComp)this.execSelectComp(-1);else if(this.activity==qe.SelectNextComp)this.execSelectComp(1);else if(this.activity==qe.SelectSide)this.execSelectSide();else if(this.activity==qe.SelectGrow)this.execSelectGrow();else if(this.activity==qe.SelectShrink)this.execSelectShrink();else if(this.activity==qe.SelectChain)this.execSelectChain();else if(this.activity==qe.SelectSmRing)this.execSelectSmRing();else if(this.activity==qe.SelectRingBlk)this.execSelectRingBlk();else if(this.activity==qe.SelectCurElement)this.execSelectCurElement();else if(this.activity==qe.SelectToggle)this.execSelectToggle();else if(this.activity==qe.SelectUnCurrent)this.execSelectUnCurrent();else if(this.activity==qe.Element)this.execElement(e.element,e.positionX,e.positionY,e.keepAbbrev);else if(this.activity==qe.Charge)this.execCharge(e.delta);else if(this.activity==qe.Connect)this.execConnect(1,qt.BONDTYPE_NORMAL);else if(this.activity==qe.Disconnect)this.execDisconnect();else if(this.activity==qe.MetalLigate)this.execMetalLigate();else if(this.activity==qe.BondOrder)this.execBond(e.order,qt.BONDTYPE_NORMAL);else if(this.activity==qe.BondType)this.execBond(1,e.type);else if(this.activity==qe.BondGeom)this.execBondGeom(e.geom);else if(this.activity==qe.BondAtom)this.execBondAtom(e.order,e.type,e.element,e.x1,e.y1,e.x2,e.y2);else if(this.activity==qe.BondSwitch)this.execBondSwitch();else if(this.activity==qe.BondRotate)this.execBondRotate();else if(this.activity==qe.BondAddTwo)this.execBondAddTwo();else if(this.activity==qe.BondInsert)this.execBondInsert();else if(this.activity==qe.Join)this.execJoin();else if(this.activity==qe.Nudge)this.execNudge(e.dir,.1);else if(this.activity==qe.NudgeLots)this.execNudge(e.dir,1);else if(this.activity==qe.NudgeFar)this.execNudgeFar(e.dir);else if(this.activity==qe.Flip)this.execFlip(e.axis);else if(this.activity==qe.Scale)this.execScale(e.mag);else if(this.activity==qe.Rotate)this.execRotate(e.theta,e.centreX,e.centreY);else if(this.activity==qe.BondDist)this.execBondDist(e.dist);else if(this.activity==qe.AlignAngle)this.execAlignAngle(e.angle);else if(this.activity==qe.AlignRegular)this.execAlignRegular();else if(this.activity==qe.AdjustTorsion)this.execAdjustTorsion(e.angle);else if(this.activity==qe.Move)this.execMove(e.refAtom,e.deltaX,e.deltaY);else if(this.activity==qe.Ring)this.execRing(e.ringX,e.ringY,e.aromatic);else{if(this.activity==qe.TemplateFusion)return this.execTemplateFusion(null!==(t=e.frag)&&void 0!==t?t:qt.fromString(e.fragNative)),void(this.owner&&this.owner.setPermutations(this.output.permutations));this.activity==qe.AbbrevTempl?this.execAbbrevTempl():this.activity==qe.AbbrevGroup?this.execAbbrevGroup():this.activity==qe.AbbrevFormula?this.execAbbrevFormula():this.activity==qe.AbbrevClear?this.execAbbrevClear():this.activity==qe.AbbrevExpand?this.execAbbrevExpand():this.activity==qe.BondArtifactPath||this.activity==qe.BondArtifactRing||this.activity==qe.BondArtifactArene||this.activity==qe.BondArtifactClear?this.execBondArtifact(this.activity):this.activity==qe.PolymerBlock?this.execPolymerBlock():this.activity==qe.AddHydrogens?this.execAddHydrogens():this.activity==qe.RemoveHydrogens?this.execRemoveHydrogens():this.activity==qe.QueryClear?this.execQueryClear():this.activity==qe.QueryCopy?this.execQueryCopy():this.activity==qe.QueryPaste?this.execQueryPaste():this.activity==qe.QuerySetAtom?this.execQuerySetAtom():this.activity==qe.QuerySetBond?this.execQuerySetBond():this.activity==qe.QueryBondAny?this.execQueryBondAny():this.activity==qe.SproutDirection&&this.execSproutDirection(e.deltaX,e.deltaY)}this.finish()}finish(){this.owner&&(null!=this.output.mol||this.output.currentAtom>=0||this.output.currentBond>=0||null!=this.output.selectedMask?(this.owner.setState(this.output,!0),null!=this.errmsg&&this.owner.showMessage(this.errmsg,!1)):null!=this.errmsg&&this.owner.showMessage(this.errmsg,!0))}execDelete(){if(!this.requireSubject())return;let t=this.input.mol;if(this.output.mol=t.clone(),this.zapSubject(),this.input.currentBond>0&&!this.hasSelected)return this.output.mol.deleteBond(this.input.currentBond),void(this.output.currentBond=0);if(1==this.subjectLength&&this.subjectIndex[0]==this.input.currentAtom){let e=t.atomAdjList(this.input.currentAtom);1==e.length&&(this.output.currentAtom=e[0],this.output.currentAtom>this.input.currentAtom&&this.output.currentAtom--)}for(let t=this.subjectLength-1;t>=0;t--)this.output.mol.deleteAtomAndBonds(this.subjectIndex[t])}execCopy(e){let n=this.input.mol;this.subjectLength>0&&(n=Dt.subgraphWithAttachments(n,this.subjectMask)),this.owner?this.owner.performCopy(n):this.toClipboard=n.toString(),e&&(this.zapSubject(),this.output.mol=Dt.subgraphMask(this.input.mol,t.notMask(this.subjectMask)))}execClear(){this.output.mol=new qt,this.zapSubject()}execSelectAll(e){let n=!0;for(let t=0;t<this.input.mol.numAtoms;t++)if(this.subjectMask[t]!=e){n=!1;break}n?this.errmsg=e?"All atoms already selected.":"All atoms already deselected.":this.output.selectedMask=t.booleanArray(e,this.input.mol.numAtoms)}execSelectComp(e){let n=Dt.componentList(this.input.mol);if(1==n.length&&this.hasSelected&&this.subjectLength==this.input.mol.numAtoms)return void(this.errmsg="All atoms already selected.");let i=this.pickSelectedGroup(n,e);this.output.selectedMask=t.booleanArray(!1,this.input.mol.numAtoms);for(let t=0;t<n[i].length;t++)this.output.selectedMask[n[i][t]-1]=!0}execSelectSide(){if(!this.requireCurrent())return;let e=this.input.mol,n=this.input.currentAtom,i=this.input.currentBond;if(n>0&&0==e.atomAdjCount(n))return void(this.errmsg="Current atom has no neighbours.");if(i>0&&1==e.atomAdjCount(e.bondFrom(i))&&1==e.atomAdjCount(e.bondTo(i)))return void(this.errmsg="Current bond has no neighbours.");let s=n>0?Dt.getAtomSides(e,n):Dt.getBondSides(e,i),l=this.pickSelectedGroup(s,1);this.output.selectedMask=t.booleanArray(!1,e.numAtoms);for(let t=0;t<s[l].length;t++)this.output.selectedMask[s[l][t]-1]=!0}execSelectGrow(){if(!this.requireSubject())return;let t=this.input.mol,e=this.input.currentAtom,n=this.input.currentBond;if(this.output.selectedMask=this.input.selectedMask.slice(0),this.hasSelected)for(let e=1;e<=t.numBonds;e++){let n=t.bondFrom(e)-1,i=t.bondTo(e)-1;this.input.selectedMask[n]&&!this.input.selectedMask[i]?this.output.selectedMask[i]=!0:this.input.selectedMask&&!this.input.selectedMask[n]&&(this.output.selectedMask[n]=!0)}else e>0?this.output.selectedMask[e-1]=!0:(this.output.selectedMask[t.bondFrom(n)-1]=!0,this.output.selectedMask[t.bondTo(n)-1]=!0)}execSelectShrink(){if(!this.requireSelected())return;let e=this.input.mol,n=t.numberArray(0,e.numAtoms);for(let t=1;t<=e.numBonds;t++){let i=e.bondFrom(t)-1,s=e.bondTo(t)-1;this.input.selectedMask[i]&&this.input.selectedMask[s]&&(n[i]++,n[s]++)}this.output.selectedMask=this.input.selectedMask.slice(0);for(let t=0;t<e.numAtoms;t++)this.output.selectedMask[t]=this.input.selectedMask[t]&&n[t]>=2}execSelectChain(){if(!this.requireSubject())return;let t=this.input.mol;this.output.selectedMask=this.input.selectedMask.slice(0);for(let e=1;e<=t.numBonds;e++){let n=t.bondFrom(e)-1,i=t.bondTo(e)-1;this.input.selectedMask[n]&&!this.input.selectedMask[i]&&0==t.atomRingBlock(i+1)?this.output.selectedMask[i]=!0:this.input.selectedMask[i]&&!this.input.selectedMask[n]&&0==t.atomRingBlock(n+1)&&(this.output.selectedMask[n]=!0)}}execSelectSmRing(){if(this.requireSubject()){this.output.selectedMask=this.input.selectedMask.slice(0);for(let t=3;t<=8;t++){let e=this.input.mol.findRingsOfSize(t);for(let t=0;t<e.length;t++){let n=!1;for(let i=0;i<e[t].length;i++)if(this.subjectMask[e[t][i]-1]){n=!0;break}if(n)for(let n=0;n<e[t].length;n++)this.output.selectedMask[e[t][n]-1]=!0}}}}execSelectRingBlk(){if(!this.requireSubject())return;let e=this.input.mol;this.output.selectedMask=this.input.selectedMask.slice(0);let n=0;for(let t=1;t<=e.numAtoms;t++)n=Math.max(n,e.atomRingBlock(t));if(0==n)return;let i=t.booleanArray(!1,n);for(let t=1;t<=e.numAtoms;t++){let n=e.atomRingBlock(t);n>0&&this.subjectMask[t-1]&&(i[n-1]=!0)}for(let t=1;t<=e.numAtoms;t++){let n=e.atomRingBlock(t);n>0&&i[n-1]&&(this.output.selectedMask[t-1]=!0)}}execSelectCurElement(){if(!this.requireCurrent())return;let t=this.input.mol;this.output.selectedMask=this.input.selectedMask.slice(0);let e="",n="";this.input.currentAtom>0?e=t.atomElement(this.input.currentAtom):(e=t.atomElement(t.bondFrom(this.input.currentBond)),n=t.atomElement(t.bondTo(this.input.currentBond)));for(let i=1;i<=t.numAtoms;i++)t.atomElement(i)!=e&&t.atomElement(i)!=n||(this.output.selectedMask[i-1]=!0)}execSelectToggle(){if(this.requireCurrent())if(this.output.selectedMask=this.input.selectedMask.slice(0),this.input.currentAtom>0)this.output.selectedMask[this.input.currentAtom-1]=!this.output.selectedMask[this.input.currentAtom-1];else{let t=this.input.mol.bondFrom(this.input.currentBond),e=this.input.mol.bondTo(this.input.currentBond),n=!this.input.selectedMask[t-1]||!this.input.selectedMask[e-1];this.output.selectedMask[t-1]=n,this.output.selectedMask[e-1]=n}}execSelectUnCurrent(){this.requireCurrent()&&(this.output.selectedMask=this.input.selectedMask.slice(0),this.input.currentAtom>0?this.output.selectedMask[this.input.currentAtom-1]=!1:(this.output.selectedMask[this.input.mol.bondFrom(this.input.currentBond)-1]=!1,this.output.selectedMask[this.input.mol.bondTo(this.input.currentBond)-1]=!1))}execElement(t,e,n,i){if(this.subjectLength>0&&!["A","X","Y","Z","Q","M","T","E","R"].includes(t)){let e=!1;for(let n=0;n<this.subjectLength;n++)if(this.input.mol.atomElement(this.subjectIndex[n])!=t){e=!0;break}if(!e)return void(this.errmsg="Elements not changed.")}let s=this.output.mol=this.input.mol.clone(),l=e=>{if("A"==t)mt.setQueryAtomElementsNot(s,e,["H"]),mt.deleteQueryAtom(s,e,ot.Elements);else if("X"==t)mt.setQueryAtomElements(s,e,["F","Cl","Br","I"]),mt.deleteQueryAtom(s,e,ot.ElementsNot);else if("Y"==t)mt.setQueryAtomElements(s,e,["O","S","Se","Te"]),mt.deleteQueryAtom(s,e,ot.ElementsNot);else if("Z"==t)mt.setQueryAtomElements(s,e,["F","Cl","Br","O","S"]),mt.deleteQueryAtom(s,e,ot.ElementsNot);else if("Q"==t)mt.setQueryAtomElementsNot(s,e,["H","C"]),mt.deleteQueryAtom(s,e,ot.Elements);else if("M"==t){const t=["H","B","C","N","O","F","Si","P","S","Cl","As","Se","Br","Te","I"];mt.setQueryAtomElementsNot(s,e,t),mt.deleteQueryAtom(s,e,ot.Elements)}else if("T"==t){const t=["Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr"];mt.setQueryAtomElements(s,e,t),mt.deleteQueryAtom(s,e,ot.ElementsNot)}else if("E"==t){const t=["B","N","O","F","Al","Si","P","S","Cl","Zn","Ga","Se","As","Se","Br","Cd","In","Sn","Sb","Te","I","Hg","Tl","Pb","Bi","Pb","At"];mt.setQueryAtomElements(s,e,t),mt.deleteQueryAtom(s,e,ot.ElementsNot)}else"R"==t&&(mt.setQueryAtomElements(s,e,["C","N","O","S","P","H"]),mt.deleteQueryAtom(s,e,ot.ElementsNot))};if(0==s.numAtoms)s.addAtom(t,0,0),l(s.numAtoms);else if(0==this.subjectLength)null!=e&&null!=n?s.addAtom(t,e,n):Ot.placeNewAtom(s,t),l(s.numAtoms);else for(let e=0;e<this.subjectLength;e++)i?s.setAtomElement(this.subjectIndex[e],t):Dt.setAtomElement(s,this.subjectIndex[e],t),l(this.subjectIndex[e])}execCharge(t){if(this.requireSubject()){this.output.mol=this.input.mol.clone();for(let e=0;e<this.subjectLength;e++){let n=Math.max(-20,Math.min(20,this.input.mol.atomCharge(this.subjectIndex[e])+t));this.output.mol.setAtomCharge(this.subjectIndex[e],n)}}}execConnect(t,e){if(!this.requireSubject())return;let n=Ot.pickAtomsToConnect(this.input.mol,this.subjectIndex);if(null!=n){this.output.mol=this.input.mol.clone();for(let i=0;i<n.length;i+=2)Dt.addBond(this.output.mol,n[i],n[i+1],t,e)}else this.errmsg="Subject atoms contain no bonds suitable for connection."}execDisconnect(){let e=[],n=this.input.mol;if(this.hasSelected)for(let t=1;t<=n.numBonds;t++)this.subjectMask[n.bondFrom(t)-1]&&this.subjectMask[n.bondTo(t)-1]&&e.push(t);else if(this.input.currentAtom>0)for(let t of n.atomAdjBonds(this.input.currentAtom))e.push(t);else this.input.currentBond>0&&e.push(this.input.currentBond);if(0==e.length)return void(this.errmsg="Subject atoms contain no bonds suitable for disconnection.");let i=t.booleanArray(!1,n.numBonds);for(let t of e)i[t-1]=!0;this.output.mol=this.input.mol.clone();for(let t=n.numBonds;t>=1;t--)i[t-1]&&this.output.mol.deleteBond(t)}execMetalLigate(){if(!this.requireSubject())return;let e=this.input.mol,n=this.subjectIndex.slice(0),i=this.input.currentAtom;if(0==i)for(let t of this.subjectIndex){let n=e.atomicNumber(t);if(s.ELEMENT_BLOCKS[n]>=3){i=t;break}}if(0==i)for(let t of this.subjectIndex){let n=e.atomicNumber(t);if(s.ELEMENT_ROWS[n]>=3){i=t;break}}if(0==i)return void(this.errmsg="Unsure which is the metal atom: try indicating as current.");let l=n.indexOf(i);if(l>=0&&n.splice(l,1),0==n.length&&(n=e.atomAdjList(i)),0!=n.length){e=new ve(e,i,n).generate(),this.output.mol=e,this.output.currentAtom=i,this.output.currentBond=-1,this.output.selectedMask=t.booleanArray(!1,e.numAtoms);for(let t of n)this.output.selectedMask[t-1]=!0}else this.errmsg="Metal centre has no attachments: try selecting atom join-points."}execBond(t,e){if(!this.requireSubject())return;if(1==this.subjectLength)return void this.performBondNew(this.subjectIndex[0],t,e);let n=Dt.subgraphMask(this.input.mol,this.subjectMask),i=!0;for(let t=n.numAtoms;t>=1;t--)if(1!=n.atomConnComp(t)){i=!1;break}i?this.performBondChange(t,e):this.execConnect(t,e)}execBondGeom(t){let e=2==this.subjectLength?this.input.mol.findBond(this.subjectIndex[0],this.subjectIndex[1]):0;0==this.subjectLength||this.subjectLength>2||2==this.subjectLength&&0==e?this.errmsg="The subject must be a single atom or bond.":1==this.subjectLength?this.performBondGeomAtom(t,this.subjectIndex[0]):this.performBondGeomBond(t,e)}execBondAtom(t,e,n,i,s,l,r){let o=this.input.mol,a=St.atomAtPoint(o,i,s,.01),h=St.atomAtPoint(o,l,r,.01);a>0&&a==h||a>0&&h>0&&o.findBond(a,h)>0||(this.output.mol=o.clone(),0==a&&(a=this.output.mol.addAtom("C",i,s)),0==h&&(h=this.output.mol.addAtom(n,l,r)),this.output.mol.addBond(a,h,t,e))}execBondSwitch(){if(this.input.altmol)return this.output.mol=this.input.altmol,void(this.output.altmol=this.input.mol);if(!this.requireSubject())return;let t=this.input.mol,e=0,n=[];if(1==this.subjectLength){e=this.subjectIndex[0];let i=t.atomAdjList(e);for(let e=0;e<i.length;e++)1==t.atomAdjCount(i[e])&&n.push(i[e])}else if(2==this.subjectLength&&t.findBond(this.subjectIndex[0],this.subjectIndex[1])>0){let i=t.atomAdjCount(this.subjectIndex[0]),s=t.atomAdjCount(this.subjectIndex[1]);i>1&&1==s?(e=this.subjectIndex[0],n.push(this.subjectIndex[1])):1==i&&s>1&&(e=this.subjectIndex[1],n.push(this.subjectIndex[0]))}if(0==e||0==n.length)return void(this.errmsg="Subject must include a terminal bond.");let i=Ot.guessAtomGeometry(t,e,1);0!=i.length?(this.output.mol=Ot.switchAtomGeometry(t,e,n,i),null==this.output.mol&&(this.errmsg="No alternative geometries identified.")):this.errmsg="No alternative geometries identified."}execBondRotate(){let e=this.input.currentBond;if(0==e)return void(this.errmsg="There must be a current bond.");let n=this.input.mol;if(n.bondInRing(e))return void(this.errmsg="Cannot rotate a ring-bond.");if(1==n.atomAdjCount(n.bondFrom(e))&&1==n.atomAdjCount(n.bondTo(e)))return void(this.errmsg="Two-atom components do not rotate.");n=n.clone();let[i,s,l]=this.mobileSide(e,!0),r=n.atomX(i),o=n.atomY(i),a=Math.atan2(n.atomY(i)-n.atomY(s),n.atomX(i)-n.atomX(s));for(let t of l)if(t!=i){let e=n.atomX(t)-r,i=n.atomY(t)-o,s=N(e,i),l=Math.atan2(i,e);l=a-z(l,a),n.setAtomPos(t,r+s*Math.cos(l),o+s*Math.sin(l))}let h=t.idxMask(t.add(l,-1),n.numAtoms);for(let t=1;t<=n.numBonds;t++)if(h[n.bondFrom(t)-1]&&h[n.bondTo(t)-1]){let e=n.bondType(t);e==qt.BONDTYPE_INCLINED?n.setBondType(t,qt.BONDTYPE_DECLINED):e==qt.BONDTYPE_DECLINED&&n.setBondType(t,qt.BONDTYPE_INCLINED)}St.sketchEquivalent(this.input.mol,n)?this.errmsg="Rotation has no effect.":this.output.mol=n}execBondAddTwo(){if(1!=this.subjectLength)return void(this.errmsg="Subject must be a single atom.");let t=this.subjectIndex[0];if(this.input.mol.atomAdjCount(t)<2)return void(this.errmsg="Subject atom must already have at least 2 bonds.");let e=Ot.calculateNewBondAngles(this.input.mol,t,1);if(0==e.length&&(e=Ot.exitVectors(this.input.mol,t)),0==e.length)return void(this.errmsg="Could not find a suitable geometry for new substituents.");let n=e[0],i=this.input.mol.atomX(t),s=this.input.mol.atomY(t);if(e.length>1){let t=0;for(let l=0;l<e.length;l++){let r=i+qt.IDEALBOND*Math.cos(e[l]),o=s+qt.IDEALBOND*Math.sin(e[l]),a=St.congestionPoint(this.input.mol,r,o);(0==l||a<t)&&(t=a,n=e[l])}}let l=n-30*_,r=n+30*_,o=this.input.mol.clone(),a=o.addAtom("C",i+qt.IDEALBOND*Math.cos(l),s+qt.IDEALBOND*Math.sin(l)),h=o.addAtom("C",i+qt.IDEALBOND*Math.cos(r),s+qt.IDEALBOND*Math.sin(r));o.addBond(t,a,1),o.addBond(t,h,1),this.output.mol=o}execBondInsert(){let e=this.input.mol,n=this.input.currentBond;if(0==n)return void(this.errmsg="There must be a current bond.");if(e.bondInRing(n))return void(this.errmsg="Cannot insert into a ring-bond.");let[i,s,l]=this.mobileSide(n);e=e.clone(),e.setBondOrder(n,1);let r=t.booleanArray(!1,e.numAtoms);for(let t of l)r[t-1]=!0;let o=Dt.subgraphWithAttachments(e,r);for(let t=e.numAtoms;t>=1;t--)r[t-1]&&t!=i&&(e.deleteAtomAndBonds(t),t<i&&(i-=1));e.setAtomElement(i,"C"),e.setAtomCharge(i,0),e.setAtomUnpaired(i,0),e.setAtomHExplicit(i,qt.HEXPLICIT_UNKNOWN),e.setAtomIsotope(i,qt.ISOTOPE_NATURAL),e.setAtomMapNum(i,0),e.setAtomExtra(i,[]),e.setAtomTransient(i,[]);let a=new Ne(e,o,"");a.withGuideOnly=!0,a.permuteAtom(i),0!=a.perms.length?(this.output.mol=a.perms[0].mol,this.zapSubject(),this.output.currentAtom=i):this.errmsg="Unable to insert."}execJoin(){this.requireSubject()&&(this.output.mol=Ot.joinOverlappingAtoms(this.input.mol,this.subjectMask),null==this.output.mol?this.errmsg="Subject contains no overlapping atoms.":this.zapSubject())}execNudge(t,e){if(!this.requireSubject())return;let n=e*("left"==t?-1:"right"==t?1:0),i=e*("down"==t?-1:"up"==t?1:0);this.output.mol=this.input.mol.clone();for(let t=0;t<this.subjectLength;t++){let e=this.output.mol.atomX(this.subjectIndex[t]),s=this.output.mol.atomY(this.subjectIndex[t]);this.output.mol.setAtomPos(this.subjectIndex[t],e+n,s+i)}}execNudgeFar(t){if(!this.requireSubject())return;if(this.subjectLength==this.input.mol.numAtoms)return void(this.errmsg="Cannot apply to entire molecule.");let e="left"==t?-1:"right"==t?1:0,n="down"==t?-1:"up"==t?1:0;this.output.mol=Ot.moveToEdge(this.input.mol,this.subjectMask,e,n),null==this.output.mol&&this.execNudge(t,1)}execFlip(e){if(this.input.mol.numAtoms<2)return void(this.errmsg="At least 2 atoms are required.");let n="ver"==e,i=0,s=0,l=this.subjectMask,r=this.input.mol;if(this.input.currentAtom>0){if(i=r.atomX(this.input.currentAtom),s=r.atomY(this.input.currentAtom),!this.hasSelected){l=t.booleanArray(!1,r.numAtoms);let e=r.atomConnComp(this.input.currentAtom);for(let t=1;t<=r.numAtoms;t++)l[t-1]=r.atomConnComp(t)==e}}else if(this.input.currentBond>0){let e=r.bondFrom(this.input.currentBond),n=r.bondTo(this.input.currentBond);if(i=.5*(r.atomX(e)+r.atomX(n)),s=.5*(r.atomY(e)+r.atomY(n)),!this.hasSelected){l=t.booleanArray(!1,r.numAtoms);let n=r.atomConnComp(e);for(let t=1;t<=r.numAtoms;t++)l[t-1]=r.atomConnComp(t)==n}}else if(0==this.subjectLength){let e=r.boundary();i=.5*(e.minX()+e.maxX()),s=.5*(e.minY()+e.maxY()),l=t.booleanArray(!0,r.numAtoms)}else{for(let t=0;t<this.subjectLength;t++)i+=r.atomX(this.subjectIndex[t]),s+=r.atomY(this.subjectIndex[t]);let t=1/this.subjectLength;i*=t,s*=t}this.output.mol=r.clone();for(let t=1;t<=r.numAtoms;t++)l[t-1]&&(n?this.output.mol.setAtomY(t,2*s-this.output.mol.atomY(t)):this.output.mol.setAtomX(t,2*i-this.output.mol.atomX(t)))}execScale(e){const{mol:n,currentAtom:i,currentBond:s}=this.input;if(n.numAtoms<2)return void(this.errmsg="At least 2 atoms are required.");if(i>0){let s=[];for(let t of this.subjectIndex)t!=i&&n.findBond(i,t)>0&&s.push(t);let l=Q.fromMolecule(n);l.isolateNode(i-1);let r=!1;for(let o of l.calculateComponentGroups()){t.addTo(o,1);let l=0,a=0,h=0;for(let t of o)s.includes(t)&&(a+=n.atomX(t)-n.atomX(i),h+=n.atomY(t)-n.atomY(i),l++);if(0!=l&&([a,h]=[a/l,h/l],!(Math.abs(a)<.1&&Math.abs(h)<.1))){[a,h]=[a*(e-1),h*(e-1)],this.output.mol||(this.output.mol=n.clone());for(let t of o)this.output.mol.setAtomPos(t,this.output.mol.atomX(t)+a,this.output.mol.atomY(t)+h);r=!0}}if(r)return}let l;if(2==this.subjectLength&&(l=n.findBond(this.subjectIndex[0],this.subjectIndex[1]))>0&&!n.bondInRing(l)){let t=this.subjectIndex[0],i=this.subjectIndex[1],s=n.clone();s.deleteBond(l);let r=[],o=[];for(let e=1;e<=s.numAtoms;e++)s.atomConnComp(e)==s.atomConnComp(t)?r.push(e):s.atomConnComp(e)==s.atomConnComp(i)&&o.push(e);let a=(n.atomX(i)-n.atomX(t))*(e-1),h=(n.atomY(i)-n.atomY(t))*(e-1);if(r.length==o.length&&(a*=.5,h*=.5),this.output.mol=n.clone(),r.length<=o.length)for(let t=0;t<r.length;t++){let e=r[t];this.output.mol.setAtomPos(e,this.output.mol.atomX(e)-a,this.output.mol.atomY(e)-h)}if(o.length<=r.length)for(let t=0;t<o.length;t++){let e=o[t];this.output.mol.setAtomPos(e,this.output.mol.atomX(e)+a,this.output.mol.atomY(e)+h)}return}let r=0,o=0;if(i>0)r=n.atomX(i),o=n.atomY(i);else if(s>0){let t=n.bondFrom(s),e=n.bondTo(s);r=.5*(n.atomX(t)+n.atomX(e)),o=.5*(n.atomY(t)+n.atomY(e))}else{for(let t=0;t<this.subjectLength;t++)r+=n.atomX(this.subjectIndex[t]),o+=n.atomY(this.subjectIndex[t]);let t=1/this.subjectLength;r*=t,o*=t}this.output.mol=n.clone();for(let t=0;t<this.subjectLength;t++){let n=this.output.mol.atomX(this.subjectIndex[t]),i=this.output.mol.atomY(this.subjectIndex[t]);this.output.mol.setAtomPos(this.subjectIndex[t],(n-r)*e+r,(i-o)*e+o)}}execRotate(e,n,i){e*=_;let s=this.input.mol;if(null!=n&&null!=i){this.output.mol=s.clone();let l=0==this.subjectLength?t.booleanArray(!0,s.numAtoms):this.subjectMask;return void St.rotateAtoms(this.output.mol,l,n,i,e)}if(s.numAtoms<2)return void(this.errmsg="At least 2 atoms are required.");let l=0,r=0,o=this.subjectMask;if(this.input.currentAtom>0){if(l=s.atomX(this.input.currentAtom),r=s.atomY(this.input.currentAtom),!this.hasSelected){o=t.booleanArray(!1,s.numAtoms);let e=s.atomConnComp(this.input.currentAtom);for(let t=1;t<=s.numAtoms;t++)o[t-1]=s.atomConnComp(t)==e}if(1==t.maskCount(o)&&o[this.input.currentAtom-1])return void(this.errmsg="Component is isolated.")}else if(this.input.currentBond>0){let e=s.bondFrom(this.input.currentBond),n=s.bondTo(this.input.currentBond);if(l=.5*(s.atomX(e)+s.atomX(n)),r=.5*(s.atomY(e)+s.atomY(n)),!this.hasSelected){o=t.booleanArray(!1,s.numAtoms);let n=s.atomConnComp(e);for(let t=1;t<=s.numAtoms;t++)o[t-1]=s.atomConnComp(t)==n}}else if(0==this.subjectLength){let e=s.boundary();l=.5*(e.minX()+e.maxX()),r=.5*(e.minY()+e.maxY()),o=t.booleanArray(!0,s.numAtoms)}else{if(1==this.subjectLength)return void(this.errmsg="Component is isolated.");for(let t=0;t<this.subjectLength;t++)l+=s.atomX(this.subjectIndex[t]),r+=s.atomY(this.subjectIndex[t]);let t=1/this.subjectLength;l*=t,r*=t}this.output.mol=s.clone(),St.rotateAtoms(this.output.mol,o,l,r,e)}execBondDist(t){let e=this.input.currentBond;if(0==e)return void(this.errmsg="There must be a current bond.");let n=this.input.mol.clone();if(n.bondInRing(e)){let i=n.bondFrom(e),s=n.bondTo(e),l=n.atomX(s)-n.atomX(i),r=n.atomY(s)-n.atomY(i),o=N(l,r),a=1/o,h=this.isSelected(i),u=this.isSelected(s),m=l*(t-o)*a,c=r*(t-o)*a;h&&!u?n.setAtomPos(i,n.atomX(i)-m,n.atomY(i)-c):u&&!h?n.setAtomPos(s,n.atomX(s)+m,n.atomY(s)+c):(n.setAtomPos(i,n.atomX(i)-.5*m,n.atomY(i)-.5*c),n.setAtomPos(s,n.atomX(s)+.5*m,n.atomY(s)+.5*c))}else{let[i,s,l]=this.mobileSide(e),r=n.atomX(s)-n.atomX(i),o=n.atomY(s)-n.atomY(i),a=N(r,o),h=1/a,u=r*(t-a)*h,m=o*(t-a)*h;for(let t of l)n.setAtomPos(t,n.atomX(t)-u,n.atomY(t)-m)}this.output.mol=n}execAlignAngle(t){let e=this.input.currentBond;if(0==e)return void(this.errmsg="There must be a current bond.");let n=this.input.mol.clone();if(n.bondInRing(e))return void(this.errmsg="Cannot align a ring-bond.");let[i,s,l]=this.mobileSide(e),r=n.atomX(s),o=n.atomY(s),a=t-Math.atan2(n.atomY(i)-o,n.atomX(i)-r),h=Math.cos(a),u=Math.sin(a);for(let t of l){let e=n.atomX(t)-r,i=n.atomY(t)-o;n.setAtomPos(t,r+e*h-i*u,o+e*u+i*h)}this.output.mol=n}execAlignRegular(){if(0==this.input.currentBond)return void(this.errmsg="There must be a current bond.");let e=this.input.mol.clone(),n=e.bondFrom(this.input.currentBond),i=e.bondTo(this.input.currentBond),s=Math.atan2(e.atomY(i)-e.atomY(n),e.atomX(i)-e.atomX(n))*L;s<0&&(s+=360);let l=30*Math.round(s/30);if(Math.abs(s-l)<.001)return;let r=(l-s)*_,o=this.input.selectedMask;if(t.allFalse(o)){let t=e.atomConnComp(n);for(let n=1;n<=e.numAtoms;n++)o[n-1]=t==e.atomConnComp(n)}let a=.5*(e.atomX(n)+e.atomX(i)),h=.5*(e.atomY(n)+e.atomY(i));for(let t=1;t<=e.numAtoms;t++)if(o[t-1]){let n=e.atomX(t)-a,i=e.atomY(t)-h,s=Math.atan2(i,n)+r,l=N(n,i);e.setAtomPos(t,a+l*Math.cos(s),h+l*Math.sin(s))}this.output.mol=e}execAdjustTorsion(e){if(0==this.input.currentAtom||3!=t.maskCount(this.input.selectedMask))return void(this.errmsg="Must be 3 selected atoms and a current atom.");let n=this.input.mol.clone(),i=this.input.currentAtom,s=[];for(let t=1;t<=n.numAtoms;t++)t!=i&&this.input.selectedMask[t-1]&&s.push(t);let l=n.findBond(i,s[0])>0?s.shift():n.findBond(i,s[1])>0?s.pop():0;if(0==l||0==n.findBond(l,s[0]))return void(this.errmsg="Selected atoms must be consecutive.");let r=s[0],o=n.atomX(l),a=n.atomY(l),h=Math.atan2(n.atomY(i)-a,n.atomX(i)-o),u=e-z(Math.atan2(n.atomY(r)-a,n.atomX(r)-o),h),m=[],c=[];if(0==n.atomRingBlock(i)||n.atomRingBlock(i)!=n.atomRingBlock(r)){let t=Q.fromMolecule(n);t.removeEdge(l-1,i-1),t.removeEdge(l-1,r-1);let e=t.calculateComponents();for(let n=0;n<t.numNodes;n++)e[n]==e[i-1]?m.push(n+1):e[n]==e[r-1]&&c.push(n+1)}n.atomRingBlock(i)>0&&n.atomRingBlock(i)==n.atomRingBlock(l)&&(m=[i]),n.atomRingBlock(r)>0&&n.atomRingBlock(r)==n.atomRingBlock(l)&&(c=[r]),St.rotateAtoms(n,t.idxMask(t.add(m,-1),n.numAtoms),o,a,-.5*u),St.rotateAtoms(n,t.idxMask(t.add(c,-1),n.numAtoms),o,a,.5*u),this.output.mol=n}execMove(e,n,i){let s=this.subjectIndex;if(0==t.len(s)){if(0==e)return;s=[e]}this.output.mol=this.input.mol.clone();for(let t of s)this.output.mol.setAtomPos(t,this.output.mol.atomX(t)+n,this.output.mol.atomY(t)+i)}execRing(e,n,i){let l=e.length,r=t.numberArray(0,l),o=t.numberArray(0,l),a=this.input.mol.clone();for(let t=0;t<l;t++)r[t]=St.atomAtPoint(a,e[t],n[t]),0==r[t]&&(r[t]=a.addAtom("C",e[t],n[t]));for(let t=0;t<l;t++){let e=t<l-1?t+1:0;o[t]=a.findBond(r[t],r[e]),0==o[t]&&(o[t]=a.addBond(r[t],r[e],1))}if(i){let e=t.numberArray(0,l),n=t.booleanArray(!1,l);for(let t=0;t<l;t++){e[t]=s.ELEMENT_BONDING[a.atomicNumber(r[t])]+a.atomCharge(r[t]),a.atomHExplicit(r[t])!=qt.HEXPLICIT_UNKNOWN&&(e[t]-=a.atomHExplicit(r[t]));for(let n of a.atomAdjBonds(r[t]))e[t]-=a.bondOrder(n);a.bondOrder(o[t])>=2&&(n[t]=!0,t<l-1?(n[t]=!0,t++):n[0]=!0)}for(let t=0;t<l;t++){let i=t<l-1?t+1:0;n[t]||n[i]||e[t]>0&&e[i]>0&&(a.setBondOrder(o[t],2),n[t]=!0,n[i]=!0,e[t]--,e[i]--)}}this.output.mol=a}execTemplateFusion(t){let e=this.input.mol,n=new Ne(e,t,"");0==this.subjectLength?n.permuteNone():1==this.subjectLength?n.permuteAtom(this.subjectIndex[0]):2==this.subjectLength&&e.findBond(this.subjectIndex[0],this.subjectIndex[1])>0?n.permuteBond(this.subjectIndex[0],this.subjectIndex[1]):n.permuteMulti(this.subjectIndex);let i=[];for(let t of n.perms){let e={};e.mol=t.mol.toString(),e.display=t.display.toString(),e.molidx=t.molidx,e.temidx=t.temidx,e.srcidx=t.srcidx,i.push(e)}this.output.permutations=i}execAbbrevTempl(){}execAbbrevGroup(){if(!this.requireSubject())return;if(!this.checkAbbreviationReady())return;let e=Dt.convertToAbbrev(this.input.mol,t.notMask(this.subjectMask),"?");if(null!=e){if(Me.main){Me.main.submitMolecule(e,!0);for(let t=1;t<=e.numAtoms;t++)"?"==e.atomElement(t)&&Dt.hasAbbrev(e,t)&&Me.main.substituteAbbrevName(e,t)}this.output.mol=e,this.zapSubject(),this.output.currentAtom=e.numAtoms}else this.errmsg="Inline abbreviations must be terminal with exactly one attachment point."}execAbbrevFormula(){if(!this.requireSubject())return;if(!this.checkAbbreviationReady())return;let e=this.input.mol.clone();for(let t=1;t<=e.numAtoms;t++)e.setAtomHExplicit(t,e.atomHydrogens(t));let n=Dt.subgraphMask(e,this.subjectMask),i=Dt.molecularFormula(n,!0),s=Dt.convertToAbbrev(this.input.mol,t.notMask(this.subjectMask),i);null!=s?(this.output.mol=s,this.zapSubject(),this.output.currentAtom=s.numAtoms):this.errmsg="Inline abbreviations must be terminal with exactly one attachment point."}execAbbrevClear(){let t=[];for(let e of this.subjectIndex)Dt.hasAbbrev(this.input.mol,e)&&t.push(e);if(0==t.length)return void(this.errmsg="No abbreviations to clear.");let e=this.input.mol.clone();for(let n of t)Dt.clearAbbrev(e,n);this.output.mol=e}execAbbrevExpand(){let t=[];for(let e of this.subjectIndex)Dt.hasAbbrev(this.input.mol,e)&&t.push(e);if(0==t.length)return void(this.errmsg="No abbreviations to expand.");let e=this.input.mol.clone();for(let n of t)Dt.expandOneAbbrev(e,n,!0);this.output.mol=e,this.zapSubject()}execBondArtifact(t){if(!this.requireAtoms()||!this.requireSubject())return;let e=new tt(this.input.mol.clone()),n=this.subjectIndex.slice(0),i=this.input.currentAtom;if(i>0&&n.indexOf(i)<0&&n.push(i),t==qe.BondArtifactPath){if(!e.createPath(n))return void(this.errmsg="Path artifact not suitable.")}else if(t==qe.BondArtifactRing){if(!e.createRing(n))return void(this.errmsg="Ring artifact not suitable.")}else if(t==qe.BondArtifactArene){if(!e.createArene(n))return void(this.errmsg="Arene artifact not suitable.")}else if(t==qe.BondArtifactClear&&!e.removeArtifact(n)){if(this.removePolymerBlock(n))return;return void(this.errmsg="No artifact removed.")}e.rewriteMolecule(),this.output.mol=e.mol}execPolymerBlock(){this.requireAtoms()&&this.requireSubject()&&this.owner&&this.owner.performPolymerBlock(this.subjectIndex)}execAddHydrogens(){let e=this.input.mol.clone();if(!this.requireAtoms())return;let n=this.subjectIndex;0==n.length&&(n=t.identity1(e.numAtoms));for(let t of n){let n=e.atomHydrogens(t);n>0&&Ot.placeAdditionalHydrogens(e,t,n)}e.numAtoms!=this.input.mol.numAtoms?this.output.mol=e:this.errmsg="Nothing needs to be added."}execRemoveHydrogens(){if(!this.requireAtoms())return;let e=this.input.mol,n=this.subjectMask;t.allFalse(n)&&(n=t.booleanArray(!0,e.numAtoms));let i=t.booleanArray(!0,e.numAtoms);for(let t=1;t<=e.numAtoms;t++)if(Dt.boringHydrogen(e,t)){let s=e.atomAdjList(t)[0];(n[t-1]||n[s-1])&&(i[t-1]=!1)}t.allTrue(i)?this.errmsg="Nothing to be deleted.":this.output.mol=Dt.subgraphMask(e,i)}execQueryClear(){if(!this.requireSubject())return;let t=this.input.mol.clone();const{currentBond:e}=this.input;if(e>0&&mt.hasAnyQueryBond(t,e))return mt.deleteQueryBondAll(t,e),void(this.output.mol=t);let n=!1;for(let e of this.subjectIndex)mt.hasAnyQueryAtom(t,e)&&(mt.deleteQueryAtomAll(t,e),n=!0);for(let e=1;e<=t.numBonds;e++)this.subjectMask[t.bondFrom(e)-1]&&this.subjectMask[t.bondTo(e)-1]&&mt.hasAnyQueryBond(t,e)&&(mt.deleteQueryBondAll(t,e),n=!0);n?this.output.mol=t:this.errmsg="No query terms to clear."}execQueryCopy(){if(!this.requireSubject())return;const{mol:t,currentBond:e}=this.input;if(e>0){if(!mt.hasAnyQueryBond(t,e))return void(this.errmsg="Bond has no query terms.");let n=new qt;n.addAtom("*",0,0),n.addAtom("*",qt.IDEALBOND,0),n.addBond(1,2,1),n.setBondExtra(1,t.bondExtra(e).filter((t=>t.startsWith("q")))),this.toClipboard=n.toString()}else if(1==this.subjectLength){let e=this.subjectIndex[0];if(!mt.hasAnyQueryAtom(t,e))return void(this.errmsg="Atom has no query terms.");let n=new qt;n.addAtom("*",0,0),n.setAtomExtra(1,t.atomExtra(e).filter((t=>t.startsWith("q")))),this.toClipboard=n.toString()}else this.errmsg="Subject has to be a single atom or bond."}execQueryPaste(){if(!this.requireSubject())return;let t=this.param.qmol;if(t){if(1==t.numAtoms&&"*"==t.atomElement(1)&&mt.hasAnyQueryAtom(t,1)){let e=this.output.mol=this.input.mol.clone(),n=t.atomExtra(1).filter((t=>t.startsWith("q")));for(let t of this.subjectIndex){let i=e.atomExtra(t).filter((t=>t.startsWith("q")));e.setAtomExtra(t,[...i,...n])}return}if(2==t.numAtoms&&"*"==t.atomElement(1)&&"*"==t.atomElement(2)&&1==t.numBonds&&mt.hasAnyQueryBond(t,1)){let e=this.output.mol=this.input.mol.clone(),n=t.bondExtra(1).filter((t=>t.startsWith("q")));for(let t=1;t<=e.numBonds;t++)if(this.subjectMask[e.bondFrom(t)-1]&&this.subjectMask[e.bondTo(t)-1]){let i=e.bondExtra(t).filter((t=>t.startsWith("q")));e.setBondExtra(t,[...i,...n])}return}}this.errmsg="Unable to paste query terms."}execQuerySetAtom(){}execQuerySetBond(){}execQueryBondAny(){if(!this.requireSubject())return;const{mol:t,currentBond:e}=this.input;let n=[];for(let e=1;e<=t.numBonds;e++)this.subjectMask[t.bondFrom(e)-1]&&this.subjectMask[t.bondTo(e)-1]&&n.push(e);if(0!=n.length){this.output.mol=t.clone();for(let t of n)this.output.mol.setBondOrder(t,0),mt.setQueryBondOrders(this.output.mol,t,[-1,0,1,2,3,4])}else this.errmsg="Must select at least one bond."}execSproutDirection(e,n){var i,s;if(!this.requireCurrent())return;if(0==e&&0==n)return;const{mol:l,currentAtom:r}=this.input;let o;if(o=0==l.atomAdjCount(r)?t.identity0(12).map((t=>t*I/12)):null!==(i=Ot.primeDirections(l,r))&&void 0!==i?i:Ot.exitVectors(l,r),0==o.length)return;let a=Math.atan2(n,e),h=t.idxMin(o.map((t=>Math.abs(z(a,t))+.01*Math.abs(Math.sin(t))))),u=l.atomX(r)+qt.IDEALBOND*Math.cos(o[h]),m=l.atomY(r)+qt.IDEALBOND*Math.sin(o[h]);this.output.mol=l.clone();let c=this.output.mol.addAtom("C",u,m);this.output.mol.addBond(r,c,1),this.output.mol=null!==(s=Ot.joinOverlappingAtoms(this.output.mol,t.booleanArray(!0,this.output.mol.numAtoms)))&&void 0!==s?s:this.output.mol;for(let t=1;t<=this.output.mol.numAtoms;t++)if(q(this.output.mol.atomX(t)-u,this.output.mol.atomY(t)-m)<St.OVERLAP_THRESHOLD_SQ){this.output.currentAtom=t;break}}requireSubject(){return 0==this.subjectLength&&(this.errmsg="Subject required: current atom/bond or selected atoms."),this.subjectLength>0}requireAtoms(){return 0==this.input.mol.numAtoms&&(this.errmsg="There are no atoms."),this.input.mol.numAtoms>0}requireCurrent(){return 0!=this.input.currentAtom||0!=this.input.currentBond||(this.errmsg="There must be a current atom or bond.",!1)}requireSelected(){return this.hasSelected||(this.errmsg="No atoms are selected."),this.hasSelected}pickSelectedGroup(t,e){if(0==this.subjectLength)return 0;for(let n=0;n<t.length;n++){let i=t[n],s=!0;for(let t=0;t<i.length;t++)if(!this.subjectMask[i[t]-1]){s=!1;break}if(s)return n+=e,n<0?n+t.length:n>=t.length?n-t.length:n}for(let e=0;e<t.length;e++){let n=t[e];for(let t=0;t<n.length;t++)if(this.subjectMask[n[t]-1])return e}return 0}zapSubject(){this.output.currentAtom=0,this.output.currentBond=0,this.output.selectedMask=t.booleanArray(!1,this.input.mol.numAtoms)}performBondNew(e,n,i){let l=this.input.mol,r=Ot.calculateNewBondAngles(l,e,n);if(0==r.length&&(r=Ot.exitVectors(l,e)),0==r.length)return void(this.errmsg="Could not find a suitable geometry for a new substituent.");let o=[],a=[],h=[];for(let t=0;t<r.length;t++){let n=l.atomX(e)+qt.IDEALBOND*Math.cos(r[t]),i=l.atomY(e)+qt.IDEALBOND*Math.sin(r[t]),u=St.congestionPoint(l,n,i);s.ELEMENT_BLOCKS[l.atomicNumber(e)]<=2?u+=1e-8*Math.abs(P(r[t])):u+=1e-8*Math.abs(z(.5*Math.PI,r[t])),o.push(n),a.push(i),h.push(u)}let u=t.idxSort(h);this.output.mol=l.clone();let m=St.atomAtPoint(this.output.mol,o[u[0]],a[u[0]]);0==m&&(m=this.output.mol.addAtom("C",o[u[0]],a[u[0]])),Dt.addBond(this.output.mol,e,m,n,i),u.length>=2&&(this.output.altmol=l.clone(),m=St.atomAtPoint(this.output.altmol,o[u[1]],a[u[1]]),0==m&&(m=this.output.altmol.addAtom("C",o[u[1]],a[u[1]])),Dt.addBond(this.output.altmol,e,m,n,i))}performBondChange(t,e){let n=this.input.mol,i=[];for(let t=1;t<=n.numBonds;t++)this.subjectMask[n.bondFrom(t)-1]&&this.subjectMask[n.bondTo(t)-1]&&i.push(t);let s=e==qt.BONDTYPE_DECLINED||e==qt.BONDTYPE_INCLINED,l=s||e==qt.BONDTYPE_UNKNOWN,r=s;for(let s=0;s<i.length&&!r;s++){let l=i[s];(n.bondOrder(l)!=t&&e==qt.BONDTYPE_NORMAL||n.bondType(l)!=e)&&(r=!0)}if(r){this.output.mol=n.clone();for(let n=0;n<i.length;n++){let r=i[n],o=this.output.mol.bondFrom(r),a=this.output.mol.bondTo(r);s&&this.output.mol.bondType(r)==e?this.output.mol.setBondFromTo(r,a,o):this.output.mol.bondOrder(r)!=t||this.output.mol.bondType(r)!=e?l||t==this.output.mol.bondOrder(r)?this.output.mol.setBondType(r,e):this.output.mol.setBondOrder(r,t):s&&this.output.mol.setBondFromTo(r,a,o)}}else this.errmsg="No bond changes made."}performBondGeomAtom(t,e){let n=this.input.mol,i=n.atomAdjList(e).length,s=Ot.GEOM_ANGLES[t].length;if(i>s)return void(this.errmsg="The current atom has more bonds than does the selected geometry.");if(0==i)return void this.performBondNew(e,1,qt.BONDTYPE_NORMAL);if(i==s)return this.output.mol=Ot.refitAtomGeometry(n,e,t),void(null==this.output.mol&&(this.errmsg="Could not re-fit the atom geometry."));let l=St.atomBondAngles(n,e),r=Ot.mapAngleSubstituent(t,l);if(null==r)return this.output.mol=Ot.refitAtomGeometry(n,e,t),void(null==this.output.mol&&(this.errmsg="Could not re-fit the atom geometry."));this.output.mol=n.clone();let o=Ot.pickNewAtomDirection(n,e,r),a=this.output.mol.atomX(e)+qt.IDEALBOND*Math.cos(o),h=this.output.mol.atomY(e)+qt.IDEALBOND*Math.sin(o),u=St.atomAtPoint(this.output.mol,a,h);0==u&&(u=this.output.mol.addAtom("C",a,h)),Dt.addBond(this.output.mol,e,u,1)}performBondGeomBond(t,e){let n=this.input.mol,i=n.bondFrom(e),s=n.bondTo(e),l=n.atomAdjCount(i),r=n.atomAdjCount(s);if(l>1&&1==r);else{if(!(1==l&&r>1))return void(this.errmsg="One end of the bond must be terminal.");{let t=l;l=r,r=t}}let o=n.atomAdjList(i),a=n.atomX(i),h=n.atomY(i),u=n.atomX(s),m=n.atomY(s),c=[];for(let t=0;t<o.length;t++)o[t]!=s&&c.push(Math.atan2(n.atomY(o[t])-h,n.atomX(o[t])-a));let d=Ot.mapAngleSubstituent(t,c);if(null==d)return void(this.errmsg="No alternative geometries identified.");let f=I+1,p=0,C=0,g=Math.atan2(m-h,u-a),A=N(u-a,m-h);for(let t=0;t<d.length;t++){let e=z(d[t],g);if(e<0&&(e+=I),t>0&&e>f)continue;let i=a+A*Math.cos(e+g),s=h+A*Math.sin(e+g);St.atomAtPoint(n,i,s)>0||(f=e,p=i,C=s)}f>I?this.errmsg="No alternative geometries identified.":(this.output.mol=n.clone(),this.output.mol.setAtomPos(s,p,C))}checkAbbreviationReady(){let t=0,e=this.input.mol,n=this.subjectMask;for(let i=1;i<=e.numBonds;i++){let s=e.bondFrom(i),l=e.bondTo(i),r=0;if(n[s-1]&&!n[l-1]&&Dt.hasAbbrev(e,s)||n[l-1]&&!n[s-1]&&Dt.hasAbbrev(e,l))return this.errmsg="Already an abbreviation.",!1;if(n[s-1]&&!n[l-1]?r=s:n[l-1]&&!n[s-1]&&(r=l),0==r||r==t);else{if(0!=t)return this.errmsg="The selected group must be terminal.",!1;t=r}}return!0}mobileSide(e,n=!1){let{mol:i}=this.input,s=i.bondFrom(e),l=i.bondTo(e),r=Q.fromMolecule(i);r.removeEdge(s-1,l-1);let o=[],a=[];for(let e of r.calculateComponentGroups())e.includes(s-1)&&(o=t.add(e,1)),e.includes(l-1)&&(a=t.add(e,1));let h=o.length*(i.atomRingBlock(s)>0?2:1),u=a.length*(i.atomRingBlock(l)>0?2:1),m=!1,c=!1;for(let t of o)if(this.isSelected(t)){m=!0;break}for(let t of a)if(this.isSelected(t)){c=!0;break}if(n&&1==i.atomAdjCount(s))return[l,s,a];if(n&&1==i.atomAdjCount(l))return[s,l,o];if(m&&!c);else if(c&&!m||u<h)return[l,s,a];return[s,l,o]}isSelected(t){let e=this.input.selectedMask;return!!e&&e[t-1]}removePolymerBlock(t){let e=new ut(this.input.mol.clone());for(let n of e.getIDList()){let i=e.getUnit(n);for(let s of t)if(i.atoms.includes(s))return e.removeUnit(n),e.rewriteMolecule(),this.output.mol=e.mol,!0}return!1}}!function(t){t[t.None=0]="None",t[t.Mass=1]="Mass",t[t.Volume=2]="Volume",t[t.Moles=3]="Moles"}(Se||(Se={}));class Oe{constructor(t){this.mixture=t,this.notes=[]}analyse(){let e=this.mixture.getOrigins(),n=e.map((t=>this.mixture.getComponent(t)));for(let i=0;i<e.length;i++){let s={origin:e[i]},l=n[i];if(l.molfile&&t.isBlank(l.contents)){let e=vt.readUnknown(l.molfile);if(!e)continue;let n=this.enumerateStereo(e);t.notBlank(n)&&(s.stereoEnum=n.map((t=>vt.writeMDLMOL(t))))}this.notes.push(s)}let i=[];for(let n=0;n<e.length;n++){i[n]=[];let s=e[n];for(let l=n+1;l<e.length;l++)e[l].length==s.length+1&&t.equals(s,e[l].slice(0,s.length))&&i[n].push(l)}let s=new Array(e.length).fill(Se.None),l=t.numberArray(null,e.length),r=t.numberArray(null,e.length),o=t.numberArray(null,e.length);for(;;){let a=!1;for(let h=0;h<e.length;h++){let e=n[h];if(this.notes[h],s[h]==Se.None&&([s[h],l[h],r[h],o[h]]=this.toAbsoluteUnits(e),s[h]!=Se.None&&(a=!0)),!t.isBlank(e.contents)){if(s[h]==Se.None){let t=0,e=Se.None;for(let n of i[h]){if(s[n]==Se.None||null!=r[n]||e!=Se.None&&s[n]!=e){e=Se.None;break}e=s[n],t+=l[n]}e!=Se.None&&(s[h]=e,l[h]=t,a=!0)}if(s[h]!=Se.None&&i[h].length>=2){let t=-1,e=0;for(let n of i[h])if(s[n]==Se.None){if(t>=0){t=-1;break}t=n}else{if(s[n]!=s[h]){t=-1;break}if(null!=r[n]){t=-1;break}e+=l[n]}t>=0&&(s[t]=s[h],l[t]=l[h]-e,a=!0)}}}if(!a)break}for(let t=0;t<e.length;t++)if(s[t]!=Se.None)for(let e of i[t])if(s[e]!=Se.None){let i=0,a=l[t],h=null;s[e]==Se.Mass?s[t]==Se.Mass?[i,h]=[100/a,Jt.pcWW]:s[t]==Se.Volume?[i,h]=[100/a,Jt.pcWV]:(s[t],Se.Moles):s[e]==Se.Volume?s[t]==Se.Mass||(s[t]==Se.Volume?[i,h]=[100/a,Jt.pcVV]:(s[t],Se.Moles)):s[e]==Se.Moles&&(s[t]==Se.Mass||(s[t]==Se.Volume?[i,h]=[1/a,Jt.mol_L]:s[t]==Se.Moles&&([i,h]=[100/a,Jt.pcMM]))),null!=h&&(null==r[e]?(this.notes[e].concQuantity=l[e]*i,this.notes[e].concError=null==o[e]?null:o[e]*i):this.notes[e].concQuantity=[l[e]*i,r[e]*i],this.notes[e].concUnits=he.uriToName(h),this.notes[e].concRelation=n[t].relation)}}findNote(e){for(let n of this.notes)if(t.equals(e,n.origin))return n;return null}enumerateStereo(t){let e=t=>{for(let e=1;e<=t.numBonds;e++)if(t.bondType(e)==qt.BONDTYPE_UNKNOWN){let n=t.clone(),i=t.clone();if(1==t.bondOrder(e))return n.setBondType(e,qt.BONDTYPE_DECLINED),i.setBondType(e,qt.BONDTYPE_INCLINED),[n,i];if(2==t.bondOrder(e)){let n=t.clone();n.setBondType(e,qt.BONDTYPE_NORMAL);let i=null;if(!t.bondInRing(e)){let t=new we({mol:n,currentAtom:0,currentBond:e,selectedMask:null},qe.BondRotate,{});t.execute(),!t.errmsg&&t.output.mol&&(i=t.output.mol)}return i?[n,i]:[n]}}return null},n=[t];for(let t=0;t<n.length;t++){let i=e(n[t]);if(i){n[t]=i[0];for(let e=i.length-1;e>=1;e--)n.splice(t+1,0,i[e]);t--}}return n.length>1?n:null}toAbsoluteUnits(t){if(!t.units||null==t.quantity)return[Se.None,null,null,null];let e=he.nameToURI(t.units);if(!e)return[Se.None,null,null,null];let n=0,i=Se.None;if(e==Jt.kg)[n,i]=[1e3,Se.Mass];else if(e==Jt.g)[n,i]=[1,Se.Mass];else if(e==Jt.mg)[n,i]=[.001,Se.Mass];else if(e==Jt.ug)[n,i]=[1e-6,Se.Mass];else if(e==Jt.ng)[n,i]=[1e-9,Se.Mass];else if(e==Jt.L)[n,i]=[1,Se.Volume];else if(e==Jt.mL)[n,i]=[.001,Se.Volume];else if(e==Jt.uL)[n,i]=[1e-6,Se.Volume];else if(e==Jt.nL)[n,i]=[1e-9,Se.Volume];else if(e==Jt.mol)[n,i]=[1,Se.Moles];else if(e==Jt.mmol)[n,i]=[.001,Se.Moles];else if(e==Jt.umol)[n,i]=[1e-6,Se.Moles];else{if(e!=Jt.nmol)return[Se.None,null,null,null];[n,i]=[1e-9,Se.Moles]}if("number"==typeof t.quantity){let e=null==t.error?null:t.error*n;return[i,t.quantity*n,null,e]}{let[e,s]=t.quantity;return[i,e*n,s*n,null]}}}class De{constructor(t){this.mixfile=t,t?this.mixfile.mixfileVersion||(this.mixfile.mixfileVersion=1):this.mixfile={mixfileVersion:1}}static fromComponent(t){let e=W(t);return e.mixfileVersion=1,new De(e)}isEmpty(){return De.isComponentEmpty(this.mixfile)}static isComponentEmpty(e){const n=["name","description","synonyms","formula","molfile","inchi","inchiKey","smiles","ratio","quantity","units","relation","identifiers","links"];for(let t of n)if(null!=e[t])return!1;return!(t.arrayLength(e.contents)>0)}static hasQuantity(t){return null!=t.quantity||null!=t.ratio}clone(){return new De(W(this.mixfile))}equals(t){return null!=t&&this.recursiveEqual(this.mixfile,t.mixfile)}static deserialise(t){let e=JSON.parse(t);return new De(e)}serialise(){return De.beautify(this.mixfile)}static serialiseComponent(t){return De.beautify(t)}getComponent(t){if(0==t.length)return this.mixfile;let e=null,n=this.mixfile.contents||[];for(let i of t){if(e=n[i],!e)return null;n=e.contents||[]}return e}getParentComponent(t){return 0==t.length?null:((t=t.slice()).pop(),this.getComponent(t))}getComponents(){let t=[],e=[this.mixfile];for(;e.length>0;){let n=e.shift();if(t.push(n),n.contents)for(let t of n.contents)e.push(t)}return t}getOrigins(){let e=[],n=(i,s)=>{e.push(i);for(let e=0;e<t.arrayLength(s.contents);e++)n(t.append(i,e),s.contents[e])};return n([],this.mixfile),e}setComponent(t,e){let n=this.mixfile,i=this.mixfile.contents;for(let e of t)n=i[e],i=n.contents;let s=!1;for(let t in e){let i=e[t];i!=n[t]&&(n[t]=i,s=!0)}return Object.keys(n).forEach((t=>{null==n[t]&&delete n[t]})),s}deleteComponent(t){if(0==t.length)return;let e=this.mixfile,n=this.mixfile.contents,i=n;for(let s of t)i=n,e=n[s],n=e.contents;let s=t[t.length-1];if(i.splice(s,1),n)for(let t of n)i.splice(s++,0,t)}prependBefore(t,e){if(0==t.length){let t=this.mixfile,e={};const n=["mixfileVersion","contents"];for(let i in t)n.includes(i)||(e[i]=t[i],delete t[i]);return void(t.contents=[e])}let n=this.mixfile,i=this.mixfile.contents,s=i;for(let e of t)s=i,n=i[e],i=n.contents;s[t[t.length-1]]=e,e.contents=[n]}static splitOrigin(t){if(0==t.length)return[null,null];let e=t.slice(0),n=e.splice(t.length-1,1)[0];return[e,n]}static beautify(t){let e=JSON.stringify(t,null,4).split("\n"),n=/^(\s*\"\w+\": )([\[\{].*)$/,i=/^(\s*)/;for(let t=0;t<e.length;t++){let s=n.exec(e[t]);if(!s)continue;let l=i.exec(e[t]);e[t]=s[1]+"\n"+l[1]+s[2]}return e.join("\n")}recursiveEqual(e,n){let i=e,s=n,l=[],r=[];for(let t in i)"contents"!=t&&null!=i[t]&&l.push(t);for(let t in s)"contents"!=t&&null!=s[t]&&r.push(t);if(l.sort(),r.sort(),!t.equals(l,r))return!1;for(let e of l){let n=i[e],l=s[e];if(Array.isArray(n)&&Array.isArray(l)){if(!t.equals(n,l))return!1}else if(n!=l)return!1}let o=t.arrayLength(e.contents);if(o!=t.arrayLength(n.contents))return!1;for(let t=0;t<o;t++)if(!this.recursiveEqual(e.contents[t],n.contents[t]))return!1;return!0}}let Re=[];const Be=4294967295;function Ie(t){return t^Be}var ke;!function(t){t[t.None=0]="None",t[t.Header=1]="Header",t[t.Component=2]="Component",t[t.Hierarchy=3]="Hierarchy",t[t.Concentration=4]="Concentration"}(ke||(ke={}));class _e{constructor(t,e){this.inchi=e,this.minchi="?",this.segment=null,this.mixture=new De(W(t)),this.norm=new Oe(this.mixture),this.norm.analyse()}fillInChI(){return t=this,e=void 0,i=function*(){let t=!1;for(let e of this.mixture.getComponents()){if(!e.molfile||e.inchi)continue;let n=null;try{n=vt.readUnknown(e.molfile)}catch(t){continue}if(Dt.isBlank(n))continue;let{inchi:i,inchiKey:s}=yield this.inchi.generate(n);e.inchi=i,e.inchiKey=s,t=!0}return t},new((n=void 0)||(n=Promise))((function(s,l){function r(t){try{a(i.next(t))}catch(t){l(t)}}function o(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}formulate(){let e=this.mixture.clone();for(let t of e.getOrigins()){let n=this.norm.findNote(t);n&&(e.getComponent(t).note=n)}t:for(let n of e.getComponents())if(t.len(n.contents)>=2){if(2!=t.len(n.contents[0].ratio))continue;let[e,i]=n.contents[0].ratio;for(let s=1;s<n.contents.length;s++){let l=n.contents[s].ratio;if(2!=t.len(l)||l[1]!=i)continue t;e+=l[0]}if(e!=i)continue;for(let t of n.contents)t.useRatio=t.ratio[0]}let n=[];for(let i of e.getOrigins()){let s=e.getComponent(i);t.len(s.contents)>0||(s.inchiFrag=s.inchi||"",s.inchiFrag.startsWith("InChI=1S/")&&(s.inchiFrag=s.inchiFrag.substring(9)),n.includes(s.inchiFrag)||n.push(s.inchiFrag))}n.sort();let i=e.mixfile,s=this.assembleContents(i,n);this.minchi="",this.segment=[];let l=(t,e)=>{this.minchi+=t;for(let n=0;n<t.length;n++)this.segment.push(e)};l("MInChI=0.99.1S",ke.Header),l("/",ke.None);for(let t=0;t<n.length;t++)t>0&&l("&",ke.None),l(n[t],ke.Component);l("/",ke.None),l("n"+s.layerN,ke.Hierarchy),l("/",ke.None),l("g"+s.layerG,ke.Concentration)}getResult(){return this.minchi}getSegment(){return this.segment}makeLongHashKey(){let e=[];for(let t of this.mixture.getComponents())if(t.molfile){if(!t.inchiKey)throw"Mixture has InChIKey(s) missing";if(!t.inchiKey.startsWith("InChIKey="))throw"Invalid InChI key: "+t.inchiKey;e.push(t.inchiKey.substring(9))}return e=t.sortedUnique(e),"Long-MInChIKey="+e.join(";")}makeShortHashKey(){!function(){if(!(Re.length>0))for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;Re.push(e)}}();const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let n=[],i=0;for(let t=0;t<4;t++)n.push(Be);let s=t=>{let s=e.indexOf(t);var l;s<0||(n[i]=(l=n[i],Re[255&(l^s)]^l>>>8),i=i<3?i+1:0)},l=[];for(let t of this.mixture.getComponents())if(t.molfile){if(!t.inchiKey)throw"Mixture has InChIKey(s) missing";if(!t.inchiKey.startsWith("InChIKey="))throw"Invalid InChI key: "+t.inchiKey;l.push(t.inchiKey.substring(9))}for(let e of t.sortedUnique(l))for(let t of e)s(t);let r="Short-MInChIKey=";for(let t of n){t=Ie(t)>>>1;for(let n=0;n<7;n++)r+=e[t%26],t=Math.trunc(t/26)}return r}static formatConcentration(t,e,n,i,s){let l=(t,e)=>Math.round(t*Math.pow(10,-e)).toString();if(null!=n){let t=this.determineExponent([n],4);return l(n,t)+"rt"+t}if(null==t||null==i)return null;let r=i;if(r.startsWith("http://")||(r=he.nameToURI(r)),!r)return;let o=[];null!=s&&o.push(s);let a="number"==typeof t?[t]:t;null!=e&&a.push(e);let[h,u]=he.convertToMInChI(r,a);if(!h)return;let m=this.determineExponent(u,4);return o.push(l(u[0],m)),u.length>1&&(Array.isArray(t)?o.push(":"):o.push("?"),o.push(l(u[1],m))),o.push(h),o.push(m.toString()),o.join("")}assembleContents(e,n){let i={layerN:"",layerG:""},s={layerN:"",layerG:""};if(t.len(e.contents)>0&&null!=e.contents)for(let t of e.contents){let e=this.assembleContents(t,n);(i.layerN.length>0||i.layerG.length>0)&&(i.layerN+="&",i.layerG+="&"),i.layerN+=e.layerN,i.layerG+=e.layerG}let l=null!=e.inchiFrag?n.indexOf(e.inchiFrag)+1:0;l>0&&(s.layerN+=l.toString());let r=_e.formatConcentration(e.quantity,e.error,e.useRatio,e.units,e.relation);if(!r&&e.note){let{concQuantity:t,concError:n,concUnits:i,concRelation:s}=e.note;r=_e.formatConcentration(t,n,null,i,s)}return r&&(s.layerG+=r),(i.layerN.length>0||i.layerG.length>0)&&(s.layerN="{"+i.layerN+"}"+s.layerN,s.layerG="{"+i.layerG+"}"+s.layerG,this.shaveBeard(s)),s}shaveBeard(t){for(;t.layerN.startsWith("{{")&&t.layerN.endsWith("}}")&&t.layerG.startsWith("{{")&&t.layerG.endsWith("}}");)t.layerN=t.layerN.substring(1,t.layerN.length-1),t.layerG=t.layerG.substring(1,t.layerG.length-1)}static determineExponent(t,e){let n=Number.POSITIVE_INFINITY;for(let e of t)n=Math.min(n,Math.abs(e));if(!Number.isFinite(n)||Number.isNaN(n)||n<=0)return 0;let i=Math.round(Math.log10(n))-e,s=[];for(let e of t)s.push(Math.round(e*Math.pow(10,-i)).toString());t:for(;;){for(let t=0;t<s.length;t++){if(!s[t].endsWith("0"))break t;s[t]=s[t].substring(0,s[t].length-1)}i++}return i}}class Le{constructor(t,e,n){this.offsetX=t,this.offsetY=e,this.pointScale=n,this.invScale=1/n}scale(){return this.pointScale}angToX(t){return t*this.pointScale+this.offsetX}angToY(t){return t*-this.pointScale+this.offsetY}xToAng(t){return(t-this.offsetX)*this.invScale}yToAng(t){return(t-this.offsetY)*-this.invScale}yIsUp(){return!1}measureText(t,e){return jt.main.measureText(t,e)}}class Pe{constructor(t){this.mixtures=[],t&&(this.mixtures=t.slice(0))}get count(){return this.mixtures.length}getMixture(t){return this.mixtures[t].clone()}getMixtureDirect(t){return this.mixtures[t]}setMixture(t,e){this.mixtures[t]=e.clone()}setMixtureDirect(t,e){this.mixtures[t]=e}deleteMixture(t){this.mixtures.splice(t,1)}appendMixture(t){return this.mixtures.push(t.clone()),this.mixtures.length-1}appendMixtureDirect(t){return this.mixtures.push(t),this.mixtures.length-1}appendCollection(t){this.mixtures=this.mixtures.concat(t.mixtures)}insertMixture(t,e){this.mixtures.splice(t,0,e.clone())}swapMixtures(t,e){let[n,i]=[this.mixtures[t],this.mixtures[e]];this.mixtures[t]=i,this.mixtures[e]=n}static deserialise(t){let e=JSON.parse(t);if(!Array.isArray(e))throw"Input content is not a JSON array.";let n=[];for(let t of e)n.push(new De(t));return new Pe(n)}serialise(t){let e=[];for(let t of this.mixtures)e.push(t.mixfile);return t||e.length<=100?De.beautify(e):"[\n    "+e.map((t=>JSON.stringify(t))).join(",\n    ")+"\n]\n"}}class ze{constructor(t,e){this.htmlFile=t,this.withMInChI=e}exec(){return t=this,e=void 0,i=function*(){let t;try{t=Rt.readFileSync(this.htmlFile).toString()}catch(t){throw"Unable to read file "+this.htmlFile+": "+t}let e=Pe.deserialise(t);if(0==e.count)throw"Nothing to render";let n=t=>console.log(t),i=t=>{process.stdout.write(t)};n("<html>"),n("<style>"),n("table {border-collapse: collapse;}"),n("td {border: 1px solid black; padding: 0.2em;}"),n(".header {background-color: #FFC0C0;}"),n(".component {background-color: #C0C0FF;}"),n(".hierarchy {background-color: #E0E080;}"),n(".concentration {background-color: #80E080;}"),n("</style>"),n("<body><table>");let s=Pt.defaultColourOnWhite(15),l=new Le(0,0,s.data.pointScale);for(let t=0;t<e.count;t++){let r=e.getMixtureDirect(t);n("<tr>"),n(`<td>${t+1}</td>`);let o=new ee(r,l,s);o.arrange();let a=new se;if(new re(o,a).draw(),a.normalise(),n("<td>"),n(a.createSVG()),n("</td>"),this.withMInChI){let t=new _e(r.mixfile,new Lt);yield t.fillInChI(),t.formulate(),i("<td><pre>");let e=t.getResult(),s=t.getSegment();for(let t=0;t<e.length;t++)i("<span"),s[t]==ke.Header?i(' class="header"'):s[t]==ke.Component?i(' class="component"'):s[t]==ke.Hierarchy?i(' class="hierarchy"'):s[t]==ke.Concentration&&i(' class="concentration"'),i(">"+V(e[t])+"</span>");n("</pre></td>")}n("</tr>")}n("</table></body></html>")},new((n=void 0)||(n=Promise))((function(s,l){function r(t){try{a(i.next(t))}catch(t){l(t)}}function o(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}}class Fe{constructor(t,e,n){this.code=t,this.allowModify=!0,this.ds=e||new it,null!=n&&(this.allowModify=n)}isColumnReserved(t){return!1}areColumnsReserved(e){let n=t.booleanArray(!1,e.length);for(let t=0;t<e.length;t++)n[t]=this.isColumnReserved(e[t]);return n}rowFirstBlock(t){return!0}rowBlockCount(t){return 1}aspectUnion(t){}initiateNewRow(t){}columnEffectivelyBlank(t){return[]}numTextRenderings(t){return 0}produceTextRendering(t,e){return null}numGraphicRenderings(t){return 0}produceGraphicRendering(t,e,n){return null}numHeaderRenderings(){return 0}produceHeaderRendering(t){return null}}Fe.TEXT_PLAIN=0,Fe.TEXT_LINK=1,Fe.TEXT_HTML=2;let Xe={};function Ue(t){let e=t.CODE,n=t.NAME;Xe[e]={code:e,name:n,classdef:t}}class Ye{constructor(){this.prefixes={},this.targetName="",this.targetURI="",this.organismName="",this.organismURI="",this.targetTypeName="",this.targetTypeURI="",this.cellName="",this.cellURI="",this.assayTypeName="",this.assayTypeURI="",this.assayDescription="",this.sourceName="",this.sourceURI="",this.sourceVersion="",this.documentName="",this.documentURI="",this.measureTypeName="",this.measureTypeURI="",this.unitNames=[],this.unitURIs=[]}}class je extends Fe{static isAssayProvenance(t){for(let e=0;e<t.numExtensions;e++)if(t.getExtType(e)==je.CODE)return!0;return!1}constructor(t,e){super(je.CODE,t,e),this.setup()}getHeader(){for(let t=0;t<this.ds.numExtensions;t++)if(this.ds.getExtType(t)==je.CODE)return this.parseMetaData(this.ds.getExtData(t));return null}setHeader(t){let e=this.formatMetaData(t);for(let t=0;t<this.ds.numExtensions;t++)if(this.ds.getExtType(t)==je.CODE)return void this.ds.setExtData(t,e);this.ds.appendExtension(je.NAME,je.CODE,e)}getMolecule(t){let e=this.ds.findColByName(je.COLNAME_MOLECULE);return e<0?null:this.ds.getMolecule(t,e)}getName(t){let e=this.ds.findColByName(je.COLNAME_NAME);return e<0?null:this.ds.getString(t,e)}getValue(t){let e=this.ds.findColByName(je.COLNAME_VALUE);return e<0?null:this.ds.isNull(t,e)?Number.NaN:this.ds.getReal(t,e)}getError(t){let e=this.ds.findColByName(je.COLNAME_ERROR);if(e<0)return null;if(this.ds.isNull(t,e))return Number.NaN;let n=this.ds.getReal(t,e);return n<=0?Number.NaN:n}getUnits(t){let e=this.ds.findColByName(je.COLNAME_UNITS);return e<0?null:this.ds.getString(t,e)}getRelation(t){let e=this.ds.findColByName(je.COLNAME_RELATION);return e<0?null:this.ds.getString(t,e)}getSourceURI(t){let e=this.ds.findColByName(je.COLNAME_SOURCEURI);return e<0?null:this.ds.getString(t,e)}setMolecule(t,e){let n=this.ds.findColByName(je.COLNAME_MOLECULE);n>=0&&this.ds.setMolecule(t,n,e)}setName(t,e){let n=this.ds.findColByName(je.COLNAME_NAME);n>=0&&this.ds.setString(t,n,e)}setValue(t,e){let n=this.ds.findColByName(je.COLNAME_VALUE);n<0||(Number.isNaN(e)?this.ds.setToNull(t,n):this.ds.setReal(t,n,e))}setError(t,e){let n=this.ds.findColByName(je.COLNAME_ERROR);n<0||(Number.isNaN(e)?this.ds.setToNull(t,n):this.ds.setReal(t,n,e))}setUnits(t,e){let n=this.ds.findColByName(je.COLNAME_UNITS);n>=0&&this.ds.setString(t,n,e)}setRelation(t,e){let n=this.ds.findColByName(je.COLNAME_RELATION);n>=0&&this.ds.setString(t,n,e)}setSourceURI(t,e){let n=this.ds.findColByName(je.COLNAME_SOURCEURI);n>=0&&this.ds.setString(t,n,e)}setup(){this.parseAndCorrect()}parseAndCorrect(){let t=new Ye,e=!1;for(let n=0;n<this.ds.numExtensions;n++)if(this.ds.getExtType(n)==je.CODE){t=this.parseMetaData(this.ds.getExtData(n)),e=!0;break}if(this.allowModify&&(this.ds.ensureColumn(je.COLNAME_MOLECULE,"molecule","Molecular structure of compound being measured"),this.ds.ensureColumn(je.COLNAME_NAME,"string","Name of compound"),this.ds.ensureColumn(je.COLNAME_VALUE,"real","Measured value"),this.ds.ensureColumn(je.COLNAME_ERROR,"real","Experimental error of measurement"),this.ds.ensureColumn(je.COLNAME_UNITS,"string","Units of measurement"),this.ds.ensureColumn(je.COLNAME_RELATION,"string","Relation: exact, greater or less"),this.ds.ensureColumn(je.COLNAME_SOURCEURI,"string","Source identifier for activity measurement")),!e&&this.allowModify){let e=this.formatMetaData(t);this.ds.appendExtension(je.NAME,je.CODE,e)}}parseMetaData(t){let e=new Ye;for(let n of t.split(/\r?\n/)){let t=n.indexOf("=");t<0||(n.startsWith("pfx:")?e.prefixes[vt.skUnescape(n.substring(4,t))]=vt.skUnescape(n.substring(t+1)):n.startsWith("targetName=")?e.targetName=vt.skUnescape(n.substring(t+1)):n.startsWith("targetURI=")?e.targetURI=vt.skUnescape(n.substring(t+1)):n.startsWith("organismName=")?e.organismName=vt.skUnescape(n.substring(t+1)):n.startsWith("organismURI=")?e.organismURI=vt.skUnescape(n.substring(t+1)):n.startsWith("targetTypeName=")?e.targetTypeName=vt.skUnescape(n.substring(t+1)):n.startsWith("targetTypeURI=")?e.targetTypeURI=vt.skUnescape(n.substring(t+1)):n.startsWith("cellName=")?e.cellName=vt.skUnescape(n.substring(t+1)):n.startsWith("cellURI=")?e.cellURI=vt.skUnescape(n.substring(t+1)):n.startsWith("assayTypeName=")?e.assayTypeName=vt.skUnescape(n.substring(t+1)):n.startsWith("assayTypeURI=")?e.assayTypeURI=vt.skUnescape(n.substring(t+1)):n.startsWith("assayDescription=")?e.assayDescription=vt.skUnescape(n.substring(t+1)):n.startsWith("sourceName=")?e.sourceName=vt.skUnescape(n.substring(t+1)):n.startsWith("sourceURI=")?e.sourceURI=vt.skUnescape(n.substring(t+1)):n.startsWith("sourceVersion=")?e.sourceVersion=vt.skUnescape(n.substring(t+1)):n.startsWith("documentName=")?e.documentName=vt.skUnescape(n.substring(t+1)):n.startsWith("documentURI=")?e.documentURI=vt.skUnescape(n.substring(t+1)):n.startsWith("measureTypeName=")?e.measureTypeName=vt.skUnescape(n.substring(t+1)):n.startsWith("measureTypeURI=")?e.measureTypeURI=vt.skUnescape(n.substring(t+1)):n.startsWith("unit:")&&(e.unitNames.push(vt.skUnescape(n.substring(5,t))),e.unitURIs.push(vt.skUnescape(n.substring(t+1)))))}return e}formatMetaData(t){let e="";for(let n in t.prefixes)e+="pfx:"+vt.skEscape(n)+"="+vt.skEscape(t.prefixes[n])+"\n";e+="targetName="+vt.skEscape(t.targetName)+"\n",e+="targetURI="+vt.skEscape(t.targetURI)+"\n",e+="organismName="+vt.skEscape(t.organismName)+"\n",e+="organismURI="+vt.skEscape(t.organismURI)+"\n",e+="targetTypeName="+vt.skEscape(t.targetTypeName)+"\n",e+="targetTypeURI="+vt.skEscape(t.targetTypeURI)+"\n",e+="cellName="+vt.skEscape(t.cellName)+"\n",e+="cellURI="+vt.skEscape(t.cellURI)+"\n",e+="assayTypeName="+vt.skEscape(t.assayTypeName)+"\n",e+="assayTypeURI="+vt.skEscape(t.assayTypeURI)+"\n",e+="assayDescription="+vt.skEscape(t.assayDescription)+"\n",e+="sourceName="+vt.skEscape(t.sourceName)+"\n",e+="sourceURI="+vt.skEscape(t.sourceURI)+"\n",e+="sourceVersion="+vt.skEscape(t.sourceVersion)+"\n",e+="documentName="+vt.skEscape(t.documentName)+"\n",e+="documentURI="+vt.skEscape(t.documentURI)+"\n",e+="measureTypeName="+vt.skEscape(t.measureTypeName)+"\n",e+="measureTypeURI="+vt.skEscape(t.measureTypeURI)+"\n";for(let n=0,i=Math.min(t.unitNames.length,t.unitURIs.length);n<i;n++)e+="unit:"+vt.skEscape(t.unitNames[n])+"="+vt.skEscape(t.unitURIs[n])+"\n";return e}plainHeading(){return je.NAME}isColumnReserved(t){return t==je.COLNAME_VALUE||t==je.COLNAME_ERROR||t==je.COLNAME_UNITS||t==je.COLNAME_RELATION||t==je.COLNAME_SOURCEURI}numTextRenderings(t){return 2}produceTextRendering(t,e){let n=this.getHeader();if(0==e){let e={name:"Activity",descr:"Activity measurement details for this record",text:"",type:Fe.TEXT_PLAIN},n=this.getValue(t),i=this.getError(t),s=this.getUnits(t),l=this.getRelation(t);return e.text="",Number.isNaN(n)||(l&&(e.text+=l+" "),e.text+=n,Number.isNaN(i)||(e.text+="  "+i),s&&(e.text+=" "+s)),e}if(1==e){let e={name:"Source",descr:"Origin of the structure and activity measurement",text:"",type:Fe.TEXT_LINK},i=this.getSourceURI(t);for(let t in n.prefixes)if(i.startsWith(t+":")){i=n.prefixes[t]+i.substring(t.length+1);break}return e.text=i,e}return null}}je.CODE="org.mmi.aspect.AssayProvenance",je.NAME="Assay Provenance",je.COLNAME_MOLECULE="Molecule",je.COLNAME_NAME="Name",je.COLNAME_VALUE="Value",je.COLNAME_ERROR="Error",je.COLNAME_UNITS="Units",je.COLNAME_RELATION="Relation",je.COLNAME_SOURCEURI="SourceURI",je.URI_UNIT_M="http://purl.obolibrary.org/obo/UO_0000062",je.URI_UNIT_mM="http://purl.obolibrary.org/obo/UO_0000063",je.URI_UNIT_uM="http://purl.obolibrary.org/obo/UO_0000064",je.URI_UNIT_nM="http://purl.obolibrary.org/obo/UO_0000065",je.URI_UNIT_pM="http://purl.obolibrary.org/obo/UO_0000066",je.URI_UNIT_logM="http://www.bioassayontology.org/bao#BAO_0000101",je.URI_UNIT_perM="http://www.bioassayontology.org/bao#BAO_0000102",je.URI_UNIT_gL="http://purl.obolibrary.org/obo/UO_0000175",je.URI_UNIT_mgL="http://purl.obolibrary.org/obo/UO_0000273",je.URI_UNIT_ugL="http://purl.obolibrary.org/obo/UO_0000275",je.URI_UNIT_binary="http://www.bioassayontology.org/bao#BAO_0080023",Ue(je);class He extends Fe{static isMeasurementData(t){for(let e=0;e<t.numExtensions;e++)if(t.getExtType(e)==He.CODE)return!0;return!1}constructor(t,e){super(He.CODE,t,e),this.header={units:[],fields:[]},this.setup()}getHeader(){return this.header}setHeader(t){this.header=t;let e=this.formatMetaData(t);for(let t=0;t<this.ds.numExtensions;t++)if(this.ds.getExtType(t)==He.CODE)return void this.ds.setExtData(t,e);this.ds.appendExtension(He.NAME,He.CODE,e)}effectHeader(t){this.setHeader(t),this.ensureFields()}rename(t,e){let n=this.header.fields[t].name;if(n!=e){this.header.fields[t].name=e,this.setHeader(this.header);for(let t of[He.SUFFIX_VALUE,He.SUFFIX_ERROR,He.SUFFIX_UNITS,He.SUFFIX_MOD]){let i=this.ds.findColByName(n+t);i>=0&&this.ds.changeColumnName(i,e+t,this.ds.colDescr(i))}}}reservedColumns(t){let e=this.header.fields[t].name;return[e+He.SUFFIX_VALUE,e+He.SUFFIX_ERROR,e+He.SUFFIX_UNITS,e+He.SUFFIX_MOD]}getValue(t,e){return this.getValueField(t,this.header.fields[e])}getValueField(t,e){let n={value:Number.NaN,error:Number.NaN,units:"",mod:""},i=this.ds.findColByName(e.name+He.SUFFIX_VALUE,"real"),s=this.ds.findColByName(e.name+He.SUFFIX_ERROR,"real"),l=this.ds.findColByName(e.name+He.SUFFIX_UNITS,"string"),r=this.ds.findColByName(e.name+He.SUFFIX_MOD,"string");return i>=0&&this.ds.notNull(t,i)&&(n.value=this.ds.getReal(t,i)),s>=0&&this.ds.notNull(t,s)&&(n.error=this.ds.getReal(t,s)),l>=0&&(n.units=this.ds.getString(t,l)),r>=0&&(n.mod=this.ds.getString(t,r)),n}setValue(t,e,n){let i=this.header.fields[e].name,s=this.ds.findColByName(i+He.SUFFIX_VALUE,"real"),l=this.ds.findColByName(i+He.SUFFIX_ERROR,"real"),r=this.ds.findColByName(i+He.SUFFIX_UNITS,"string"),o=this.ds.findColByName(i+He.SUFFIX_MOD,"string");s>=0&&(isNaN(n.value)?this.ds.setToNull(t,s):this.ds.setReal(t,s,n.value)),l>=0&&(isNaN(n.error)?this.ds.setToNull(t,l):this.ds.setReal(t,l,n.error)),r>=0&&this.ds.setString(t,r,n.units),o>=0&&this.ds.setString(t,o,n.mod)}clearValue(t,e){let n=this.header.fields[e].name,i=this.ds.findColByName(n+He.SUFFIX_VALUE,"real"),s=this.ds.findColByName(n+He.SUFFIX_ERROR,"real"),l=this.ds.findColByName(n+He.SUFFIX_UNITS,"string"),r=this.ds.findColByName(n+He.SUFFIX_MOD,"string");i>=0&&this.ds.setToNull(t,i),s>=0&&this.ds.setToNull(t,s),l>=0&&this.ds.setToNull(t,l),r>=0&&this.ds.setToNull(t,r)}getDescr(t,e){let n=this.ds.findColByName(this.header.fields[e].name);return n<0?"":this.ds.colDescr(n)}setDescr(t,e,n){let i=this.ds.findColByName(this.header.fields[e].name);i>=0&&this.ds.changeColumnName(i,this.ds.colName(i),n)}setup(){this.parseAndCorrect()}parseAndCorrect(){this.header={units:[],fields:[]};let t=!1;for(let e=0;e<this.ds.numExtensions;e++)if(this.ds.getExtType(e)==He.CODE){this.header=this.parseMetaData(this.ds.getExtData(e)),t=!0;break}if(this.ensureFields(),!t&&this.allowModify){let t=this.formatMetaData(this.header);this.ds.appendExtension(He.NAME,He.CODE,t)}}ensureFields(){for(let t of this.header.fields){let e="Measurement",n=this.ds.findColByName(t.name);n>=0&&(e=this.ds.colDescr(n)),this.allowModify&&(this.ds.ensureColumn(t.name+He.SUFFIX_VALUE,"real",e),this.ds.ensureColumn(t.name+He.SUFFIX_ERROR,"real","Error"),this.ds.ensureColumn(t.name+He.SUFFIX_UNITS,"string","Units"),this.ds.ensureColumn(t.name+He.SUFFIX_MOD,"string","Modifier"))}}parseMetaData(t){let e={units:[],fields:[]};for(let n of t.split(/\r?\n/)){let t=n.indexOf("=");if(!(t<0))if(n.startsWith("unit=")){let i=n.substring(t+1).split(",");i.length>=2&&e.units.push({name:vt.skUnescape(i[0]),uri:vt.skUnescape(i[1])})}else if(n.startsWith("field=")){let i=n.substring(t+1).split(","),s={name:vt.skUnescape(i[0]),units:[],defnURI:[]};for(let t=1;t<i.length;t++)s.units.push(vt.skUnescape(i[t]));e.fields.push(s)}else if(n.startsWith("definition=")){let i=n.substring(t+1).split(",");if(i.length>=2){let t=e.fields.find((t=>t.name==i[0]));if(!t)continue;for(let e=1;e<i.length;e++)t.defnURI.push(vt.skUnescape(i[e]))}}}return e}formatMetaData(e){let n=[];for(let t of e.units)n.push("unit="+vt.skEscape(t.name)+","+vt.skEscape(t.uri));for(let i of e.fields){let e="field="+vt.skEscape(i.name);for(let t of i.units)e+=","+vt.skEscape(t);if(n.push(e),t.notBlank(i.defnURI)){e="definition="+vt.skEscape(i.name);for(let t of i.defnURI)e+=","+vt.skEscape(t);n.push(e)}}return n.join("\n")}plainHeading(){return He.NAME}isColumnReserved(t){return this.areColumnsReserved([t])[0]}areColumnsReserved(t){let e=new Set;for(let t of this.header.fields)e.add(t.name+He.SUFFIX_VALUE),e.add(t.name+He.SUFFIX_ERROR),e.add(t.name+He.SUFFIX_UNITS),e.add(t.name+He.SUFFIX_MOD);let n=[];for(let i of t)n.push(e.has(i));return n}numTextRenderings(t){return this.header.fields.length}produceTextRendering(t,e){let n=this.header.fields[e],i=this.ds.findColByName(n.name),s={name:n.name,descr:i<0?"":this.ds.colDescr(i),text:"",type:Fe.TEXT_PLAIN},l=this.getValue(t,e);return Number.isNaN(l.value)||(l.mod&&(s.text+=l.mod+" "),s.text+=l.value,Number.isNaN(l.error)||(s.text+="  "+l.error),l.units&&(s.text+=" "+l.units)),s}}var We;He.CODE="org.mmi.aspect.MeasurementData",He.NAME="Measurement Data",He.SUFFIX_VALUE="",He.SUFFIX_ERROR="_error",He.SUFFIX_UNITS="_units",He.SUFFIX_MOD="_mod",Ue(He),function(t){t.Structure="structure",t.Name="name",t.Quantity="quantity",t.Bound="bound",t.Error="error",t.Ratio="ratio",t.Units="units",t.Relation="relation",t.Identifier="identifier",t.Link="link",t.Property="property"}(We||(We={}));class Ve extends Fe{static isMixture(t){for(let e=0;e<t.numExtensions;e++)if(t.getExtType(e)==Ve.CODE)return!0;return!1}constructor(t,e){super(Ve.CODE,t,e),this.header={attributes:[]},this.setup()}getHeader(){return this.header}setHeader(t){this.header=t;let e=this.formatMetaData(t);for(let t=0;t<this.ds.numExtensions;t++)if(this.ds.getExtType(t)==Ve.CODE)return void this.ds.setExtData(t,e);this.ds.appendExtension(Ve.NAME,Ve.CODE,e)}setup(){this.parseAndCorrect()}parseAndCorrect(){this.header={attributes:[]};let t=!1;for(let e=0;e<this.ds.numExtensions;e++)if(this.ds.getExtType(e)==Ve.CODE){this.header=this.parseMetaData(this.ds.getExtData(e)),t=!0;break}if(!t&&this.allowModify){let t=this.formatMetaData(this.header);this.ds.appendExtension(Ve.NAME,Ve.CODE,t)}}parseMetaData(t){let e={attributes:[]};for(let n of t.split(/\r?\n/)){let t=n.indexOf("=");if(!(t<0)&&n.startsWith("attr=")){let i=n.substring(t+1).split(",");if(i.length<3)continue;let s=vt.skUnescape(i[0]),l=[];"0"!=i[1]&&(l=i[1].split(".").map((t=>parseInt(t))));let r=i[2],o=[];for(let t=3;t<i.length;t++)o.push(vt.skUnescape(i[t]));e.attributes.push({column:s,position:l,type:r,info:o})}}return e}formatMetaData(e){let n=[];for(let i of e.attributes){let e=[vt.skEscape(i.column)];if(t.isBlank(i.position)?e.push("0"):e.push(i.position.join(".")),e.push(i.type),i.info)for(let t of i.info)e.push(vt.skEscape(t));n.push("attr="+e.join(","))}return n.join("\n")}plainHeading(){return He.NAME}isColumnReserved(t){return this.areColumnsReserved([t])[0]}areColumnsReserved(t){let e=new Set;for(let t of this.header.attributes)e.add(t.column);let n=[];for(let i of t)n.push(e.has(i));return n}}Ve.CODE="org.mmi.aspect.Mixture",Ve.NAME="Mixture",Ve.SUFFIX_VALUE="",Ue(Ve);var Ge;!function(t){t.Structure="structure",t.Name="name",t.Quantity="quantity",t.Bound="bound",t.Error="error",t.Ratio="ratio",t.Units="units",t.Relation="relation",t.Identifier="identifier",t.Link="link",t.Property="property"}(Ge||(Ge={}));class Qe{constructor(t,e,n,i){this.tableFile=t,this.lookupFile=e,this.mappingFile=n,this.verbose=i,this.table=null,this.aprov=null,this.mdata=null,this.lookup=null,this.mappings=[]}exec(){return t=this,e=void 0,i=function*(){let t;try{t=Rt.readFileSync(this.tableFile).toString()}catch(t){throw"Unable to read file "+this.tableFile+": "+t}if(this.tableFile.endsWith(".ds")?this.table=Ee.readXML(t):this.tableFile.endsWith(".sdf")?this.table=new gt(t).parse():this.tableFile.endsWith(".csv")?this.table=this.parseLines(",",!0):(this.tableFile.endsWith(".tsv")||this.tableFile.endsWith(".tab"))&&(this.table=this.parseLines("\t",!1)),!this.table)throw"Unable to parse: "+this.tableFile;if(je.isAssayProvenance(this.table)&&(this.aprov=new je(this.table,!1)),He.isMeasurementData(this.table)&&(this.mdata=new He(this.table,!1)),this.lookupFile,this.initialMapping(),this.mappingFile&&(t=Rt.readFileSync(this.mappingFile).toString(),this.customMapping(JSON.parse(t))),0==this.mappings.length)throw"No column mapping information available.";let e=new Pe;for(let t=0;t<this.table.numRows;t++){let n=this.extractMixture(t);n&&e.appendMixtureDirect(n)}console.log(e.serialise(!0))},new((n=void 0)||(n=Promise))((function(s,l){function r(t){try{a(i.next(t))}catch(t){l(t)}}function o(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}parseLines(t,e){return new it}initialMapping(){if(!Ve.isMixture(this.table))return;let e=new Ve(this.table,!1);for(let n of e.getHeader().attributes){let e={column:n.column,origin:t.add(n.position,-1),type:n.type,info:n.info};this.mappings.push(e)}}customMapping(t){for(let e of t){let t=this.mappings.findIndex((t=>t.column==e.column));t>=0?this.mappings[t]=e:this.mappings.push(e)}}extractMixture(e){let n=new De;for(let t of this.mappings){let e=n.mixfile;for(let n of t.origin){for(null==e.contents&&(e.contents=[]);n>=e.contents.length;)e.contents.push({});e=e.contents[n]}}let i=(t,e)=>isNaN(e)?t:null==t?e:"number"==typeof t&&t!=e?[Math.min(t,e),Math.max(t,e)]:t,s=new Map,l=this.mdata?this.mdata.getHeader().fields:[];for(let t of this.mappings){let r=this.table.findColByName(t.column);if(r<0||this.table.isNull(e,r))continue;let o=n.getComponent(t.origin);if(t.type==Ge.Structure){let t=this.table.getMolecule(e,r);o.molfile=new bt(t).write()}else if(t.type==Ge.Name)o.name=this.table.toString(e,r);else if(t.type==Ge.Quantity){if(this.aprov&&t.column==je.COLNAME_VALUE){o.quantity=this.aprov.getValue(e);let t=this.aprov.getError(e);isNaN(t)||(o.error=t),o.units=this.aprov.getUnits(e);let n=this.aprov.getRelation(e);n&&"="!=n&&(o.relation=n);continue}let n=l.find((e=>e.name==t.column));if(n){let t=this.mdata.getValueField(e,n);o.quantity=t.value,isNaN(t.error)||(o.error=t.error),o.units=t.units,t.mod&&"="!=t.mod&&(o.relation=t.mod);continue}let s=parseFloat(this.table.toString(e,r));o.quantity=i(o.quantity,s)}else if(t.type==Ge.Bound){let t=parseFloat(this.table.toString(e,r));o.quantity=i(o.quantity,t)}else if(t.type==Ge.Error){let t=parseFloat(this.table.toString(e,r));isNaN(t)||(o.error=t)}else if(t.type==Ge.Ratio){let n=parseFloat(this.table.toString(e,r));isNaN(n)||s.set(JSON.stringify(t.origin),n)}else if(t.type==Ge.Units){let t=this.table.toString(e,r);o.units=t}else if(t.type==Ge.Relation){let t=this.table.toString(e,r);o.relation=t}else t.type==Ge.Identifier?(null==o.identifiers&&(o.identifiers={}),o.identifiers[t.column]=this.table.toString(e,r)):t.type==Ge.Link?(null==o.links&&(o.links={}),o.links[t.column]=this.table.toString(e,r)):t.type==Ge.Property&&console.log("TODO: property")}for(let e of n.getOrigins()){let i=n.getComponent(e);if(t.isBlank(i.contents))continue;let l=0,r=0;for(let t=0;t<i.contents.length;t++)if(!De.isComponentEmpty(i.contents[t])){let n=s.get(JSON.stringify([...e,t]));if(!n){l=0;break}l++,r+=n}if(l>0)for(let t=0;t<i.contents.length;t++)if(!De.isComponentEmpty(i.contents[t])){let n=s.get(JSON.stringify([...e,t]));i.contents[t].ratio=[n,r]}}t:for(let e of t.reverse(n.getOrigins())){let i=n.getComponent(e);if(De.isComponentEmpty(i)){n.deleteComponent(e);continue}if(1!=t.arrayLength(i.contents))continue;for(let t in i)if("contents"!=t&&i[t])continue t;let s=i.contents[0];i.contents=null,n.setComponent(e,s)}return n}}class Ke{constructor(){this.ds=new it,this.colMol=this.ds.appendColumn("Molecule","molecule",""),this.colName=this.ds.appendColumn("Name","string",""),this.colHier=this.ds.appendColumn("MINCHI$N","string",""),this.colConc=this.ds.appendColumn("MINCHI$C","string","")}append(t){if(t.name||t.molfile||t.inchi)this.appendComponent(t,[1]);else if(t.contents)for(let e=0;e<t.contents.length;e++)this.appendComponent(t.contents[e],[e+1])}write(){return new yt(this.ds).write()}appendComponent(t,e){let n=this.ds.appendRow(),i=null;if(t.molfile&&(i=qt.fromString(t.molfile),!i))try{i=new Ct(t.molfile).parse()}catch(t){}if(i||(i=new qt),this.ds.setMolecule(n,this.colMol,i),t.name&&this.ds.setString(n,this.colName,t.name),this.ds.setString(n,this.colHier,e.join(".")),this.ds.setString(n,this.colConc,this.formatConcentration(t)),t.contents)for(let n=0;n<t.contents.length;n++){let i=e.slice(0);i.push(n+1),this.appendComponent(t.contents[n],i)}}formatConcentration(e){let n=null;return 2==t.len(e.ratio)&&(n=e.ratio[0]),_e.formatConcentration(e.quantity,e.error,n,e.units,e.relation)}}class $e{constructor(){this.buffer="",this.components=[],this.mixfiles=[]}feed(t){for(this.buffer+=t;;){let t=this.buffer.indexOf("$$$$\n");if(t<0)break;t+=5,this.processBlock(this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t)}}poll(e=!1){return t.notBlank(this.mixfiles)?this.mixfiles.shift():e&&t.notBlank(this.components)?(this.assembleComponents(),this.mixfiles[0]):null}processBlock(e){let n=new gt(e);n.upcastColumns=!1;let i=n.parse();if(!i||0==i.numRows)return;let s=i.firstColOfType("molecule"),l=i.findColByName("Name"),r=i.findColByName("MINCHI$N"),o=i.findColByName("MINCHI$C");if(r<0)return;let a=s<0?null:i.getMolecule(0,s),h=l<0?null:i.getString(0,l),u=i.getString(0,r),m=o<0?null:i.getString(0,o);t.notBlank(this.components)&&"1"==u&&this.assembleComponents(),this.components.push({mol:a,name:h,hier:u,conc:m})}assembleComponents(){let e=new De;for(let t of this.components){let n=t.mol?new bt(t.mol).write():void 0,i=t.hier.split(".").map((t=>parseInt(t)-1)),s=i.pop(),l=e.getComponent(i);l.contents||(l.contents=[]);let r={name:t.name,molfile:n,contents:[]};t.conc&&this.decodeConcentration(t.conc,r),l.contents[s]=r}1==e.mixfile.contents.length&&(e=new De(e.mixfile.contents[0]));let n=e=>{if(t.isBlank(e.contents))return;let i=0;for(let n of e.contents){if(!n.ratio||2!=t.len(n.ratio)){i=0;break}i+=n.ratio[0]}for(let t of e.contents)t.ratio=i>0?[t.ratio[0],i]:void 0;for(let t of e.contents)n(t)};n(e.mixfile),this.components=[],this.mixfiles.push(e.mixfile)}decodeConcentration(t,e){let n=t.match(/^([\>\<\=\~]*)([-\d\.:]+)(\w\w)([-\d]*)$/);if(!n)return;let i=n[1],s=n[2],l=n[3],r=parseInt(n[4])||0,o=null,a=NaN;if(n=s.match(/^([-\d\.]+):([-\d\.]+)$/)){if(o=parseFloat(n[1]),a=parseFloat(n[2]),isNaN(o)||isNaN(a))return}else if(o=parseFloat(s),isNaN(o))return;let h="",u=1,m=!1;if("pp"==l)h=Jt.pc;else if("wv"==l)[h,u]=[Jt.pcWV,100];else if("wf"==l)[h,u]=[Jt.pcWW,100];else if("vf"==l)[h,u]=[Jt.pcVV,100];else if("mf"==l)[h,u]=[Jt.pcMM,100];else if("rt"==l)m=!0;else if("mr"==l)[h,u]=[Jt.mol_L,1];else if("wv"==l)[h,u]=[Jt.g_L,1e3];else{if("mb"!=l)return;h=Jt.mol_kg}e.relation=i||void 0,m?e.ratio=[o,0]:isNaN(a)?(e.quantity=o*Math.pow(10,r)*u,e.units=he.uriToName(h)):(e.quantity=[o*Math.pow(10,r)*u,a*Math.pow(10,r)*u],e.units=he.uriToName(h))}}var Ze,Je=function(t,e,n,i){return new(n||(n=Promise))((function(s,l){function r(t){try{a(i.next(t))}catch(t){l(t)}}function o(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}a((i=i.apply(t,e||[])).next())}))};!function(t){t.Mixfile="mixfile",t.JSON="json",t.SDF="sdf",t.MInChI="minchi",t.LongMInChIKey="longminchikey",t.ShortMInChIKey="shortminchikey",t.SVG="svg"}(Ze||(Ze={}));const tn=Object.values(Ze);class en{constructor(t,e,i,s){if(this.inputFile=t,this.outputFile=i,this.process=n(932),this.inputFormat=null,this.outputFormat=null,this.instream=null,this.outstream=null,this.count=0,this.nextIndex=0,this.roster=[],e){if(!tn.includes(e))throw"Unknown input format: "+e;this.inputFormat=e}if(s){if(!tn.includes(s))throw"Unknown output format: "+s;this.outputFormat=s}}exec(){return Je(this,void 0,void 0,(function*(){if(this.inputFile&&!this.inputFormat)for(let t of tn)if(this.inputFile.endsWith("."+t)){this.inputFormat=t;break}if(!this.inputFormat)throw"Unknown input format";if(this.inputFormat==Ze.MInChI||this.inputFormat==Ze.SVG||this.inputFormat==Ze.LongMInChIKey||this.inputFormat==Ze.ShortMInChIKey)throw"Can only write format: "+this.inputFormat;if(this.outputFile&&!this.outputFormat)for(let t of tn)if(this.outputFile.endsWith("."+t)){this.outputFormat=t;break}if(!this.outputFormat)throw"Unknown output format";if((this.outputFormat==Ze.MInChI||this.outputFormat==Ze.LongMInChIKey||this.outputFormat==Ze.ShortMInChIKey)&&!Lt.hasExecutable())throw"For MInChI, must specify InChI executable as command line parameter.";this.instream=this.inputFile?Rt.createReadStream(this.inputFile):this.process.stdin,this.outstream=this.outputFile?Rt.createWriteStream(this.outputFile):this.process.stdout,this.outputFormat==Ze.JSON&&this.outstream.write("[\n"),this.inputFormat==Ze.Mixfile?yield this.pipeMixfile():this.inputFormat==Ze.JSON?yield this.pipeJSON():this.inputFormat==Ze.SDF&&(yield this.pipeSDF()),this.flushRoster(),this.outputFormat==Ze.JSON&&this.outstream.write("]\n"),this.outstream.end()}))}pipeMixfile(){return Je(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{let n="";this.instream.on("data",(t=>n+=t)),this.instream.on("end",(()=>{(()=>{Je(this,void 0,void 0,(function*(){try{let e=JSON.parse(n);yield this.processMixfile(this.count++,e),t()}catch(t){e(t)}}))})()}))}))}))}pipeJSON(){return Je(this,void 0,void 0,(function*(){const t=n(20);return new Promise(((e,n)=>{let i=t.withParser();this.instream.pipe(i.input),i.on("data",(t=>{let e=t.value;(()=>{Je(this,void 0,void 0,(function*(){try{yield this.processMixfile(this.count++,e)}catch(t){n(t)}}))})()})),i.on("end",(()=>e()))}))}))}pipeSDF(){return Je(this,void 0,void 0,(function*(){let t=new $e;return new Promise(((e,n)=>{this.instream.on("data",(e=>{t.feed(e);for(let e=t.poll();e;e=t.poll())this.processMixfile(this.count++,e)})),this.instream.on("end",(()=>{(()=>{Je(this,void 0,void 0,(function*(){try{let n=t.poll(!0);n&&(yield this.processMixfile(this.count++,n)),e()}catch(t){n(t)}}))})()}))}))}))}processMixfile(t,e){return Je(this,void 0,void 0,(function*(){if(null==e.mixfileVersion)throw"Invalid mixfile";let n=null;if(this.outputFormat==Ze.Mixfile)n=new De(e).serialise()+"\n";else if(this.outputFormat==Ze.JSON)this.outstream.write(0==t?" ":","),n=JSON.stringify(e)+"\n";else if(this.outputFormat==Ze.SDF){let t=new Ke;t.append(e),n=t.write()+"\n"}else if(this.outputFormat==Ze.MInChI){if(!Lt.isAvailable())throw"InChI unavailable: need to specify executable on command line";let t=new _e(e,new Lt);yield t.fillInChI(),t.formulate(),n=t.getResult()+"\n"}else if(this.outputFormat==Ze.LongMInChIKey){if(!Lt.isAvailable())throw"InChI unavailable: need to specify executable on command line";let t=new _e(e,new Lt);yield t.fillInChI(),n=t.makeLongHashKey()+"\n"}else if(this.outputFormat==Ze.ShortMInChIKey){if(!Lt.isAvailable())throw"InChI unavailable: need to specify executable on command line";let t=new _e(e,new Lt);yield t.fillInChI(),n=t.makeShortHashKey()+"\n"}else if(this.outputFormat==Ze.SVG){let t=Pt.defaultColourOnWhite(20),i=new Le(0,0,t.data.pointScale),s=new ee(new De(e),i,t);s.arrange();let l=new se;new re(s,l).draw(),l.normalise(),n=l.createSVG(!1)+"\n"}this.roster.push({idx:t,chunk:n}),this.flushRoster()}))}flushRoster(){for(this.roster.length>1&&this.roster.sort(((t,e)=>t.idx-e.idx));this.roster.length>0&&t.first(this.roster).idx==this.nextIndex;){let{chunk:t}=this.roster.shift();t&&this.outstream.write(t),this.nextIndex++}}}class nn{constructor(t){this.inputFile=null,this.inputFormat=null,this.outputFile=null,this.outputFormat=null,this.tableFile=null,this.lookupFile=null,this.mappingFile=null,this.htmlFile=null,this.withMInChI=!1,this.justHelp=!1,this.verbose=!1;for(let e=0;e<t.length;e++)"-i"==t[e]&&e+1<t.length?this.inputFile=t[++e]:"-if"==t[e]&&e+1<t.length?this.inputFormat=t[++e]:"-o"==t[e]&&e+1<t.length?this.outputFile=t[++e]:"-of"==t[e]&&e+1<t.length?this.outputFormat=t[++e]:"--table"==t[e]&&e+1<t.length?this.tableFile=t[++e]:"--lookup"==t[e]&&e+1<t.length?this.lookupFile=t[++e]:"--mapping"==t[e]&&e+1<t.length?this.mappingFile=t[++e]:"--html"==t[e]&&e+1<t.length?this.htmlFile=t[++e]:"--minchi"==t[e]?this.withMInChI=!0:"--inchi"==t[e]&&e<t.length-1?Lt.setExecutable(t[++e]):"-h"==t[e]||"-help"==t[e]||"--help"==t[e]?this.justHelp=!0:"--verbose"==t[e]&&(this.verbose=!0)}run(){return t=this,e=void 0,i=function*(){this.tableFile?yield new Qe(this.tableFile,this.lookupFile,this.mappingFile,this.verbose).exec():this.htmlFile?yield new ze(this.htmlFile,this.withMInChI).exec():this.inputFile||this.inputFormat||this.outputFile||this.outputFormat?yield new en(this.inputFile,this.inputFormat,this.outputFile,this.outputFormat).exec():(this.justHelp||this.log("Nothing to do."),this.printHelp())},new((n=void 0)||(n=Promise))((function(s,l){function r(t){try{a(i.next(t))}catch(t){l(t)}}function o(t){try{a(i.throw(t))}catch(t){l(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,o)}a((i=i.apply(t,e||[])).next())}));var t,e,n,i}printHelp(){console.log("Mixtures console utilities. Arguments:"),console.log("    -i {fn}          read input file (type guessed from suffix)"),console.log("    -if {fmt}        specify/override type for input file"),console.log("    -o {fn}          write output file (type guessed from suffix)"),console.log("    -of {fmt}        specify/override type for output file"),console.log("    --table {fn}     convert a tabular datafile to mixfile collection"),console.log("    --lookup {fn}    (optional) lookup file for name-to-structure"),console.log("    --mapping {fn}   (optional) JSON-formatted file for column mappings"),console.log("    --html {fn}      render mixfile collection as an HTML table"),console.log("    --minchi         (optional) include MInChI notation"),console.log("    --inchi {fn}     (optional) specify InChI executable location"),console.log("Mixture formats:");for(let t of tn)console.log("    "+t)}log(t){this.verbose&&console.log(t)}}})(),Mixtures=i})();
//# sourceMappingURL=mixtures-cmd.js.map